{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4947023347020149, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.00010000000000000002, "total_loss": 3.9984121225774287, "policy_loss": -0.0010634410471539013, "vf_loss": 8.018604266643525, "vf_explained_var": 0.02432607114315033, "kl": 0.000492472195292848, "entropy": 9.92506106197834, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49897750053140855, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0001, "total_loss": 1.3779194050365025, "policy_loss": -0.005810559750904167, "vf_loss": 2.7860887794267564, "vf_explained_var": 0.024375533489953905, "kl": 0.002894402650906794, "entropy": 9.8933000912742, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": 100.28689682360415, "episode_reward_min": 65.2425894765955, "episode_reward_mean": 81.43055367130587, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 3915, "policy_reward_min": {"seeker_policy": 29.98238245231051, "hider_policy": -21.007496549820083}, "policy_reward_max": {"seeker_policy": 96.86038341868985, "hider_policy": 44.27653930403754}, "policy_reward_mean": {"seeker_policy": 81.94517428780641, "hider_policy": -0.25731030825027434}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.86267964409278, 91.24622416521056, 81.19464624597865, 86.58943685330102, 84.25434306198922, 72.98037385998163, 100.28689682360415, 70.59990794424824, 80.47065183562654, 72.55820389672307, 72.09236261136957, 91.81516382467372, 89.1997202042219, 86.20409970373501, 99.88253930403752, 65.2425894765955, 70.92213953771414, 82.27035670238706, 75.14625081569937, 73.21438305849574, 75.31665379438277, 76.31947604183524, 84.17610220725115, 77.13698178612631, 75.68913722413193, 93.70189073437011, 74.65591419544953, 72.60326864265096, 90.85366227198685], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [85.07992826147898, 84.55812828159446, 92.73475069701607, 95.31067505682246, 88.3835723917388, 95.00995076707116, 55.78981977069456, 94.78431163017427, 93.34668270222136, 91.4906514129141, 86.77002197140122, 77.39349654982007, 63.19757700470505, 68.52916645277593, 29.98238245231051, 96.86038341868985, 72.63594469593315, 82.30686075210285, 93.31518104197697, 90.98395309278078, 84.4141068628106, 87.92212557645455, 69.41059448489747, 92.28846736478994, 90.5144494565257, 65.9478173621321, 87.90415471731266, 87.4538803890441, 72.0910197281964], "policy_hider_policy_reward": [0.29115082252310653, 9.491600560090713, 0.3784076968319373, 6.309688186784133, -9.067725586351486, -2.4723788646860076, -5.134675056822477, -3.5865631466989907, -5.287572391738746, 1.1583430619892323, -12.551148908615781, -9.47842799847374, 40.000896823604194, 4.49618022930542, -6.366092055751701, -17.81831163017429, -16.260682702221356, 3.384651835626611, -6.391059434140754, -12.541388082050336, -13.021347601007273, -1.6563117590243708, -21.007496549820083, 35.42916382467367, -4.131577004705057, 30.133720204221856, 22.248099703735033, -4.57316645277595, 25.6236175476895, 44.27653930403754, -13.559956309111296, -18.057837632983073, -5.081046826514573, 3.367241668295556, -0.7447655757409888, 0.7082615260251726, -5.779181041976949, -12.389749184300694, -6.492861773813907, -11.276708260471148, -5.639346205617221, -3.4581068628106224, 0.8113443480814599, -12.413993882700764, 9.272881499447738, 5.492626222905922, -4.539018213873613, -10.612467364789934, -7.673442533165173, -7.151869699228559, 38.205890734370065, -10.451817362132104, -9.987431640340143, -3.2608088815229808, -5.520142297542141, -9.330469448850945, -12.275019728196382, 31.037662271986854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0463416770052174, "mean_inference_ms": 0.7367183553728573, "mean_action_processing_ms": 0.1290219928347686, "mean_env_wait_ms": 1.7599420111288404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002014636993408203, "StateBufferConnector_ms": 0.002056565778008823, "ViewRequirementAgentConnector_ms": 0.05044608280576508}, "num_episodes": 29, "episode_return_max": 100.28689682360415, "episode_return_min": 65.2425894765955, "episode_return_mean": 81.43055367130587, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.60131584258522, "num_env_steps_trained_throughput_per_sec": 241.60131584258522, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 16556.214, "restore_workers_time_ms": 0.01, "training_step_time_ms": 16556.177, "sample_time_ms": 14734.933, "learn_time_ms": 1821.039, "learn_throughput": 2196.548, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 1, "trial_id": "default", "date": "2025-10-13_04-19-50", "timestamp": 1760343590, "time_this_iter_s": 16.55676794052124, "time_total_s": 16.55676794052124, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.55676794052124, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 26.34583333333333, "ram_util_percent": 34.987500000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49976712493225933, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.217439017444849, "policy_loss": -0.002712052350398153, "vf_loss": 6.459869332611561, "vf_explained_var": -0.0271213598549366, "kl": 0.0012007880665064988, "entropy": 9.903672569990158, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.0001, "total_loss": 1.219466541683863, "policy_loss": -0.006786939958923511, "vf_loss": 2.4716414860316687, "vf_explained_var": 0.09050364210492089, "kl": 0.003522951877867057, "entropy": 9.91955284088377, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.42857142857143, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 23965, "num_agent_steps_trained": 23965}, "env_runners": {"episode_reward_max": 100.28689682360415, "episode_reward_min": 64.07970624424243, "episode_reward_mean": 80.54027130403671, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 7965, "policy_reward_min": {"seeker_policy": 29.98238245231051, "hider_policy": -23.57882139736539}, "policy_reward_max": {"seeker_policy": 116.47535871961209, "hider_policy": 44.27653930403754}, "policy_reward_mean": {"seeker_policy": 84.42690291232954, "hider_policy": -1.9433158041464258}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.86267964409278, 91.24622416521056, 81.19464624597865, 86.58943685330102, 84.25434306198922, 72.98037385998163, 100.28689682360415, 70.59990794424824, 80.47065183562654, 72.55820389672307, 72.09236261136957, 91.81516382467372, 89.1997202042219, 86.20409970373501, 99.88253930403752, 65.2425894765955, 70.92213953771414, 82.27035670238706, 75.14625081569937, 73.21438305849574, 75.31665379438277, 76.31947604183524, 84.17610220725115, 77.13698178612631, 75.68913722413193, 93.70189073437011, 74.65591419544953, 72.60326864265096, 90.85366227198685, 95.25968457573441, 70.32176806190502, 82.46367502865414, 79.37594309665361, 77.19739088805039, 77.04854949347632, 74.32467592207293, 77.08484782772784, 83.0702939803183, 82.4125079900354, 72.16982328543041, 89.87918528938845, 88.23914308359664, 77.19002695039248, 77.60044649996411, 64.07970624424243, 89.37515807752908, 78.2100130862332, 68.4676553798916, 84.14254048445645, 75.06680847502176, 80.35312153072032, 81.07241591544229, 84.60885860435732, 68.99002075405166, 72.68154533069246, 81.50965242763306, 74.24123411647732, 89.30294332491178, 94.65031474523357], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [85.07992826147898, 84.55812828159446, 92.73475069701607, 95.31067505682246, 88.3835723917388, 95.00995076707116, 55.78981977069456, 94.78431163017427, 93.34668270222136, 91.4906514129141, 86.77002197140122, 77.39349654982007, 63.19757700470505, 68.52916645277593, 29.98238245231051, 96.86038341868985, 72.63594469593315, 82.30686075210285, 93.31518104197697, 90.98395309278078, 84.4141068628106, 87.92212557645455, 69.41059448489747, 92.28846736478994, 90.5144494565257, 65.9478173621321, 87.90415471731266, 87.4538803890441, 72.0910197281964, 58.378517295652, 91.2256584507183, 79.9311053693754, 89.17964583420633, 104.75482139736539, 101.83615644323592, 94.00292977839851, 92.17810284617015, 75.02406654934921, 69.64999875586817, 84.6988675842102, 65.83056507227914, 55.604201264157645, 95.97336242429927, 79.63073721053853, 90.80717983070937, 44.72084845315939, 77.72654582146832, 95.8129489297958, 86.2881856527847, 94.0262155402372, 84.83452804555623, 93.91052148256412, 92.56784610720715, 95.77726925718771, 99.23971870454706, 96.43040328997094, 89.69446382303238, 116.47535871961209, 108.56644754740012], "policy_hider_policy_reward": [0.29115082252310653, 9.491600560090713, 0.3784076968319373, 6.309688186784133, -9.067725586351486, -2.4723788646860076, -5.134675056822477, -3.5865631466989907, -5.287572391738746, 1.1583430619892323, -12.551148908615781, -9.47842799847374, 40.000896823604194, 4.49618022930542, -6.366092055751701, -17.81831163017429, -16.260682702221356, 3.384651835626611, -6.391059434140754, -12.541388082050336, -13.021347601007273, -1.6563117590243708, -21.007496549820083, 35.42916382467367, -4.131577004705057, 30.133720204221856, 22.248099703735033, -4.57316645277595, 25.6236175476895, 44.27653930403754, -13.559956309111296, -18.057837632983073, -5.081046826514573, 3.367241668295556, -0.7447655757409888, 0.7082615260251726, -5.779181041976949, -12.389749184300694, -6.492861773813907, -11.276708260471148, -5.639346205617221, -3.4581068628106224, 0.8113443480814599, -12.413993882700764, 9.272881499447738, 5.492626222905922, -4.539018213873613, -10.612467364789934, -7.673442533165173, -7.151869699228559, 38.205890734370065, -10.451817362132104, -9.987431640340143, -3.2608088815229808, -5.520142297542141, -9.330469448850945, -12.275019728196382, 31.037662271986854, 40.66368457573441, -3.782517295651998, -9.469658450718304, -11.434231938094978, 9.167675028654122, -6.635105369375412, 6.629943096653622, -16.43364583420634, -23.57882139736539, -3.9786091119495635, -11.77244379535329, -13.015163154406396, -8.915961344414171, -10.762292511911468, -5.053135443781859, -10.040119574660503, -2.3980665493491764, 10.444293980318253, 2.6023725538191544, 10.160136680348021, -0.9960695215478579, -11.532974777231964, -0.7945650722791797, 24.84318528938846, 6.45722969088473, 26.177712128554255, -0.9759730496075361, -17.80736242429925, -3.2432062209298214, 1.2129155103553897, -13.333110604494077, -13.394362981972904, 33.3836794101224, 11.270630214247243, 9.847382195729093, -9.36391493096418, -12.686507168686967, -14.65878638121714, 8.246540484456526, -10.392185652784754, -14.169440558783972, -4.789966506431483, -4.078528045556245, -0.4028784692796569, 3.8664159154422437, -16.704521482564136, -9.921846107207182, 1.9628586043573732, -17.888216635173166, -8.899031867962853, -14.244454669307565, -12.313718704547053, -10.172688362264523, -4.748062500073469, -6.5372744104748515, -8.915955296080224, -14.102991834410675, -13.06942356028966, -19.248073531400287, 5.331940729233877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.053358878164288, "mean_inference_ms": 0.7419032965113117, "mean_action_processing_ms": 0.12994415070174548, "mean_env_wait_ms": 1.7744215951255082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020198902841341696, "StateBufferConnector_ms": 0.0020712108935339976, "ViewRequirementAgentConnector_ms": 0.05215446827775341}, "num_episodes": 30, "episode_return_max": 100.28689682360415, "episode_return_min": 64.07970624424243, "episode_return_mean": 80.54027130403671, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23965, "num_agent_steps_trained": 23965, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.86137596700937, "num_env_steps_trained_throughput_per_sec": 234.86137596700937, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 23965, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 23965, "timers": {"training_iteration_time_ms": 16793.772, "restore_workers_time_ms": 0.009, "training_step_time_ms": 16793.74, "sample_time_ms": 14950.417, "learn_time_ms": 1843.076, "learn_throughput": 2170.285, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 23965, "num_agent_steps_trained": 23965}, "done": false, "training_iteration": 2, "trial_id": "default", "date": "2025-10-13_04-20-07", "timestamp": 1760343607, "time_this_iter_s": 17.03175115585327, "time_total_s": 33.58851909637451, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.58851909637451, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 32.72083333333333, "ram_util_percent": 35.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00010000000000000002, "total_loss": 3.235263277590275, "policy_loss": -0.002528839948354289, "vf_loss": 6.494806237518787, "vf_explained_var": 0.004748981259763241, "kl": 0.003463873089997452, "entropy": 9.784205254912376, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 800.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 1.3250694252195812, "policy_loss": -0.006970164414110874, "vf_loss": 2.683485504180666, "vf_explained_var": 0.06609475158509753, "kl": 0.004096685699975094, "entropy": 9.907981798383926, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.28571428571429, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 35921, "num_agent_steps_trained": 35921}, "env_runners": {"episode_reward_max": 100.28689682360415, "episode_reward_min": 64.07970624424243, "episode_reward_mean": 80.08718717586062, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 11880, "policy_reward_min": {"seeker_policy": 29.98238245231051, "hider_policy": -27.029827128907147}, "policy_reward_max": {"seeker_policy": 116.47535871961209, "hider_policy": 44.27653930403754}, "policy_reward_mean": {"seeker_policy": 84.50911007500345, "hider_policy": -2.2109614495714256}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.86267964409278, 91.24622416521056, 81.19464624597865, 86.58943685330102, 84.25434306198922, 72.98037385998163, 100.28689682360415, 70.59990794424824, 80.47065183562654, 72.55820389672307, 72.09236261136957, 91.81516382467372, 89.1997202042219, 86.20409970373501, 99.88253930403752, 65.2425894765955, 70.92213953771414, 82.27035670238706, 75.14625081569937, 73.21438305849574, 75.31665379438277, 76.31947604183524, 84.17610220725115, 77.13698178612631, 75.68913722413193, 93.70189073437011, 74.65591419544953, 72.60326864265096, 90.85366227198685, 95.25968457573441, 70.32176806190502, 82.46367502865414, 79.37594309665361, 77.19739088805039, 77.04854949347632, 74.32467592207293, 77.08484782772784, 83.0702939803183, 82.4125079900354, 72.16982328543041, 89.87918528938845, 88.23914308359664, 77.19002695039248, 77.60044649996411, 64.07970624424243, 89.37515807752908, 78.2100130862332, 68.4676553798916, 84.14254048445645, 75.06680847502176, 80.35312153072032, 81.07241591544229, 84.60885860435732, 68.99002075405166, 72.68154533069246, 81.50965242763306, 74.24123411647732, 89.30294332491178, 94.65031474523357, 78.03286758217949, 77.5991887137722, 89.18943638949702, 81.32738216154289, 84.0404435608089, 83.42810699530958, 86.89068697272552, 89.57845705455944, 68.9284626154206, 85.16846295121978, 77.38047968531318, 81.67642204865494, 90.10289602412394, 66.56340782157008, 70.6714867456337, 67.9878594305288, 71.5268362789977, 77.73738834481209, 70.64170675427818, 85.53774512373711, 81.81733951141072, 84.45826855329258, 96.95775690107398, 75.43603316632087, 71.98512259209312, 78.26513456762638, 73.3008124836269, 76.23849545761253, 73.32777804982702], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [85.07992826147898, 84.55812828159446, 92.73475069701607, 95.31067505682246, 88.3835723917388, 95.00995076707116, 55.78981977069456, 94.78431163017427, 93.34668270222136, 91.4906514129141, 86.77002197140122, 77.39349654982007, 63.19757700470505, 68.52916645277593, 29.98238245231051, 96.86038341868985, 72.63594469593315, 82.30686075210285, 93.31518104197697, 90.98395309278078, 84.4141068628106, 87.92212557645455, 69.41059448489747, 92.28846736478994, 90.5144494565257, 65.9478173621321, 87.90415471731266, 87.4538803890441, 72.0910197281964, 58.378517295652, 91.2256584507183, 79.9311053693754, 89.17964583420633, 104.75482139736539, 101.83615644323592, 94.00292977839851, 92.17810284617015, 75.02406654934921, 69.64999875586817, 84.6988675842102, 65.83056507227914, 55.604201264157645, 95.97336242429927, 79.63073721053853, 90.80717983070937, 44.72084845315939, 77.72654582146832, 95.8129489297958, 86.2881856527847, 94.0262155402372, 84.83452804555623, 93.91052148256412, 92.56784610720715, 95.77726925718771, 99.23971870454706, 96.43040328997094, 89.69446382303238, 116.47535871961209, 108.56644754740012, 68.11585848399149, 97.95751802708064, 97.79880555117573, 88.22249613244308, 75.45356430081559, 85.564251092431, 78.1576295177295, 45.47541586174302, 88.55101161239972, 94.72629513393136, 91.4214592681518, 94.36638100983991, 35.22471631784082, 97.94644882746893, 99.28205905866935, 104.30582712890713, 90.08257708936279, 89.43438280749405, 102.39323611735541, 86.8511548379376, 64.46216908843344, 84.27695109028652, 61.15721565961049, 96.99714935029985, 88.35741785397876, 83.68533342593227, 81.06913796976693, 87.81064863203362, 96.46730352575074], "policy_hider_policy_reward": [0.29115082252310653, 9.491600560090713, 0.3784076968319373, 6.309688186784133, -9.067725586351486, -2.4723788646860076, -5.134675056822477, -3.5865631466989907, -5.287572391738746, 1.1583430619892323, -12.551148908615781, -9.47842799847374, 40.000896823604194, 4.49618022930542, -6.366092055751701, -17.81831163017429, -16.260682702221356, 3.384651835626611, -6.391059434140754, -12.541388082050336, -13.021347601007273, -1.6563117590243708, -21.007496549820083, 35.42916382467367, -4.131577004705057, 30.133720204221856, 22.248099703735033, -4.57316645277595, 25.6236175476895, 44.27653930403754, -13.559956309111296, -18.057837632983073, -5.081046826514573, 3.367241668295556, -0.7447655757409888, 0.7082615260251726, -5.779181041976949, -12.389749184300694, -6.492861773813907, -11.276708260471148, -5.639346205617221, -3.4581068628106224, 0.8113443480814599, -12.413993882700764, 9.272881499447738, 5.492626222905922, -4.539018213873613, -10.612467364789934, -7.673442533165173, -7.151869699228559, 38.205890734370065, -10.451817362132104, -9.987431640340143, -3.2608088815229808, -5.520142297542141, -9.330469448850945, -12.275019728196382, 31.037662271986854, 40.66368457573441, -3.782517295651998, -9.469658450718304, -11.434231938094978, 9.167675028654122, -6.635105369375412, 6.629943096653622, -16.43364583420634, -23.57882139736539, -3.9786091119495635, -11.77244379535329, -13.015163154406396, -8.915961344414171, -10.762292511911468, -5.053135443781859, -10.040119574660503, -2.3980665493491764, 10.444293980318253, 2.6023725538191544, 10.160136680348021, -0.9960695215478579, -11.532974777231964, -0.7945650722791797, 24.84318528938846, 6.45722969088473, 26.177712128554255, -0.9759730496075361, -17.80736242429925, -3.2432062209298214, 1.2129155103553897, -13.333110604494077, -13.394362981972904, 33.3836794101224, 11.270630214247243, 9.847382195729093, -9.36391493096418, -12.686507168686967, -14.65878638121714, 8.246540484456526, -10.392185652784754, -14.169440558783972, -4.789966506431483, -4.078528045556245, -0.4028784692796569, 3.8664159154422437, -16.704521482564136, -9.921846107207182, 1.9628586043573732, -17.888216635173166, -8.899031867962853, -14.244454669307565, -12.313718704547053, -10.172688362264523, -4.748062500073469, -6.5372744104748515, -8.915955296080224, -14.102991834410675, -13.06942356028966, -19.248073531400287, 5.331940729233877, 13.666867582179488, -3.7498584839915003, -1.2868112862278067, -19.071518027080604, -2.6839098509595694, -5.925459310719128, -8.936496132443086, 2.0413821615428294, -0.047564300815576235, 8.634443560808956, 2.8121069953095055, -4.948251092430954, -7.8016295177294674, 16.53468697272551, 30.48599993116105, 13.617041261655272, -8.530682992773054, -11.091866004206082, -10.760295133931443, 1.2024629512197709, -4.825520314686806, -9.215459268151779, -11.340381009839932, -1.349577951345058, 35.60968699987353, 19.268492706409535, -16.773360545540665, -14.609680460358163, -20.21605905866937, -8.394513254366286, -27.029827128907147, -9.288140569471226, -17.796577089362735, -0.759163721002281, -12.869774671893856, 1.1727802092119304, -20.2257218194256, -11.525807543651695, 18.321745123737152, -19.635154837937595, 4.25643712965905, 13.098733293318174, -10.33095109028649, 10.512268553292555, 42.871756901073915, -7.071215659610517, -6.8099668336791, -14.751149350299883, -9.965113097011685, -6.4071821648739595, -2.972461633858528, -2.44773722444736, -4.0599043289905845, -3.7084211571495302, -4.912741643635451, -6.65941153078566, -13.039310255327157, -10.10021522059659]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0535752256634627, "mean_inference_ms": 0.7426113779819876, "mean_action_processing_ms": 0.13034691628200523, "mean_env_wait_ms": 1.781302275202315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020342794331637297, "StateBufferConnector_ms": 0.0020995736122131348, "ViewRequirementAgentConnector_ms": 0.05066421898928555}, "num_episodes": 29, "episode_return_max": 100.28689682360415, "episode_return_min": 64.07970624424243, "episode_return_mean": 80.08718717586062, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35921, "num_agent_steps_trained": 35921, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.80219035311353, "num_env_steps_trained_throughput_per_sec": 238.80219035311353, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 35921, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 35921, "timers": {"training_iteration_time_ms": 16779.272, "restore_workers_time_ms": 0.009, "training_step_time_ms": 16779.242, "sample_time_ms": 14942.591, "learn_time_ms": 1836.366, "learn_throughput": 2178.215, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 35921, "num_agent_steps_trained": 35921}, "done": false, "training_iteration": 3, "trial_id": "default", "date": "2025-10-13_04-20-23", "timestamp": 1760343623, "time_this_iter_s": 16.750703811645508, "time_total_s": 50.33922290802002, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 50.33922290802002, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 33.666666666666664, "ram_util_percent": 35.15833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.00010000000000000002, "total_loss": 3.206467892974615, "policy_loss": -0.006765860474843066, "vf_loss": 6.445790882408619, "vf_explained_var": 0.005530278757214546, "kl": 0.003399518300911818, "entropy": 9.746667385101318, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1120.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000002, "total_loss": 1.2209817921923052, "policy_loss": -0.007017642798112525, "vf_loss": 2.4756229316034624, "vf_explained_var": 0.12062262979245955, "kl": 0.0040537944281597545, "entropy": 9.91337894162824, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.61290322580645, "num_grad_updates_lifetime": 2200.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 47833, "num_agent_steps_trained": 47833}, "env_runners": {"episode_reward_max": 96.95775690107398, "episode_reward_min": 64.07970624424243, "episode_reward_mean": 79.88052325549968, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 35.22471631784082, "hider_policy": -27.029827128907147}, "policy_reward_max": {"seeker_policy": 116.47535871961209, "hider_policy": 42.871756901073915}, "policy_reward_mean": {"seeker_policy": 83.59675168884884, "hider_policy": -1.8581142166745754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.14625081569937, 73.21438305849574, 75.31665379438277, 76.31947604183524, 84.17610220725115, 77.13698178612631, 75.68913722413193, 93.70189073437011, 74.65591419544953, 72.60326864265096, 90.85366227198685, 95.25968457573441, 70.32176806190502, 82.46367502865414, 79.37594309665361, 77.19739088805039, 77.04854949347632, 74.32467592207293, 77.08484782772784, 83.0702939803183, 82.4125079900354, 72.16982328543041, 89.87918528938845, 88.23914308359664, 77.19002695039248, 77.60044649996411, 64.07970624424243, 89.37515807752908, 78.2100130862332, 68.4676553798916, 84.14254048445645, 75.06680847502176, 80.35312153072032, 81.07241591544229, 84.60885860435732, 68.99002075405166, 72.68154533069246, 81.50965242763306, 74.24123411647732, 89.30294332491178, 94.65031474523357, 78.03286758217949, 77.5991887137722, 89.18943638949702, 81.32738216154289, 84.0404435608089, 83.42810699530958, 86.89068697272552, 89.57845705455944, 68.9284626154206, 85.16846295121978, 77.38047968531318, 81.67642204865494, 90.10289602412394, 66.56340782157008, 70.6714867456337, 67.9878594305288, 71.5268362789977, 77.73738834481209, 70.64170675427818, 85.53774512373711, 81.81733951141072, 84.45826855329258, 96.95775690107398, 75.43603316632087, 71.98512259209312, 78.26513456762638, 73.3008124836269, 76.23849545761253, 73.32777804982702, 82.50786716273868, 73.16889083102052, 90.28872483652157, 82.96826638646051, 72.59208170400858, 77.08274697321596, 92.2355853465098, 85.02940090888514, 79.60584524043989, 79.21607469525807, 81.85423579321973, 92.46164145976718, 73.78832204189567, 79.811363695853, 78.02517395102915, 87.40910603696805, 78.7933895467537, 69.93883656506956, 84.94085144294849, 91.17653951860137, 85.89082499222344, 84.91223515017951, 66.47707107151098, 80.81539293721737, 80.41423056767914, 81.95257803118183, 71.94841516612209, 78.87767341569541, 82.7219476776355, 86.1468766231148], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [93.31518104197697, 90.98395309278078, 84.4141068628106, 87.92212557645455, 69.41059448489747, 92.28846736478994, 90.5144494565257, 65.9478173621321, 87.90415471731266, 87.4538803890441, 72.0910197281964, 58.378517295652, 91.2256584507183, 79.9311053693754, 89.17964583420633, 104.75482139736539, 101.83615644323592, 94.00292977839851, 92.17810284617015, 75.02406654934921, 69.64999875586817, 84.6988675842102, 65.83056507227914, 55.604201264157645, 95.97336242429927, 79.63073721053853, 90.80717983070937, 44.72084845315939, 77.72654582146832, 95.8129489297958, 86.2881856527847, 94.0262155402372, 84.83452804555623, 93.91052148256412, 92.56784610720715, 95.77726925718771, 99.23971870454706, 96.43040328997094, 89.69446382303238, 116.47535871961209, 108.56644754740012, 68.11585848399149, 97.95751802708064, 97.79880555117573, 88.22249613244308, 75.45356430081559, 85.564251092431, 78.1576295177295, 45.47541586174302, 88.55101161239972, 94.72629513393136, 91.4214592681518, 94.36638100983991, 35.22471631784082, 97.94644882746893, 99.28205905866935, 104.30582712890713, 90.08257708936279, 89.43438280749405, 102.39323611735541, 86.8511548379376, 64.46216908843344, 84.27695109028652, 61.15721565961049, 96.99714935029985, 88.35741785397876, 83.68533342593227, 81.06913796976693, 87.81064863203362, 96.46730352575074, 68.46943336508261, 84.81061195002859, 55.99566073160292, 81.77015511769804, 92.29770705942185, 86.96983940918213, 109.03335704387948, 58.42927332346808, 92.42649806384713, 96.44527373493432, 87.57253411333625, 49.58630126880341, 87.56442739138026, 70.53583249768154, 84.66889075747407, 55.542623805628345, 75.50036370953283, 84.28526892719447, 75.73550773743722, 69.90152049922648, 67.99187816313646, 72.49266326205628, 79.93164130648674, 80.80818729470865, 80.70236331131585, 99.28044777117829, 97.51700615788175, 82.29188396832043, 80.48753372747865, 67.99310108464043], "policy_hider_policy_reward": [-5.779181041976949, -12.389749184300694, -6.492861773813907, -11.276708260471148, -5.639346205617221, -3.4581068628106224, 0.8113443480814599, -12.413993882700764, 9.272881499447738, 5.492626222905922, -4.539018213873613, -10.612467364789934, -7.673442533165173, -7.151869699228559, 38.205890734370065, -10.451817362132104, -9.987431640340143, -3.2608088815229808, -5.520142297542141, -9.330469448850945, -12.275019728196382, 31.037662271986854, 40.66368457573441, -3.782517295651998, -9.469658450718304, -11.434231938094978, 9.167675028654122, -6.635105369375412, 6.629943096653622, -16.43364583420634, -23.57882139736539, -3.9786091119495635, -11.77244379535329, -13.015163154406396, -8.915961344414171, -10.762292511911468, -5.053135443781859, -10.040119574660503, -2.3980665493491764, 10.444293980318253, 2.6023725538191544, 10.160136680348021, -0.9960695215478579, -11.532974777231964, -0.7945650722791797, 24.84318528938846, 6.45722969088473, 26.177712128554255, -0.9759730496075361, -17.80736242429925, -3.2432062209298214, 1.2129155103553897, -13.333110604494077, -13.394362981972904, 33.3836794101224, 11.270630214247243, 9.847382195729093, -9.36391493096418, -12.686507168686967, -14.65878638121714, 8.246540484456526, -10.392185652784754, -14.169440558783972, -4.789966506431483, -4.078528045556245, -0.4028784692796569, 3.8664159154422437, -16.704521482564136, -9.921846107207182, 1.9628586043573732, -17.888216635173166, -8.899031867962853, -14.244454669307565, -12.313718704547053, -10.172688362264523, -4.748062500073469, -6.5372744104748515, -8.915955296080224, -14.102991834410675, -13.06942356028966, -19.248073531400287, 5.331940729233877, 13.666867582179488, -3.7498584839915003, -1.2868112862278067, -19.071518027080604, -2.6839098509595694, -5.925459310719128, -8.936496132443086, 2.0413821615428294, -0.047564300815576235, 8.634443560808956, 2.8121069953095055, -4.948251092430954, -7.8016295177294674, 16.53468697272551, 30.48599993116105, 13.617041261655272, -8.530682992773054, -11.091866004206082, -10.760295133931443, 1.2024629512197709, -4.825520314686806, -9.215459268151779, -11.340381009839932, -1.349577951345058, 35.60968699987353, 19.268492706409535, -16.773360545540665, -14.609680460358163, -20.21605905866937, -8.394513254366286, -27.029827128907147, -9.288140569471226, -17.796577089362735, -0.759163721002281, -12.869774671893856, 1.1727802092119304, -20.2257218194256, -11.525807543651695, 18.321745123737152, -19.635154837937595, 4.25643712965905, 13.098733293318174, -10.33095109028649, 10.512268553292555, 42.871756901073915, -7.071215659610517, -6.8099668336791, -14.751149350299883, -9.965113097011685, -6.4071821648739595, -2.972461633858528, -2.44773722444736, -4.0599043289905845, -3.7084211571495302, -4.912741643635451, -6.65941153078566, -13.039310255327157, -10.10021522059659, 9.75772226605756, 4.280711531598523, -5.945839430696629, -5.695881688311488, 0.13033926839707793, 34.16272483652153, 3.7605989810251557, -2.562487712262635, -6.283918295991443, -13.421707059421813, 0.1567469732159199, -10.043839409182134, 0.3325689779066253, -17.130340675276273, 14.885228425199863, 11.714899160217257, -5.260154759560042, -7.560498063847182, -12.222048356452746, -5.007150683223541, -11.586534113336274, 5.8682357932197, 34.2156414597672, 8.659698731196562, -2.241351935593595, -11.534753413891002, 6.545363695852989, 2.730167502318445, -9.802890757474078, 3.159173951029187, 5.453812720700264, 26.4126695106394, 5.273932530847656, -1.9809066936267945, -6.90585856957812, -7.440573792546826, -7.16950773743719, 16.37485144294845, 34.96053951860137, -13.685520499226474, 0.5641218368635301, 17.334824992223474, -2.2866632620563068, 14.706235150179587, -12.464798698508497, -0.9897715364672117, 1.5093929372174182, -1.5021872947086876, 11.248230567679204, -11.536363311315892, -8.129865033926489, -9.198004706069959, -21.3910061578817, -4.17758483387787, -4.2998456825575895, 0.8856351299325556, 6.307433182781661, -4.073019232624842, -1.827101084640437, 19.980876623114753]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0558055746091712, "mean_inference_ms": 0.7434964317670034, "mean_action_processing_ms": 0.1309286448301247, "mean_env_wait_ms": 1.7923143667316486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001992940902709961, "StateBufferConnector_ms": 0.002047300338745117, "ViewRequirementAgentConnector_ms": 0.04866194725036621}, "num_episodes": 30, "episode_return_max": 96.95775690107398, "episode_return_min": 64.07970624424243, "episode_return_mean": 79.88052325549968, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47833, "num_agent_steps_trained": 47833, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.7780634889253, "num_env_steps_trained_throughput_per_sec": 234.7780634889253, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 47833, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 47833, "timers": {"training_iteration_time_ms": 16843.797, "restore_workers_time_ms": 0.008, "training_step_time_ms": 16843.769, "sample_time_ms": 14985.28, "learn_time_ms": 1858.188, "learn_throughput": 2152.635, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 47833, "num_agent_steps_trained": 47833}, "done": false, "training_iteration": 4, "trial_id": "default", "date": "2025-10-13_04-20-40", "timestamp": 1760343640, "time_this_iter_s": 17.03793478012085, "time_total_s": 67.37715768814087, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 67.37715768814087, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 32.0, "ram_util_percent": 35.208333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.1793309837579726, "policy_loss": -0.0041250042151659725, "vf_loss": 6.386356815695763, "vf_explained_var": -0.023441222496330738, "kl": 0.0033469408068020562, "entropy": 9.76426253914833, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 0.0001, "total_loss": 1.317582495912673, "policy_loss": -0.00724803414047947, "vf_loss": 2.669349473620218, "vf_explained_var": 0.24411126091366722, "kl": 0.003716685090802329, "entropy": 9.89066807126242, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2825.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 59833, "num_agent_steps_trained": 59833}, "env_runners": {"episode_reward_max": 96.95775690107398, "episode_reward_min": 62.36008135845665, "episode_reward_mean": 79.58379805325563, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 35.22471631784082, "hider_policy": -27.029827128907147}, "policy_reward_max": {"seeker_policy": 116.47535871961209, "hider_policy": 42.871756901073915}, "policy_reward_mean": {"seeker_policy": 83.39027348960957, "hider_policy": -1.903237718176972}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.14254048445645, 75.06680847502176, 80.35312153072032, 81.07241591544229, 84.60885860435732, 68.99002075405166, 72.68154533069246, 81.50965242763306, 74.24123411647732, 89.30294332491178, 94.65031474523357, 78.03286758217949, 77.5991887137722, 89.18943638949702, 81.32738216154289, 84.0404435608089, 83.42810699530958, 86.89068697272552, 89.57845705455944, 68.9284626154206, 85.16846295121978, 77.38047968531318, 81.67642204865494, 90.10289602412394, 66.56340782157008, 70.6714867456337, 67.9878594305288, 71.5268362789977, 77.73738834481209, 70.64170675427818, 85.53774512373711, 81.81733951141072, 84.45826855329258, 96.95775690107398, 75.43603316632087, 71.98512259209312, 78.26513456762638, 73.3008124836269, 76.23849545761253, 73.32777804982702, 82.50786716273868, 73.16889083102052, 90.28872483652157, 82.96826638646051, 72.59208170400858, 77.08274697321596, 92.2355853465098, 85.02940090888514, 79.60584524043989, 79.21607469525807, 81.85423579321973, 92.46164145976718, 73.78832204189567, 79.811363695853, 78.02517395102915, 87.40910603696805, 78.7933895467537, 69.93883656506956, 84.94085144294849, 91.17653951860137, 85.89082499222344, 84.91223515017951, 66.47707107151098, 80.81539293721737, 80.41423056767914, 81.95257803118183, 71.94841516612209, 78.87767341569541, 82.7219476776355, 86.1468766231148, 67.54476946803469, 72.852163980523, 83.71161224838318, 85.13335058786365, 74.29020440087382, 73.43097939506981, 83.95375173710079, 87.05349455950326, 96.27029475997149, 69.45229141462544, 79.59513755734838, 71.35680640556868, 73.37299700722177, 88.54301924308763, 69.37754666358427, 79.94493024313181, 79.09989530249034, 77.85320844667562, 82.08851414698773, 71.54060831275979, 72.30867740255536, 73.5997611061362, 66.93472101440291, 76.76821077110223, 82.51013687626643, 62.36008135845665, 90.99325863986452, 72.33665377948326, 95.9077650230781, 82.72685345712058], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [86.2881856527847, 94.0262155402372, 84.83452804555623, 93.91052148256412, 92.56784610720715, 95.77726925718771, 99.23971870454706, 96.43040328997094, 89.69446382303238, 116.47535871961209, 108.56644754740012, 68.11585848399149, 97.95751802708064, 97.79880555117573, 88.22249613244308, 75.45356430081559, 85.564251092431, 78.1576295177295, 45.47541586174302, 88.55101161239972, 94.72629513393136, 91.4214592681518, 94.36638100983991, 35.22471631784082, 97.94644882746893, 99.28205905866935, 104.30582712890713, 90.08257708936279, 89.43438280749405, 102.39323611735541, 86.8511548379376, 64.46216908843344, 84.27695109028652, 61.15721565961049, 96.99714935029985, 88.35741785397876, 83.68533342593227, 81.06913796976693, 87.81064863203362, 96.46730352575074, 68.46943336508261, 84.81061195002859, 55.99566073160292, 81.77015511769804, 92.29770705942185, 86.96983940918213, 109.03335704387948, 58.42927332346808, 92.42649806384713, 96.44527373493432, 87.57253411333625, 49.58630126880341, 87.56442739138026, 70.53583249768154, 84.66889075747407, 55.542623805628345, 75.50036370953283, 84.28526892719447, 75.73550773743722, 69.90152049922648, 67.99187816313646, 72.49266326205628, 79.93164130648674, 80.80818729470865, 80.70236331131585, 99.28044777117829, 97.51700615788175, 82.29188396832043, 80.48753372747865, 67.99310108464043, 91.28945788127162, 83.11100538783974, 97.22536307570385, 74.80198626509613, 85.89933549204952, 73.61002919131708, 77.57937520132457, 71.53623293006773, 66.11326047725659, 108.67617404453328, 81.83839826028452, 84.11966700516975, 89.30771467890592, 42.31551742874246, 85.60501198838652, 91.95211413126994, 82.54583768034875, 79.92740857333402, 65.9215137761799, 108.23828910755354, 89.51898497156996, 88.77506891376083, 82.8386110861087, 96.42507279193977, 66.56024051645842, 91.22654238646126, 47.89312842958692, 100.360261664662, 71.48092138839844, 71.87166473837142], "policy_hider_policy_reward": [8.246540484456526, -10.392185652784754, -14.169440558783972, -4.789966506431483, -4.078528045556245, -0.4028784692796569, 3.8664159154422437, -16.704521482564136, -9.921846107207182, 1.9628586043573732, -17.888216635173166, -8.899031867962853, -14.244454669307565, -12.313718704547053, -10.172688362264523, -4.748062500073469, -6.5372744104748515, -8.915955296080224, -14.102991834410675, -13.06942356028966, -19.248073531400287, 5.331940729233877, 13.666867582179488, -3.7498584839915003, -1.2868112862278067, -19.071518027080604, -2.6839098509595694, -5.925459310719128, -8.936496132443086, 2.0413821615428294, -0.047564300815576235, 8.634443560808956, 2.8121069953095055, -4.948251092430954, -7.8016295177294674, 16.53468697272551, 30.48599993116105, 13.617041261655272, -8.530682992773054, -11.091866004206082, -10.760295133931443, 1.2024629512197709, -4.825520314686806, -9.215459268151779, -11.340381009839932, -1.349577951345058, 35.60968699987353, 19.268492706409535, -16.773360545540665, -14.609680460358163, -20.21605905866937, -8.394513254366286, -27.029827128907147, -9.288140569471226, -17.796577089362735, -0.759163721002281, -12.869774671893856, 1.1727802092119304, -20.2257218194256, -11.525807543651695, 18.321745123737152, -19.635154837937595, 4.25643712965905, 13.098733293318174, -10.33095109028649, 10.512268553292555, 42.871756901073915, -7.071215659610517, -6.8099668336791, -14.751149350299883, -9.965113097011685, -6.4071821648739595, -2.972461633858528, -2.44773722444736, -4.0599043289905845, -3.7084211571495302, -4.912741643635451, -6.65941153078566, -13.039310255327157, -10.10021522059659, 9.75772226605756, 4.280711531598523, -5.945839430696629, -5.695881688311488, 0.13033926839707793, 34.16272483652153, 3.7605989810251557, -2.562487712262635, -6.283918295991443, -13.421707059421813, 0.1567469732159199, -10.043839409182134, 0.3325689779066253, -17.130340675276273, 14.885228425199863, 11.714899160217257, -5.260154759560042, -7.560498063847182, -12.222048356452746, -5.007150683223541, -11.586534113336274, 5.8682357932197, 34.2156414597672, 8.659698731196562, -2.241351935593595, -11.534753413891002, 6.545363695852989, 2.730167502318445, -9.802890757474078, 3.159173951029187, 5.453812720700264, 26.4126695106394, 5.273932530847656, -1.9809066936267945, -6.90585856957812, -7.440573792546826, -7.16950773743719, 16.37485144294845, 34.96053951860137, -13.685520499226474, 0.5641218368635301, 17.334824992223474, -2.2866632620563068, 14.706235150179587, -12.464798698508497, -0.9897715364672117, 1.5093929372174182, -1.5021872947086876, 11.248230567679204, -11.536363311315892, -8.129865033926489, -9.198004706069959, -21.3910061578817, -4.17758483387787, -4.2998456825575895, 0.8856351299325556, 6.307433182781661, -4.073019232624842, -1.827101084640437, 19.980876623114753, -11.00034156902459, -12.744346844212284, -8.077015219885327, -2.1818261874313656, 2.045612248383175, -15.559363075703848, 12.527350587863658, -2.195986265096103, -7.585012275825491, -4.024118815350218, 1.8166524674715363, -1.9957022637187696, -7.573375201324561, 13.947751737100827, -8.270232930067726, 23.787494559503337, 41.70429475997157, -11.547260477256556, -14.543708585374487, -24.680174044533327, -4.728915445245744, 2.4856547423095727, -5.353120159713541, -7.409740439887526, -6.084742080126222, -9.849975591557891, 18.360714306531452, 27.86678750781368, -6.884795686390429, -9.342669638411838, -11.806114131269949, -0.2010697568681722, 0.6927291522381059, -4.138671530096539, -6.684894628599291, 4.6106945019409515, 12.492514146987808, 3.674486223820103, -22.1322891075536, -14.565391687240187, -12.224868109716317, -4.98543945929824, -5.706238893863846, -9.469068913760827, -0.19127898559704615, -15.712611086108696, -12.007464993699568, -7.649397027137989, 16.278053914860287, -0.32815755505223154, -10.836176284789282, -18.030284743215244, 6.03287157041308, 37.06725863986452, -2.913524264576677, -25.11008362060205, 40.55176502307807, -16.12492138839843, 11.59729133916099, -0.7421026204117587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0571428799422957, "mean_inference_ms": 0.7436738299157151, "mean_action_processing_ms": 0.13145166859456858, "mean_env_wait_ms": 1.8053200921244947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020122528076171875, "StateBufferConnector_ms": 0.002006053924560547, "ViewRequirementAgentConnector_ms": 0.047118544578552246}, "num_episodes": 30, "episode_return_max": 96.95775690107398, "episode_return_min": 62.36008135845665, "episode_return_mean": 79.58379805325563, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59833, "num_agent_steps_trained": 59833, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 231.6081548047485, "num_env_steps_trained_throughput_per_sec": 231.6081548047485, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 59833, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 59833, "timers": {"training_iteration_time_ms": 16929.149, "restore_workers_time_ms": 0.008, "training_step_time_ms": 16929.121, "sample_time_ms": 15069.678, "learn_time_ms": 1859.165, "learn_throughput": 2151.503, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 59833, "num_agent_steps_trained": 59833}, "done": false, "training_iteration": 5, "trial_id": "default", "date": "2025-10-13_04-20-58", "timestamp": 1760343658, "time_this_iter_s": 17.27112126350403, "time_total_s": 84.6482789516449, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 84.6482789516449, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 32.408, "ram_util_percent": 35.24}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 0.00010000000000000002, "total_loss": 3.1879638068377973, "policy_loss": -0.008291245417785831, "vf_loss": 6.411908558011055, "vf_explained_var": -0.04193725120276213, "kl": 0.005200698544603641, "entropy": 9.731712827086449, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1760.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 0.0001, "total_loss": 1.2454078289251478, "policy_loss": -0.007321319023206357, "vf_loss": 2.525135893291897, "vf_explained_var": 0.3982714641661871, "kl": 0.003683457646937121, "entropy": 9.861820785583012, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.44444444444444, "num_grad_updates_lifetime": 3455.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 71799, "num_agent_steps_trained": 71799}, "env_runners": {"episode_reward_max": 96.95775690107398, "episode_reward_min": 62.36008135845665, "episode_reward_mean": 78.94174666047756, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 40.6029788138891, "hider_policy": -25.11008362060205}, "policy_reward_max": {"seeker_policy": 109.03335704387948, "hider_policy": 42.871756901073915}, "policy_reward_mean": {"seeker_policy": 82.4626933329375, "hider_policy": -1.7604733362299647}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.64170675427818, 85.53774512373711, 81.81733951141072, 84.45826855329258, 96.95775690107398, 75.43603316632087, 71.98512259209312, 78.26513456762638, 73.3008124836269, 76.23849545761253, 73.32777804982702, 82.50786716273868, 73.16889083102052, 90.28872483652157, 82.96826638646051, 72.59208170400858, 77.08274697321596, 92.2355853465098, 85.02940090888514, 79.60584524043989, 79.21607469525807, 81.85423579321973, 92.46164145976718, 73.78832204189567, 79.811363695853, 78.02517395102915, 87.40910603696805, 78.7933895467537, 69.93883656506956, 84.94085144294849, 91.17653951860137, 85.89082499222344, 84.91223515017951, 66.47707107151098, 80.81539293721737, 80.41423056767914, 81.95257803118183, 71.94841516612209, 78.87767341569541, 82.7219476776355, 86.1468766231148, 67.54476946803469, 72.852163980523, 83.71161224838318, 85.13335058786365, 74.29020440087382, 73.43097939506981, 83.95375173710079, 87.05349455950326, 96.27029475997149, 69.45229141462544, 79.59513755734838, 71.35680640556868, 73.37299700722177, 88.54301924308763, 69.37754666358427, 79.94493024313181, 79.09989530249034, 77.85320844667562, 82.08851414698773, 71.54060831275979, 72.30867740255536, 73.5997611061362, 66.93472101440291, 76.76821077110223, 82.51013687626643, 62.36008135845665, 90.99325863986452, 72.33665377948326, 95.9077650230781, 82.72685345712058, 73.31831995443586, 79.36642460533713, 75.11918811734218, 69.06519080387687, 76.99148620011373, 69.60444247349461, 76.94407330650706, 64.11523841934694, 74.43517651554743, 73.51388476734664, 91.09485379876791, 81.9595798597596, 77.73135465649781, 78.85767646594255, 77.6710077793296, 71.7726955394547, 73.51680235236515, 69.13628246998283, 76.6942924775419, 85.3065131390446, 73.49015103686821, 75.46683369333537, 84.91191686408911, 89.40574268395785, 70.05787586966926, 73.3422144961912, 77.04742409444029, 96.34434341984337, 93.96360194743087], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [102.39323611735541, 86.8511548379376, 64.46216908843344, 84.27695109028652, 61.15721565961049, 96.99714935029985, 88.35741785397876, 83.68533342593227, 81.06913796976693, 87.81064863203362, 96.46730352575074, 68.46943336508261, 84.81061195002859, 55.99566073160292, 81.77015511769804, 92.29770705942185, 86.96983940918213, 109.03335704387948, 58.42927332346808, 92.42649806384713, 96.44527373493432, 87.57253411333625, 49.58630126880341, 87.56442739138026, 70.53583249768154, 84.66889075747407, 55.542623805628345, 75.50036370953283, 84.28526892719447, 75.73550773743722, 69.90152049922648, 67.99187816313646, 72.49266326205628, 79.93164130648674, 80.80818729470865, 80.70236331131585, 99.28044777117829, 97.51700615788175, 82.29188396832043, 80.48753372747865, 67.99310108464043, 91.28945788127162, 83.11100538783974, 97.22536307570385, 74.80198626509613, 85.89933549204952, 73.61002919131708, 77.57937520132457, 71.53623293006773, 66.11326047725659, 108.67617404453328, 81.83839826028452, 84.11966700516975, 89.30771467890592, 42.31551742874246, 85.60501198838652, 91.95211413126994, 82.54583768034875, 79.92740857333402, 65.9215137761799, 108.23828910755354, 89.51898497156996, 88.77506891376083, 82.8386110861087, 96.42507279193977, 66.56024051645842, 91.22654238646126, 47.89312842958692, 100.360261664662, 71.48092138839844, 71.87166473837142, 84.42065685714297, 99.77732057600781, 92.67050437450213, 101.40234799493209, 85.41603673407901, 76.40816790207461, 75.5347096604129, 97.46720321609668, 90.209071822823, 105.15633110142936, 52.665070033507256, 77.23556391815899, 87.4737777084883, 89.65298257212271, 87.46067304240944, 93.02927671355737, 97.63466019193031, 90.2048543142496, 90.41125709655817, 79.07282121280488, 93.84229988318685, 85.62577642175461, 75.43808250061444, 40.6029788138891, 86.97960611142551, 97.91532440233806, 91.22519895327054, 63.04341828495106, 99.16366730964938], "policy_hider_policy_reward": [-20.2257218194256, -11.525807543651695, 18.321745123737152, -19.635154837937595, 4.25643712965905, 13.098733293318174, -10.33095109028649, 10.512268553292555, 42.871756901073915, -7.071215659610517, -6.8099668336791, -14.751149350299883, -9.965113097011685, -6.4071821648739595, -2.972461633858528, -2.44773722444736, -4.0599043289905845, -3.7084211571495302, -4.912741643635451, -6.65941153078566, -13.039310255327157, -10.10021522059659, 9.75772226605756, 4.280711531598523, -5.945839430696629, -5.695881688311488, 0.13033926839707793, 34.16272483652153, 3.7605989810251557, -2.562487712262635, -6.283918295991443, -13.421707059421813, 0.1567469732159199, -10.043839409182134, 0.3325689779066253, -17.130340675276273, 14.885228425199863, 11.714899160217257, -5.260154759560042, -7.560498063847182, -12.222048356452746, -5.007150683223541, -11.586534113336274, 5.8682357932197, 34.2156414597672, 8.659698731196562, -2.241351935593595, -11.534753413891002, 6.545363695852989, 2.730167502318445, -9.802890757474078, 3.159173951029187, 5.453812720700264, 26.4126695106394, 5.273932530847656, -1.9809066936267945, -6.90585856957812, -7.440573792546826, -7.16950773743719, 16.37485144294845, 34.96053951860137, -13.685520499226474, 0.5641218368635301, 17.334824992223474, -2.2866632620563068, 14.706235150179587, -12.464798698508497, -0.9897715364672117, 1.5093929372174182, -1.5021872947086876, 11.248230567679204, -11.536363311315892, -8.129865033926489, -9.198004706069959, -21.3910061578817, -4.17758483387787, -4.2998456825575895, 0.8856351299325556, 6.307433182781661, -4.073019232624842, -1.827101084640437, 19.980876623114753, -11.00034156902459, -12.744346844212284, -8.077015219885327, -2.1818261874313656, 2.045612248383175, -15.559363075703848, 12.527350587863658, -2.195986265096103, -7.585012275825491, -4.024118815350218, 1.8166524674715363, -1.9957022637187696, -7.573375201324561, 13.947751737100827, -8.270232930067726, 23.787494559503337, 41.70429475997157, -11.547260477256556, -14.543708585374487, -24.680174044533327, -4.728915445245744, 2.4856547423095727, -5.353120159713541, -7.409740439887526, -6.084742080126222, -9.849975591557891, 18.360714306531452, 27.86678750781368, -6.884795686390429, -9.342669638411838, -11.806114131269949, -0.2010697568681722, 0.6927291522381059, -4.138671530096539, -6.684894628599291, 4.6106945019409515, 12.492514146987808, 3.674486223820103, -22.1322891075536, -14.565391687240187, -12.224868109716317, -4.98543945929824, -5.706238893863846, -9.469068913760827, -0.19127898559704615, -15.712611086108696, -12.007464993699568, -7.649397027137989, 16.278053914860287, -0.32815755505223154, -10.836176284789282, -18.030284743215244, 6.03287157041308, 37.06725863986452, -2.913524264576677, -25.11008362060205, 40.55176502307807, -16.12492138839843, 11.59729133916099, -0.7421026204117587, -8.724656857143007, -2.377680045564082, -0.1895753946628584, -20.22132057600787, -20.304504374502155, 2.7531881173422015, -21.406347994932084, -10.930809196123091, -1.3645137998862635, -7.060036734079032, -1.7640566521865013, -5.039668776393485, -3.8987096604128837, 5.3080733065070165, -18.000065458762567, -15.35189933798712, -2.8008234844525473, -12.97307182282299, -24.05033110142936, -7.592115232653443, 1.850929966492737, 36.57885379876802, 0.2760596042149714, 4.4479563373856905, 1.7853546564977758, -11.527777708488305, -9.687258647161437, -1.1080474590187144, 3.125007779329596, -12.914673042409442, -16.773276713557355, -4.483304460545311, -18.51866019193031, -5.5991976476349095, -8.50192602746334, -12.566645816803462, -11.092193067668763, -2.6247715513474765, -6.206821212804879, 12.440513139044565, -9.175285963739904, -11.176862882578794, -4.117492402676218, -6.041450325742976, 0.9279174993855381, 8.545916864089136, 24.62164969255303, 24.181114177515614, -8.594450152145884, -8.327280089610369, -19.269324402338057, -5.303785503808738, -6.383322546688544, -7.794452312141696, 42.0983434198434, -8.797418284951043, -15.32487039729457, 10.124805035076083]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0573223695450924, "mean_inference_ms": 0.7446890344665629, "mean_action_processing_ms": 0.13169810759197276, "mean_env_wait_ms": 1.8173301915196292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020350217819213867, "StateBufferConnector_ms": 0.0020328760147094727, "ViewRequirementAgentConnector_ms": 0.04804790019989014}, "num_episodes": 29, "episode_return_max": 96.95775690107398, "episode_return_min": 62.36008135845665, "episode_return_mean": 78.94174666047756, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71799, "num_agent_steps_trained": 71799, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 231.20660220646562, "num_env_steps_trained_throughput_per_sec": 231.20660220646562, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 71799, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 71799, "timers": {"training_iteration_time_ms": 16991.049, "restore_workers_time_ms": 0.008, "training_step_time_ms": 16991.023, "sample_time_ms": 15129.761, "learn_time_ms": 1860.996, "learn_throughput": 2149.387, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 71799, "num_agent_steps_trained": 71799}, "done": false, "training_iteration": 6, "trial_id": "default", "date": "2025-10-13_04-21-15", "timestamp": 1760343675, "time_this_iter_s": 17.301069021224976, "time_total_s": 101.94934797286987, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 101.94934797286987, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 31.425, "ram_util_percent": 35.21666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 0.00010000000000000002, "total_loss": 3.246832021325827, "policy_loss": -0.005052165378583595, "vf_loss": 6.523249773681163, "vf_explained_var": -0.058128802105784416, "kl": 0.003454850529277048, "entropy": 9.762285906076432, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2080.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 0.0001, "total_loss": 1.2499190595414904, "policy_loss": -0.006106190138407761, "vf_loss": 2.5317254127018036, "vf_explained_var": 0.4023731761508518, "kl": 0.003553755700717285, "entropy": 9.848562876383463, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4085.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 83799, "num_agent_steps_trained": 83799}, "env_runners": {"episode_reward_max": 96.34434341984337, "episode_reward_min": 62.36008135845665, "episode_reward_mean": 78.64957602966791, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 40.6029788138891, "hider_policy": -25.11008362060205}, "policy_reward_max": {"seeker_policy": 108.67617404453328, "hider_policy": 42.0983434198434}, "policy_reward_mean": {"seeker_policy": 82.67450203916172, "hider_policy": -2.01246300474691}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.17653951860137, 85.89082499222344, 84.91223515017951, 66.47707107151098, 80.81539293721737, 80.41423056767914, 81.95257803118183, 71.94841516612209, 78.87767341569541, 82.7219476776355, 86.1468766231148, 67.54476946803469, 72.852163980523, 83.71161224838318, 85.13335058786365, 74.29020440087382, 73.43097939506981, 83.95375173710079, 87.05349455950326, 96.27029475997149, 69.45229141462544, 79.59513755734838, 71.35680640556868, 73.37299700722177, 88.54301924308763, 69.37754666358427, 79.94493024313181, 79.09989530249034, 77.85320844667562, 82.08851414698773, 71.54060831275979, 72.30867740255536, 73.5997611061362, 66.93472101440291, 76.76821077110223, 82.51013687626643, 62.36008135845665, 90.99325863986452, 72.33665377948326, 95.9077650230781, 82.72685345712058, 73.31831995443586, 79.36642460533713, 75.11918811734218, 69.06519080387687, 76.99148620011373, 69.60444247349461, 76.94407330650706, 64.11523841934694, 74.43517651554743, 73.51388476734664, 91.09485379876791, 81.9595798597596, 77.73135465649781, 78.85767646594255, 77.6710077793296, 71.7726955394547, 73.51680235236515, 69.13628246998283, 76.6942924775419, 85.3065131390446, 73.49015103686821, 75.46683369333537, 84.91191686408911, 89.40574268395785, 70.05787586966926, 73.3422144961912, 77.04742409444029, 96.34434341984337, 93.96360194743087, 81.3447325683988, 74.58564845720842, 66.20486995998851, 87.12161709882724, 81.48634098603166, 79.48887586266552, 76.52194884163471, 80.81505111257776, 76.66898820401701, 81.06116384206045, 86.92902331108014, 81.7619362036671, 72.53355118621099, 69.55680373219388, 75.17796518589707, 82.68422467124273, 88.204650544293, 89.97294199014026, 80.09335977724035, 70.22801316813282, 81.07071785699682, 72.65404309095754, 80.32183638047502, 74.74143248896728, 87.4994833992037, 85.5777230050944, 92.875791503513, 76.9258205412428, 75.81422636502546, 70.5447533635122], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [69.90152049922648, 67.99187816313646, 72.49266326205628, 79.93164130648674, 80.80818729470865, 80.70236331131585, 99.28044777117829, 97.51700615788175, 82.29188396832043, 80.48753372747865, 67.99310108464043, 91.28945788127162, 83.11100538783974, 97.22536307570385, 74.80198626509613, 85.89933549204952, 73.61002919131708, 77.57937520132457, 71.53623293006773, 66.11326047725659, 108.67617404453328, 81.83839826028452, 84.11966700516975, 89.30771467890592, 42.31551742874246, 85.60501198838652, 91.95211413126994, 82.54583768034875, 79.92740857333402, 65.9215137761799, 108.23828910755354, 89.51898497156996, 88.77506891376083, 82.8386110861087, 96.42507279193977, 66.56024051645842, 91.22654238646126, 47.89312842958692, 100.360261664662, 71.48092138839844, 71.87166473837142, 84.42065685714297, 99.77732057600781, 92.67050437450213, 101.40234799493209, 85.41603673407901, 76.40816790207461, 75.5347096604129, 97.46720321609668, 90.209071822823, 105.15633110142936, 52.665070033507256, 77.23556391815899, 87.4737777084883, 89.65298257212271, 87.46067304240944, 93.02927671355737, 97.63466019193031, 90.2048543142496, 90.41125709655817, 79.07282121280488, 93.84229988318685, 85.62577642175461, 75.43808250061444, 40.6029788138891, 86.97960611142551, 97.91532440233806, 91.22519895327054, 63.04341828495106, 99.16366730964938, 97.51486894460905, 97.51488589219633, 100.60403711123861, 72.12919354575226, 71.63641147165046, 96.80019106311414, 100.04214456461797, 84.24869917960334, 84.14424717379211, 60.56851825174386, 60.94482204652575, 85.79140130246176, 83.70914103972515, 96.54992564521676, 85.86737433618651, 78.24343267079611, 66.23329568056039, 68.31904533245444, 90.18380178983568, 89.20162814220906, 54.43560195585533, 84.1178364451245, 85.4742374736474, 100.46868783021974, 41.21499642146928, 78.59926456848163, 54.29487097953814, 96.56342003066919, 97.73528693234606, 89.19688035978194], "policy_hider_policy_reward": [34.96053951860137, -13.685520499226474, 0.5641218368635301, 17.334824992223474, -2.2866632620563068, 14.706235150179587, -12.464798698508497, -0.9897715364672117, 1.5093929372174182, -1.5021872947086876, 11.248230567679204, -11.536363311315892, -8.129865033926489, -9.198004706069959, -21.3910061578817, -4.17758483387787, -4.2998456825575895, 0.8856351299325556, 6.307433182781661, -4.073019232624842, -1.827101084640437, 19.980876623114753, -11.00034156902459, -12.744346844212284, -8.077015219885327, -2.1818261874313656, 2.045612248383175, -15.559363075703848, 12.527350587863658, -2.195986265096103, -7.585012275825491, -4.024118815350218, 1.8166524674715363, -1.9957022637187696, -7.573375201324561, 13.947751737100827, -8.270232930067726, 23.787494559503337, 41.70429475997157, -11.547260477256556, -14.543708585374487, -24.680174044533327, -4.728915445245744, 2.4856547423095727, -5.353120159713541, -7.409740439887526, -6.084742080126222, -9.849975591557891, 18.360714306531452, 27.86678750781368, -6.884795686390429, -9.342669638411838, -11.806114131269949, -0.2010697568681722, 0.6927291522381059, -4.138671530096539, -6.684894628599291, 4.6106945019409515, 12.492514146987808, 3.674486223820103, -22.1322891075536, -14.565391687240187, -12.224868109716317, -4.98543945929824, -5.706238893863846, -9.469068913760827, -0.19127898559704615, -15.712611086108696, -12.007464993699568, -7.649397027137989, 16.278053914860287, -0.32815755505223154, -10.836176284789282, -18.030284743215244, 6.03287157041308, 37.06725863986452, -2.913524264576677, -25.11008362060205, 40.55176502307807, -16.12492138839843, 11.59729133916099, -0.7421026204117587, -8.724656857143007, -2.377680045564082, -0.1895753946628584, -20.22132057600787, -20.304504374502155, 2.7531881173422015, -21.406347994932084, -10.930809196123091, -1.3645137998862635, -7.060036734079032, -1.7640566521865013, -5.039668776393485, -3.8987096604128837, 5.3080733065070165, -18.000065458762567, -15.35189933798712, -2.8008234844525473, -12.97307182282299, -24.05033110142936, -7.592115232653443, 1.850929966492737, 36.57885379876802, 0.2760596042149714, 4.4479563373856905, 1.7853546564977758, -11.527777708488305, -9.687258647161437, -1.1080474590187144, 3.125007779329596, -12.914673042409442, -16.773276713557355, -4.483304460545311, -18.51866019193031, -5.5991976476349095, -8.50192602746334, -12.566645816803462, -11.092193067668763, -2.6247715513474765, -6.206821212804879, 12.440513139044565, -9.175285963739904, -11.176862882578794, -4.117492402676218, -6.041450325742976, 0.9279174993855381, 8.545916864089136, 24.62164969255303, 24.181114177515614, -8.594450152145884, -8.327280089610369, -19.269324402338057, -5.303785503808738, -6.383322546688544, -7.794452312141696, 42.0983434198434, -8.797418284951043, -15.32487039729457, 10.124805035076083, 2.288732568398728, -18.458868944609023, -4.81035154279156, -18.118885892196346, -14.36741284458724, -20.031754306662865, 15.925617098827272, -0.9331935457522648, 7.19445095555523, 2.655478558826009, -14.904191063114121, -2.4071241373345105, -17.976144564618014, -5.54405115836531, 3.249051112577814, -6.682699179603347, 1.527784010794167, -9.003042980569257, 3.577185705160634, 16.91545988515592, 21.623023311080253, 4.361177953474236, -5.08540130246178, 1.0559362036671138, -6.002299000393579, -5.173290853120611, -10.863925645216737, -16.129196267806112, -5.3820540228090525, -5.307355127480477, -1.3585345407599874, 5.799326541206568, -7.367295680560374, 29.338650544293102, 34.486941990140345, -12.833045332454457, 2.5473597772402803, -12.637801789835684, -20.778637503960766, 1.8050225298845484, 12.22921194945824, 14.40590395168324, -0.7604778698976027, -10.703315484269254, -4.36823747364742, -0.7841636195248369, -11.244567511032685, -14.482687830219765, 19.647697066126188, 26.636789911608172, -5.223264568481652, 12.201723005094477, 39.07979150351292, -0.498870979538132, -0.30017945875713226, -19.337420030669243, -6.826241252444385, -15.094819314876169, -9.814581227580307, -8.837545768689417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0580668538909173, "mean_inference_ms": 0.7457475227766273, "mean_action_processing_ms": 0.1317342289764168, "mean_env_wait_ms": 1.8294905730370714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0019971132278442383, "StateBufferConnector_ms": 0.002046942710876465, "ViewRequirementAgentConnector_ms": 0.048426032066345215}, "num_episodes": 30, "episode_return_max": 96.34434341984337, "episode_return_min": 62.36008135845665, "episode_return_mean": 78.64957602966791, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83799, "num_agent_steps_trained": 83799, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 232.3415108404608, "num_env_steps_trained_throughput_per_sec": 232.3415108404608, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 83799, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 83799, "timers": {"training_iteration_time_ms": 17023.191, "restore_workers_time_ms": 0.008, "training_step_time_ms": 17023.165, "sample_time_ms": 15155.521, "learn_time_ms": 1867.391, "learn_throughput": 2142.026, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 83799, "num_agent_steps_trained": 83799}, "done": false, "training_iteration": 7, "trial_id": "default", "date": "2025-10-13_04-21-32", "timestamp": 1760343692, "time_this_iter_s": 17.21659779548645, "time_total_s": 119.16594576835632, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 119.16594576835632, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 33.0, "ram_util_percent": 35.272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.1030025579035283, "policy_loss": -0.005714142622309737, "vf_loss": 6.236799095571041, "vf_explained_var": -0.02069285623729229, "kl": 0.00312137198648232, "entropy": 9.692611709237099, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 0.0001, "total_loss": 1.2565614906568376, "policy_loss": -0.0052750619047040505, "vf_loss": 2.54333799150255, "vf_explained_var": 0.6069120860289013, "kl": 0.003969394214968033, "entropy": 9.838643964131673, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4715.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 95799, "num_agent_steps_trained": 95799}, "env_runners": {"episode_reward_max": 96.34434341984337, "episode_reward_min": 62.36008135845665, "episode_reward_mean": 78.63538251392842, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 25.821959980817347, "hider_policy": -25.11008362060205}, "policy_reward_max": {"seeker_policy": 108.23828910755354, "hider_policy": 42.0983434198434}, "policy_reward_mean": {"seeker_policy": 82.81561103584549, "hider_policy": -2.090114260958518}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.54060831275979, 72.30867740255536, 73.5997611061362, 66.93472101440291, 76.76821077110223, 82.51013687626643, 62.36008135845665, 90.99325863986452, 72.33665377948326, 95.9077650230781, 82.72685345712058, 73.31831995443586, 79.36642460533713, 75.11918811734218, 69.06519080387687, 76.99148620011373, 69.60444247349461, 76.94407330650706, 64.11523841934694, 74.43517651554743, 73.51388476734664, 91.09485379876791, 81.9595798597596, 77.73135465649781, 78.85767646594255, 77.6710077793296, 71.7726955394547, 73.51680235236515, 69.13628246998283, 76.6942924775419, 85.3065131390446, 73.49015103686821, 75.46683369333537, 84.91191686408911, 89.40574268395785, 70.05787586966926, 73.3422144961912, 77.04742409444029, 96.34434341984337, 93.96360194743087, 81.3447325683988, 74.58564845720842, 66.20486995998851, 87.12161709882724, 81.48634098603166, 79.48887586266552, 76.52194884163471, 80.81505111257776, 76.66898820401701, 81.06116384206045, 86.92902331108014, 81.7619362036671, 72.53355118621099, 69.55680373219388, 75.17796518589707, 82.68422467124273, 88.204650544293, 89.97294199014026, 80.09335977724035, 70.22801316813282, 81.07071785699682, 72.65404309095754, 80.32183638047502, 74.74143248896728, 87.4994833992037, 85.5777230050944, 92.875791503513, 76.9258205412428, 75.81422636502546, 70.5447533635122, 73.78331664367158, 86.2846008164208, 86.31185117665153, 69.04209416986589, 95.63144020527197, 70.76764273639479, 74.9527652374262, 82.61825542468878, 74.11801652799272, 71.29737356349413, 83.9850496410077, 67.05924017861746, 77.52461030391096, 78.27796346857254, 78.09080262750702, 83.03277774758783, 75.19861531664249, 93.01414534890401, 76.56605046072173, 85.20405732390445, 84.72923866043853, 76.88900400671646, 80.21956414156655, 79.81223751504517, 66.48000076151551, 89.43942912705516, 73.20521217539606, 89.3208294663127, 80.10356776678802, 81.87964860517094], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [108.23828910755354, 89.51898497156996, 88.77506891376083, 82.8386110861087, 96.42507279193977, 66.56024051645842, 91.22654238646126, 47.89312842958692, 100.360261664662, 71.48092138839844, 71.87166473837142, 84.42065685714297, 99.77732057600781, 92.67050437450213, 101.40234799493209, 85.41603673407901, 76.40816790207461, 75.5347096604129, 97.46720321609668, 90.209071822823, 105.15633110142936, 52.665070033507256, 77.23556391815899, 87.4737777084883, 89.65298257212271, 87.46067304240944, 93.02927671355737, 97.63466019193031, 90.2048543142496, 90.41125709655817, 79.07282121280488, 93.84229988318685, 85.62577642175461, 75.43808250061444, 40.6029788138891, 86.97960611142551, 97.91532440233806, 91.22519895327054, 63.04341828495106, 99.16366730964938, 97.51486894460905, 97.51488589219633, 100.60403711123861, 72.12919354575226, 71.63641147165046, 96.80019106311414, 100.04214456461797, 84.24869917960334, 84.14424717379211, 60.56851825174386, 60.94482204652575, 85.79140130246176, 83.70914103972515, 96.54992564521676, 85.86737433618651, 78.24343267079611, 66.23329568056039, 68.31904533245444, 90.18380178983568, 89.20162814220906, 54.43560195585533, 84.1178364451245, 85.4742374736474, 100.46868783021974, 41.21499642146928, 78.59926456848163, 54.29487097953814, 96.56342003066919, 97.73528693234606, 89.19688035978194, 88.49382015108705, 87.72153962224158, 58.81276564678313, 96.68635955837024, 25.821959980817347, 85.07345378321243, 85.39313061126587, 92.11935143821981, 70.87141620633125, 87.0781808100978, 72.13190731004036, 95.3825684223895, 93.94178147765801, 91.22108524287829, 97.9190834261275, 84.18689267980757, 90.89291685320953, 65.57311372919526, 77.78578214416851, 64.36568930544648, 83.36600195838372, 85.82726434629119, 81.10076318170647, 82.22389745199618, 94.99387897290724, 60.75558005696082, 91.43347746564278, 60.58227960955416, 75.03871390376744, 100.0898743373284], "policy_hider_policy_reward": [-22.1322891075536, -14.565391687240187, -12.224868109716317, -4.98543945929824, -5.706238893863846, -9.469068913760827, -0.19127898559704615, -15.712611086108696, -12.007464993699568, -7.649397027137989, 16.278053914860287, -0.32815755505223154, -10.836176284789282, -18.030284743215244, 6.03287157041308, 37.06725863986452, -2.913524264576677, -25.11008362060205, 40.55176502307807, -16.12492138839843, 11.59729133916099, -0.7421026204117587, -8.724656857143007, -2.377680045564082, -0.1895753946628584, -20.22132057600787, -20.304504374502155, 2.7531881173422015, -21.406347994932084, -10.930809196123091, -1.3645137998862635, -7.060036734079032, -1.7640566521865013, -5.039668776393485, -3.8987096604128837, 5.3080733065070165, -18.000065458762567, -15.35189933798712, -2.8008234844525473, -12.97307182282299, -24.05033110142936, -7.592115232653443, 1.850929966492737, 36.57885379876802, 0.2760596042149714, 4.4479563373856905, 1.7853546564977758, -11.527777708488305, -9.687258647161437, -1.1080474590187144, 3.125007779329596, -12.914673042409442, -16.773276713557355, -4.483304460545311, -18.51866019193031, -5.5991976476349095, -8.50192602746334, -12.566645816803462, -11.092193067668763, -2.6247715513474765, -6.206821212804879, 12.440513139044565, -9.175285963739904, -11.176862882578794, -4.117492402676218, -6.041450325742976, 0.9279174993855381, 8.545916864089136, 24.62164969255303, 24.181114177515614, -8.594450152145884, -8.327280089610369, -19.269324402338057, -5.303785503808738, -6.383322546688544, -7.794452312141696, 42.0983434198434, -8.797418284951043, -15.32487039729457, 10.124805035076083, 2.288732568398728, -18.458868944609023, -4.81035154279156, -18.118885892196346, -14.36741284458724, -20.031754306662865, 15.925617098827272, -0.9331935457522648, 7.19445095555523, 2.655478558826009, -14.904191063114121, -2.4071241373345105, -17.976144564618014, -5.54405115836531, 3.249051112577814, -6.682699179603347, 1.527784010794167, -9.003042980569257, 3.577185705160634, 16.91545988515592, 21.623023311080253, 4.361177953474236, -5.08540130246178, 1.0559362036671138, -6.002299000393579, -5.173290853120611, -10.863925645216737, -16.129196267806112, -5.3820540228090525, -5.307355127480477, -1.3585345407599874, 5.799326541206568, -7.367295680560374, 29.338650544293102, 34.486941990140345, -12.833045332454457, 2.5473597772402803, -12.637801789835684, -20.778637503960766, 1.8050225298845484, 12.22921194945824, 14.40590395168324, -0.7604778698976027, -10.703315484269254, -4.36823747364742, -0.7841636195248369, -11.244567511032685, -14.482687830219765, 19.647697066126188, 26.636789911608172, -5.223264568481652, 12.201723005094477, 39.07979150351292, -0.498870979538132, -0.30017945875713226, -19.337420030669243, -6.826241252444385, -15.094819314876169, -9.814581227580307, -8.837545768689417, -2.935650094520756, -11.774853412894732, -18.235539622241614, 16.79860081642087, 18.015851176651523, 9.483234353216842, -19.11820713079417, -8.526058257710183, 28.36404001918265, 41.44544020527201, -14.778738963263597, 0.47292791644593984, -4.215148369116749, -6.225217004722866, 0.41225542468883336, -9.91335143821983, 13.896740273197059, -10.650139951535564, -11.220321395287108, -4.560485851316607, 14.71904964100776, -2.865907310040371, -15.337831369118781, -12.985496874653252, -17.26976041822693, 0.8525892444799081, -9.685085242878344, -3.25803653142745, -16.51308342612752, -3.3151973724929364, -9.73048685080878, 8.576371918589054, -13.846916853209537, -1.8473846833575043, -11.567113729195244, 39.008145348904016, 0.658862521200219, -1.8785942046469628, 22.068057323904405, -1.2296893054464575, -17.220001958383722, 18.58323866043849, -5.587708333440762, -3.35055200613393, -2.381934166577832, 1.5007351264378666, 1.7362375150451494, -4.14789745199619, -16.27042738606893, -12.243450825322888, -5.209580056960827, 33.89342912705524, -5.920787824603927, -12.307477465642814, -2.396279609554194, 31.134829466312773, 14.837567766788032, -9.772713903767444, 0.6336486051709539, -18.843874337328426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0587821594179716, "mean_inference_ms": 0.7464631890283809, "mean_action_processing_ms": 0.1317269067243286, "mean_env_wait_ms": 1.8425951448080145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002063751220703125, "StateBufferConnector_ms": 0.0021665096282958984, "ViewRequirementAgentConnector_ms": 0.050467848777770996}, "num_episodes": 30, "episode_return_max": 96.34434341984337, "episode_return_min": 62.36008135845665, "episode_return_mean": 78.63538251392842, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95799, "num_agent_steps_trained": 95799, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.7293869801194, "num_env_steps_trained_throughput_per_sec": 226.7293869801194, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 95799, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 95799, "timers": {"training_iteration_time_ms": 17100.565, "restore_workers_time_ms": 0.008, "training_step_time_ms": 17100.54, "sample_time_ms": 15231.866, "learn_time_ms": 1868.424, "learn_throughput": 2140.841, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 95799, "num_agent_steps_trained": 95799}, "done": false, "training_iteration": 8, "trial_id": "default", "date": "2025-10-13_04-21-50", "timestamp": 1760343710, "time_this_iter_s": 17.64273190498352, "time_total_s": 136.80867767333984, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 136.80867767333984, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 32.096, "ram_util_percent": 35.31999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.13615672364831, "policy_loss": -0.006364529125858098, "vf_loss": 6.304289105534553, "vf_explained_var": -0.025880086421966552, "kl": 0.004894836830892414, "entropy": 9.6309356123209, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2720.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00078125, "cur_lr": 0.00010000000000000002, "total_loss": 1.1288918765321854, "policy_loss": -0.005717599596978436, "vf_loss": 2.2889548197869334, "vf_explained_var": 0.6459150138401216, "kl": 0.0031620010818242564, "entropy": 9.870403981977894, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.40322580645162, "num_grad_updates_lifetime": 5340.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 107698, "num_agent_steps_trained": 107698}, "env_runners": {"episode_reward_max": 96.34434341984337, "episode_reward_min": 66.20486995998851, "episode_reward_mean": 79.63665522608315, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 25.821959980817347, "hider_policy": -20.778637503960766}, "policy_reward_max": {"seeker_policy": 102.36608075311439, "hider_policy": 42.0983434198434}, "policy_reward_mean": {"seeker_policy": 82.59806790610337, "hider_policy": -1.4807063400101068}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.6942924775419, 85.3065131390446, 73.49015103686821, 75.46683369333537, 84.91191686408911, 89.40574268395785, 70.05787586966926, 73.3422144961912, 77.04742409444029, 96.34434341984337, 93.96360194743087, 81.3447325683988, 74.58564845720842, 66.20486995998851, 87.12161709882724, 81.48634098603166, 79.48887586266552, 76.52194884163471, 80.81505111257776, 76.66898820401701, 81.06116384206045, 86.92902331108014, 81.7619362036671, 72.53355118621099, 69.55680373219388, 75.17796518589707, 82.68422467124273, 88.204650544293, 89.97294199014026, 80.09335977724035, 70.22801316813282, 81.07071785699682, 72.65404309095754, 80.32183638047502, 74.74143248896728, 87.4994833992037, 85.5777230050944, 92.875791503513, 76.9258205412428, 75.81422636502546, 70.5447533635122, 73.78331664367158, 86.2846008164208, 86.31185117665153, 69.04209416986589, 95.63144020527197, 70.76764273639479, 74.9527652374262, 82.61825542468878, 74.11801652799272, 71.29737356349413, 83.9850496410077, 67.05924017861746, 77.52461030391096, 78.27796346857254, 78.09080262750702, 83.03277774758783, 75.19861531664249, 93.01414534890401, 76.56605046072173, 85.20405732390445, 84.72923866043853, 76.88900400671646, 80.21956414156655, 79.81223751504517, 66.48000076151551, 89.43942912705516, 73.20521217539606, 89.3208294663127, 80.10356776678802, 81.87964860517094, 70.71226183036013, 80.18169901545747, 80.86107856319306, 82.3205784707977, 84.97444099936706, 74.55674910762626, 70.76161497815848, 74.90054166800253, 86.22099950231508, 81.44371117112952, 84.04322640098351, 71.65086804407787, 72.41977937373983, 75.74913518019785, 86.30592751196454, 73.44774779266015, 79.98845263168108, 83.79072476105715, 74.29939770960245, 84.23076862775915, 80.1872904081195, 71.79964512770344, 84.67184214532655, 88.69737604390592, 75.10088249267875, 86.52865180841256, 88.56746131785734, 70.67345502725222, 83.24136933075994], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [90.41125709655817, 79.07282121280488, 93.84229988318685, 85.62577642175461, 75.43808250061444, 40.6029788138891, 86.97960611142551, 97.91532440233806, 91.22519895327054, 63.04341828495106, 99.16366730964938, 97.51486894460905, 97.51488589219633, 100.60403711123861, 72.12919354575226, 71.63641147165046, 96.80019106311414, 100.04214456461797, 84.24869917960334, 84.14424717379211, 60.56851825174386, 60.94482204652575, 85.79140130246176, 83.70914103972515, 96.54992564521676, 85.86737433618651, 78.24343267079611, 66.23329568056039, 68.31904533245444, 90.18380178983568, 89.20162814220906, 54.43560195585533, 84.1178364451245, 85.4742374736474, 100.46868783021974, 41.21499642146928, 78.59926456848163, 54.29487097953814, 96.56342003066919, 97.73528693234606, 89.19688035978194, 88.49382015108705, 87.72153962224158, 58.81276564678313, 96.68635955837024, 25.821959980817347, 85.07345378321243, 85.39313061126587, 92.11935143821981, 70.87141620633125, 87.0781808100978, 72.13190731004036, 95.3825684223895, 93.94178147765801, 91.22108524287829, 97.9190834261275, 84.18689267980757, 90.89291685320953, 65.57311372919526, 77.78578214416851, 64.36568930544648, 83.36600195838372, 85.82726434629119, 81.10076318170647, 82.22389745199618, 94.99387897290724, 60.75558005696082, 91.43347746564278, 60.58227960955416, 75.03871390376744, 100.0898743373284, 83.38887404741392, 67.71836737295938, 82.94050515888894, 88.68097506378476, 91.96921219736313, 89.94419620579777, 94.53484345594526, 89.58037722455015, 102.36608075311439, 87.21017248822258, 89.98060827621147, 89.59888306858146, 99.23623482185647, 87.34838747288877, 87.01197960196933, 91.41567114148577, 82.17338933238644, 76.37790983397349, 89.20124673564032, 65.27516040904133, 79.14073525671469, 91.7387912584814, 76.71567429165789, 70.55924279444707, 88.07294344448165, 74.00190480108593, 73.18858693727731, 91.152093634937, 96.73063467342811], "policy_hider_policy_reward": [-11.092193067668763, -2.6247715513474765, -6.206821212804879, 12.440513139044565, -9.175285963739904, -11.176862882578794, -4.117492402676218, -6.041450325742976, 0.9279174993855381, 8.545916864089136, 24.62164969255303, 24.181114177515614, -8.594450152145884, -8.327280089610369, -19.269324402338057, -5.303785503808738, -6.383322546688544, -7.794452312141696, 42.0983434198434, -8.797418284951043, -15.32487039729457, 10.124805035076083, 2.288732568398728, -18.458868944609023, -4.81035154279156, -18.118885892196346, -14.36741284458724, -20.031754306662865, 15.925617098827272, -0.9331935457522648, 7.19445095555523, 2.655478558826009, -14.904191063114121, -2.4071241373345105, -17.976144564618014, -5.54405115836531, 3.249051112577814, -6.682699179603347, 1.527784010794167, -9.003042980569257, 3.577185705160634, 16.91545988515592, 21.623023311080253, 4.361177953474236, -5.08540130246178, 1.0559362036671138, -6.002299000393579, -5.173290853120611, -10.863925645216737, -16.129196267806112, -5.3820540228090525, -5.307355127480477, -1.3585345407599874, 5.799326541206568, -7.367295680560374, 29.338650544293102, 34.486941990140345, -12.833045332454457, 2.5473597772402803, -12.637801789835684, -20.778637503960766, 1.8050225298845484, 12.22921194945824, 14.40590395168324, -0.7604778698976027, -10.703315484269254, -4.36823747364742, -0.7841636195248369, -11.244567511032685, -14.482687830219765, 19.647697066126188, 26.636789911608172, -5.223264568481652, 12.201723005094477, 39.07979150351292, -0.498870979538132, -0.30017945875713226, -19.337420030669243, -6.826241252444385, -15.094819314876169, -9.814581227580307, -8.837545768689417, -2.935650094520756, -11.774853412894732, -18.235539622241614, 16.79860081642087, 18.015851176651523, 9.483234353216842, -19.11820713079417, -8.526058257710183, 28.36404001918265, 41.44544020527201, -14.778738963263597, 0.47292791644593984, -4.215148369116749, -6.225217004722866, 0.41225542468883336, -9.91335143821983, 13.896740273197059, -10.650139951535564, -11.220321395287108, -4.560485851316607, 14.71904964100776, -2.865907310040371, -15.337831369118781, -12.985496874653252, -17.26976041822693, 0.8525892444799081, -9.685085242878344, -3.25803653142745, -16.51308342612752, -3.3151973724929364, -9.73048685080878, 8.576371918589054, -13.846916853209537, -1.8473846833575043, -11.567113729195244, 39.008145348904016, 0.658862521200219, -1.8785942046469628, 22.068057323904405, -1.2296893054464575, -17.220001958383722, 18.58323866043849, -5.587708333440762, -3.35055200613393, -2.381934166577832, 1.5007351264378666, 1.7362375150451494, -4.14789745199619, -16.27042738606893, -12.243450825322888, -5.209580056960827, 33.89342912705524, -5.920787824603927, -12.307477465642814, -2.396279609554194, 31.134829466312773, 14.837567766788032, -9.772713903767444, 0.6336486051709539, -18.843874337328426, -5.985001273837901, -6.691610943215856, 3.678482396951584, 8.784849245546553, -3.394505158888954, 1.315078563193106, -12.454975063784804, 6.094578470797732, -1.023437062059134, -5.971334135936899, -4.743994406953346, -10.643452691218164, -16.59098222511438, -7.18224625267243, -7.307668420592221, -7.372167135955415, -8.502678588407415, -7.642402662391881, 0.05771117112961681, -5.82417248822262, 6.497226400983562, -12.434608276211524, -7.0566145416928565, -10.891400482810708, -16.02023752588165, -10.796217922235037, -6.710081630403906, -4.889170662286928, 7.689927511964606, -8.39597960196934, -9.81635219721246, -8.151571151613107, -4.656517479598544, 2.471580778893253, -4.611909833973479, 12.024724761057131, -1.9206259071583474, -12.981223118879617, 5.040839590958657, 13.914768627759095, -4.038190850366442, 5.084746001771276, -3.0863548722965803, -16.852791258481407, 4.230693538466232, 3.725474315202455, 24.591376043905935, -6.4532427944471005, -4.7627360612403065, -8.209324890562554, 21.41265180841273, -8.885904801085971, 29.461461317857367, -14.08258693727731, -10.810707935527784, -9.667930672157, 5.2953693307599705, -18.784634673428148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0593113452269427, "mean_inference_ms": 0.7466182222141251, "mean_action_processing_ms": 0.13172716732417583, "mean_env_wait_ms": 1.8585675401528703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020650625228881836, "StateBufferConnector_ms": 0.0021442174911499023, "ViewRequirementAgentConnector_ms": 0.05075514316558838}, "num_episodes": 29, "episode_return_max": 96.34434341984337, "episode_return_min": 66.20486995998851, "episode_return_mean": 79.63665522608315, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107698, "num_agent_steps_trained": 107698, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.53768491178485, "num_env_steps_trained_throughput_per_sec": 209.53768491178485, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 107698, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 107698, "timers": {"training_iteration_time_ms": 17321.574, "restore_workers_time_ms": 0.008, "training_step_time_ms": 17321.55, "sample_time_ms": 15336.479, "learn_time_ms": 1984.831, "learn_throughput": 2015.285, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 107698, "num_agent_steps_trained": 107698}, "done": false, "training_iteration": 9, "trial_id": "default", "date": "2025-10-13_04-22-09", "timestamp": 1760343729, "time_this_iter_s": 19.090204000473022, "time_total_s": 155.89888167381287, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 155.89888167381287, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 55.4037037037037, "ram_util_percent": 35.374074074074066}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.275722003728151, "policy_loss": -0.01131212878099177, "vf_loss": 6.593412189185619, "vf_explained_var": -0.04404131770133972, "kl": 0.005596925881595656, "entropy": 9.676349905133247, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3040.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.000390625, "cur_lr": 0.00010000000000000002, "total_loss": 1.4720780661990565, "policy_loss": -0.007197198838055615, "vf_loss": 2.977983555486125, "vf_explained_var": 0.6988374751421713, "kl": 0.004878521374314105, "entropy": 9.718417790628248, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.88709677419355, "num_grad_updates_lifetime": 5960.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 119627, "num_agent_steps_trained": 119627}, "env_runners": {"episode_reward_max": 97.57712569557832, "episode_reward_min": 66.48000076151551, "episode_reward_mean": 79.92016060733437, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 25.821959980817347, "hider_policy": -21.096452236067197}, "policy_reward_max": {"seeker_policy": 106.79481980390933, "hider_policy": 43.13112569557839}, "policy_reward_mean": {"seeker_policy": 82.1965195925938, "hider_policy": -1.1381794926297104}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.22801316813282, 81.07071785699682, 72.65404309095754, 80.32183638047502, 74.74143248896728, 87.4994833992037, 85.5777230050944, 92.875791503513, 76.9258205412428, 75.81422636502546, 70.5447533635122, 73.78331664367158, 86.2846008164208, 86.31185117665153, 69.04209416986589, 95.63144020527197, 70.76764273639479, 74.9527652374262, 82.61825542468878, 74.11801652799272, 71.29737356349413, 83.9850496410077, 67.05924017861746, 77.52461030391096, 78.27796346857254, 78.09080262750702, 83.03277774758783, 75.19861531664249, 93.01414534890401, 76.56605046072173, 85.20405732390445, 84.72923866043853, 76.88900400671646, 80.21956414156655, 79.81223751504517, 66.48000076151551, 89.43942912705516, 73.20521217539606, 89.3208294663127, 80.10356776678802, 81.87964860517094, 70.71226183036013, 80.18169901545747, 80.86107856319306, 82.3205784707977, 84.97444099936706, 74.55674910762626, 70.76161497815848, 74.90054166800253, 86.22099950231508, 81.44371117112952, 84.04322640098351, 71.65086804407787, 72.41977937373983, 75.74913518019785, 86.30592751196454, 73.44774779266015, 79.98845263168108, 83.79072476105715, 74.29939770960245, 84.23076862775915, 80.1872904081195, 71.79964512770344, 84.67184214532655, 88.69737604390592, 75.10088249267875, 86.52865180841256, 88.56746131785734, 70.67345502725222, 83.24136933075994, 96.12423219452717, 72.42274565672936, 72.76423672528279, 89.14910682745338, 87.77822997484017, 86.16254125337241, 67.38321366915048, 74.80763315341743, 77.42918555229961, 70.86506206749542, 67.51554553059212, 84.65191833081776, 66.69684666482424, 76.67618295606466, 79.88273935217501, 81.22181357105349, 86.02615785591512, 77.9834173389904, 90.7860106423449, 71.51167634086445, 95.36030308281339, 86.91541780549088, 83.4293776675357, 97.57712569557832, 79.52052338850442, 82.13089777714683, 82.67124934041554, 84.68771931708037, 75.53239424695012, 90.93163740318265], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [89.20162814220906, 54.43560195585533, 84.1178364451245, 85.4742374736474, 100.46868783021974, 41.21499642146928, 78.59926456848163, 54.29487097953814, 96.56342003066919, 97.73528693234606, 89.19688035978194, 88.49382015108705, 87.72153962224158, 58.81276564678313, 96.68635955837024, 25.821959980817347, 85.07345378321243, 85.39313061126587, 92.11935143821981, 70.87141620633125, 87.0781808100978, 72.13190731004036, 95.3825684223895, 93.94178147765801, 91.22108524287829, 97.9190834261275, 84.18689267980757, 90.89291685320953, 65.57311372919526, 77.78578214416851, 64.36568930544648, 83.36600195838372, 85.82726434629119, 81.10076318170647, 82.22389745199618, 94.99387897290724, 60.75558005696082, 91.43347746564278, 60.58227960955416, 75.03871390376744, 100.0898743373284, 83.38887404741392, 67.71836737295938, 82.94050515888894, 88.68097506378476, 91.96921219736313, 89.94419620579777, 94.53484345594526, 89.58037722455015, 102.36608075311439, 87.21017248822258, 89.98060827621147, 89.59888306858146, 99.23623482185647, 87.34838747288877, 87.01197960196933, 91.41567114148577, 82.17338933238644, 76.37790983397349, 89.20124673564032, 65.27516040904133, 79.14073525671469, 91.7387912584814, 76.71567429165789, 70.55924279444707, 88.07294344448165, 74.00190480108593, 73.18858693727731, 91.152093634937, 96.73063467342811, 54.91540584235807, 99.02245223606721, 99.86539934761996, 70.17555339527787, 62.626410469652825, 88.29483758442053, 99.97499530690344, 98.94975166693155, 87.94919772922323, 71.61492965475769, 85.97547339461867, 92.71236652302333, 102.42800439285149, 87.46535580815208, 99.00620816323993, 106.79481980390933, 53.62197255970742, 68.63169151287207, 57.361293844113476, 90.07122524165203, 58.60219253597442, 59.31117827623811, 82.47881282864671, 65.8656251249801, 92.4419681176607, 96.46940799781702, 81.03043262482149, 76.47088513460425, 89.91714254465941, 64.16604701881087], "policy_hider_policy_reward": [-20.778637503960766, 1.8050225298845484, 12.22921194945824, 14.40590395168324, -0.7604778698976027, -10.703315484269254, -4.36823747364742, -0.7841636195248369, -11.244567511032685, -14.482687830219765, 19.647697066126188, 26.636789911608172, -5.223264568481652, 12.201723005094477, 39.07979150351292, -0.498870979538132, -0.30017945875713226, -19.337420030669243, -6.826241252444385, -15.094819314876169, -9.814581227580307, -8.837545768689417, -2.935650094520756, -11.774853412894732, -18.235539622241614, 16.79860081642087, 18.015851176651523, 9.483234353216842, -19.11820713079417, -8.526058257710183, 28.36404001918265, 41.44544020527201, -14.778738963263597, 0.47292791644593984, -4.215148369116749, -6.225217004722866, 0.41225542468883336, -9.91335143821983, 13.896740273197059, -10.650139951535564, -11.220321395287108, -4.560485851316607, 14.71904964100776, -2.865907310040371, -15.337831369118781, -12.985496874653252, -17.26976041822693, 0.8525892444799081, -9.685085242878344, -3.25803653142745, -16.51308342612752, -3.3151973724929364, -9.73048685080878, 8.576371918589054, -13.846916853209537, -1.8473846833575043, -11.567113729195244, 39.008145348904016, 0.658862521200219, -1.8785942046469628, 22.068057323904405, -1.2296893054464575, -17.220001958383722, 18.58323866043849, -5.587708333440762, -3.35055200613393, -2.381934166577832, 1.5007351264378666, 1.7362375150451494, -4.14789745199619, -16.27042738606893, -12.243450825322888, -5.209580056960827, 33.89342912705524, -5.920787824603927, -12.307477465642814, -2.396279609554194, 31.134829466312773, 14.837567766788032, -9.772713903767444, 0.6336486051709539, -18.843874337328426, -5.985001273837901, -6.691610943215856, 3.678482396951584, 8.784849245546553, -3.394505158888954, 1.315078563193106, -12.454975063784804, 6.094578470797732, -1.023437062059134, -5.971334135936899, -4.743994406953346, -10.643452691218164, -16.59098222511438, -7.18224625267243, -7.307668420592221, -7.372167135955415, -8.502678588407415, -7.642402662391881, 0.05771117112961681, -5.82417248822262, 6.497226400983562, -12.434608276211524, -7.0566145416928565, -10.891400482810708, -16.02023752588165, -10.796217922235037, -6.710081630403906, -4.889170662286928, 7.689927511964606, -8.39597960196934, -9.81635219721246, -8.151571151613107, -4.656517479598544, 2.471580778893253, -4.611909833973479, 12.024724761057131, -1.9206259071583474, -12.981223118879617, 5.040839590958657, 13.914768627759095, -4.038190850366442, 5.084746001771276, -3.0863548722965803, -16.852791258481407, 4.230693538466232, 3.725474315202455, 24.591376043905935, -6.4532427944471005, -4.7627360612403065, -8.209324890562554, 21.41265180841273, -8.885904801085971, 29.461461317857367, -14.08258693727731, -10.810707935527784, -9.667930672157, 5.2953693307599705, -18.784634673428148, -0.6294058423580816, 41.83823219452717, -5.503254343270634, -21.096452236067197, -18.118537514017845, -8.982625108319294, -11.009553395277859, 29.98310682745336, 25.3622299748402, -0.2104104696528717, 3.3162141770950364, -5.448510508143178, -13.906761982770531, -18.68501965498237, -18.01375166693159, -6.128366846582559, -0.35681444770033066, -10.163197729223233, -12.00538587051583, 11.255518283253592, -1.734847796535753, -16.725080067490794, 7.5459183308178375, -15.60636652302339, -21.080066385568763, -14.651091342458495, -12.201150611621014, 1.411977759533568, -17.96020816323998, -1.1632606478249052, -18.888819803909357, -6.684186428946498, 25.899004635321237, 6.505180660886452, -1.6056915128720908, 10.95741733899043, -2.635293844113462, 36.06001064234495, -8.957768178058727, -9.601780722728858, 39.94430308281347, -3.1861925359744103, 11.712954108544007, 15.891285420708758, -12.312812828646752, 13.263377667535742, -11.419625124980145, 43.13112569557839, -9.515968117660714, -3.4054766114955597, -20.563407997817023, 6.224897777146818, -9.804432624821494, 11.44524934041555, 2.5751148653957894, 5.6417193170803435, -10.391142544659425, -3.99360575304982, 36.0356374031827, -9.270047018810821]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0609618226157165, "mean_inference_ms": 0.7474635334866523, "mean_action_processing_ms": 0.13171836893624217, "mean_env_wait_ms": 1.8798787884298511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021305084228515625, "StateBufferConnector_ms": 0.002186894416809082, "ViewRequirementAgentConnector_ms": 0.05138504505157471}, "num_episodes": 30, "episode_return_max": 97.57712569557832, "episode_return_min": 66.48000076151551, "episode_return_mean": 79.92016060733437, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 119627, "num_agent_steps_trained": 119627, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 197.95806238636982, "num_env_steps_trained_throughput_per_sec": 197.95806238636982, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 119627, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 119627, "timers": {"training_iteration_time_ms": 17610.047, "restore_workers_time_ms": 0.007, "training_step_time_ms": 17610.024, "sample_time_ms": 15463.639, "learn_time_ms": 2146.153, "learn_throughput": 1863.8, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 119627, "num_agent_steps_trained": 119627}, "done": false, "training_iteration": 10, "trial_id": "default", "date": "2025-10-13_04-22-29", "timestamp": 1760343749, "time_this_iter_s": 20.206847429275513, "time_total_s": 176.10572910308838, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 176.10572910308838, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 66.17586206896553, "ram_util_percent": 35.36551724137931}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.1903709903359414, "policy_loss": -0.010352227816474624, "vf_loss": 6.42081231623888, "vf_explained_var": -0.036596565321087834, "kl": 0.005577899055190041, "entropy": 9.687286129593849, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 0.0001, "total_loss": 1.3866317471578007, "policy_loss": -0.010833874950924563, "vf_loss": 2.8144157527931153, "vf_explained_var": 0.7366797815239619, "kl": 0.004266302431422043, "entropy": 9.743090602329799, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.01587301587301, "num_grad_updates_lifetime": 6585.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 131566, "num_agent_steps_trained": 131566}, "env_runners": {"episode_reward_max": 103.81850424931869, "episode_reward_min": 66.48000076151551, "episode_reward_mean": 81.29456948662838, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 42.29918453627947, "hider_policy": -21.096452236067197}, "policy_reward_max": {"seeker_policy": 106.79481980390933, "hider_policy": 49.512504249318724}, "policy_reward_mean": {"seeker_policy": 80.8701798076797, "hider_policy": 0.21219483947434725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.56605046072173, 85.20405732390445, 84.72923866043853, 76.88900400671646, 80.21956414156655, 79.81223751504517, 66.48000076151551, 89.43942912705516, 73.20521217539606, 89.3208294663127, 80.10356776678802, 81.87964860517094, 70.71226183036013, 80.18169901545747, 80.86107856319306, 82.3205784707977, 84.97444099936706, 74.55674910762626, 70.76161497815848, 74.90054166800253, 86.22099950231508, 81.44371117112952, 84.04322640098351, 71.65086804407787, 72.41977937373983, 75.74913518019785, 86.30592751196454, 73.44774779266015, 79.98845263168108, 83.79072476105715, 74.29939770960245, 84.23076862775915, 80.1872904081195, 71.79964512770344, 84.67184214532655, 88.69737604390592, 75.10088249267875, 86.52865180841256, 88.56746131785734, 70.67345502725222, 83.24136933075994, 96.12423219452717, 72.42274565672936, 72.76423672528279, 89.14910682745338, 87.77822997484017, 86.16254125337241, 67.38321366915048, 74.80763315341743, 77.42918555229961, 70.86506206749542, 67.51554553059212, 84.65191833081776, 66.69684666482424, 76.67618295606466, 79.88273935217501, 81.22181357105349, 86.02615785591512, 77.9834173389904, 90.7860106423449, 71.51167634086445, 95.36030308281339, 86.91541780549088, 83.4293776675357, 97.57712569557832, 79.52052338850442, 82.13089777714683, 82.67124934041554, 84.68771931708037, 75.53239424695012, 90.93163740318265, 82.93341740592243, 103.81850424931869, 71.63923940681039, 92.05116692574131, 73.48703675083932, 75.53549016619307, 87.36072745784917, 90.06987948792985, 77.91733923254853, 82.3481463856455, 79.75098936404436, 82.7704604611034, 84.31268335706895, 74.29078425141361, 85.50096662370743, 81.13208735532079, 87.97830704493771, 73.44702855727608, 100.29611944453515, 75.18526798744442, 78.37306351848655, 100.84415747325501, 80.26185176521449, 80.10004425225661, 94.5201111175607, 87.73472801026239, 81.92663498704806, 78.44888908076443, 82.65016810665377], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [77.78578214416851, 64.36568930544648, 83.36600195838372, 85.82726434629119, 81.10076318170647, 82.22389745199618, 94.99387897290724, 60.75558005696082, 91.43347746564278, 60.58227960955416, 75.03871390376744, 100.0898743373284, 83.38887404741392, 67.71836737295938, 82.94050515888894, 88.68097506378476, 91.96921219736313, 89.94419620579777, 94.53484345594526, 89.58037722455015, 102.36608075311439, 87.21017248822258, 89.98060827621147, 89.59888306858146, 99.23623482185647, 87.34838747288877, 87.01197960196933, 91.41567114148577, 82.17338933238644, 76.37790983397349, 89.20124673564032, 65.27516040904133, 79.14073525671469, 91.7387912584814, 76.71567429165789, 70.55924279444707, 88.07294344448165, 74.00190480108593, 73.18858693727731, 91.152093634937, 96.73063467342811, 54.91540584235807, 99.02245223606721, 99.86539934761996, 70.17555339527787, 62.626410469652825, 88.29483758442053, 99.97499530690344, 98.94975166693155, 87.94919772922323, 71.61492965475769, 85.97547339461867, 92.71236652302333, 102.42800439285149, 87.46535580815208, 99.00620816323993, 106.79481980390933, 53.62197255970742, 68.63169151287207, 57.361293844113476, 90.07122524165203, 58.60219253597442, 59.31117827623811, 82.47881282864671, 65.8656251249801, 92.4419681176607, 96.46940799781702, 81.03043262482149, 76.47088513460425, 89.91714254465941, 64.16604701881087, 93.64249265589656, 60.49843221094019, 86.87411604115549, 50.66762071298622, 88.86454079953046, 96.96215828501107, 57.82255424983119, 42.29918453627947, 87.69887335572975, 84.69921998401666, 76.07813004779112, 69.89869077279658, 94.21976134181155, 85.5355548180775, 92.70387435209457, 84.57212183911098, 54.79925775535075, 84.85005929437875, 61.258406976527965, 84.33085260978389, 76.52749545797766, 71.76875453056209, 78.33913222388117, 70.62785140162312, 55.85573136069015, 75.11914144202538, 66.06419850732514, 95.88728217295444, 79.52456986152582], "policy_hider_policy_reward": [0.658862521200219, -1.8785942046469628, 22.068057323904405, -1.2296893054464575, -17.220001958383722, 18.58323866043849, -5.587708333440762, -3.35055200613393, -2.381934166577832, 1.5007351264378666, 1.7362375150451494, -4.14789745199619, -16.27042738606893, -12.243450825322888, -5.209580056960827, 33.89342912705524, -5.920787824603927, -12.307477465642814, -2.396279609554194, 31.134829466312773, 14.837567766788032, -9.772713903767444, 0.6336486051709539, -18.843874337328426, -5.985001273837901, -6.691610943215856, 3.678482396951584, 8.784849245546553, -3.394505158888954, 1.315078563193106, -12.454975063784804, 6.094578470797732, -1.023437062059134, -5.971334135936899, -4.743994406953346, -10.643452691218164, -16.59098222511438, -7.18224625267243, -7.307668420592221, -7.372167135955415, -8.502678588407415, -7.642402662391881, 0.05771117112961681, -5.82417248822262, 6.497226400983562, -12.434608276211524, -7.0566145416928565, -10.891400482810708, -16.02023752588165, -10.796217922235037, -6.710081630403906, -4.889170662286928, 7.689927511964606, -8.39597960196934, -9.81635219721246, -8.151571151613107, -4.656517479598544, 2.471580778893253, -4.611909833973479, 12.024724761057131, -1.9206259071583474, -12.981223118879617, 5.040839590958657, 13.914768627759095, -4.038190850366442, 5.084746001771276, -3.0863548722965803, -16.852791258481407, 4.230693538466232, 3.725474315202455, 24.591376043905935, -6.4532427944471005, -4.7627360612403065, -8.209324890562554, 21.41265180841273, -8.885904801085971, 29.461461317857367, -14.08258693727731, -10.810707935527784, -9.667930672157, 5.2953693307599705, -18.784634673428148, -0.6294058423580816, 41.83823219452717, -5.503254343270634, -21.096452236067197, -18.118537514017845, -8.982625108319294, -11.009553395277859, 29.98310682745336, 25.3622299748402, -0.2104104696528717, 3.3162141770950364, -5.448510508143178, -13.906761982770531, -18.68501965498237, -18.01375166693159, -6.128366846582559, -0.35681444770033066, -10.163197729223233, -12.00538587051583, 11.255518283253592, -1.734847796535753, -16.725080067490794, 7.5459183308178375, -15.60636652302339, -21.080066385568763, -14.651091342458495, -12.201150611621014, 1.411977759533568, -17.96020816323998, -1.1632606478249052, -18.888819803909357, -6.684186428946498, 25.899004635321237, 6.505180660886452, -1.6056915128720908, 10.95741733899043, -2.635293844113462, 36.06001064234495, -8.957768178058727, -9.601780722728858, 39.94430308281347, -3.1861925359744103, 11.712954108544007, 15.891285420708758, -12.312812828646752, 13.263377667535742, -11.419625124980145, 43.13112569557839, -9.515968117660714, -3.4054766114955597, -20.563407997817023, 6.224897777146818, -9.804432624821494, 11.44524934041555, 2.5751148653957894, 5.6417193170803435, -10.391142544659425, -3.99360575304982, 36.0356374031827, -9.270047018810821, -9.786492655896641, -0.922582594077499, -6.192432210940179, 49.512504249318724, -3.628143543132257, -11.606733091212819, 3.0383792870137736, 38.34516692574135, -5.741083347253527, -9.636420701437572, -5.630509833806841, -15.796158285011062, 13.932439039124354, 15.605734168893626, 30.755659385601792, 17.015035566048542, -4.952873355729752, -4.828660767451521, 13.282146385645557, -15.63321998401666, -0.5430738948973663, 4.21593321115058, 9.664460461103449, 3.2073092272034076, 10.216683357068918, -20.12376134181156, -8.343342438965415, -2.9014281276984657, -1.1271720867738746, -6.075735641613232, 8.677452546958401, -12.117487030748569, 27.9423070449377, 5.236742244649257, -7.682586950212472, -3.720443786890216, -6.812406976527978, 45.85011944453516, -4.01975156849529, -5.125833053844235, 5.977718276632011, -4.132150216123128, -17.49275453056209, 46.568157473254935, 2.9058517652144533, -0.9831322238811652, 9.03404425225659, 0.43814859837690945, 40.22411111756073, -1.5597313606901517, -7.623141442025369, 20.238728010262342, 6.333871254919205, 9.528565224803671, -16.431282172954376, -1.0071109192356518, 7.934168106653823, -4.808569861525832]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0646788653480073, "mean_inference_ms": 0.7493068112637056, "mean_action_processing_ms": 0.1318623333694379, "mean_env_wait_ms": 1.9016033490151645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020753145217895508, "StateBufferConnector_ms": 0.002089858055114746, "ViewRequirementAgentConnector_ms": 0.050604820251464844}, "num_episodes": 29, "episode_return_max": 103.81850424931869, "episode_return_min": 66.48000076151551, "episode_return_mean": 81.29456948662838, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131566, "num_agent_steps_trained": 131566, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.13500903853097, "num_env_steps_trained_throughput_per_sec": 211.13500903853097, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 131566, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 131566, "timers": {"training_iteration_time_ms": 17848.949, "restore_workers_time_ms": 0.007, "training_step_time_ms": 17848.928, "sample_time_ms": 15666.6, "learn_time_ms": 2182.093, "learn_throughput": 1833.102, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 131566, "num_agent_steps_trained": 131566}, "done": false, "training_iteration": 11, "trial_id": "default", "date": "2025-10-13_04-22-49", "timestamp": 1760343769, "time_this_iter_s": 18.945850133895874, "time_total_s": 195.05157923698425, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 195.05157923698425, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 51.76428571428572, "ram_util_percent": 35.36071428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.245911566913128, "policy_loss": -0.00985045580600854, "vf_loss": 6.531033374369144, "vf_explained_var": -0.016699047572910786, "kl": 0.00609981629492966, "entropy": 9.759401255846024, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3680.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 9.765624999999999e-05, "cur_lr": 0.0001, "total_loss": 1.2879630600649212, "policy_loss": -0.007135640109874427, "vf_loss": 2.6095546251251585, "vf_explained_var": 0.7925423132994819, "kl": 0.004381165264573035, "entropy": 9.679037519485231, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 7215.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 143566, "num_agent_steps_trained": 143566}, "env_runners": {"episode_reward_max": 103.81850424931869, "episode_reward_min": 64.70875743353449, "episode_reward_mean": 81.79069906397467, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 18.387386550151255, "hider_policy": -21.096452236067197}, "policy_reward_max": {"seeker_policy": 106.79481980390933, "hider_policy": 49.512504249318724}, "policy_reward_mean": {"seeker_policy": 78.6683431375989, "hider_policy": 1.5611779631878944}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.29939770960245, 84.23076862775915, 80.1872904081195, 71.79964512770344, 84.67184214532655, 88.69737604390592, 75.10088249267875, 86.52865180841256, 88.56746131785734, 70.67345502725222, 83.24136933075994, 96.12423219452717, 72.42274565672936, 72.76423672528279, 89.14910682745338, 87.77822997484017, 86.16254125337241, 67.38321366915048, 74.80763315341743, 77.42918555229961, 70.86506206749542, 67.51554553059212, 84.65191833081776, 66.69684666482424, 76.67618295606466, 79.88273935217501, 81.22181357105349, 86.02615785591512, 77.9834173389904, 90.7860106423449, 71.51167634086445, 95.36030308281339, 86.91541780549088, 83.4293776675357, 97.57712569557832, 79.52052338850442, 82.13089777714683, 82.67124934041554, 84.68771931708037, 75.53239424695012, 90.93163740318265, 82.93341740592243, 103.81850424931869, 71.63923940681039, 92.05116692574131, 73.48703675083932, 75.53549016619307, 87.36072745784917, 90.06987948792985, 77.91733923254853, 82.3481463856455, 79.75098936404436, 82.7704604611034, 84.31268335706895, 74.29078425141361, 85.50096662370743, 81.13208735532079, 87.97830704493771, 73.44702855727608, 100.29611944453515, 75.18526798744442, 78.37306351848655, 100.84415747325501, 80.26185176521449, 80.10004425225661, 94.5201111175607, 87.73472801026239, 81.92663498704806, 78.44888908076443, 82.65016810665377, 80.71938477971936, 71.59920569064136, 99.28425485374783, 94.78372426492848, 90.01261922123705, 78.14672872094914, 80.44151367681225, 75.89757045622666, 93.95618160278526, 86.06706888136206, 74.92885968122563, 85.15352043211513, 78.72417111809627, 69.61062628760212, 94.19395867940023, 82.99350686429882, 82.73209876207602, 73.83033354672543, 78.72582568811909, 90.44510291878618, 71.32089006264175, 78.01186790701723, 71.57370410115549, 85.4936451912391, 74.10964629157482, 75.10864603029448, 75.0541140363373, 96.97224464570382, 73.19156292167605, 64.70875743353449], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [89.20124673564032, 65.27516040904133, 79.14073525671469, 91.7387912584814, 76.71567429165789, 70.55924279444707, 88.07294344448165, 74.00190480108593, 73.18858693727731, 91.152093634937, 96.73063467342811, 54.91540584235807, 99.02245223606721, 99.86539934761996, 70.17555339527787, 62.626410469652825, 88.29483758442053, 99.97499530690344, 98.94975166693155, 87.94919772922323, 71.61492965475769, 85.97547339461867, 92.71236652302333, 102.42800439285149, 87.46535580815208, 99.00620816323993, 106.79481980390933, 53.62197255970742, 68.63169151287207, 57.361293844113476, 90.07122524165203, 58.60219253597442, 59.31117827623811, 82.47881282864671, 65.8656251249801, 92.4419681176607, 96.46940799781702, 81.03043262482149, 76.47088513460425, 89.91714254465941, 64.16604701881087, 93.64249265589656, 60.49843221094019, 86.87411604115549, 50.66762071298622, 88.86454079953046, 96.96215828501107, 57.82255424983119, 42.29918453627947, 87.69887335572975, 84.69921998401666, 76.07813004779112, 69.89869077279658, 94.21976134181155, 85.5355548180775, 92.70387435209457, 84.57212183911098, 54.79925775535075, 84.85005929437875, 61.258406976527965, 84.33085260978389, 76.52749545797766, 71.76875453056209, 78.33913222388117, 70.62785140162312, 55.85573136069015, 75.11914144202538, 66.06419850732514, 95.88728217295444, 79.52456986152582, 95.00933544947395, 81.50221146495349, 18.387386550151255, 38.80794468113071, 76.66796928576764, 82.70811814339625, 85.59757238250478, 88.0904531465644, 54.236710304032854, 76.03130899112377, 88.50369029609904, 65.91306512882912, 89.53852061583662, 85.92004900724348, 69.09832854445152, 60.04766353351688, 73.73781995847021, 96.20347059033938, 88.54446197944577, 74.66100815736547, 87.97629862325628, 92.94815035448653, 76.95780521243115, 49.38403381580764, 103.0627613973986, 92.51989488699698, 90.59338814398629, 58.78529743708397, 84.6444491643439, 92.77703599697732], "policy_hider_policy_reward": [-1.9206259071583474, -12.981223118879617, 5.040839590958657, 13.914768627759095, -4.038190850366442, 5.084746001771276, -3.0863548722965803, -16.852791258481407, 4.230693538466232, 3.725474315202455, 24.591376043905935, -6.4532427944471005, -4.7627360612403065, -8.209324890562554, 21.41265180841273, -8.885904801085971, 29.461461317857367, -14.08258693727731, -10.810707935527784, -9.667930672157, 5.2953693307599705, -18.784634673428148, -0.6294058423580816, 41.83823219452717, -5.503254343270634, -21.096452236067197, -18.118537514017845, -8.982625108319294, -11.009553395277859, 29.98310682745336, 25.3622299748402, -0.2104104696528717, 3.3162141770950364, -5.448510508143178, -13.906761982770531, -18.68501965498237, -18.01375166693159, -6.128366846582559, -0.35681444770033066, -10.163197729223233, -12.00538587051583, 11.255518283253592, -1.734847796535753, -16.725080067490794, 7.5459183308178375, -15.60636652302339, -21.080066385568763, -14.651091342458495, -12.201150611621014, 1.411977759533568, -17.96020816323998, -1.1632606478249052, -18.888819803909357, -6.684186428946498, 25.899004635321237, 6.505180660886452, -1.6056915128720908, 10.95741733899043, -2.635293844113462, 36.06001064234495, -8.957768178058727, -9.601780722728858, 39.94430308281347, -3.1861925359744103, 11.712954108544007, 15.891285420708758, -12.312812828646752, 13.263377667535742, -11.419625124980145, 43.13112569557839, -9.515968117660714, -3.4054766114955597, -20.563407997817023, 6.224897777146818, -9.804432624821494, 11.44524934041555, 2.5751148653957894, 5.6417193170803435, -10.391142544659425, -3.99360575304982, 36.0356374031827, -9.270047018810821, -9.786492655896641, -0.922582594077499, -6.192432210940179, 49.512504249318724, -3.628143543132257, -11.606733091212819, 3.0383792870137736, 38.34516692574135, -5.741083347253527, -9.636420701437572, -5.630509833806841, -15.796158285011062, 13.932439039124354, 15.605734168893626, 30.755659385601792, 17.015035566048542, -4.952873355729752, -4.828660767451521, 13.282146385645557, -15.63321998401666, -0.5430738948973663, 4.21593321115058, 9.664460461103449, 3.2073092272034076, 10.216683357068918, -20.12376134181156, -8.343342438965415, -2.9014281276984657, -1.1271720867738746, -6.075735641613232, 8.677452546958401, -12.117487030748569, 27.9423070449377, 5.236742244649257, -7.682586950212472, -3.720443786890216, -6.812406976527978, 45.85011944453516, -4.01975156849529, -5.125833053844235, 5.977718276632011, -4.132150216123128, -17.49275453056209, 46.568157473254935, 2.9058517652144533, -0.9831322238811652, 9.03404425225659, 0.43814859837690945, 40.22411111756073, -1.5597313606901517, -7.623141442025369, 20.238728010262342, 6.333871254919205, 9.528565224803671, -16.431282172954376, -1.0071109192356518, 7.934168106653823, -4.808569861525832, -11.743335449474015, -2.5466152202806596, -0.6067943093586253, -9.296211464953524, 36.33915529336355, 44.557713010232995, 39.67772426492846, 16.29805531886928, -11.361969285767646, 24.706619221237087, -1.7269426233266516, -2.834446799120456, 2.005513676812198, -7.161572382504766, -11.186101077935366, -1.0067816124023332, -0.23071030403284745, 39.95018160278523, -4.465308991123763, 14.501068881362082, -3.837140318774338, -9.737690296099045, 8.43847936929895, 10.801975933987045, -10.936623764471122, 0.12227426673077911, -12.850619878596667, -3.458802841044748, 39.08795867940016, -13.992328544451526, 15.189013626313745, 7.756829704468247, -0.5718199584702054, 9.566098762075953, -7.097285006774943, -15.27585203683904, -8.003358247388299, -1.8152780439383958, 26.90910291878622, -11.12500815736549, -10.27963319181636, -6.375775368798101, -17.56215035448659, 2.6258679070172857, -3.6622958988444956, -1.721805212431163, 21.456014909698315, 14.653596465733054, -9.007101642331026, -19.946013463492672, -4.247353969705567, -13.16389488699691, -1.1718859636627095, -14.367388143986304, 42.76624464570383, -4.579297437083994, 1.395562921676087, -12.848449164343922, -10.92466855554265, -17.14361000790013]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0685421527729684, "mean_inference_ms": 0.7506178591686529, "mean_action_processing_ms": 0.13203754644315782, "mean_env_wait_ms": 1.922843665132293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020350217819213867, "StateBufferConnector_ms": 0.0019683837890625, "ViewRequirementAgentConnector_ms": 0.04840433597564697}, "num_episodes": 30, "episode_return_max": 103.81850424931869, "episode_return_min": 64.70875743353449, "episode_return_mean": 81.79069906397467, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143566, "num_agent_steps_trained": 143566, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.62709639409815, "num_env_steps_trained_throughput_per_sec": 216.62709639409815, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 143566, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 143566, "timers": {"training_iteration_time_ms": 17992.307, "restore_workers_time_ms": 0.007, "training_step_time_ms": 17992.287, "sample_time_ms": 15789.665, "learn_time_ms": 2202.398, "learn_throughput": 1816.202, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 143566, "num_agent_steps_trained": 143566}, "done": false, "training_iteration": 12, "trial_id": "default", "date": "2025-10-13_04-23-07", "timestamp": 1760343787, "time_this_iter_s": 18.465500354766846, "time_total_s": 213.5170795917511, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 213.5170795917511, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 47.2, "ram_util_percent": 35.323076923076925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.228336618468165, "policy_loss": -0.008232959537417628, "vf_loss": 6.492560473829508, "vf_explained_var": -0.02413054686039686, "kl": 0.005352255670928249, "entropy": 9.714844971895218, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4000.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 0.0001, "total_loss": 1.4879989605101327, "policy_loss": -0.008216411616682769, "vf_loss": 3.0117590393338887, "vf_explained_var": 0.7562822968240768, "kl": 0.004067941734666391, "entropy": 9.664350031292628, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.57142857142857, "num_grad_updates_lifetime": 7845.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 155540, "num_agent_steps_trained": 155540}, "env_runners": {"episode_reward_max": 103.81850424931869, "episode_reward_min": 64.70875743353449, "episode_reward_mean": 81.96756641752765, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 18.387386550151255, "hider_policy": -22.276604726779805}, "policy_reward_max": {"seeker_policy": 111.9255125493938, "hider_policy": 49.512504249318724}, "policy_reward_mean": {"seeker_policy": 78.5769182170264, "hider_policy": 1.6953241002506214}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.51167634086445, 95.36030308281339, 86.91541780549088, 83.4293776675357, 97.57712569557832, 79.52052338850442, 82.13089777714683, 82.67124934041554, 84.68771931708037, 75.53239424695012, 90.93163740318265, 82.93341740592243, 103.81850424931869, 71.63923940681039, 92.05116692574131, 73.48703675083932, 75.53549016619307, 87.36072745784917, 90.06987948792985, 77.91733923254853, 82.3481463856455, 79.75098936404436, 82.7704604611034, 84.31268335706895, 74.29078425141361, 85.50096662370743, 81.13208735532079, 87.97830704493771, 73.44702855727608, 100.29611944453515, 75.18526798744442, 78.37306351848655, 100.84415747325501, 80.26185176521449, 80.10004425225661, 94.5201111175607, 87.73472801026239, 81.92663498704806, 78.44888908076443, 82.65016810665377, 80.71938477971936, 71.59920569064136, 99.28425485374783, 94.78372426492848, 90.01261922123705, 78.14672872094914, 80.44151367681225, 75.89757045622666, 93.95618160278526, 86.06706888136206, 74.92885968122563, 85.15352043211513, 78.72417111809627, 69.61062628760212, 94.19395867940023, 82.99350686429882, 82.73209876207602, 73.83033354672543, 78.72582568811909, 90.44510291878618, 71.32089006264175, 78.01186790701723, 71.57370410115549, 85.4936451912391, 74.10964629157482, 75.10864603029448, 75.0541140363373, 96.97224464570382, 73.19156292167605, 64.70875743353449, 73.34957756346294, 98.69911340357802, 79.95912296811038, 93.51422309943443, 76.60047311211773, 86.4103874459059, 69.35494622203674, 74.10900618519278, 89.85138883477612, 84.63100058810967, 76.44483394068507, 67.82397228143634, 65.61564992662467, 80.77506810684982, 83.1132347758957, 78.94285643484552, 82.2700735234765, 84.87757314965098, 78.33057330526111, 94.21530746641545, 75.21842812137804, 87.26680303697312, 70.07644000818745, 84.33428667801088, 69.64327632354613, 78.58927929680551, 78.44781980136227, 83.89350385249583, 78.90585802047988, 86.74761723891523], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [90.07122524165203, 58.60219253597442, 59.31117827623811, 82.47881282864671, 65.8656251249801, 92.4419681176607, 96.46940799781702, 81.03043262482149, 76.47088513460425, 89.91714254465941, 64.16604701881087, 93.64249265589656, 60.49843221094019, 86.87411604115549, 50.66762071298622, 88.86454079953046, 96.96215828501107, 57.82255424983119, 42.29918453627947, 87.69887335572975, 84.69921998401666, 76.07813004779112, 69.89869077279658, 94.21976134181155, 85.5355548180775, 92.70387435209457, 84.57212183911098, 54.79925775535075, 84.85005929437875, 61.258406976527965, 84.33085260978389, 76.52749545797766, 71.76875453056209, 78.33913222388117, 70.62785140162312, 55.85573136069015, 75.11914144202538, 66.06419850732514, 95.88728217295444, 79.52456986152582, 95.00933544947395, 81.50221146495349, 18.387386550151255, 38.80794468113071, 76.66796928576764, 82.70811814339625, 85.59757238250478, 88.0904531465644, 54.236710304032854, 76.03130899112377, 88.50369029609904, 65.91306512882912, 89.53852061583662, 85.92004900724348, 69.09832854445152, 60.04766353351688, 73.73781995847021, 96.20347059033938, 88.54446197944577, 74.66100815736547, 87.97629862325628, 92.94815035448653, 76.95780521243115, 49.38403381580764, 103.0627613973986, 92.51989488699698, 90.59338814398629, 58.78529743708397, 84.6444491643439, 92.77703599697732, 90.79379845825243, 64.29971718283696, 87.00915500292561, 26.429937533140432, 74.6028951889618, 111.9255125493938, 98.90260472677976, 86.62868757156318, 85.15178440128618, 73.00635550718714, 88.03607262217186, 89.99069274504413, 98.31432223367945, 83.87941430061414, 79.27079964280584, 97.19857498248645, 89.33162676447598, 65.59979900008891, 82.60434851035498, 77.15865720805904, 86.89081844714406, 75.73117518629678, 86.30563632750459, 68.73436682004453, 96.70726704019359, 73.7900937843401, 86.38101917967333, 84.8511968606772, 94.16854620103716, 70.32576543662402], "policy_hider_policy_reward": [-8.957768178058727, -9.601780722728858, 39.94430308281347, -3.1861925359744103, 11.712954108544007, 15.891285420708758, -12.312812828646752, 13.263377667535742, -11.419625124980145, 43.13112569557839, -9.515968117660714, -3.4054766114955597, -20.563407997817023, 6.224897777146818, -9.804432624821494, 11.44524934041555, 2.5751148653957894, 5.6417193170803435, -10.391142544659425, -3.99360575304982, 36.0356374031827, -9.270047018810821, -9.786492655896641, -0.922582594077499, -6.192432210940179, 49.512504249318724, -3.628143543132257, -11.606733091212819, 3.0383792870137736, 38.34516692574135, -5.741083347253527, -9.636420701437572, -5.630509833806841, -15.796158285011062, 13.932439039124354, 15.605734168893626, 30.755659385601792, 17.015035566048542, -4.952873355729752, -4.828660767451521, 13.282146385645557, -15.63321998401666, -0.5430738948973663, 4.21593321115058, 9.664460461103449, 3.2073092272034076, 10.216683357068918, -20.12376134181156, -8.343342438965415, -2.9014281276984657, -1.1271720867738746, -6.075735641613232, 8.677452546958401, -12.117487030748569, 27.9423070449377, 5.236742244649257, -7.682586950212472, -3.720443786890216, -6.812406976527978, 45.85011944453516, -4.01975156849529, -5.125833053844235, 5.977718276632011, -4.132150216123128, -17.49275453056209, 46.568157473254935, 2.9058517652144533, -0.9831322238811652, 9.03404425225659, 0.43814859837690945, 40.22411111756073, -1.5597313606901517, -7.623141442025369, 20.238728010262342, 6.333871254919205, 9.528565224803671, -16.431282172954376, -1.0071109192356518, 7.934168106653823, -4.808569861525832, -11.743335449474015, -2.5466152202806596, -0.6067943093586253, -9.296211464953524, 36.33915529336355, 44.557713010232995, 39.67772426492846, 16.29805531886928, -11.361969285767646, 24.706619221237087, -1.7269426233266516, -2.834446799120456, 2.005513676812198, -7.161572382504766, -11.186101077935366, -1.0067816124023332, -0.23071030403284745, 39.95018160278523, -4.465308991123763, 14.501068881362082, -3.837140318774338, -9.737690296099045, 8.43847936929895, 10.801975933987045, -10.936623764471122, 0.12227426673077911, -12.850619878596667, -3.458802841044748, 39.08795867940016, -13.992328544451526, 15.189013626313745, 7.756829704468247, -0.5718199584702054, 9.566098762075953, -7.097285006774943, -15.27585203683904, -8.003358247388299, -1.8152780439383958, 26.90910291878622, -11.12500815736549, -10.27963319181636, -6.375775368798101, -17.56215035448659, 2.6258679070172857, -3.6622958988444956, -1.721805212431163, 21.456014909698315, 14.653596465733054, -9.007101642331026, -19.946013463492672, -4.247353969705567, -13.16389488699691, -1.1718859636627095, -14.367388143986304, 42.76624464570383, -4.579297437083994, 1.395562921676087, -12.848449164343922, -10.92466855554265, -17.14361000790013, -8.11301857673686, -9.33120231805261, 41.20311340357788, -6.803717182836952, -9.843155002925625, 2.793122968110353, 35.19044912539586, 31.89383644089812, -7.026895188961792, 9.024473112117755, -15.801566742306692, -9.713558361181287, -7.271053777963234, -22.276604726779805, -1.357006953825316, -11.162674432545003, -20.545784401286184, 25.24538883477603, -2.750355507187157, 14.375000588109648, -8.509691772368853, -3.081546909117993, -12.344985942119672, -9.82173452148812, -17.93832223367947, -14.760350073375363, 7.129068106849772, -10.233414300614088, 4.020943471094245, -0.17850833800435478, -6.593143565154455, -11.662574982486447, 2.57407352347653, -9.635626764476003, 12.274253336997281, 7.003520812564819, -2.785638913593682, -1.4881362915002032, 38.32930746641546, -21.27265720805903, -1.0175718786219465, -10.654818447144072, 32.370803036973214, -20.83517518629682, -12.668013279123224, -3.5611830401939457, 12.62832578375099, 2.9715940742153646, -10.971896021740964, -16.09209469490654, -5.944093784340123, 10.743279296805548, -13.935019179673354, 6.001819801362301, 5.8975038524958405, -6.855196860677219, -17.372546201037178, 2.1098580204798516, -1.0197654366240092, 17.441617238915228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0718744401285911, "mean_inference_ms": 0.7507007065701834, "mean_action_processing_ms": 0.13215917718688192, "mean_env_wait_ms": 1.9398644036252228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020742416381835938, "StateBufferConnector_ms": 0.0020062923431396484, "ViewRequirementAgentConnector_ms": 0.048053860664367676}, "num_episodes": 30, "episode_return_max": 103.81850424931869, "episode_return_min": 64.70875743353449, "episode_return_mean": 81.96756641752765, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155540, "num_agent_steps_trained": 155540, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.18591637860933, "num_env_steps_trained_throughput_per_sec": 218.18591637860933, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 155540, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 155540, "timers": {"training_iteration_time_ms": 18150.58, "restore_workers_time_ms": 0.006, "training_step_time_ms": 18150.56, "sample_time_ms": 15915.957, "learn_time_ms": 2234.378, "learn_throughput": 1790.208, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 155540, "num_agent_steps_trained": 155540}, "done": false, "training_iteration": 13, "trial_id": "default", "date": "2025-10-13_04-23-26", "timestamp": 1760343806, "time_this_iter_s": 18.3336238861084, "time_total_s": 231.8507034778595, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 231.8507034778595, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 46.16153846153846, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.0373412378132345, "policy_loss": -0.008618989633396268, "vf_loss": 6.111334444582463, "vf_explained_var": -0.017265693843364717, "kl": 0.005349775422499218, "entropy": 9.711182793974876, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 2.4414062499999998e-05, "cur_lr": 0.0001, "total_loss": 1.3820750686857435, "policy_loss": -0.007656526414766198, "vf_loss": 2.79873875833693, "vf_explained_var": 0.7478024091039385, "kl": 0.004831550621276401, "entropy": 9.637896224430628, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8475.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 167540, "num_agent_steps_trained": 167540}, "env_runners": {"episode_reward_max": 100.84415747325501, "episode_reward_min": 64.70875743353449, "episode_reward_mean": 80.35189026588084, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 18.387386550151255, "hider_policy": -28.89241493408398}, "policy_reward_max": {"seeker_policy": 111.9255125493938, "hider_policy": 46.568157473254935}, "policy_reward_mean": {"seeker_policy": 80.0917305209808, "hider_policy": 0.13007987245000963}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.29611944453515, 75.18526798744442, 78.37306351848655, 100.84415747325501, 80.26185176521449, 80.10004425225661, 94.5201111175607, 87.73472801026239, 81.92663498704806, 78.44888908076443, 82.65016810665377, 80.71938477971936, 71.59920569064136, 99.28425485374783, 94.78372426492848, 90.01261922123705, 78.14672872094914, 80.44151367681225, 75.89757045622666, 93.95618160278526, 86.06706888136206, 74.92885968122563, 85.15352043211513, 78.72417111809627, 69.61062628760212, 94.19395867940023, 82.99350686429882, 82.73209876207602, 73.83033354672543, 78.72582568811909, 90.44510291878618, 71.32089006264175, 78.01186790701723, 71.57370410115549, 85.4936451912391, 74.10964629157482, 75.10864603029448, 75.0541140363373, 96.97224464570382, 73.19156292167605, 64.70875743353449, 73.34957756346294, 98.69911340357802, 79.95912296811038, 93.51422309943443, 76.60047311211773, 86.4103874459059, 69.35494622203674, 74.10900618519278, 89.85138883477612, 84.63100058810967, 76.44483394068507, 67.82397228143634, 65.61564992662467, 80.77506810684982, 83.1132347758957, 78.94285643484552, 82.2700735234765, 84.87757314965098, 78.33057330526111, 94.21530746641545, 75.21842812137804, 87.26680303697312, 70.07644000818745, 84.33428667801088, 69.64327632354613, 78.58927929680551, 78.44781980136227, 83.89350385249583, 78.90585802047988, 86.74761723891523, 76.31671722499193, 73.22731461169252, 76.3868272324287, 90.82910466392771, 69.0098520944293, 70.58782544128985, 75.06758794400173, 86.50532199786407, 78.67635500188432, 74.69384582762491, 67.88629955880636, 76.84590785725011, 92.03679930971121, 70.01724054035638, 75.92018352512366, 75.8192872997314, 90.08543461390211, 82.06832249421798, 67.44720130146244, 80.13536214020309, 82.98979988265467, 68.39141413641852, 86.42850932821864, 80.73582196869943, 95.23201678539517, 67.01361643273279, 82.59543563413503, 70.38776931327936, 71.7077872221185], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [61.258406976527965, 84.33085260978389, 76.52749545797766, 71.76875453056209, 78.33913222388117, 70.62785140162312, 55.85573136069015, 75.11914144202538, 66.06419850732514, 95.88728217295444, 79.52456986152582, 95.00933544947395, 81.50221146495349, 18.387386550151255, 38.80794468113071, 76.66796928576764, 82.70811814339625, 85.59757238250478, 88.0904531465644, 54.236710304032854, 76.03130899112377, 88.50369029609904, 65.91306512882912, 89.53852061583662, 85.92004900724348, 69.09832854445152, 60.04766353351688, 73.73781995847021, 96.20347059033938, 88.54446197944577, 74.66100815736547, 87.97629862325628, 92.94815035448653, 76.95780521243115, 49.38403381580764, 103.0627613973986, 92.51989488699698, 90.59338814398629, 58.78529743708397, 84.6444491643439, 92.77703599697732, 90.79379845825243, 64.29971718283696, 87.00915500292561, 26.429937533140432, 74.6028951889618, 111.9255125493938, 98.90260472677976, 86.62868757156318, 85.15178440128618, 73.00635550718714, 88.03607262217186, 89.99069274504413, 98.31432223367945, 83.87941430061414, 79.27079964280584, 97.19857498248645, 89.33162676447598, 65.59979900008891, 82.60434851035498, 77.15865720805904, 86.89081844714406, 75.73117518629678, 86.30563632750459, 68.73436682004453, 96.70726704019359, 73.7900937843401, 86.38101917967333, 84.8511968606772, 94.16854620103716, 70.32576543662402, 86.94773927342655, 76.13856954517534, 90.55727771672198, 66.45503135007375, 101.0765217915136, 94.52735775668025, 92.1544885305684, 69.48830918757105, 86.58298764086075, 101.19841493408398, 82.15899906796557, 81.40680791061479, 62.676109877106114, 84.5796111632001, 94.93984104941742, 86.23094472492689, 33.87074981418172, 68.12673308758401, 93.26837499388044, 75.8895674048491, 84.35302353453488, 94.24375127911713, 80.58373355688605, 95.87481299815465, 64.09471669215858, 88.9913132526668, 92.87784632854562, 92.12250249619021, 79.57665393543861], "policy_hider_policy_reward": [-6.812406976527978, 45.85011944453516, -4.01975156849529, -5.125833053844235, 5.977718276632011, -4.132150216123128, -17.49275453056209, 46.568157473254935, 2.9058517652144533, -0.9831322238811652, 9.03404425225659, 0.43814859837690945, 40.22411111756073, -1.5597313606901517, -7.623141442025369, 20.238728010262342, 6.333871254919205, 9.528565224803671, -16.431282172954376, -1.0071109192356518, 7.934168106653823, -4.808569861525832, -11.743335449474015, -2.5466152202806596, -0.6067943093586253, -9.296211464953524, 36.33915529336355, 44.557713010232995, 39.67772426492846, 16.29805531886928, -11.361969285767646, 24.706619221237087, -1.7269426233266516, -2.834446799120456, 2.005513676812198, -7.161572382504766, -11.186101077935366, -1.0067816124023332, -0.23071030403284745, 39.95018160278523, -4.465308991123763, 14.501068881362082, -3.837140318774338, -9.737690296099045, 8.43847936929895, 10.801975933987045, -10.936623764471122, 0.12227426673077911, -12.850619878596667, -3.458802841044748, 39.08795867940016, -13.992328544451526, 15.189013626313745, 7.756829704468247, -0.5718199584702054, 9.566098762075953, -7.097285006774943, -15.27585203683904, -8.003358247388299, -1.8152780439383958, 26.90910291878622, -11.12500815736549, -10.27963319181636, -6.375775368798101, -17.56215035448659, 2.6258679070172857, -3.6622958988444956, -1.721805212431163, 21.456014909698315, 14.653596465733054, -9.007101642331026, -19.946013463492672, -4.247353969705567, -13.16389488699691, -1.1718859636627095, -14.367388143986304, 42.76624464570383, -4.579297437083994, 1.395562921676087, -12.848449164343922, -10.92466855554265, -17.14361000790013, -8.11301857673686, -9.33120231805261, 41.20311340357788, -6.803717182836952, -9.843155002925625, 2.793122968110353, 35.19044912539586, 31.89383644089812, -7.026895188961792, 9.024473112117755, -15.801566742306692, -9.713558361181287, -7.271053777963234, -22.276604726779805, -1.357006953825316, -11.162674432545003, -20.545784401286184, 25.24538883477603, -2.750355507187157, 14.375000588109648, -8.509691772368853, -3.081546909117993, -12.344985942119672, -9.82173452148812, -17.93832223367947, -14.760350073375363, 7.129068106849772, -10.233414300614088, 4.020943471094245, -0.17850833800435478, -6.593143565154455, -11.662574982486447, 2.57407352347653, -9.635626764476003, 12.274253336997281, 7.003520812564819, -2.785638913593682, -1.4881362915002032, 38.32930746641546, -21.27265720805903, -1.0175718786219465, -10.654818447144072, 32.370803036973214, -20.83517518629682, -12.668013279123224, -3.5611830401939457, 12.62832578375099, 2.9715940742153646, -10.971896021740964, -16.09209469490654, -5.944093784340123, 10.743279296805548, -13.935019179673354, 6.001819801362301, 5.8975038524958405, -6.855196860677219, -17.372546201037178, 2.1098580204798516, -1.0197654366240092, 17.441617238915228, -3.8292827750080956, -6.801739273426524, -1.4333745019576025, -1.4778804315252783, -2.789172767571316, -11.381277716721954, -12.909031350073777, 37.283104663927794, -17.247853202230598, -14.81881649485367, -10.732528598796328, -13.207003716594071, -8.611483628623446, -8.475416957943217, -4.8423091875710575, 21.859321997864086, -7.356987640860737, -0.5496449981156498, -28.89241493408398, 2.387845827624859, -5.788771230355506, -8.483928278803761, -1.6742426039818241, -2.8866574493828137, -8.070109877106104, 37.4307993097112, -9.003611163200068, -5.558759459643622, -14.49384104941742, -4.525816474876342, -3.7067127002686155, -6.704944724926871, 20.6056702784766, 35.60901452124375, 10.494458733277519, 3.447130673356466, -10.674996591170052, -15.146177101247973, 1.4810909147332822, 2.764703820620781, 9.163799882654738, -10.527023534534882, -14.537751279117204, -11.314585863581465, -8.987733556886079, 14.832509328218647, -16.328812998154657, 1.1898219686993798, -8.828716692158617, 39.966016785395176, -12.686174608469772, -9.2915222114643, -14.001846328545593, 3.71943563413502, -13.151380953443178, -8.583352229467645, -7.846644370947007, -0.02222234237317648]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0725630557227053, "mean_inference_ms": 0.749764128410911, "mean_action_processing_ms": 0.13210518938505614, "mean_env_wait_ms": 1.954216076949684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020488500595092773, "StateBufferConnector_ms": 0.001977682113647461, "ViewRequirementAgentConnector_ms": 0.04756462574005127}, "num_episodes": 29, "episode_return_max": 100.84415747325501, "episode_return_min": 64.70875743353449, "episode_return_mean": 80.35189026588084, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167540, "num_agent_steps_trained": 167540, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.37263752820758, "num_env_steps_trained_throughput_per_sec": 217.37263752820758, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 167540, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 167540, "timers": {"training_iteration_time_ms": 18287.001, "restore_workers_time_ms": 0.006, "training_step_time_ms": 18286.982, "sample_time_ms": 16028.972, "learn_time_ms": 2257.793, "learn_throughput": 1771.641, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 167540, "num_agent_steps_trained": 167540}, "done": false, "training_iteration": 14, "trial_id": "default", "date": "2025-10-13_04-23-44", "timestamp": 1760343824, "time_this_iter_s": 18.40219497680664, "time_total_s": 250.25289845466614, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 250.25289845466614, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 47.142307692307696, "ram_util_percent": 35.34615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.240335378050804, "policy_loss": -0.009712784804287366, "vf_loss": 6.519571095705032, "vf_explained_var": -0.03061789870262146, "kl": 0.00572223642452061, "entropy": 9.741855013370515, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4640.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 1.2207031249999999e-05, "cur_lr": 0.0001, "total_loss": 1.7139081769519382, "policy_loss": -0.008279654283874801, "vf_loss": 3.4636328008439805, "vf_explained_var": 0.7436641357247792, "kl": 0.00470817262517554, "entropy": 9.6286313193185, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.52380952380952, "num_grad_updates_lifetime": 9105.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 179511, "num_agent_steps_trained": 179511}, "env_runners": {"episode_reward_max": 101.71455314384845, "episode_reward_min": 64.70875743353449, "episode_reward_mean": 80.21601620304097, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 13.780763068077649, "hider_policy": -28.89241493408398}, "policy_reward_max": {"seeker_policy": 111.9255125493938, "hider_policy": 44.71843955838704}, "policy_reward_mean": {"seeker_policy": 80.42510540522998, "hider_policy": -0.10454460109450026}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.44510291878618, 71.32089006264175, 78.01186790701723, 71.57370410115549, 85.4936451912391, 74.10964629157482, 75.10864603029448, 75.0541140363373, 96.97224464570382, 73.19156292167605, 64.70875743353449, 73.34957756346294, 98.69911340357802, 79.95912296811038, 93.51422309943443, 76.60047311211773, 86.4103874459059, 69.35494622203674, 74.10900618519278, 89.85138883477612, 84.63100058810967, 76.44483394068507, 67.82397228143634, 65.61564992662467, 80.77506810684982, 83.1132347758957, 78.94285643484552, 82.2700735234765, 84.87757314965098, 78.33057330526111, 94.21530746641545, 75.21842812137804, 87.26680303697312, 70.07644000818745, 84.33428667801088, 69.64327632354613, 78.58927929680551, 78.44781980136227, 83.89350385249583, 78.90585802047988, 86.74761723891523, 76.31671722499193, 73.22731461169252, 76.3868272324287, 90.82910466392771, 69.0098520944293, 70.58782544128985, 75.06758794400173, 86.50532199786407, 78.67635500188432, 74.69384582762491, 67.88629955880636, 76.84590785725011, 92.03679930971121, 70.01724054035638, 75.92018352512366, 75.8192872997314, 90.08543461390211, 82.06832249421798, 67.44720130146244, 80.13536214020309, 82.98979988265467, 68.39141413641852, 86.42850932821864, 80.73582196869943, 95.23201678539517, 67.01361643273279, 82.59543563413503, 70.38776931327936, 71.7077872221185, 81.4271761728953, 90.72673252059313, 101.71455314384845, 88.6077071635315, 72.89667316569513, 85.57415140358185, 97.70040800449047, 80.39137780688387, 77.38187020482468, 92.59242113857287, 86.56743879448945, 99.92443955838704, 97.25535948516752, 81.61359287184831, 81.39554800623756, 73.28116754344778, 82.93990561257345, 70.88527599435534, 90.0924566368135, 89.40023071929754, 69.98670809825575, 89.79630582629946, 76.17113510573483, 90.31724866951718, 76.81370672692319, 83.96274135378101, 68.16561709160587, 73.2882031909675, 79.60243342791671, 68.08219722902881], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [74.66100815736547, 87.97629862325628, 92.94815035448653, 76.95780521243115, 49.38403381580764, 103.0627613973986, 92.51989488699698, 90.59338814398629, 58.78529743708397, 84.6444491643439, 92.77703599697732, 90.79379845825243, 64.29971718283696, 87.00915500292561, 26.429937533140432, 74.6028951889618, 111.9255125493938, 98.90260472677976, 86.62868757156318, 85.15178440128618, 73.00635550718714, 88.03607262217186, 89.99069274504413, 98.31432223367945, 83.87941430061414, 79.27079964280584, 97.19857498248645, 89.33162676447598, 65.59979900008891, 82.60434851035498, 77.15865720805904, 86.89081844714406, 75.73117518629678, 86.30563632750459, 68.73436682004453, 96.70726704019359, 73.7900937843401, 86.38101917967333, 84.8511968606772, 94.16854620103716, 70.32576543662402, 86.94773927342655, 76.13856954517534, 90.55727771672198, 66.45503135007375, 101.0765217915136, 94.52735775668025, 92.1544885305684, 69.48830918757105, 86.58298764086075, 101.19841493408398, 82.15899906796557, 81.40680791061479, 62.676109877106114, 84.5796111632001, 94.93984104941742, 86.23094472492689, 33.87074981418172, 68.12673308758401, 93.26837499388044, 75.8895674048491, 84.35302353453488, 94.24375127911713, 80.58373355688605, 95.87481299815465, 64.09471669215858, 88.9913132526668, 92.87784632854562, 92.12250249619021, 79.57665393543861, 81.28328326314798, 63.2739463977444, 77.17230083849657, 46.56624245682979, 92.16040400962648, 69.38742225628887, 13.780763068077649, 69.158767648493, 84.04378707690579, 52.37433716579156, 92.434895186941, 37.587192144629206, 73.12968026180519, 83.89455263780808, 77.71553096896531, 81.6556171690273, 74.51857133776969, 97.97826647996685, 55.65130090705994, 81.11956081790915, 91.6879395877283, 61.08168866781285, 87.06204021037686, 58.16101801195689, 97.00018009044724, 91.50858800710053, 88.09148008023261, 91.1237863630143, 99.05082668129195, 93.53301522988116], "policy_hider_policy_reward": [26.90910291878622, -11.12500815736549, -10.27963319181636, -6.375775368798101, -17.56215035448659, 2.6258679070172857, -3.6622958988444956, -1.721805212431163, 21.456014909698315, 14.653596465733054, -9.007101642331026, -19.946013463492672, -4.247353969705567, -13.16389488699691, -1.1718859636627095, -14.367388143986304, 42.76624464570383, -4.579297437083994, 1.395562921676087, -12.848449164343922, -10.92466855554265, -17.14361000790013, -8.11301857673686, -9.33120231805261, 41.20311340357788, -6.803717182836952, -9.843155002925625, 2.793122968110353, 35.19044912539586, 31.89383644089812, -7.026895188961792, 9.024473112117755, -15.801566742306692, -9.713558361181287, -7.271053777963234, -22.276604726779805, -1.357006953825316, -11.162674432545003, -20.545784401286184, 25.24538883477603, -2.750355507187157, 14.375000588109648, -8.509691772368853, -3.081546909117993, -12.344985942119672, -9.82173452148812, -17.93832223367947, -14.760350073375363, 7.129068106849772, -10.233414300614088, 4.020943471094245, -0.17850833800435478, -6.593143565154455, -11.662574982486447, 2.57407352347653, -9.635626764476003, 12.274253336997281, 7.003520812564819, -2.785638913593682, -1.4881362915002032, 38.32930746641546, -21.27265720805903, -1.0175718786219465, -10.654818447144072, 32.370803036973214, -20.83517518629682, -12.668013279123224, -3.5611830401939457, 12.62832578375099, 2.9715940742153646, -10.971896021740964, -16.09209469490654, -5.944093784340123, 10.743279296805548, -13.935019179673354, 6.001819801362301, 5.8975038524958405, -6.855196860677219, -17.372546201037178, 2.1098580204798516, -1.0197654366240092, 17.441617238915228, -3.8292827750080956, -6.801739273426524, -1.4333745019576025, -1.4778804315252783, -2.789172767571316, -11.381277716721954, -12.909031350073777, 37.283104663927794, -17.247853202230598, -14.81881649485367, -10.732528598796328, -13.207003716594071, -8.611483628623446, -8.475416957943217, -4.8423091875710575, 21.859321997864086, -7.356987640860737, -0.5496449981156498, -28.89241493408398, 2.387845827624859, -5.788771230355506, -8.483928278803761, -1.6742426039818241, -2.8866574493828137, -8.070109877106104, 37.4307993097112, -9.003611163200068, -5.558759459643622, -14.49384104941742, -4.525816474876342, -3.7067127002686155, -6.704944724926871, 20.6056702784766, 35.60901452124375, 10.494458733277519, 3.447130673356466, -10.674996591170052, -15.146177101247973, 1.4810909147332822, 2.764703820620781, 9.163799882654738, -10.527023534534882, -14.537751279117204, -11.314585863581465, -8.987733556886079, 14.832509328218647, -16.328812998154657, 1.1898219686993798, -8.828716692158617, 39.966016785395176, -12.686174608469772, -9.2915222114643, -14.001846328545593, 3.71943563413502, -13.151380953443178, -8.583352229467645, -7.846644370947007, -0.02222234237317648, -9.797283263147945, 9.94117617289526, -8.597946397744405, 36.050732520593044, 39.0830128448921, -14.54076053954018, 21.73372452736306, 20.307740179338687, -4.929326834304889, -14.33440400962646, 13.941561753392397, 2.245167393900594, 43.043783964135024, 40.87586097227783, 13.034547766886243, -1.801937608495384, 2.2558702048247232, -8.917787076905835, 11.421662834208453, 28.796421138572878, -27.88889518694101, 22.021438794489494, 17.61880785537079, 44.71843955838704, -18.92368026180518, 43.049359485167535, -11.828552637808114, 9.54759287184839, 5.120622095557209, -1.440605058284907, -7.438098388593341, -0.9363512369860524, -3.3625713377696584, 11.783905612573486, -6.160724005644633, -20.93226647996684, 35.496456636813654, -1.0553009070599353, 21.37423071929763, -13.093560817909161, -14.094706829658215, -7.606524659814363, -6.9056886678128535, 35.62030582629958, -7.433291654248345, -3.4576134503937186, 32.9712486695172, -0.8150180119569057, -5.152293273076767, -15.034180090447265, -19.582588007100508, 12.036741353780933, -17.230527523701916, -2.6953354649248684, -10.937786363014325, -6.8977968090324655, 0.2164334279167187, -19.664826681291988, -11.216758193008221, -14.23405980784408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0722373247125632, "mean_inference_ms": 0.7492549631099317, "mean_action_processing_ms": 0.1319096776898406, "mean_env_wait_ms": 1.9688301731519378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020531415939331055, "StateBufferConnector_ms": 0.0020035505294799805, "ViewRequirementAgentConnector_ms": 0.04822850227355957}, "num_episodes": 30, "episode_return_max": 101.71455314384845, "episode_return_min": 64.70875743353449, "episode_return_mean": 80.21601620304097, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179511, "num_agent_steps_trained": 179511, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.88802210171536, "num_env_steps_trained_throughput_per_sec": 210.88802210171536, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 179511, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 179511, "timers": {"training_iteration_time_ms": 18456.687, "restore_workers_time_ms": 0.006, "training_step_time_ms": 18456.669, "sample_time_ms": 16174.04, "learn_time_ms": 2282.382, "learn_throughput": 1752.555, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 179511, "num_agent_steps_trained": 179511}, "done": false, "training_iteration": 15, "trial_id": "default", "date": "2025-10-13_04-24-03", "timestamp": 1760343843, "time_this_iter_s": 18.968015909194946, "time_total_s": 269.2209143638611, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 269.2209143638611, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 47.13703703703704, "ram_util_percent": 35.35185185185185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.190009181201458, "policy_loss": -0.010981277632527053, "vf_loss": 6.421469037234783, "vf_explained_var": -0.02349056489765644, "kl": 0.004895439047874132, "entropy": 9.747897684574127, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4960.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 0.0001, "total_loss": 1.4478218028942744, "policy_loss": -0.007626810519113427, "vf_loss": 2.93006400499079, "vf_explained_var": 0.8067750266620091, "kl": 0.005312629558852694, "entropy": 9.583394463857015, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.06349206349206, "num_grad_updates_lifetime": 9735.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 191453, "num_agent_steps_trained": 191453}, "env_runners": {"episode_reward_max": 101.71455314384845, "episode_reward_min": 67.01361643273279, "episode_reward_mean": 81.3616174974178, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 13.780763068077649, "hider_policy": -28.89241493408398}, "policy_reward_max": {"seeker_policy": 108.94169127280276, "hider_policy": 44.71843955838704}, "policy_reward_mean": {"seeker_policy": 78.793473256913, "hider_policy": 1.2840721202523993}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.21530746641545, 75.21842812137804, 87.26680303697312, 70.07644000818745, 84.33428667801088, 69.64327632354613, 78.58927929680551, 78.44781980136227, 83.89350385249583, 78.90585802047988, 86.74761723891523, 76.31671722499193, 73.22731461169252, 76.3868272324287, 90.82910466392771, 69.0098520944293, 70.58782544128985, 75.06758794400173, 86.50532199786407, 78.67635500188432, 74.69384582762491, 67.88629955880636, 76.84590785725011, 92.03679930971121, 70.01724054035638, 75.92018352512366, 75.8192872997314, 90.08543461390211, 82.06832249421798, 67.44720130146244, 80.13536214020309, 82.98979988265467, 68.39141413641852, 86.42850932821864, 80.73582196869943, 95.23201678539517, 67.01361643273279, 82.59543563413503, 70.38776931327936, 71.7077872221185, 81.4271761728953, 90.72673252059313, 101.71455314384845, 88.6077071635315, 72.89667316569513, 85.57415140358185, 97.70040800449047, 80.39137780688387, 77.38187020482468, 92.59242113857287, 86.56743879448945, 99.92443955838704, 97.25535948516752, 81.61359287184831, 81.39554800623756, 73.28116754344778, 82.93990561257345, 70.88527599435534, 90.0924566368135, 89.40023071929754, 69.98670809825575, 89.79630582629946, 76.17113510573483, 90.31724866951718, 76.81370672692319, 83.96274135378101, 68.16561709160587, 73.2882031909675, 79.60243342791671, 68.08219722902881, 89.0674344136, 76.95127801223612, 70.8656097014385, 75.13222949371685, 88.03437648980895, 89.16088406768013, 84.7938785477843, 92.32452865037857, 86.03748858116887, 83.0741701807497, 73.5310408605358, 81.18937914193282, 81.26918608676776, 96.03468912449554, 88.5863756944515, 88.2242457717902, 75.36502105921001, 81.59076912158136, 78.29669875397234, 85.52153773491241, 87.86295940450596, 82.90713244385213, 77.67791026546143, 77.09581224946716, 67.43731907639021, 94.29143495468314, 80.70647335447204, 76.72293741649776, 90.73020773611614, 94.74037745543504], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [77.15865720805904, 86.89081844714406, 75.73117518629678, 86.30563632750459, 68.73436682004453, 96.70726704019359, 73.7900937843401, 86.38101917967333, 84.8511968606772, 94.16854620103716, 70.32576543662402, 86.94773927342655, 76.13856954517534, 90.55727771672198, 66.45503135007375, 101.0765217915136, 94.52735775668025, 92.1544885305684, 69.48830918757105, 86.58298764086075, 101.19841493408398, 82.15899906796557, 81.40680791061479, 62.676109877106114, 84.5796111632001, 94.93984104941742, 86.23094472492689, 33.87074981418172, 68.12673308758401, 93.26837499388044, 75.8895674048491, 84.35302353453488, 94.24375127911713, 80.58373355688605, 95.87481299815465, 64.09471669215858, 88.9913132526668, 92.87784632854562, 92.12250249619021, 79.57665393543861, 81.28328326314798, 63.2739463977444, 77.17230083849657, 46.56624245682979, 92.16040400962648, 69.38742225628887, 13.780763068077649, 69.158767648493, 84.04378707690579, 52.37433716579156, 92.434895186941, 37.587192144629206, 73.12968026180519, 83.89455263780808, 77.71553096896531, 81.6556171690273, 74.51857133776969, 97.97826647996685, 55.65130090705994, 81.11956081790915, 91.6879395877283, 61.08168866781285, 87.06204021037686, 58.16101801195689, 97.00018009044724, 91.50858800710053, 88.09148008023261, 91.1237863630143, 99.05082668129195, 93.53301522988116, 77.73111607556591, 91.49948814127035, 85.56763551507058, 77.13276737239295, 72.44356759136029, 69.07868686817216, 61.790690945313735, 51.43929961791444, 62.650423450198545, 80.39649230568156, 93.19015507665682, 100.0086542499398, 100.00275055090054, 62.69153521866102, 65.79451908189093, 70.86866838557991, 91.43548628637699, 69.28344523889737, 87.1758662319107, 69.94261541545939, 66.96758625639997, 108.94169127280276, 99.93092385737444, 83.73279164650332, 92.89266426183661, 64.39394563464573, 74.49129954832893, 85.22561815563968, 52.281774665543026, 45.140848364196664], "policy_hider_policy_reward": [38.32930746641546, -21.27265720805903, -1.0175718786219465, -10.654818447144072, 32.370803036973214, -20.83517518629682, -12.668013279123224, -3.5611830401939457, 12.62832578375099, 2.9715940742153646, -10.971896021740964, -16.09209469490654, -5.944093784340123, 10.743279296805548, -13.935019179673354, 6.001819801362301, 5.8975038524958405, -6.855196860677219, -17.372546201037178, 2.1098580204798516, -1.0197654366240092, 17.441617238915228, -3.8292827750080956, -6.801739273426524, -1.4333745019576025, -1.4778804315252783, -2.789172767571316, -11.381277716721954, -12.909031350073777, 37.283104663927794, -17.247853202230598, -14.81881649485367, -10.732528598796328, -13.207003716594071, -8.611483628623446, -8.475416957943217, -4.8423091875710575, 21.859321997864086, -7.356987640860737, -0.5496449981156498, -28.89241493408398, 2.387845827624859, -5.788771230355506, -8.483928278803761, -1.6742426039818241, -2.8866574493828137, -8.070109877106104, 37.4307993097112, -9.003611163200068, -5.558759459643622, -14.49384104941742, -4.525816474876342, -3.7067127002686155, -6.704944724926871, 20.6056702784766, 35.60901452124375, 10.494458733277519, 3.447130673356466, -10.674996591170052, -15.146177101247973, 1.4810909147332822, 2.764703820620781, 9.163799882654738, -10.527023534534882, -14.537751279117204, -11.314585863581465, -8.987733556886079, 14.832509328218647, -16.328812998154657, 1.1898219686993798, -8.828716692158617, 39.966016785395176, -12.686174608469772, -9.2915222114643, -14.001846328545593, 3.71943563413502, -13.151380953443178, -8.583352229467645, -7.846644370947007, -0.02222234237317648, -9.797283263147945, 9.94117617289526, -8.597946397744405, 36.050732520593044, 39.0830128448921, -14.54076053954018, 21.73372452736306, 20.307740179338687, -4.929326834304889, -14.33440400962646, 13.941561753392397, 2.245167393900594, 43.043783964135024, 40.87586097227783, 13.034547766886243, -1.801937608495384, 2.2558702048247232, -8.917787076905835, 11.421662834208453, 28.796421138572878, -27.88889518694101, 22.021438794489494, 17.61880785537079, 44.71843955838704, -18.92368026180518, 43.049359485167535, -11.828552637808114, 9.54759287184839, 5.120622095557209, -1.440605058284907, -7.438098388593341, -0.9363512369860524, -3.3625713377696584, 11.783905612573486, -6.160724005644633, -20.93226647996684, 35.496456636813654, -1.0553009070599353, 21.37423071929763, -13.093560817909161, -14.094706829658215, -7.606524659814363, -6.9056886678128535, 35.62030582629958, -7.433291654248345, -3.4576134503937186, 32.9712486695172, -0.8150180119569057, -5.152293273076767, -15.034180090447265, -19.582588007100508, 12.036741353780933, -17.230527523701916, -2.6953354649248684, -10.937786363014325, -6.8977968090324655, 0.2164334279167187, -19.664826681291988, -11.216758193008221, -14.23405980784408, -10.14406042808146, 21.48037876611557, -5.514721987763844, -9.03348814127037, -4.351088811827433, -10.350937001804606, 8.731419140854026, -10.731957019530144, -6.53775323941127, 22.128562137859927, 32.784884067680046, -12.702686868172162, 16.537878547784363, 6.465309054686261, 7.296700382085536, 33.58852865037858, 3.9297972615395675, 19.45726786943079, 8.848170180749785, -6.170492305681593, 5.78504086053579, -25.444155076656816, 0.6333791419328538, -19.45265424993984, -20.99675055090055, 2.2631860867677593, -7.625535218661044, 40.96868912449552, 30.280375694451568, -7.488519081890935, -7.422668385579911, 24.778245771790147, -15.959486286376967, -0.11097894079006611, 2.1025547611026014, 10.204769121581313, -12.869866231910711, 3.9906987539723806, -1.7866154154593739, 17.365537734912433, -7.6415862563999735, 28.53695940450595, -12.55627063978524, -13.478288189165267, -1.748089734538562, -20.50492385737447, -2.113928849085789, -4.523050547950383, -13.899684292123432, -11.555660893323, 40.23543495468308, -10.337945634645706, 4.034241392413552, 2.1809324137295687, 1.6791200567783617, -10.181800795920198, 1.9242253344569598, 36.52420773611619, 40.844377455435065, 8.755151635803324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0721367846451633, "mean_inference_ms": 0.7490557741132018, "mean_action_processing_ms": 0.13165041540111116, "mean_env_wait_ms": 1.9841173895690047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020378828048706055, "StateBufferConnector_ms": 0.0020105838775634766, "ViewRequirementAgentConnector_ms": 0.0483403205871582}, "num_episodes": 30, "episode_return_max": 101.71455314384845, "episode_return_min": 67.01361643273279, "episode_return_mean": 81.3616174974178, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 191453, "num_agent_steps_trained": 191453, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.39568471071573, "num_env_steps_trained_throughput_per_sec": 211.39568471071573, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 191453, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 191453, "timers": {"training_iteration_time_ms": 18618.819, "restore_workers_time_ms": 0.006, "training_step_time_ms": 18618.801, "sample_time_ms": 16318.047, "learn_time_ms": 2300.51, "learn_throughput": 1738.745, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 191453, "num_agent_steps_trained": 191453}, "done": false, "training_iteration": 16, "trial_id": "default", "date": "2025-10-13_04-24-22", "timestamp": 1760343862, "time_this_iter_s": 18.922442197799683, "time_total_s": 288.14335656166077, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 288.14335656166077, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 48.344444444444434, "ram_util_percent": 35.43333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.191823393851519, "policy_loss": -0.009666450138320215, "vf_loss": 6.422585107386112, "vf_explained_var": -0.010278158076107501, "kl": 0.005316717132269844, "entropy": 9.804793614149094, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.00010000000000000002, "total_loss": 1.4989160816515645, "policy_loss": -0.009131492998811507, "vf_loss": 3.035337463117415, "vf_explained_var": 0.751396494911563, "kl": 0.004530710997762691, "entropy": 9.621163740465718, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.43548387096774, "num_grad_updates_lifetime": 10360.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 203354, "num_agent_steps_trained": 203354}, "env_runners": {"episode_reward_max": 103.09066341046687, "episode_reward_min": 64.62076520502183, "episode_reward_mean": 82.28853210078634, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 13.780763068077649, "hider_policy": -27.88889518694101}, "policy_reward_max": {"seeker_policy": 108.94169127280276, "hider_policy": 48.82466341046694}, "policy_reward_mean": {"seeker_policy": 77.58968818985566, "hider_policy": 2.349421955465337}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.44720130146244, 80.13536214020309, 82.98979988265467, 68.39141413641852, 86.42850932821864, 80.73582196869943, 95.23201678539517, 67.01361643273279, 82.59543563413503, 70.38776931327936, 71.7077872221185, 81.4271761728953, 90.72673252059313, 101.71455314384845, 88.6077071635315, 72.89667316569513, 85.57415140358185, 97.70040800449047, 80.39137780688387, 77.38187020482468, 92.59242113857287, 86.56743879448945, 99.92443955838704, 97.25535948516752, 81.61359287184831, 81.39554800623756, 73.28116754344778, 82.93990561257345, 70.88527599435534, 90.0924566368135, 89.40023071929754, 69.98670809825575, 89.79630582629946, 76.17113510573483, 90.31724866951718, 76.81370672692319, 83.96274135378101, 68.16561709160587, 73.2882031909675, 79.60243342791671, 68.08219722902881, 89.0674344136, 76.95127801223612, 70.8656097014385, 75.13222949371685, 88.03437648980895, 89.16088406768013, 84.7938785477843, 92.32452865037857, 86.03748858116887, 83.0741701807497, 73.5310408605358, 81.18937914193282, 81.26918608676776, 96.03468912449554, 88.5863756944515, 88.2242457717902, 75.36502105921001, 81.59076912158136, 78.29669875397234, 85.52153773491241, 87.86295940450596, 82.90713244385213, 77.67791026546143, 77.09581224946716, 67.43731907639021, 94.29143495468314, 80.70647335447204, 76.72293741649776, 90.73020773611614, 94.74037745543504, 76.19577916837297, 91.75641699916333, 77.17992085401391, 70.9206040015769, 84.90605315010869, 101.27552585447894, 81.3999563499411, 100.0993013563223, 73.57039397217241, 77.0788427676624, 64.62076520502183, 84.52583827372453, 99.59635675775804, 80.06502783850077, 73.8566895261886, 83.25398431105714, 78.29224711103039, 103.09066341046687, 77.4048250546462, 80.69499927372765, 97.79856503210041, 74.3578958042763, 73.28296985086396, 77.07608185665929, 75.5433021285113, 84.71112617806874, 82.86825063310974, 87.08819306396602, 69.49973163716768], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [93.26837499388044, 75.8895674048491, 84.35302353453488, 94.24375127911713, 80.58373355688605, 95.87481299815465, 64.09471669215858, 88.9913132526668, 92.87784632854562, 92.12250249619021, 79.57665393543861, 81.28328326314798, 63.2739463977444, 77.17230083849657, 46.56624245682979, 92.16040400962648, 69.38742225628887, 13.780763068077649, 69.158767648493, 84.04378707690579, 52.37433716579156, 92.434895186941, 37.587192144629206, 73.12968026180519, 83.89455263780808, 77.71553096896531, 81.6556171690273, 74.51857133776969, 97.97826647996685, 55.65130090705994, 81.11956081790915, 91.6879395877283, 61.08168866781285, 87.06204021037686, 58.16101801195689, 97.00018009044724, 91.50858800710053, 88.09148008023261, 91.1237863630143, 99.05082668129195, 93.53301522988116, 77.73111607556591, 91.49948814127035, 85.56763551507058, 77.13276737239295, 72.44356759136029, 69.07868686817216, 61.790690945313735, 51.43929961791444, 62.650423450198545, 80.39649230568156, 93.19015507665682, 100.0086542499398, 100.00275055090054, 62.69153521866102, 65.79451908189093, 70.86866838557991, 91.43548628637699, 69.28344523889737, 87.1758662319107, 69.94261541545939, 66.96758625639997, 108.94169127280276, 99.93092385737444, 83.73279164650332, 92.89266426183661, 64.39394563464573, 74.49129954832893, 85.22561815563968, 52.281774665543026, 45.140848364196664, 92.94106132368942, 54.95700580710131, 76.83297417861736, 85.77025692357721, 70.55432191828912, 62.32210902082554, 74.87480619897376, 68.88406023127166, 89.84978885347071, 90.25080487886932, 98.50081697265462, 65.0550992839011, 46.38668467841308, 74.05661612222643, 84.10516413893018, 94.08334375351545, 86.50248408727654, 48.17027725420291, 65.65328437899369, 81.34984498596147, 15.802367325082097, 97.4880854442444, 94.98042163596409, 88.71016358049772, 78.10200895686002, 85.98486926944297, 89.44363919867273, 80.96218519040615, 97.20798461560238], "policy_hider_policy_reward": [-10.674996591170052, -15.146177101247973, 1.4810909147332822, 2.764703820620781, 9.163799882654738, -10.527023534534882, -14.537751279117204, -11.314585863581465, -8.987733556886079, 14.832509328218647, -16.328812998154657, 1.1898219686993798, -8.828716692158617, 39.966016785395176, -12.686174608469772, -9.2915222114643, -14.001846328545593, 3.71943563413502, -13.151380953443178, -8.583352229467645, -7.846644370947007, -0.02222234237317648, -9.797283263147945, 9.94117617289526, -8.597946397744405, 36.050732520593044, 39.0830128448921, -14.54076053954018, 21.73372452736306, 20.307740179338687, -4.929326834304889, -14.33440400962646, 13.941561753392397, 2.245167393900594, 43.043783964135024, 40.87586097227783, 13.034547766886243, -1.801937608495384, 2.2558702048247232, -8.917787076905835, 11.421662834208453, 28.796421138572878, -27.88889518694101, 22.021438794489494, 17.61880785537079, 44.71843955838704, -18.92368026180518, 43.049359485167535, -11.828552637808114, 9.54759287184839, 5.120622095557209, -1.440605058284907, -7.438098388593341, -0.9363512369860524, -3.3625713377696584, 11.783905612573486, -6.160724005644633, -20.93226647996684, 35.496456636813654, -1.0553009070599353, 21.37423071929763, -13.093560817909161, -14.094706829658215, -7.606524659814363, -6.9056886678128535, 35.62030582629958, -7.433291654248345, -3.4576134503937186, 32.9712486695172, -0.8150180119569057, -5.152293273076767, -15.034180090447265, -19.582588007100508, 12.036741353780933, -17.230527523701916, -2.6953354649248684, -10.937786363014325, -6.8977968090324655, 0.2164334279167187, -19.664826681291988, -11.216758193008221, -14.23405980784408, -10.14406042808146, 21.48037876611557, -5.514721987763844, -9.03348814127037, -4.351088811827433, -10.350937001804606, 8.731419140854026, -10.731957019530144, -6.53775323941127, 22.128562137859927, 32.784884067680046, -12.702686868172162, 16.537878547784363, 6.465309054686261, 7.296700382085536, 33.58852865037858, 3.9297972615395675, 19.45726786943079, 8.848170180749785, -6.170492305681593, 5.78504086053579, -25.444155076656816, 0.6333791419328538, -19.45265424993984, -20.99675055090055, 2.2631860867677593, -7.625535218661044, 40.96868912449552, 30.280375694451568, -7.488519081890935, -7.422668385579911, 24.778245771790147, -15.959486286376967, -0.11097894079006611, 2.1025547611026014, 10.204769121581313, -12.869866231910711, 3.9906987539723806, -1.7866154154593739, 17.365537734912433, -7.6415862563999735, 28.53695940450595, -12.55627063978524, -13.478288189165267, -1.748089734538562, -20.50492385737447, -2.113928849085789, -4.523050547950383, -13.899684292123432, -11.555660893323, 40.23543495468308, -10.337945634645706, 4.034241392413552, 2.1809324137295687, 1.6791200567783617, -10.181800795920198, 1.9242253344569598, 36.52420773611619, 40.844377455435065, 8.755151635803324, -1.6287008559457996, -15.1165812993706, 1.97899419289868, 34.82041699916324, 2.496047491645191, -2.1491008162486582, -5.848668032661364, -9.000984889338884, 20.340053150108726, -5.988321918289107, -7.6061090208255475, 46.559525854478935, 6.453665243379833, 0.0714849075875049, -14.478060231271664, 45.69330135632241, -2.275606027827621, -14.003788853470713, -0.3571572323376656, -12.814804878869307, -14.848050414415024, -19.03200135321781, 0.8500133436967077, 18.620725646126722, 45.29035675775804, 7.919315321586911, 2.7290278385007682, 3.279383877773569, -0.7393104738113926, -9.509164138930174, -10.437343753515481, -0.39201568894277355, 0.20840925916223163, -8.418646235408412, 48.82466341046694, 6.095722745797099, 3.9127156210063387, 7.8388250546462235, 2.338999273727722, -2.993844985961472, 38.9175111857118, 43.07868652130644, -10.931847894307282, -12.198341745660754, -17.33442163596411, -4.363030149136043, -4.376121592852866, -7.257960130985612, 6.268737898492978, -8.827444726841705, -14.518869269442984, 13.245126178068785, 11.072250633109785, -17.647639198672714, -13.566185190406175, 19.692193063966034, -12.278374207975446, -15.429878770459366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0720366777246741, "mean_inference_ms": 0.7491718478523748, "mean_action_processing_ms": 0.13144628525693622, "mean_env_wait_ms": 1.9996520983926789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020827054977416992, "StateBufferConnector_ms": 0.002035975456237793, "ViewRequirementAgentConnector_ms": 0.04902958869934082}, "num_episodes": 29, "episode_return_max": 103.09066341046687, "episode_return_min": 64.62076520502183, "episode_return_mean": 82.28853210078634, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 203354, "num_agent_steps_trained": 203354, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.55446535112895, "num_env_steps_trained_throughput_per_sec": 212.55446535112895, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 203354, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 203354, "timers": {"training_iteration_time_ms": 18779.086, "restore_workers_time_ms": 0.006, "training_step_time_ms": 18779.068, "sample_time_ms": 16467.957, "learn_time_ms": 2310.86, "learn_throughput": 1730.957, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 203354, "num_agent_steps_trained": 203354}, "done": false, "training_iteration": 17, "trial_id": "default", "date": "2025-10-13_04-24-41", "timestamp": 1760343881, "time_this_iter_s": 18.819353103637695, "time_total_s": 306.96270966529846, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 306.96270966529846, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 50.22222222222222, "ram_util_percent": 35.51481481481481}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.263156567513943, "policy_loss": -0.012780463270610198, "vf_loss": 6.571441380679607, "vf_explained_var": -0.042167183756828305, "kl": 0.007082596130904083, "entropy": 9.786438104510307, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5600.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.522684119050465, "policy_loss": -0.010344305040595669, "vf_loss": 3.0853602426392692, "vf_explained_var": 0.7996627232385061, "kl": 0.0058279594946480115, "entropy": 9.651700764610654, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10985.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 215354, "num_agent_steps_trained": 215354}, "env_runners": {"episode_reward_max": 103.818843896933, "episode_reward_min": 64.62076520502183, "episode_reward_mean": 81.90367857279774, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 15.802367325082097, "hider_policy": -25.444155076656816}, "policy_reward_max": {"seeker_policy": 108.94169127280276, "hider_policy": 49.21284389693295}, "policy_reward_mean": {"seeker_policy": 78.44226596724756, "hider_policy": 1.7307063027750997}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.40023071929754, 69.98670809825575, 89.79630582629946, 76.17113510573483, 90.31724866951718, 76.81370672692319, 83.96274135378101, 68.16561709160587, 73.2882031909675, 79.60243342791671, 68.08219722902881, 89.0674344136, 76.95127801223612, 70.8656097014385, 75.13222949371685, 88.03437648980895, 89.16088406768013, 84.7938785477843, 92.32452865037857, 86.03748858116887, 83.0741701807497, 73.5310408605358, 81.18937914193282, 81.26918608676776, 96.03468912449554, 88.5863756944515, 88.2242457717902, 75.36502105921001, 81.59076912158136, 78.29669875397234, 85.52153773491241, 87.86295940450596, 82.90713244385213, 77.67791026546143, 77.09581224946716, 67.43731907639021, 94.29143495468314, 80.70647335447204, 76.72293741649776, 90.73020773611614, 94.74037745543504, 76.19577916837297, 91.75641699916333, 77.17992085401391, 70.9206040015769, 84.90605315010869, 101.27552585447894, 81.3999563499411, 100.0993013563223, 73.57039397217241, 77.0788427676624, 64.62076520502183, 84.52583827372453, 99.59635675775804, 80.06502783850077, 73.8566895261886, 83.25398431105714, 78.29224711103039, 103.09066341046687, 77.4048250546462, 80.69499927372765, 97.79856503210041, 74.3578958042763, 73.28296985086396, 77.07608185665929, 75.5433021285113, 84.71112617806874, 82.86825063310974, 87.08819306396602, 69.49973163716768, 74.31347824561925, 77.44071224651408, 75.83293140633793, 99.91936135825401, 74.86187951730896, 77.60866621401702, 85.28480688285558, 87.75014857023216, 66.37500050243756, 94.3771949255015, 80.82346161078509, 82.81292323024802, 69.19917930909574, 78.7085190022721, 74.27591768744503, 68.33369116535185, 88.67809144636402, 81.01004703187671, 80.26077921426072, 85.58051771137431, 84.34098950942072, 83.45802395755342, 88.80300204906274, 96.39704767938392, 79.50705978743783, 71.39419923860036, 84.15504722773356, 66.27306364966067, 85.95305230075755, 103.818843896933], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [81.11956081790915, 91.6879395877283, 61.08168866781285, 87.06204021037686, 58.16101801195689, 97.00018009044724, 91.50858800710053, 88.09148008023261, 91.1237863630143, 99.05082668129195, 93.53301522988116, 77.73111607556591, 91.49948814127035, 85.56763551507058, 77.13276737239295, 72.44356759136029, 69.07868686817216, 61.790690945313735, 51.43929961791444, 62.650423450198545, 80.39649230568156, 93.19015507665682, 100.0086542499398, 100.00275055090054, 62.69153521866102, 65.79451908189093, 70.86866838557991, 91.43548628637699, 69.28344523889737, 87.1758662319107, 69.94261541545939, 66.96758625639997, 108.94169127280276, 99.93092385737444, 83.73279164650332, 92.89266426183661, 64.39394563464573, 74.49129954832893, 85.22561815563968, 52.281774665543026, 45.140848364196664, 92.94106132368942, 54.95700580710131, 76.83297417861736, 85.77025692357721, 70.55432191828912, 62.32210902082554, 74.87480619897376, 68.88406023127166, 89.84978885347071, 90.25080487886932, 98.50081697265462, 65.0550992839011, 46.38668467841308, 74.05661612222643, 84.10516413893018, 94.08334375351545, 86.50248408727654, 48.17027725420291, 65.65328437899369, 81.34984498596147, 15.802367325082097, 97.4880854442444, 94.98042163596409, 88.71016358049772, 78.10200895686002, 85.98486926944297, 89.44363919867273, 80.96218519040615, 97.20798461560238, 100.13785879420479, 88.82289469774119, 73.02589859306146, 57.663901004631, 86.99359803620703, 78.91880143423295, 58.06371769034503, 79.89024529796825, 99.45142083731298, 62.28937016553563, 97.15241863600451, 74.25283134947917, 96.58092798234783, 72.71996228517352, 89.19214161470389, 81.33787891577123, 68.79256924089442, 89.21513070746815, 83.41420356636729, 69.01716394484504, 69.81644273666085, 73.69465104617028, 41.84830279347921, 64.73447214105128, 80.48375766487004, 93.6168036488914, 75.93633139916042, 99.81350187111259, 91.09006928918896, 52.93366810210403], "policy_hider_policy_reward": [21.37423071929763, -13.093560817909161, -14.094706829658215, -7.606524659814363, -6.9056886678128535, 35.62030582629958, -7.433291654248345, -3.4576134503937186, 32.9712486695172, -0.8150180119569057, -5.152293273076767, -15.034180090447265, -19.582588007100508, 12.036741353780933, -17.230527523701916, -2.6953354649248684, -10.937786363014325, -6.8977968090324655, 0.2164334279167187, -19.664826681291988, -11.216758193008221, -14.23405980784408, -10.14406042808146, 21.48037876611557, -5.514721987763844, -9.03348814127037, -4.351088811827433, -10.350937001804606, 8.731419140854026, -10.731957019530144, -6.53775323941127, 22.128562137859927, 32.784884067680046, -12.702686868172162, 16.537878547784363, 6.465309054686261, 7.296700382085536, 33.58852865037858, 3.9297972615395675, 19.45726786943079, 8.848170180749785, -6.170492305681593, 5.78504086053579, -25.444155076656816, 0.6333791419328538, -19.45265424993984, -20.99675055090055, 2.2631860867677593, -7.625535218661044, 40.96868912449552, 30.280375694451568, -7.488519081890935, -7.422668385579911, 24.778245771790147, -15.959486286376967, -0.11097894079006611, 2.1025547611026014, 10.204769121581313, -12.869866231910711, 3.9906987539723806, -1.7866154154593739, 17.365537734912433, -7.6415862563999735, 28.53695940450595, -12.55627063978524, -13.478288189165267, -1.748089734538562, -20.50492385737447, -2.113928849085789, -4.523050547950383, -13.899684292123432, -11.555660893323, 40.23543495468308, -10.337945634645706, 4.034241392413552, 2.1809324137295687, 1.6791200567783617, -10.181800795920198, 1.9242253344569598, 36.52420773611619, 40.844377455435065, 8.755151635803324, -1.6287008559457996, -15.1165812993706, 1.97899419289868, 34.82041699916324, 2.496047491645191, -2.1491008162486582, -5.848668032661364, -9.000984889338884, 20.340053150108726, -5.988321918289107, -7.6061090208255475, 46.559525854478935, 6.453665243379833, 0.0714849075875049, -14.478060231271664, 45.69330135632241, -2.275606027827621, -14.003788853470713, -0.3571572323376656, -12.814804878869307, -14.848050414415024, -19.03200135321781, 0.8500133436967077, 18.620725646126722, 45.29035675775804, 7.919315321586911, 2.7290278385007682, 3.279383877773569, -0.7393104738113926, -9.509164138930174, -10.437343753515481, -0.39201568894277355, 0.20840925916223163, -8.418646235408412, 48.82466341046694, 6.095722745797099, 3.9127156210063387, 7.8388250546462235, 2.338999273727722, -2.993844985961472, 38.9175111857118, 43.07868652130644, -10.931847894307282, -12.198341745660754, -17.33442163596411, -4.363030149136043, -4.376121592852866, -7.257960130985612, 6.268737898492978, -8.827444726841705, -14.518869269442984, 13.245126178068785, 11.072250633109785, -17.647639198672714, -13.566185190406175, 19.692193063966034, -12.278374207975446, -15.429878770459366, -18.808251697530658, -7.016128851054916, -6.703130192998703, -4.679052258228406, 5.756931406337965, -2.9498985930614587, -3.5279010046310177, 45.78336135825411, -3.1700476265771846, -8.961670892320901, -2.8856975651530594, 1.5755623449371772, 10.785114465115191, 16.435974727395365, -14.554245297968297, 22.414148570232182, -17.26159253079593, -15.81482780407941, 40.73119492550162, -8.64337016553561, -20.106418636004577, 3.7774616107851076, 4.737185307714104, 3.8229065730547576, -9.512698161571327, -17.869050511680815, 2.322095060366051, 3.666461656732503, -11.31522260798277, -3.6010013192761288, -6.870188855201094, -6.133998895218344, -14.096569240894437, 33.9820914463641, -12.839130707468227, 4.634047031876733, 4.614779214260735, -7.768203566367284, 15.164517711374325, 1.398836055154917, 2.4395572633391756, 12.084989509420653, -0.08599764993819366, 9.849370561321345, 33.70700204906277, 13.247697206520813, 42.29104767938397, -10.628472141051269, -4.894620759664015, 3.917922882231851, -12.610803648891393, -9.611800761399646, -5.1403313991604405, 13.359047227733518, -16.0189550224561, -17.52148319899584, 8.80705230075742, -13.944069289188892, 1.6723318978959771, 49.21284389693295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0721311705406305, "mean_inference_ms": 0.7492235589211811, "mean_action_processing_ms": 0.1312942963975851, "mean_env_wait_ms": 2.015779636458805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002058863639831543, "StateBufferConnector_ms": 0.002045750617980957, "ViewRequirementAgentConnector_ms": 0.04905557632446289}, "num_episodes": 30, "episode_return_max": 103.818843896933, "episode_return_min": 64.62076520502183, "episode_return_mean": 81.90367857279774, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215354, "num_agent_steps_trained": 215354, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.41828595291508, "num_env_steps_trained_throughput_per_sec": 208.41828595291508, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 215354, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 215354, "timers": {"training_iteration_time_ms": 18934.085, "restore_workers_time_ms": 0.005, "training_step_time_ms": 18934.069, "sample_time_ms": 16602.6, "learn_time_ms": 2331.207, "learn_throughput": 1715.849, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 215354, "num_agent_steps_trained": 215354}, "done": false, "training_iteration": 18, "trial_id": "default", "date": "2025-10-13_04-25-00", "timestamp": 1760343900, "time_this_iter_s": 19.1927649974823, "time_total_s": 326.15547466278076, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 326.15547466278076, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 44.870370370370374, "ram_util_percent": 35.548148148148144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.438202427327633, "policy_loss": -0.0116946435009595, "vf_loss": 6.9195243388414385, "vf_explained_var": 0.0019224496558308602, "kl": 0.006287027401680276, "entropy": 9.867541718482972, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5920.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.7096550379480635, "policy_loss": -0.01077347618439013, "vf_loss": 3.460025008141048, "vf_explained_var": 0.8069900464443933, "kl": 0.006606624565491035, "entropy": 9.5839857025752, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 11615.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 227354, "num_agent_steps_trained": 227354}, "env_runners": {"episode_reward_max": 104.45253214561879, "episode_reward_min": 64.62076520502183, "episode_reward_mean": 83.05323409264875, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 15.802367325082097, "hider_policy": -21.83626885536913}, "policy_reward_max": {"seeker_policy": 108.94169127280276, "hider_policy": 49.66653214561879}, "policy_reward_mean": {"seeker_policy": 75.54956427474754, "hider_policy": 3.7518349089506047}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.29669875397234, 85.52153773491241, 87.86295940450596, 82.90713244385213, 77.67791026546143, 77.09581224946716, 67.43731907639021, 94.29143495468314, 80.70647335447204, 76.72293741649776, 90.73020773611614, 94.74037745543504, 76.19577916837297, 91.75641699916333, 77.17992085401391, 70.9206040015769, 84.90605315010869, 101.27552585447894, 81.3999563499411, 100.0993013563223, 73.57039397217241, 77.0788427676624, 64.62076520502183, 84.52583827372453, 99.59635675775804, 80.06502783850077, 73.8566895261886, 83.25398431105714, 78.29224711103039, 103.09066341046687, 77.4048250546462, 80.69499927372765, 97.79856503210041, 74.3578958042763, 73.28296985086396, 77.07608185665929, 75.5433021285113, 84.71112617806874, 82.86825063310974, 87.08819306396602, 69.49973163716768, 74.31347824561925, 77.44071224651408, 75.83293140633793, 99.91936135825401, 74.86187951730896, 77.60866621401702, 85.28480688285558, 87.75014857023216, 66.37500050243756, 94.3771949255015, 80.82346161078509, 82.81292323024802, 69.19917930909574, 78.7085190022721, 74.27591768744503, 68.33369116535185, 88.67809144636402, 81.01004703187671, 80.26077921426072, 85.58051771137431, 84.34098950942072, 83.45802395755342, 88.80300204906274, 96.39704767938392, 79.50705978743783, 71.39419923860036, 84.15504722773356, 66.27306364966067, 85.95305230075755, 103.818843896933, 95.46126062255208, 92.16141667254387, 88.9002310657478, 92.40737412244879, 81.96269548581971, 90.23650225869675, 88.28041473542949, 104.45253214561879, 80.55417960792651, 72.74344458953314, 97.59954907452308, 83.26834328495154, 96.34892518465664, 71.13356444481985, 85.68303772773565, 71.00154115557612, 91.51889993689431, 76.0980624759089, 92.41370804324215, 89.99307630055574, 91.82713560586146, 75.20360132055711, 74.22619590939628, 91.03038992369817, 76.90452668724413, 86.05124704632064, 67.61964861128068, 75.90266518852536, 100.79049519568893], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [87.1758662319107, 69.94261541545939, 66.96758625639997, 108.94169127280276, 99.93092385737444, 83.73279164650332, 92.89266426183661, 64.39394563464573, 74.49129954832893, 85.22561815563968, 52.281774665543026, 45.140848364196664, 92.94106132368942, 54.95700580710131, 76.83297417861736, 85.77025692357721, 70.55432191828912, 62.32210902082554, 74.87480619897376, 68.88406023127166, 89.84978885347071, 90.25080487886932, 98.50081697265462, 65.0550992839011, 46.38668467841308, 74.05661612222643, 84.10516413893018, 94.08334375351545, 86.50248408727654, 48.17027725420291, 65.65328437899369, 81.34984498596147, 15.802367325082097, 97.4880854442444, 94.98042163596409, 88.71016358049772, 78.10200895686002, 85.98486926944297, 89.44363919867273, 80.96218519040615, 97.20798461560238, 100.13785879420479, 88.82289469774119, 73.02589859306146, 57.663901004631, 86.99359803620703, 78.91880143423295, 58.06371769034503, 79.89024529796825, 99.45142083731298, 62.28937016553563, 97.15241863600451, 74.25283134947917, 96.58092798234783, 72.71996228517352, 89.19214161470389, 81.33787891577123, 68.79256924089442, 89.21513070746815, 83.41420356636729, 69.01716394484504, 69.81644273666085, 73.69465104617028, 41.84830279347921, 64.73447214105128, 80.48375766487004, 93.6168036488914, 75.93633139916042, 99.81350187111259, 91.09006928918896, 52.93366810210403, 34.19936764429211, 65.05539836105329, 47.62315403429415, 50.90313577947359, 78.90414033418647, 65.08459932834523, 78.82270010277979, 49.69409342937425, 75.7836863982503, 97.52450999650651, 28.721194276357267, 89.28924024691366, 57.74885870804705, 88.93871946922816, 66.42725184299844, 87.46882551515519, 38.91279121249359, 94.30226885536912, 83.7391288588876, 34.24666485763113, 38.78461307184123, 101.97948141418007, 107.01678257840844, 72.96225748939682, 93.58797391492915, 62.49113129533191, 101.87283591432221, 75.17610668418394, 65.8944248553635], "policy_hider_policy_reward": [-12.869866231910711, 3.9906987539723806, -1.7866154154593739, 17.365537734912433, -7.6415862563999735, 28.53695940450595, -12.55627063978524, -13.478288189165267, -1.748089734538562, -20.50492385737447, -2.113928849085789, -4.523050547950383, -13.899684292123432, -11.555660893323, 40.23543495468308, -10.337945634645706, 4.034241392413552, 2.1809324137295687, 1.6791200567783617, -10.181800795920198, 1.9242253344569598, 36.52420773611619, 40.844377455435065, 8.755151635803324, -1.6287008559457996, -15.1165812993706, 1.97899419289868, 34.82041699916324, 2.496047491645191, -2.1491008162486582, -5.848668032661364, -9.000984889338884, 20.340053150108726, -5.988321918289107, -7.6061090208255475, 46.559525854478935, 6.453665243379833, 0.0714849075875049, -14.478060231271664, 45.69330135632241, -2.275606027827621, -14.003788853470713, -0.3571572323376656, -12.814804878869307, -14.848050414415024, -19.03200135321781, 0.8500133436967077, 18.620725646126722, 45.29035675775804, 7.919315321586911, 2.7290278385007682, 3.279383877773569, -0.7393104738113926, -9.509164138930174, -10.437343753515481, -0.39201568894277355, 0.20840925916223163, -8.418646235408412, 48.82466341046694, 6.095722745797099, 3.9127156210063387, 7.8388250546462235, 2.338999273727722, -2.993844985961472, 38.9175111857118, 43.07868652130644, -10.931847894307282, -12.198341745660754, -17.33442163596411, -4.363030149136043, -4.376121592852866, -7.257960130985612, 6.268737898492978, -8.827444726841705, -14.518869269442984, 13.245126178068785, 11.072250633109785, -17.647639198672714, -13.566185190406175, 19.692193063966034, -12.278374207975446, -15.429878770459366, -18.808251697530658, -7.016128851054916, -6.703130192998703, -4.679052258228406, 5.756931406337965, -2.9498985930614587, -3.5279010046310177, 45.78336135825411, -3.1700476265771846, -8.961670892320901, -2.8856975651530594, 1.5755623449371772, 10.785114465115191, 16.435974727395365, -14.554245297968297, 22.414148570232182, -17.26159253079593, -15.81482780407941, 40.73119492550162, -8.64337016553561, -20.106418636004577, 3.7774616107851076, 4.737185307714104, 3.8229065730547576, -9.512698161571327, -17.869050511680815, 2.322095060366051, 3.666461656732503, -11.31522260798277, -3.6010013192761288, -6.870188855201094, -6.133998895218344, -14.096569240894437, 33.9820914463641, -12.839130707468227, 4.634047031876733, 4.614779214260735, -7.768203566367284, 15.164517711374325, 1.398836055154917, 2.4395572633391756, 12.084989509420653, -0.08599764993819366, 9.849370561321345, 33.70700204906277, 13.247697206520813, 42.29104767938397, -10.628472141051269, -4.894620759664015, 3.917922882231851, -12.610803648891393, -9.611800761399646, -5.1403313991604405, 13.359047227733518, -16.0189550224561, -17.52148319899584, 8.80705230075742, -13.944069289188892, 1.6723318978959771, 49.21284389693295, 41.21526062255205, 20.046632355707885, -10.309398361053299, 37.415416672543856, 29.58649970017906, 11.69057733127459, 3.5528642205264265, 37.951374122448804, -2.9949525625171005, 6.053507714150409, 34.61050225869682, -9.458599328345233, -16.75670010277974, 26.21441473542951, 49.66653214561879, 5.091906570625734, 6.053765248858595, -1.2832720391823529, -13.498509996506499, -11.282555410466877, 43.36354907452315, 25.51480572364275, -11.103240246913687, 5.082343284951585, -2.842858708047054, 41.44292518465671, -11.053723658147705, -6.751431366260535, 0.6487481570015445, 18.607037727735566, -6.7554530938970565, -9.711831265682028, 16.085976014428088, 36.52013270997272, 3.6320624759089175, -21.83626885536913, -19.69312885888758, 28.367708043242153, 34.98274349186677, 20.763667951057915, 34.46113560586156, 18.581386928158786, -6.227000711955579, -20.54887938166748, -15.22411744912271, -17.566469219889417, -15.526257489396823, 33.59438992369816, -11.641973914929112, -5.0414733127558815, -1.3051312953319019, 24.865247046320608, -16.422081914834067, -17.83110538820746, -3.8272285728345032, 4.553787077176002, -12.008424855363495, 46.904495195688895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0719059775421642, "mean_inference_ms": 0.7495890242785187, "mean_action_processing_ms": 0.13124428643841646, "mean_env_wait_ms": 2.032207407226308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020788908004760742, "StateBufferConnector_ms": 0.002046942710876465, "ViewRequirementAgentConnector_ms": 0.04994034767150879}, "num_episodes": 29, "episode_return_max": 104.45253214561879, "episode_return_min": 64.62076520502183, "episode_return_mean": 83.05323409264875, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227354, "num_agent_steps_trained": 227354, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.86634148323813, "num_env_steps_trained_throughput_per_sec": 204.86634148323813, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 227354, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 227354, "timers": {"training_iteration_time_ms": 18977.613, "restore_workers_time_ms": 0.005, "training_step_time_ms": 18977.596, "sample_time_ms": 16740.027, "learn_time_ms": 2237.302, "learn_throughput": 1787.868, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 227354, "num_agent_steps_trained": 227354}, "done": false, "training_iteration": 19, "trial_id": "default", "date": "2025-10-13_04-25-19", "timestamp": 1760343919, "time_this_iter_s": 19.525561094284058, "time_total_s": 345.6810357570648, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 345.6810357570648, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 35.51428571428572, "ram_util_percent": 35.50714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.0979786068201065, "policy_loss": -0.008523823964060285, "vf_loss": 6.232663510739803, "vf_explained_var": -0.01666867844760418, "kl": 0.0065337235121433355, "entropy": 9.831886985898018, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.6715976513567425, "policy_loss": -0.010843086909754053, "vf_loss": 3.3840851023083642, "vf_explained_var": 0.7480343049480802, "kl": 0.006660731744526125, "entropy": 9.601808926415822, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12245.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 239354, "num_agent_steps_trained": 239354}, "env_runners": {"episode_reward_max": 104.45253214561879, "episode_reward_min": 65.99531230520755, "episode_reward_mean": 82.08205692987767, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 15.802367325082097, "hider_policy": -22.22569370138244}, "policy_reward_max": {"seeker_policy": 107.01678257840844, "hider_policy": 49.66653214561879}, "policy_reward_mean": {"seeker_policy": 76.975472423129, "hider_policy": 2.5532922533743396}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.4048250546462, 80.69499927372765, 97.79856503210041, 74.3578958042763, 73.28296985086396, 77.07608185665929, 75.5433021285113, 84.71112617806874, 82.86825063310974, 87.08819306396602, 69.49973163716768, 74.31347824561925, 77.44071224651408, 75.83293140633793, 99.91936135825401, 74.86187951730896, 77.60866621401702, 85.28480688285558, 87.75014857023216, 66.37500050243756, 94.3771949255015, 80.82346161078509, 82.81292323024802, 69.19917930909574, 78.7085190022721, 74.27591768744503, 68.33369116535185, 88.67809144636402, 81.01004703187671, 80.26077921426072, 85.58051771137431, 84.34098950942072, 83.45802395755342, 88.80300204906274, 96.39704767938392, 79.50705978743783, 71.39419923860036, 84.15504722773356, 66.27306364966067, 85.95305230075755, 103.818843896933, 95.46126062255208, 92.16141667254387, 88.9002310657478, 92.40737412244879, 81.96269548581971, 90.23650225869675, 88.28041473542949, 104.45253214561879, 80.55417960792651, 72.74344458953314, 97.59954907452308, 83.26834328495154, 96.34892518465664, 71.13356444481985, 85.68303772773565, 71.00154115557612, 91.51889993689431, 76.0980624759089, 92.41370804324215, 89.99307630055574, 91.82713560586146, 75.20360132055711, 74.22619590939628, 91.03038992369817, 76.90452668724413, 86.05124704632064, 67.61964861128068, 75.90266518852536, 100.79049519568893, 73.50676597679265, 75.14009825961259, 72.64905844208496, 87.37829270008868, 79.10840820913259, 86.84058406672015, 65.99531230520755, 68.764087515121, 73.98938390960123, 83.57039768458675, 86.14456900384515, 82.4392362500682, 74.5356443352117, 89.31343281506234, 69.93760150300884, 79.05606580374197, 79.29142210198201, 74.39406054232816, 85.31469164430946, 94.59507284053613, 76.58783569518106, 81.534530302167, 87.71028983141179, 97.4011799883459, 94.27581638984115, 71.96485169504619, 71.60863005376403, 73.96141507321163, 71.8031854654813, 89.7455310727302], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [65.65328437899369, 81.34984498596147, 15.802367325082097, 97.4880854442444, 94.98042163596409, 88.71016358049772, 78.10200895686002, 85.98486926944297, 89.44363919867273, 80.96218519040615, 97.20798461560238, 100.13785879420479, 88.82289469774119, 73.02589859306146, 57.663901004631, 86.99359803620703, 78.91880143423295, 58.06371769034503, 79.89024529796825, 99.45142083731298, 62.28937016553563, 97.15241863600451, 74.25283134947917, 96.58092798234783, 72.71996228517352, 89.19214161470389, 81.33787891577123, 68.79256924089442, 89.21513070746815, 83.41420356636729, 69.01716394484504, 69.81644273666085, 73.69465104617028, 41.84830279347921, 64.73447214105128, 80.48375766487004, 93.6168036488914, 75.93633139916042, 99.81350187111259, 91.09006928918896, 52.93366810210403, 34.19936764429211, 65.05539836105329, 47.62315403429415, 50.90313577947359, 78.90414033418647, 65.08459932834523, 78.82270010277979, 49.69409342937425, 75.7836863982503, 97.52450999650651, 28.721194276357267, 89.28924024691366, 57.74885870804705, 88.93871946922816, 66.42725184299844, 87.46882551515519, 38.91279121249359, 94.30226885536912, 83.7391288588876, 34.24666485763113, 38.78461307184123, 101.97948141418007, 107.01678257840844, 72.96225748939682, 93.58797391492915, 62.49113129533191, 101.87283591432221, 75.17610668418394, 65.8944248553635, 99.61169370138242, 97.9779289338312, 98.6855136241, 61.566697967876365, 79.57671655016816, 66.51240369742516, 85.04385207707689, 96.9639260612505, 74.75907113601161, 71.72988393776228, 65.76618871438409, 84.28706692283261, 88.93986797049405, 85.32769324104117, 86.48033468840285, 87.41974099279089, 100.50745296286483, 103.1919111193438, 76.3765982840111, 60.97831438672976, 83.71470148021571, 82.10050161223327, 68.38687101950538, 67.76751887807673, 41.33540577279518, 89.53139656499296, 84.61838986882331, 91.54504106317243, 89.67954927941575, 67.42388326558464], "policy_hider_policy_reward": [3.9127156210063387, 7.8388250546462235, 2.338999273727722, -2.993844985961472, 38.9175111857118, 43.07868652130644, -10.931847894307282, -12.198341745660754, -17.33442163596411, -4.363030149136043, -4.376121592852866, -7.257960130985612, 6.268737898492978, -8.827444726841705, -14.518869269442984, 13.245126178068785, 11.072250633109785, -17.647639198672714, -13.566185190406175, 19.692193063966034, -12.278374207975446, -15.429878770459366, -18.808251697530658, -7.016128851054916, -6.703130192998703, -4.679052258228406, 5.756931406337965, -2.9498985930614587, -3.5279010046310177, 45.78336135825411, -3.1700476265771846, -8.961670892320901, -2.8856975651530594, 1.5755623449371772, 10.785114465115191, 16.435974727395365, -14.554245297968297, 22.414148570232182, -17.26159253079593, -15.81482780407941, 40.73119492550162, -8.64337016553561, -20.106418636004577, 3.7774616107851076, 4.737185307714104, 3.8229065730547576, -9.512698161571327, -17.869050511680815, 2.322095060366051, 3.666461656732503, -11.31522260798277, -3.6010013192761288, -6.870188855201094, -6.133998895218344, -14.096569240894437, 33.9820914463641, -12.839130707468227, 4.634047031876733, 4.614779214260735, -7.768203566367284, 15.164517711374325, 1.398836055154917, 2.4395572633391756, 12.084989509420653, -0.08599764993819366, 9.849370561321345, 33.70700204906277, 13.247697206520813, 42.29104767938397, -10.628472141051269, -4.894620759664015, 3.917922882231851, -12.610803648891393, -9.611800761399646, -5.1403313991604405, 13.359047227733518, -16.0189550224561, -17.52148319899584, 8.80705230075742, -13.944069289188892, 1.6723318978959771, 49.21284389693295, 41.21526062255205, 20.046632355707885, -10.309398361053299, 37.415416672543856, 29.58649970017906, 11.69057733127459, 3.5528642205264265, 37.951374122448804, -2.9949525625171005, 6.053507714150409, 34.61050225869682, -9.458599328345233, -16.75670010277974, 26.21441473542951, 49.66653214561879, 5.091906570625734, 6.053765248858595, -1.2832720391823529, -13.498509996506499, -11.282555410466877, 43.36354907452315, 25.51480572364275, -11.103240246913687, 5.082343284951585, -2.842858708047054, 41.44292518465671, -11.053723658147705, -6.751431366260535, 0.6487481570015445, 18.607037727735566, -6.7554530938970565, -9.711831265682028, 16.085976014428088, 36.52013270997272, 3.6320624759089175, -21.83626885536913, -19.69312885888758, 28.367708043242153, 34.98274349186677, 20.763667951057915, 34.46113560586156, 18.581386928158786, -6.227000711955579, -20.54887938166748, -15.22411744912271, -17.566469219889417, -15.526257489396823, 33.59438992369816, -11.641973914929112, -5.0414733127558815, -1.3051312953319019, 24.865247046320608, -16.422081914834067, -17.83110538820746, -3.8272285728345032, 4.553787077176002, -12.008424855363495, 46.904495195688895, -3.879234023207354, -22.22569370138244, -17.43192893383116, -5.405901740387562, -17.27504512204084, -8.761410059974232, 1.9893020321236483, 23.82229270008876, 10.052408209132583, -10.52071655016808, 24.90458406672009, -4.576403697425159, -11.032292380703025, -8.016247391166326, -12.815991018753683, -15.383847527375757, -4.659389400354046, 3.8897021739436792, 11.384397684586762, 0.4561160622376982, 19.968569003845122, 0.40981128561592045, 1.2709524142517796, -3.118783087016192, -2.9003556647882496, -11.503867970494053, -15.041693241041163, 19.027432815062326, -1.8883984969912202, -14.654334688402807, 4.890065803741983, -13.253740992790915, -2.6845778980180026, -18.53145296286484, -17.2059111193438, -11.591939457671808, -5.18059828401112, 14.118691644309472, -6.652314386729753, 40.26907284053615, -3.9789237251145315, -3.147942059920124, -2.145914252863571, 1.5799429427972642, -8.140871019505369, 27.464289831411726, 43.28517998834602, -13.651518878076741, 12.920594227204845, 40.019816389841125, -6.5071692346041985, -11.059375635342514, -12.610363205363555, -0.3993966096957611, -13.13409813347627, -4.449527856484591, -12.573549279415795, -5.302814534518732, -11.527883265584615, 33.849531072730194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0718283891594067, "mean_inference_ms": 0.750676719418978, "mean_action_processing_ms": 0.1313197121118871, "mean_env_wait_ms": 2.050923686884997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002057790756225586, "StateBufferConnector_ms": 0.00205230712890625, "ViewRequirementAgentConnector_ms": 0.04999828338623047}, "num_episodes": 30, "episode_return_max": 104.45253214561879, "episode_return_min": 65.99531230520755, "episode_return_mean": 82.08205692987767, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239354, "num_agent_steps_trained": 239354, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 199.55669414523518, "num_env_steps_trained_throughput_per_sec": 199.55669414523518, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 239354, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 239354, "timers": {"training_iteration_time_ms": 18961.427, "restore_workers_time_ms": 0.006, "training_step_time_ms": 18961.409, "sample_time_ms": 16876.01, "learn_time_ms": 2085.128, "learn_throughput": 1918.347, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 239354, "num_agent_steps_trained": 239354}, "done": false, "training_iteration": 20, "trial_id": "default", "date": "2025-10-13_04-25-39", "timestamp": 1760343939, "time_this_iter_s": 20.04506492614746, "time_total_s": 365.7261006832123, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 365.7261006832123, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 36.332142857142856, "ram_util_percent": 35.58214285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.287540976703167, "policy_loss": -0.009030015325697605, "vf_loss": 6.612783595919609, "vf_explained_var": -0.005901806801557541, "kl": 0.006870607415675113, "entropy": 9.82349347770214, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6560.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.5909421771291703, "policy_loss": -0.010462819189128895, "vf_loss": 3.2220187647002083, "vf_explained_var": 0.6290351212024688, "kl": 0.005863008052863623, "entropy": 9.604389632694305, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12875.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 251354, "num_agent_steps_trained": 251354}, "env_runners": {"episode_reward_max": 104.45253214561879, "episode_reward_min": 65.99531230520755, "episode_reward_mean": 82.03246272920418, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 28.721194276357267, "hider_policy": -22.559835791519827}, "policy_reward_max": {"seeker_policy": 107.01678257840844, "hider_policy": 49.66653214561879}, "policy_reward_mean": {"seeker_policy": 76.46219856175406, "hider_policy": 2.785132083725057}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.58051771137431, 84.34098950942072, 83.45802395755342, 88.80300204906274, 96.39704767938392, 79.50705978743783, 71.39419923860036, 84.15504722773356, 66.27306364966067, 85.95305230075755, 103.818843896933, 95.46126062255208, 92.16141667254387, 88.9002310657478, 92.40737412244879, 81.96269548581971, 90.23650225869675, 88.28041473542949, 104.45253214561879, 80.55417960792651, 72.74344458953314, 97.59954907452308, 83.26834328495154, 96.34892518465664, 71.13356444481985, 85.68303772773565, 71.00154115557612, 91.51889993689431, 76.0980624759089, 92.41370804324215, 89.99307630055574, 91.82713560586146, 75.20360132055711, 74.22619590939628, 91.03038992369817, 76.90452668724413, 86.05124704632064, 67.61964861128068, 75.90266518852536, 100.79049519568893, 73.50676597679265, 75.14009825961259, 72.64905844208496, 87.37829270008868, 79.10840820913259, 86.84058406672015, 65.99531230520755, 68.764087515121, 73.98938390960123, 83.57039768458675, 86.14456900384515, 82.4392362500682, 74.5356443352117, 89.31343281506234, 69.93760150300884, 79.05606580374197, 79.29142210198201, 74.39406054232816, 85.31469164430946, 94.59507284053613, 76.58783569518106, 81.534530302167, 87.71028983141179, 97.4011799883459, 94.27581638984115, 71.96485169504619, 71.60863005376403, 73.96141507321163, 71.8031854654813, 89.7455310727302, 72.28201752356449, 73.88118796411959, 96.21931646695248, 70.26304690648946, 80.23528384279736, 79.44497466335056, 71.84521454841219, 76.78602555867214, 79.65326951816162, 81.96973166229205, 87.75132057173131, 69.69217012158141, 69.87745421259709, 92.32358950420858, 87.00826281042507, 72.79094668439518, 70.23973847368423, 93.33434471595893, 90.74006410742373, 74.29061780241179, 84.33628056893515, 93.51270800030798, 75.84842093040572, 69.25262721312939, 87.81893845247298, 86.18792960474222, 71.52309378343502, 91.09537370993966, 76.10968512245829, 66.91967496746759], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [69.01716394484504, 69.81644273666085, 73.69465104617028, 41.84830279347921, 64.73447214105128, 80.48375766487004, 93.6168036488914, 75.93633139916042, 99.81350187111259, 91.09006928918896, 52.93366810210403, 34.19936764429211, 65.05539836105329, 47.62315403429415, 50.90313577947359, 78.90414033418647, 65.08459932834523, 78.82270010277979, 49.69409342937425, 75.7836863982503, 97.52450999650651, 28.721194276357267, 89.28924024691366, 57.74885870804705, 88.93871946922816, 66.42725184299844, 87.46882551515519, 38.91279121249359, 94.30226885536912, 83.7391288588876, 34.24666485763113, 38.78461307184123, 101.97948141418007, 107.01678257840844, 72.96225748939682, 93.58797391492915, 62.49113129533191, 101.87283591432221, 75.17610668418394, 65.8944248553635, 99.61169370138242, 97.9779289338312, 98.6855136241, 61.566697967876365, 79.57671655016816, 66.51240369742516, 85.04385207707689, 96.9639260612505, 74.75907113601161, 71.72988393776228, 65.76618871438409, 84.28706692283261, 88.93986797049405, 85.32769324104117, 86.48033468840285, 87.41974099279089, 100.50745296286483, 103.1919111193438, 76.3765982840111, 60.97831438672976, 83.71470148021571, 82.10050161223327, 68.38687101950538, 67.76751887807673, 41.33540577279518, 89.53139656499296, 84.61838986882331, 91.54504106317243, 89.67954927941575, 67.42388326558464, 88.71155116897668, 100.10308200806074, 35.84430546540288, 87.04588634151092, 83.87131039201797, 94.01910975647263, 85.36935777789165, 90.42348990731655, 84.9314113098331, 103.42583579151983, 84.48695759055445, 76.2724068271722, 100.72593602328136, 55.933013885139374, 72.03892464528636, 89.21070068071354, 84.01347203653087, 38.04886150983409, 62.57603206739505, 89.43420164850237, 75.46041731822656, 60.03312346621466, 87.33130739777815, 84.59423741459554, 57.71091980440344, 69.20138630356358, 92.86381859107982, 64.57749785813024, 83.55323721834331, 80.46144708793538], "policy_hider_policy_reward": [15.164517711374325, 1.398836055154917, 2.4395572633391756, 12.084989509420653, -0.08599764993819366, 9.849370561321345, 33.70700204906277, 13.247697206520813, 42.29104767938397, -10.628472141051269, -4.894620759664015, 3.917922882231851, -12.610803648891393, -9.611800761399646, -5.1403313991604405, 13.359047227733518, -16.0189550224561, -17.52148319899584, 8.80705230075742, -13.944069289188892, 1.6723318978959771, 49.21284389693295, 41.21526062255205, 20.046632355707885, -10.309398361053299, 37.415416672543856, 29.58649970017906, 11.69057733127459, 3.5528642205264265, 37.951374122448804, -2.9949525625171005, 6.053507714150409, 34.61050225869682, -9.458599328345233, -16.75670010277974, 26.21441473542951, 49.66653214561879, 5.091906570625734, 6.053765248858595, -1.2832720391823529, -13.498509996506499, -11.282555410466877, 43.36354907452315, 25.51480572364275, -11.103240246913687, 5.082343284951585, -2.842858708047054, 41.44292518465671, -11.053723658147705, -6.751431366260535, 0.6487481570015445, 18.607037727735566, -6.7554530938970565, -9.711831265682028, 16.085976014428088, 36.52013270997272, 3.6320624759089175, -21.83626885536913, -19.69312885888758, 28.367708043242153, 34.98274349186677, 20.763667951057915, 34.46113560586156, 18.581386928158786, -6.227000711955579, -20.54887938166748, -15.22411744912271, -17.566469219889417, -15.526257489396823, 33.59438992369816, -11.641973914929112, -5.0414733127558815, -1.3051312953319019, 24.865247046320608, -16.422081914834067, -17.83110538820746, -3.8272285728345032, 4.553787077176002, -12.008424855363495, 46.904495195688895, -3.879234023207354, -22.22569370138244, -17.43192893383116, -5.405901740387562, -17.27504512204084, -8.761410059974232, 1.9893020321236483, 23.82229270008876, 10.052408209132583, -10.52071655016808, 24.90458406672009, -4.576403697425159, -11.032292380703025, -8.016247391166326, -12.815991018753683, -15.383847527375757, -4.659389400354046, 3.8897021739436792, 11.384397684586762, 0.4561160622376982, 19.968569003845122, 0.40981128561592045, 1.2709524142517796, -3.118783087016192, -2.9003556647882496, -11.503867970494053, -15.041693241041163, 19.027432815062326, -1.8883984969912202, -14.654334688402807, 4.890065803741983, -13.253740992790915, -2.6845778980180026, -18.53145296286484, -17.2059111193438, -11.591939457671808, -5.18059828401112, 14.118691644309472, -6.652314386729753, 40.26907284053615, -3.9789237251145315, -3.147942059920124, -2.145914252863571, 1.5799429427972642, -8.140871019505369, 27.464289831411726, 43.28517998834602, -13.651518878076741, 12.920594227204845, 40.019816389841125, -6.5071692346041985, -11.059375635342514, -12.610363205363555, -0.3993966096957611, -13.13409813347627, -4.449527856484591, -12.573549279415795, -5.302814534518732, -11.527883265584615, 33.849531072730194, -1.9794127039124254, -14.450120941499682, -14.80708200806074, -11.414812035880402, 22.5633795790124, 37.81163142253721, -9.311847299112294, -7.470992135909114, -5.325310392017993, 1.6892838427973065, -11.323109756472622, -3.2510253366493993, -0.5807854515878421, -12.943357777891613, -1.5199744413278673, -12.117489907316529, 15.417269518161634, -20.695411309833133, -22.559835791519827, 1.1037316622920705, -13.240957590554459, 16.505320571731367, -1.6438298784185912, -4.936406827172187, -15.669583517195267, -15.178898293488974, 1.5729861148606086, 34.81758950420859, 14.682262810425124, 0.28707535471364726, -10.92549248274581, -5.494261513572631, -10.955964834994989, -2.817768727851651, 15.94713849016589, 39.33834471595885, -4.0300320673950605, 32.194064107423735, -4.940563811691035, -10.203020034399602, -0.1644173182265854, 9.040280568935186, 39.14670800030796, -5.6671234662146635, -9.16530739777815, -2.3175790695942844, -7.2242120679383515, -8.117398133527887, 24.46603909184643, 5.641979556223211, 20.841929604742212, -3.8553863035635723, -9.229860206233232, -12.110864601411523, -3.61149785813027, 30.129373709939777, -2.6215027836896576, -4.822049312195328, -7.062377838805186, -6.47939428166257]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0820829554415232, "mean_inference_ms": 0.7522541435128036, "mean_action_processing_ms": 0.13145780291152495, "mean_env_wait_ms": 2.072007913423668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021381378173828125, "StateBufferConnector_ms": 0.0021080970764160156, "ViewRequirementAgentConnector_ms": 0.05092823505401611}, "num_episodes": 30, "episode_return_max": 104.45253214561879, "episode_return_min": 65.99531230520755, "episode_return_mean": 82.03246272920418, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 251354, "num_agent_steps_trained": 251354, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 173.6512606125332, "num_env_steps_trained_throughput_per_sec": 173.6512606125332, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 251354, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 251354, "timers": {"training_iteration_time_ms": 19370.372, "restore_workers_time_ms": 0.006, "training_step_time_ms": 19370.354, "sample_time_ms": 17321.854, "learn_time_ms": 2048.23, "learn_throughput": 1952.906, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 251354, "num_agent_steps_trained": 251354}, "done": false, "training_iteration": 21, "trial_id": "default", "date": "2025-10-13_04-26-03", "timestamp": 1760343963, "time_this_iter_s": 23.035325050354004, "time_total_s": 388.7614257335663, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 388.7614257335663, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 39.59117647058823, "ram_util_percent": 35.53235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.1936023004353045, "policy_loss": -0.01309708642802434, "vf_loss": 6.43311752974987, "vf_explained_var": -0.00928246546536684, "kl": 0.007111341567917917, "entropy": 9.862150594592094, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6880.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.6280188516964988, "policy_loss": -0.010756478406163672, "vf_loss": 3.2967594248907908, "vf_explained_var": 0.6959909015231662, "kl": 0.005504714158586672, "entropy": 9.604381249442934, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 13505.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 263354, "num_agent_steps_trained": 263354}, "env_runners": {"episode_reward_max": 108.70945891127892, "episode_reward_min": 65.99531230520755, "episode_reward_mean": 80.78065822849237, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 10.436757988839405, "hider_policy": -24.656163074310875}, "policy_reward_max": {"seeker_policy": 107.01678257840844, "hider_policy": 52.94345891127894}, "policy_reward_mean": {"seeker_policy": 79.06551434216506, "hider_policy": 0.8575719431636623}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.41370804324215, 89.99307630055574, 91.82713560586146, 75.20360132055711, 74.22619590939628, 91.03038992369817, 76.90452668724413, 86.05124704632064, 67.61964861128068, 75.90266518852536, 100.79049519568893, 73.50676597679265, 75.14009825961259, 72.64905844208496, 87.37829270008868, 79.10840820913259, 86.84058406672015, 65.99531230520755, 68.764087515121, 73.98938390960123, 83.57039768458675, 86.14456900384515, 82.4392362500682, 74.5356443352117, 89.31343281506234, 69.93760150300884, 79.05606580374197, 79.29142210198201, 74.39406054232816, 85.31469164430946, 94.59507284053613, 76.58783569518106, 81.534530302167, 87.71028983141179, 97.4011799883459, 94.27581638984115, 71.96485169504619, 71.60863005376403, 73.96141507321163, 71.8031854654813, 89.7455310727302, 72.28201752356449, 73.88118796411959, 96.21931646695248, 70.26304690648946, 80.23528384279736, 79.44497466335056, 71.84521454841219, 76.78602555867214, 79.65326951816162, 81.96973166229205, 87.75132057173131, 69.69217012158141, 69.87745421259709, 92.32358950420858, 87.00826281042507, 72.79094668439518, 70.23973847368423, 93.33434471595893, 90.74006410742373, 74.29061780241179, 84.33628056893515, 93.51270800030798, 75.84842093040572, 69.25262721312939, 87.81893845247298, 86.18792960474222, 71.52309378343502, 91.09537370993966, 76.10968512245829, 66.91967496746759, 94.9212589485507, 96.91567904109816, 69.82804724821767, 108.70945891127892, 87.25585799495855, 77.91651692215844, 76.45707199036032, 69.87143114753903, 88.5084642112727, 88.93617943759682, 69.5683180662659, 69.81028073148809, 70.25247616473517, 77.30661494288117, 77.92952194407492, 69.57189275632632, 85.84968832832324, 89.24501710592425, 75.11319286210475, 82.26381833402186, 76.6465459239617, 76.09264846802782, 75.20169667742746, 85.2961561252967, 91.75770346644569, 84.13737527983949, 83.8326808607228, 81.80137152570437, 83.31540611151782], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [83.7391288588876, 34.24666485763113, 38.78461307184123, 101.97948141418007, 107.01678257840844, 72.96225748939682, 93.58797391492915, 62.49113129533191, 101.87283591432221, 75.17610668418394, 65.8944248553635, 99.61169370138242, 97.9779289338312, 98.6855136241, 61.566697967876365, 79.57671655016816, 66.51240369742516, 85.04385207707689, 96.9639260612505, 74.75907113601161, 71.72988393776228, 65.76618871438409, 84.28706692283261, 88.93986797049405, 85.32769324104117, 86.48033468840285, 87.41974099279089, 100.50745296286483, 103.1919111193438, 76.3765982840111, 60.97831438672976, 83.71470148021571, 82.10050161223327, 68.38687101950538, 67.76751887807673, 41.33540577279518, 89.53139656499296, 84.61838986882331, 91.54504106317243, 89.67954927941575, 67.42388326558464, 88.71155116897668, 100.10308200806074, 35.84430546540288, 87.04588634151092, 83.87131039201797, 94.01910975647263, 85.36935777789165, 90.42348990731655, 84.9314113098331, 103.42583579151983, 84.48695759055445, 76.2724068271722, 100.72593602328136, 55.933013885139374, 72.03892464528636, 89.21070068071354, 84.01347203653087, 38.04886150983409, 62.57603206739505, 89.43420164850237, 75.46041731822656, 60.03312346621466, 87.33130739777815, 84.59423741459554, 57.71091980440344, 69.20138630356358, 92.86381859107982, 64.57749785813024, 83.55323721834331, 80.46144708793538, 52.50340329566465, 75.38082604935974, 95.99939166430369, 10.436757988839405, 69.06286546936796, 90.88107915355937, 82.16086912988456, 78.39941545075608, 59.71219073935376, 71.37837700282246, 82.3900711468175, 96.06904077469851, 101.33121796834776, 86.73474215991212, 88.96912327426216, 91.67370359434315, 86.92969395813272, 62.95493794767917, 91.04216307431086, 85.08705154692521, 95.73186047888167, 83.19970727164416, 88.70857742921905, 80.43462102387304, 29.246168063406657, 91.01781054900545, 76.62670104242764, 86.95358942317604, 77.70472154277617], "policy_hider_policy_reward": [-19.69312885888758, 28.367708043242153, 34.98274349186677, 20.763667951057915, 34.46113560586156, 18.581386928158786, -6.227000711955579, -20.54887938166748, -15.22411744912271, -17.566469219889417, -15.526257489396823, 33.59438992369816, -11.641973914929112, -5.0414733127558815, -1.3051312953319019, 24.865247046320608, -16.422081914834067, -17.83110538820746, -3.8272285728345032, 4.553787077176002, -12.008424855363495, 46.904495195688895, -3.879234023207354, -22.22569370138244, -17.43192893383116, -5.405901740387562, -17.27504512204084, -8.761410059974232, 1.9893020321236483, 23.82229270008876, 10.052408209132583, -10.52071655016808, 24.90458406672009, -4.576403697425159, -11.032292380703025, -8.016247391166326, -12.815991018753683, -15.383847527375757, -4.659389400354046, 3.8897021739436792, 11.384397684586762, 0.4561160622376982, 19.968569003845122, 0.40981128561592045, 1.2709524142517796, -3.118783087016192, -2.9003556647882496, -11.503867970494053, -15.041693241041163, 19.027432815062326, -1.8883984969912202, -14.654334688402807, 4.890065803741983, -13.253740992790915, -2.6845778980180026, -18.53145296286484, -17.2059111193438, -11.591939457671808, -5.18059828401112, 14.118691644309472, -6.652314386729753, 40.26907284053615, -3.9789237251145315, -3.147942059920124, -2.145914252863571, 1.5799429427972642, -8.140871019505369, 27.464289831411726, 43.28517998834602, -13.651518878076741, 12.920594227204845, 40.019816389841125, -6.5071692346041985, -11.059375635342514, -12.610363205363555, -0.3993966096957611, -13.13409813347627, -4.449527856484591, -12.573549279415795, -5.302814534518732, -11.527883265584615, 33.849531072730194, -1.9794127039124254, -14.450120941499682, -14.80708200806074, -11.414812035880402, 22.5633795790124, 37.81163142253721, -9.311847299112294, -7.470992135909114, -5.325310392017993, 1.6892838427973065, -11.323109756472622, -3.2510253366493993, -0.5807854515878421, -12.943357777891613, -1.5199744413278673, -12.117489907316529, 15.417269518161634, -20.695411309833133, -22.559835791519827, 1.1037316622920705, -13.240957590554459, 16.505320571731367, -1.6438298784185912, -4.936406827172187, -15.669583517195267, -15.178898293488974, 1.5729861148606086, 34.81758950420859, 14.682262810425124, 0.28707535471364726, -10.92549248274581, -5.494261513572631, -10.955964834994989, -2.817768727851651, 15.94713849016589, 39.33834471595885, -4.0300320673950605, 32.194064107423735, -4.940563811691035, -10.203020034399602, -0.1644173182265854, 9.040280568935186, 39.14670800030796, -5.6671234662146635, -9.16530739777815, -2.3175790695942844, -7.2242120679383515, -8.117398133527887, 24.46603909184643, 5.641979556223211, 20.841929604742212, -3.8553863035635723, -9.229860206233232, -12.110864601411523, -3.61149785813027, 30.129373709939777, -2.6215027836896576, -4.822049312195328, -7.062377838805186, -6.47939428166257, 4.6025967043353235, 37.8152589485507, -21.15482604935978, 42.68967904109809, -16.893391664303646, -9.277952751782376, 45.329242011160595, 52.94345891127894, -9.726865469367945, 27.91985799495859, -5.69624659627112, -7.268315635129805, -5.644869129884578, -0.05892800963966534, 0.6454311475390144, -9.173415450756059, -5.766190739353755, 34.56246421127269, 30.540179437596844, -12.982377002822474, -3.6176819337340667, -9.20407114681751, -6.255719268511845, -20.00304077469855, -22.665217968347722, -8.413523835264826, -3.999385057118777, -5.42874215991213, -11.453123274262182, 0.41352194407493853, -17.440839446649413, -4.660971391367516, -13.563693958132763, 12.483688328323268, 32.85901710592431, -6.568937947679146, -24.656163074310875, 8.727192862104733, -8.121051546925207, 5.297818334021876, -14.025860478881683, -5.059454076038378, -3.5003927724107684, -3.60666603120557, -9.119963141729471, -4.3869176100620395, 14.9301561252968, -10.068621023873062, 26.462300640253105, 36.049234762785936, -13.731810549005399, 6.851375279839476, -10.350701042427605, 17.55668086072272, -11.127589423176008, 5.975371525704382, 5.014510850937543, 0.5961737178040751]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0963567368363873, "mean_inference_ms": 0.754518554078894, "mean_action_processing_ms": 0.13163752874215073, "mean_env_wait_ms": 2.0921327797968234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002187013626098633, "StateBufferConnector_ms": 0.0021910667419433594, "ViewRequirementAgentConnector_ms": 0.051749229431152344}, "num_episodes": 29, "episode_return_max": 108.70945891127892, "episode_return_min": 65.99531230520755, "episode_return_mean": 80.78065822849237, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263354, "num_agent_steps_trained": 263354, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 185.14309008413545, "num_env_steps_trained_throughput_per_sec": 185.14309008413545, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 263354, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 263354, "timers": {"training_iteration_time_ms": 19684.371, "restore_workers_time_ms": 0.006, "training_step_time_ms": 19684.354, "sample_time_ms": 17637.342, "learn_time_ms": 2046.738, "learn_throughput": 1954.329, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 263354, "num_agent_steps_trained": 263354}, "done": false, "training_iteration": 22, "trial_id": "default", "date": "2025-10-13_04-26-25", "timestamp": 1760343985, "time_this_iter_s": 21.605498790740967, "time_total_s": 410.36692452430725, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 410.36692452430725, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 38.51612903225806, "ram_util_percent": 35.57096774193548}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.231493239104748, "policy_loss": -0.010874103949754499, "vf_loss": 6.504163905978203, "vf_explained_var": 0.005248731188476086, "kl": 0.007015398655848107, "entropy": 9.717371201515197, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.6373035319267757, "policy_loss": -0.01485800522837847, "vf_loss": 3.3234010499621194, "vf_explained_var": 0.7119061389612773, "kl": 0.008271216581167794, "entropy": 9.538990807911706, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.84126984126983, "num_grad_updates_lifetime": 14135.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 275345, "num_agent_steps_trained": 275345}, "env_runners": {"episode_reward_max": 108.70945891127892, "episode_reward_min": 65.22503771279202, "episode_reward_mean": 80.63094926294467, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 10.436757988839405, "hider_policy": -27.31545246499631}, "policy_reward_max": {"seeker_policy": 104.21663516621537, "hider_policy": 52.94345891127894}, "policy_reward_mean": {"seeker_policy": 79.45936817549078, "hider_policy": 0.5857905437269504}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.59507284053613, 76.58783569518106, 81.534530302167, 87.71028983141179, 97.4011799883459, 94.27581638984115, 71.96485169504619, 71.60863005376403, 73.96141507321163, 71.8031854654813, 89.7455310727302, 72.28201752356449, 73.88118796411959, 96.21931646695248, 70.26304690648946, 80.23528384279736, 79.44497466335056, 71.84521454841219, 76.78602555867214, 79.65326951816162, 81.96973166229205, 87.75132057173131, 69.69217012158141, 69.87745421259709, 92.32358950420858, 87.00826281042507, 72.79094668439518, 70.23973847368423, 93.33434471595893, 90.74006410742373, 74.29061780241179, 84.33628056893515, 93.51270800030798, 75.84842093040572, 69.25262721312939, 87.81893845247298, 86.18792960474222, 71.52309378343502, 91.09537370993966, 76.10968512245829, 66.91967496746759, 94.9212589485507, 96.91567904109816, 69.82804724821767, 108.70945891127892, 87.25585799495855, 77.91651692215844, 76.45707199036032, 69.87143114753903, 88.5084642112727, 88.93617943759682, 69.5683180662659, 69.81028073148809, 70.25247616473517, 77.30661494288117, 77.92952194407492, 69.57189275632632, 85.84968832832324, 89.24501710592425, 75.11319286210475, 82.26381833402186, 76.6465459239617, 76.09264846802782, 75.20169667742746, 85.2961561252967, 91.75770346644569, 84.13737527983949, 83.8326808607228, 81.80137152570437, 83.31540611151782, 93.96444269897188, 74.62625229343449, 73.28147435501288, 69.73974665857898, 76.237571505282, 85.69410233748361, 81.16602449678528, 80.59112575466482, 71.35937451297633, 72.62004266197759, 77.45461748807584, 65.22503771279202, 82.20821434499803, 92.81674237712697, 97.33883735892084, 68.86738568770186, 78.44728656196597, 82.56468324581554, 87.80780618897035, 94.61772355091884, 78.35056004570966, 68.63080273786494, 78.87304534626709, 70.17986106276278, 76.4425935518902, 74.65275015880898, 97.428880262121, 86.3761129614832, 80.87259773587188, 75.92521069087243], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [60.97831438672976, 83.71470148021571, 82.10050161223327, 68.38687101950538, 67.76751887807673, 41.33540577279518, 89.53139656499296, 84.61838986882331, 91.54504106317243, 89.67954927941575, 67.42388326558464, 88.71155116897668, 100.10308200806074, 35.84430546540288, 87.04588634151092, 83.87131039201797, 94.01910975647263, 85.36935777789165, 90.42348990731655, 84.9314113098331, 103.42583579151983, 84.48695759055445, 76.2724068271722, 100.72593602328136, 55.933013885139374, 72.03892464528636, 89.21070068071354, 84.01347203653087, 38.04886150983409, 62.57603206739505, 89.43420164850237, 75.46041731822656, 60.03312346621466, 87.33130739777815, 84.59423741459554, 57.71091980440344, 69.20138630356358, 92.86381859107982, 64.57749785813024, 83.55323721834331, 80.46144708793538, 52.50340329566465, 75.38082604935974, 95.99939166430369, 10.436757988839405, 69.06286546936796, 90.88107915355937, 82.16086912988456, 78.39941545075608, 59.71219073935376, 71.37837700282246, 82.3900711468175, 96.06904077469851, 101.33121796834776, 86.73474215991212, 88.96912327426216, 91.67370359434315, 86.92969395813272, 62.95493794767917, 91.04216307431086, 85.08705154692521, 95.73186047888167, 83.19970727164416, 88.70857742921905, 80.43462102387304, 29.246168063406657, 91.01781054900545, 76.62670104242764, 86.95358942317604, 77.70472154277617, 70.4194613332507, 104.13145246499627, 96.02369625746233, 86.64119868527719, 95.68736900089287, 91.50228316744762, 80.85313425127447, 98.39726313965235, 81.13760606812363, 92.1781889615874, 87.36145230817326, 82.21771245564837, 89.53413968185808, 55.33162862043409, 32.15558047403134, 78.81494866636599, 83.92691833297722, 71.39803569067405, 75.05252745040376, 60.692094155383174, 74.78739556974027, 104.21663516621537, 89.46336769695729, 97.22996396799569, 84.85184446019066, 74.92471375250167, 96.97586514476158, 78.15019814079632, 91.40907726050457, 82.39557452452065], "policy_hider_policy_reward": [-6.652314386729753, 40.26907284053615, -3.9789237251145315, -3.147942059920124, -2.145914252863571, 1.5799429427972642, -8.140871019505369, 27.464289831411726, 43.28517998834602, -13.651518878076741, 12.920594227204845, 40.019816389841125, -6.5071692346041985, -11.059375635342514, -12.610363205363555, -0.3993966096957611, -13.13409813347627, -4.449527856484591, -12.573549279415795, -5.302814534518732, -11.527883265584615, 33.849531072730194, -1.9794127039124254, -14.450120941499682, -14.80708200806074, -11.414812035880402, 22.5633795790124, 37.81163142253721, -9.311847299112294, -7.470992135909114, -5.325310392017993, 1.6892838427973065, -11.323109756472622, -3.2510253366493993, -0.5807854515878421, -12.943357777891613, -1.5199744413278673, -12.117489907316529, 15.417269518161634, -20.695411309833133, -22.559835791519827, 1.1037316622920705, -13.240957590554459, 16.505320571731367, -1.6438298784185912, -4.936406827172187, -15.669583517195267, -15.178898293488974, 1.5729861148606086, 34.81758950420859, 14.682262810425124, 0.28707535471364726, -10.92549248274581, -5.494261513572631, -10.955964834994989, -2.817768727851651, 15.94713849016589, 39.33834471595885, -4.0300320673950605, 32.194064107423735, -4.940563811691035, -10.203020034399602, -0.1644173182265854, 9.040280568935186, 39.14670800030796, -5.6671234662146635, -9.16530739777815, -2.3175790695942844, -7.2242120679383515, -8.117398133527887, 24.46603909184643, 5.641979556223211, 20.841929604742212, -3.8553863035635723, -9.229860206233232, -12.110864601411523, -3.61149785813027, 30.129373709939777, -2.6215027836896576, -4.822049312195328, -7.062377838805186, -6.47939428166257, 4.6025967043353235, 37.8152589485507, -21.15482604935978, 42.68967904109809, -16.893391664303646, -9.277952751782376, 45.329242011160595, 52.94345891127894, -9.726865469367945, 27.91985799495859, -5.69624659627112, -7.268315635129805, -5.644869129884578, -0.05892800963966534, 0.6454311475390144, -9.173415450756059, -5.766190739353755, 34.56246421127269, 30.540179437596844, -12.982377002822474, -3.6176819337340667, -9.20407114681751, -6.255719268511845, -20.00304077469855, -22.665217968347722, -8.413523835264826, -3.999385057118777, -5.42874215991213, -11.453123274262182, 0.41352194407493853, -17.440839446649413, -4.660971391367516, -13.563693958132763, 12.483688328323268, 32.85901710592431, -6.568937947679146, -24.656163074310875, 8.727192862104733, -8.121051546925207, 5.297818334021876, -14.025860478881683, -5.059454076038378, -3.5003927724107684, -3.60666603120557, -9.119963141729471, -4.3869176100620395, 14.9301561252968, -10.068621023873062, 26.462300640253105, 36.049234762785936, -13.731810549005399, 6.851375279839476, -10.350701042427605, 17.55668086072272, -11.127589423176008, 5.975371525704382, 5.014510850937543, 0.5961737178040751, 34.27844269897185, -10.733461333250705, -27.31545246499631, -2.1897477065654525, -18.28652739000892, -4.455694512440513, -10.645978130366554, -6.255473896331692, -3.3607387714781747, -16.089058724132705, 12.02810233748354, -17.836283167447547, -3.051842539979267, 3.364732785490069, -4.884874245335201, -12.921263139652334, -4.131431410657063, -5.6468001444902205, -8.498913812158138, -11.059232487451583, -10.705452308173225, 0.7986174880758258, 0.9156618163000839, -17.908336559156364, -10.408139681858083, 3.0822143449979635, 38.310742377126935, -0.8256286204340821, 42.79283735892083, 22.390419525968653, -5.2348486741900935, -4.712714304474055, -2.3594492979756794, -3.1201824730355154, 12.568683245815508, -1.4020356906740497, -5.40652745040372, 18.161806188970342, 41.07172355091892, -7.14609415538318, 4.324560045709837, -0.7613955697403471, -19.616643400182856, -15.969189028167586, 1.1370453462671344, -11.72736769695733, -13.3785125201235, -13.671590385109406, -1.9764771386494329, -6.432773769651055, 2.7043660975923243, -2.9763296912849566, 3.061820026280904, -2.608804908921441, -9.604198140796324, 17.830112961483312, -1.4730772605045945, -9.06340226412815, -10.409574524520691, 3.939210690872446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1113718836462134, "mean_inference_ms": 0.757254344643897, "mean_action_processing_ms": 0.13178903646269974, "mean_env_wait_ms": 2.111230064690756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002279520034790039, "StateBufferConnector_ms": 0.0023080110549926758, "ViewRequirementAgentConnector_ms": 0.054433226585388184}, "num_episodes": 30, "episode_return_max": 108.70945891127892, "episode_return_min": 65.22503771279202, "episode_return_mean": 80.63094926294467, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 275345, "num_agent_steps_trained": 275345, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 196.858813508004, "num_env_steps_trained_throughput_per_sec": 196.858813508004, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 275345, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 275345, "timers": {"training_iteration_time_ms": 19882.986, "restore_workers_time_ms": 0.006, "training_step_time_ms": 19882.968, "sample_time_ms": 17849.704, "learn_time_ms": 2033.009, "learn_throughput": 1967.527, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 275345, "num_agent_steps_trained": 275345}, "done": false, "training_iteration": 23, "trial_id": "default", "date": "2025-10-13_04-26-45", "timestamp": 1760344005, "time_this_iter_s": 20.31974220275879, "time_total_s": 430.68666672706604, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 430.68666672706604, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 37.50714285714287, "ram_util_percent": 35.60714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.1761312894523144, "policy_loss": -0.008870626245334278, "vf_loss": 6.389756797254085, "vf_explained_var": -0.02118005361407995, "kl": 0.007223872780781515, "entropy": 9.879319950938225, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7520.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.5289386725614942, "policy_loss": -0.010625099742947708, "vf_loss": 3.0980072543734596, "vf_explained_var": 0.761375934169406, "kl": 0.005493047927660586, "entropy": 9.439860829852876, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14765.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 287345, "num_agent_steps_trained": 287345}, "env_runners": {"episode_reward_max": 108.70945891127892, "episode_reward_min": 65.22503771279202, "episode_reward_mean": 80.66965910945983, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 10.436757988839405, "hider_policy": -27.31545246499631}, "policy_reward_max": {"seeker_policy": 104.21663516621537, "hider_policy": 52.94345891127894}, "policy_reward_mean": {"seeker_policy": 78.78948224011033, "hider_policy": 0.9400884346747479}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.29061780241179, 84.33628056893515, 93.51270800030798, 75.84842093040572, 69.25262721312939, 87.81893845247298, 86.18792960474222, 71.52309378343502, 91.09537370993966, 76.10968512245829, 66.91967496746759, 94.9212589485507, 96.91567904109816, 69.82804724821767, 108.70945891127892, 87.25585799495855, 77.91651692215844, 76.45707199036032, 69.87143114753903, 88.5084642112727, 88.93617943759682, 69.5683180662659, 69.81028073148809, 70.25247616473517, 77.30661494288117, 77.92952194407492, 69.57189275632632, 85.84968832832324, 89.24501710592425, 75.11319286210475, 82.26381833402186, 76.6465459239617, 76.09264846802782, 75.20169667742746, 85.2961561252967, 91.75770346644569, 84.13737527983949, 83.8326808607228, 81.80137152570437, 83.31540611151782, 93.96444269897188, 74.62625229343449, 73.28147435501288, 69.73974665857898, 76.237571505282, 85.69410233748361, 81.16602449678528, 80.59112575466482, 71.35937451297633, 72.62004266197759, 77.45461748807584, 65.22503771279202, 82.20821434499803, 92.81674237712697, 97.33883735892084, 68.86738568770186, 78.44728656196597, 82.56468324581554, 87.80780618897035, 94.61772355091884, 78.35056004570966, 68.63080273786494, 78.87304534626709, 70.17986106276278, 76.4425935518902, 74.65275015880898, 97.428880262121, 86.3761129614832, 80.87259773587188, 75.92521069087243, 78.51183768472089, 96.74118306852561, 69.72236137033612, 88.88453768527313, 73.60533433947086, 70.18261616864407, 80.63182056508009, 78.69527399147435, 67.05674937629661, 68.76843923325299, 84.07808255321595, 78.26872542193409, 91.66938876811065, 86.58059661261305, 72.80198671278383, 93.07544358224331, 84.11579070592795, 82.25738918934395, 76.1064198243752, 96.0862858923484, 80.36231323984725, 70.22367682255573, 81.19193363521627, 75.52493976822265, 78.31125370300306, 92.42007754857019, 97.93085068245001, 77.67972538201751, 87.93445981919649, 71.97778956899886], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [89.43420164850237, 75.46041731822656, 60.03312346621466, 87.33130739777815, 84.59423741459554, 57.71091980440344, 69.20138630356358, 92.86381859107982, 64.57749785813024, 83.55323721834331, 80.46144708793538, 52.50340329566465, 75.38082604935974, 95.99939166430369, 10.436757988839405, 69.06286546936796, 90.88107915355937, 82.16086912988456, 78.39941545075608, 59.71219073935376, 71.37837700282246, 82.3900711468175, 96.06904077469851, 101.33121796834776, 86.73474215991212, 88.96912327426216, 91.67370359434315, 86.92969395813272, 62.95493794767917, 91.04216307431086, 85.08705154692521, 95.73186047888167, 83.19970727164416, 88.70857742921905, 80.43462102387304, 29.246168063406657, 91.01781054900545, 76.62670104242764, 86.95358942317604, 77.70472154277617, 70.4194613332507, 104.13145246499627, 96.02369625746233, 86.64119868527719, 95.68736900089287, 91.50228316744762, 80.85313425127447, 98.39726313965235, 81.13760606812363, 92.1781889615874, 87.36145230817326, 82.21771245564837, 89.53413968185808, 55.33162862043409, 32.15558047403134, 78.81494866636599, 83.92691833297722, 71.39803569067405, 75.05252745040376, 60.692094155383174, 74.78739556974027, 104.21663516621537, 89.46336769695729, 97.22996396799569, 84.85184446019066, 74.92471375250167, 96.97586514476158, 78.15019814079632, 91.40907726050457, 82.39557452452065, 91.7852517634131, 42.28394945727542, 95.24147397587544, 54.78755882108349, 90.54404090054307, 88.93914192450173, 78.85232430863127, 78.17223263280339, 93.54534694261345, 84.94292280157099, 72.47513690358788, 93.41086412441858, 72.28446763261634, 63.183940448502796, 88.17344129562107, 45.29972920712826, 73.0313379032374, 87.74854974215579, 91.37014968460478, 77.9456764160669, 71.3837028366848, 82.19360558760962, 83.60533865350183, 80.86825502281603, 89.43055951200243, 56.31298109889291, 14.070836206002797, 88.50903567457671, 63.758066213368934, 82.994707146704], "policy_hider_policy_reward": [-4.940563811691035, -10.203020034399602, -0.1644173182265854, 9.040280568935186, 39.14670800030796, -5.6671234662146635, -9.16530739777815, -2.3175790695942844, -7.2242120679383515, -8.117398133527887, 24.46603909184643, 5.641979556223211, 20.841929604742212, -3.8553863035635723, -9.229860206233232, -12.110864601411523, -3.61149785813027, 30.129373709939777, -2.6215027836896576, -4.822049312195328, -7.062377838805186, -6.47939428166257, 4.6025967043353235, 37.8152589485507, -21.15482604935978, 42.68967904109809, -16.893391664303646, -9.277952751782376, 45.329242011160595, 52.94345891127894, -9.726865469367945, 27.91985799495859, -5.69624659627112, -7.268315635129805, -5.644869129884578, -0.05892800963966534, 0.6454311475390144, -9.173415450756059, -5.766190739353755, 34.56246421127269, 30.540179437596844, -12.982377002822474, -3.6176819337340667, -9.20407114681751, -6.255719268511845, -20.00304077469855, -22.665217968347722, -8.413523835264826, -3.999385057118777, -5.42874215991213, -11.453123274262182, 0.41352194407493853, -17.440839446649413, -4.660971391367516, -13.563693958132763, 12.483688328323268, 32.85901710592431, -6.568937947679146, -24.656163074310875, 8.727192862104733, -8.121051546925207, 5.297818334021876, -14.025860478881683, -5.059454076038378, -3.5003927724107684, -3.60666603120557, -9.119963141729471, -4.3869176100620395, 14.9301561252968, -10.068621023873062, 26.462300640253105, 36.049234762785936, -13.731810549005399, 6.851375279839476, -10.350701042427605, 17.55668086072272, -11.127589423176008, 5.975371525704382, 5.014510850937543, 0.5961737178040751, 34.27844269897185, -10.733461333250705, -27.31545246499631, -2.1897477065654525, -18.28652739000892, -4.455694512440513, -10.645978130366554, -6.255473896331692, -3.3607387714781747, -16.089058724132705, 12.02810233748354, -17.836283167447547, -3.051842539979267, 3.364732785490069, -4.884874245335201, -12.921263139652334, -4.131431410657063, -5.6468001444902205, -8.498913812158138, -11.059232487451583, -10.705452308173225, 0.7986174880758258, 0.9156618163000839, -17.908336559156364, -10.408139681858083, 3.0822143449979635, 38.310742377126935, -0.8256286204340821, 42.79283735892083, 22.390419525968653, -5.2348486741900935, -4.712714304474055, -2.3594492979756794, -3.1201824730355154, 12.568683245815508, -1.4020356906740497, -5.40652745040372, 18.161806188970342, 41.07172355091892, -7.14609415538318, 4.324560045709837, -0.7613955697403471, -19.616643400182856, -15.969189028167586, 1.1370453462671344, -11.72736769695733, -13.3785125201235, -13.671590385109406, -1.9764771386494329, -6.432773769651055, 2.7043660975923243, -2.9763296912849566, 3.061820026280904, -2.608804908921441, -9.604198140796324, 17.830112961483312, -1.4730772605045945, -9.06340226412815, -10.409574524520691, 3.939210690872446, -3.0741623152790982, -10.199251763413072, 13.042050542724581, 41.41518306852577, -13.495754447571134, -12.023358157968195, 10.478441178916519, 23.618537685272983, -12.228040900543105, -4.710665660529145, -10.178070906010609, -8.578454849847077, 4.680951915866616, -2.9014556594178575, 5.7192739914743775, -5.196232632803389, -14.348666221635629, -12.139931344681248, -11.599216807268705, -4.575266761049222, -5.429136903587877, 17.03208255321602, 1.8627254219341178, -17.00486412441856, 36.873388768110644, -17.48846763261638, 7.1620595514971885, 16.234596612613014, -9.136689769734973, -6.2347648131022115, 38.12944358224338, 9.64627079287175, 1.164662096762589, 9.91979070592804, -9.990346677428416, 4.499186124616565, -5.259580175624749, -10.004149684604823, 39.44028589234843, -21.299676416066927, 3.802297163315186, 5.1763132398472305, -2.108573041559032, -9.861355723494869, 5.275933635216325, -7.689338653501854, -1.7176269466231808, -3.625688307970178, -9.11621431150569, -2.0030914974936724, 37.7240775485702, -1.6169810988929352, 42.86931405748767, 40.99070041895948, -4.189441930384916, -6.639868362174253, 25.8884598191965, -1.7120662133689406, -15.563570592863979, 4.546653015158824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.120350066491586, "mean_inference_ms": 0.7608279830781194, "mean_action_processing_ms": 0.13194501764570787, "mean_env_wait_ms": 2.128499179190046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002372145652770996, "StateBufferConnector_ms": 0.0023543834686279297, "ViewRequirementAgentConnector_ms": 0.05635809898376465}, "num_episodes": 30, "episode_return_max": 108.70945891127892, "episode_return_min": 65.22503771279202, "episode_return_mean": 80.66965910945983, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287345, "num_agent_steps_trained": 287345, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 192.08191237252856, "num_env_steps_trained_throughput_per_sec": 192.08191237252856, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 287345, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 287345, "timers": {"training_iteration_time_ms": 20125.273, "restore_workers_time_ms": 0.006, "training_step_time_ms": 20125.255, "sample_time_ms": 18112.789, "learn_time_ms": 2012.214, "learn_throughput": 1987.86, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 287345, "num_agent_steps_trained": 287345}, "done": false, "training_iteration": 24, "trial_id": "default", "date": "2025-10-13_04-27-06", "timestamp": 1760344026, "time_this_iter_s": 20.825129985809326, "time_total_s": 451.51179671287537, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 451.51179671287537, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 38.28666666666667, "ram_util_percent": 35.64666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.179176338762045, "policy_loss": -0.013708878235775046, "vf_loss": 6.405480255186558, "vf_explained_var": -0.020652376115322113, "kl": 0.007881896101480438, "entropy": 9.857977288961411, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7840.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.6010169714216202, "policy_loss": -0.007427531791230043, "vf_loss": 3.235834011009761, "vf_explained_var": 0.6279783984971425, "kl": 0.006164293514055138, "entropy": 9.472503344217936, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.15873015873017, "num_grad_updates_lifetime": 15395.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 299293, "num_agent_steps_trained": 299293}, "env_runners": {"episode_reward_max": 97.93085068245001, "episode_reward_min": 64.15048736498056, "episode_reward_mean": 81.04434943020307, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 14.070836206002797, "hider_policy": -27.31545246499631}, "policy_reward_max": {"seeker_policy": 104.21663516621537, "hider_policy": 42.86931405748767}, "policy_reward_mean": {"seeker_policy": 79.50731459400606, "hider_policy": 0.768517418098508}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.11319286210475, 82.26381833402186, 76.6465459239617, 76.09264846802782, 75.20169667742746, 85.2961561252967, 91.75770346644569, 84.13737527983949, 83.8326808607228, 81.80137152570437, 83.31540611151782, 93.96444269897188, 74.62625229343449, 73.28147435501288, 69.73974665857898, 76.237571505282, 85.69410233748361, 81.16602449678528, 80.59112575466482, 71.35937451297633, 72.62004266197759, 77.45461748807584, 65.22503771279202, 82.20821434499803, 92.81674237712697, 97.33883735892084, 68.86738568770186, 78.44728656196597, 82.56468324581554, 87.80780618897035, 94.61772355091884, 78.35056004570966, 68.63080273786494, 78.87304534626709, 70.17986106276278, 76.4425935518902, 74.65275015880898, 97.428880262121, 86.3761129614832, 80.87259773587188, 75.92521069087243, 78.51183768472089, 96.74118306852561, 69.72236137033612, 88.88453768527313, 73.60533433947086, 70.18261616864407, 80.63182056508009, 78.69527399147435, 67.05674937629661, 68.76843923325299, 84.07808255321595, 78.26872542193409, 91.66938876811065, 86.58059661261305, 72.80198671278383, 93.07544358224331, 84.11579070592795, 82.25738918934395, 76.1064198243752, 96.0862858923484, 80.36231323984725, 70.22367682255573, 81.19193363521627, 75.52493976822265, 78.31125370300306, 92.42007754857019, 97.93085068245001, 77.67972538201751, 87.93445981919649, 71.97778956899886, 64.15048736498056, 78.2434826246274, 88.52670013499299, 81.22788872309955, 97.38501486508325, 78.13453207564277, 90.23510000316027, 86.15066153771487, 69.57694007170718, 72.36332061264157, 86.38876590204653, 81.02843954576743, 71.74971400893273, 71.4200472428391, 87.34587435048746, 83.42793552923374, 95.69748268995068, 82.24613447606698, 86.0400309885656, 75.1493774869993, 79.57474012573634, 97.21415652832532, 85.64595548622168, 79.20553170258576, 78.86415736956518, 76.53648179974066, 91.93163062216563, 75.13918395119026, 92.61839030300948], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [91.04216307431086, 85.08705154692521, 95.73186047888167, 83.19970727164416, 88.70857742921905, 80.43462102387304, 29.246168063406657, 91.01781054900545, 76.62670104242764, 86.95358942317604, 77.70472154277617, 70.4194613332507, 104.13145246499627, 96.02369625746233, 86.64119868527719, 95.68736900089287, 91.50228316744762, 80.85313425127447, 98.39726313965235, 81.13760606812363, 92.1781889615874, 87.36145230817326, 82.21771245564837, 89.53413968185808, 55.33162862043409, 32.15558047403134, 78.81494866636599, 83.92691833297722, 71.39803569067405, 75.05252745040376, 60.692094155383174, 74.78739556974027, 104.21663516621537, 89.46336769695729, 97.22996396799569, 84.85184446019066, 74.92471375250167, 96.97586514476158, 78.15019814079632, 91.40907726050457, 82.39557452452065, 91.7852517634131, 42.28394945727542, 95.24147397587544, 54.78755882108349, 90.54404090054307, 88.93914192450173, 78.85232430863127, 78.17223263280339, 93.54534694261345, 84.94292280157099, 72.47513690358788, 93.41086412441858, 72.28446763261634, 63.183940448502796, 88.17344129562107, 45.29972920712826, 73.0313379032374, 87.74854974215579, 91.37014968460478, 77.9456764160669, 71.3837028366848, 82.19360558760962, 83.60533865350183, 80.86825502281603, 89.43055951200243, 56.31298109889291, 14.070836206002797, 88.50903567457671, 63.758066213368934, 82.994707146704, 87.29369107358102, 88.49349521105569, 53.94832744407447, 82.79773597990344, 42.90458438144795, 96.59786462221427, 84.73637521576232, 73.91567636697395, 91.26615079925328, 88.63408575040113, 72.46416480816553, 87.37585566217697, 85.1703085370375, 86.99741020239975, 77.57758205984716, 86.77592439930228, 67.70563279446333, 96.22272304110062, 66.87800951220194, 86.91849691025911, 90.68322944927033, 62.14982631787907, 49.41727859454698, 87.32337204484416, 83.87258592795605, 101.31098938650352, 54.85254267660547, 86.6659079417128, 79.02270915550987], "policy_hider_policy_reward": [-24.656163074310875, 8.727192862104733, -8.121051546925207, 5.297818334021876, -14.025860478881683, -5.059454076038378, -3.5003927724107684, -3.60666603120557, -9.119963141729471, -4.3869176100620395, 14.9301561252968, -10.068621023873062, 26.462300640253105, 36.049234762785936, -13.731810549005399, 6.851375279839476, -10.350701042427605, 17.55668086072272, -11.127589423176008, 5.975371525704382, 5.014510850937543, 0.5961737178040751, 34.27844269897185, -10.733461333250705, -27.31545246499631, -2.1897477065654525, -18.28652739000892, -4.455694512440513, -10.645978130366554, -6.255473896331692, -3.3607387714781747, -16.089058724132705, 12.02810233748354, -17.836283167447547, -3.051842539979267, 3.364732785490069, -4.884874245335201, -12.921263139652334, -4.131431410657063, -5.6468001444902205, -8.498913812158138, -11.059232487451583, -10.705452308173225, 0.7986174880758258, 0.9156618163000839, -17.908336559156364, -10.408139681858083, 3.0822143449979635, 38.310742377126935, -0.8256286204340821, 42.79283735892083, 22.390419525968653, -5.2348486741900935, -4.712714304474055, -2.3594492979756794, -3.1201824730355154, 12.568683245815508, -1.4020356906740497, -5.40652745040372, 18.161806188970342, 41.07172355091892, -7.14609415538318, 4.324560045709837, -0.7613955697403471, -19.616643400182856, -15.969189028167586, 1.1370453462671344, -11.72736769695733, -13.3785125201235, -13.671590385109406, -1.9764771386494329, -6.432773769651055, 2.7043660975923243, -2.9763296912849566, 3.061820026280904, -2.608804908921441, -9.604198140796324, 17.830112961483312, -1.4730772605045945, -9.06340226412815, -10.409574524520691, 3.939210690872446, -3.0741623152790982, -10.199251763413072, 13.042050542724581, 41.41518306852577, -13.495754447571134, -12.023358157968195, 10.478441178916519, 23.618537685272983, -12.228040900543105, -4.710665660529145, -10.178070906010609, -8.578454849847077, 4.680951915866616, -2.9014556594178575, 5.7192739914743775, -5.196232632803389, -14.348666221635629, -12.139931344681248, -11.599216807268705, -4.575266761049222, -5.429136903587877, 17.03208255321602, 1.8627254219341178, -17.00486412441856, 36.873388768110644, -17.48846763261638, 7.1620595514971885, 16.234596612613014, -9.136689769734973, -6.2347648131022115, 38.12944358224338, 9.64627079287175, 1.164662096762589, 9.91979070592804, -9.990346677428416, 4.499186124616565, -5.259580175624749, -10.004149684604823, 39.44028589234843, -21.299676416066927, 3.802297163315186, 5.1763132398472305, -2.108573041559032, -9.861355723494869, 5.275933635216325, -7.689338653501854, -1.7176269466231808, -3.625688307970178, -9.11621431150569, -2.0030914974936724, 37.7240775485702, -1.6169810988929352, 42.86931405748767, 40.99070041895948, -4.189441930384916, -6.639868362174253, 25.8884598191965, -1.7120662133689406, -15.563570592863979, 4.546653015158824, -8.022196025452951, -15.121007683147504, -11.97749521105568, 1.727482624627441, 24.876126746159805, 9.7022459447587, 4.001888723099484, -5.571735979903419, 13.921415618552054, 40.55901486508322, -2.4122918741381447, -16.051040672433306, -16.050375215762287, 21.54910000316025, -4.009676366974, 16.244661537714965, -13.120150799253304, -8.56905992829284, -6.949393550834822, -9.321371586924673, 18.87276590204653, -4.948164808165558, -8.849855662176918, 2.502439545767424, -10.173374670771176, -3.2472198573335995, -13.711410202399819, -1.865952757160887, -16.551582059847167, 26.319874350487435, -8.119924399302361, 4.771935529233765, 39.36148268995063, -11.369632794463325, 3.7001344760669514, -17.67672304110063, 14.114030988565688, 5.047990487798067, -7.411490377825998, -4.35762904543388, -3.3812598742635624, -7.7272294492703555, -7.773826317879062, 42.83815652832538, 15.441407788808382, 20.78726910286634, -11.577372044844191, 3.45953170258579, 4.383635283553842, -9.39206384194469, -9.759518200259357, -15.01498938650347, 8.83345732339454, 28.245630622165653, -0.2649351281207874, -11.261788862401657, 6.9926625481342075, 6.603018599365403]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.12311798089639, "mean_inference_ms": 0.7645965584807886, "mean_action_processing_ms": 0.1321448365033913, "mean_env_wait_ms": 2.1450030218702265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023908615112304688, "StateBufferConnector_ms": 0.0023802518844604492, "ViewRequirementAgentConnector_ms": 0.0570751428604126}, "num_episodes": 29, "episode_return_max": 97.93085068245001, "episode_return_min": 64.15048736498056, "episode_return_mean": 81.04434943020307, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 299293, "num_agent_steps_trained": 299293, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 189.57375617962714, "num_env_steps_trained_throughput_per_sec": 189.57375617962714, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 299293, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 299293, "timers": {"training_iteration_time_ms": 20338.528, "restore_workers_time_ms": 0.006, "training_step_time_ms": 20338.51, "sample_time_ms": 18343.496, "learn_time_ms": 1994.78, "learn_throughput": 2005.234, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 299293, "num_agent_steps_trained": 299293}, "done": false, "training_iteration": 25, "trial_id": "default", "date": "2025-10-13_04-27-27", "timestamp": 1760344047, "time_this_iter_s": 21.100588083267212, "time_total_s": 472.6123847961426, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 472.6123847961426, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 36.78, "ram_util_percent": 35.67333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.0827986486256123, "policy_loss": -0.010119670403946656, "vf_loss": 6.205215825140476, "vf_explained_var": -0.033432405814528464, "kl": 0.005632760285604435, "entropy": 9.691793158650398, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.611860051798442, "policy_loss": -0.011105872097144288, "vf_loss": 3.2649846584077866, "vf_explained_var": 0.6951727579510402, "kl": 0.007043134855392449, "entropy": 9.526406701405843, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16025.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 311293, "num_agent_steps_trained": 311293}, "env_runners": {"episode_reward_max": 97.93085068245001, "episode_reward_min": 64.15048736498056, "episode_reward_mean": 80.98557489779392, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 14.070836206002797, "hider_policy": -21.9949280163923}, "policy_reward_max": {"seeker_policy": 104.21663516621537, "hider_policy": 42.86931405748767}, "policy_reward_mean": {"seeker_policy": 79.31439365678027, "hider_policy": 0.8355906205068306}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.61772355091884, 78.35056004570966, 68.63080273786494, 78.87304534626709, 70.17986106276278, 76.4425935518902, 74.65275015880898, 97.428880262121, 86.3761129614832, 80.87259773587188, 75.92521069087243, 78.51183768472089, 96.74118306852561, 69.72236137033612, 88.88453768527313, 73.60533433947086, 70.18261616864407, 80.63182056508009, 78.69527399147435, 67.05674937629661, 68.76843923325299, 84.07808255321595, 78.26872542193409, 91.66938876811065, 86.58059661261305, 72.80198671278383, 93.07544358224331, 84.11579070592795, 82.25738918934395, 76.1064198243752, 96.0862858923484, 80.36231323984725, 70.22367682255573, 81.19193363521627, 75.52493976822265, 78.31125370300306, 92.42007754857019, 97.93085068245001, 77.67972538201751, 87.93445981919649, 71.97778956899886, 64.15048736498056, 78.2434826246274, 88.52670013499299, 81.22788872309955, 97.38501486508325, 78.13453207564277, 90.23510000316027, 86.15066153771487, 69.57694007170718, 72.36332061264157, 86.38876590204653, 81.02843954576743, 71.74971400893273, 71.4200472428391, 87.34587435048746, 83.42793552923374, 95.69748268995068, 82.24613447606698, 86.0400309885656, 75.1493774869993, 79.57474012573634, 97.21415652832532, 85.64595548622168, 79.20553170258576, 78.86415736956518, 76.53648179974066, 91.93163062216563, 75.13918395119026, 92.61839030300948, 87.99764308107548, 85.64959279884457, 67.22249485478275, 78.03541015404443, 88.81563089005074, 80.13583740924898, 86.4234372385103, 77.75498400423031, 83.94982578849184, 66.13824012531784, 64.36724500090396, 81.01986935683134, 77.20817549694648, 81.69766846296726, 86.86132492463841, 96.3737816553113, 76.31750391887861, 73.94292191364565, 67.80329281478211, 67.88207932033768, 84.333620638119, 91.50211858530551, 79.61189840384168, 66.53793518748637, 77.72060670880352, 85.52812794339047, 81.98891164135956, 70.3981065344927, 97.60040880382238, 90.77321697923061], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [60.692094155383174, 74.78739556974027, 104.21663516621537, 89.46336769695729, 97.22996396799569, 84.85184446019066, 74.92471375250167, 96.97586514476158, 78.15019814079632, 91.40907726050457, 82.39557452452065, 91.7852517634131, 42.28394945727542, 95.24147397587544, 54.78755882108349, 90.54404090054307, 88.93914192450173, 78.85232430863127, 78.17223263280339, 93.54534694261345, 84.94292280157099, 72.47513690358788, 93.41086412441858, 72.28446763261634, 63.183940448502796, 88.17344129562107, 45.29972920712826, 73.0313379032374, 87.74854974215579, 91.37014968460478, 77.9456764160669, 71.3837028366848, 82.19360558760962, 83.60533865350183, 80.86825502281603, 89.43055951200243, 56.31298109889291, 14.070836206002797, 88.50903567457671, 63.758066213368934, 82.994707146704, 87.29369107358102, 88.49349521105569, 53.94832744407447, 82.79773597990344, 42.90458438144795, 96.59786462221427, 84.73637521576232, 73.91567636697395, 91.26615079925328, 88.63408575040113, 72.46416480816553, 87.37585566217697, 85.1703085370375, 86.99741020239975, 77.57758205984716, 86.77592439930228, 67.70563279446333, 96.22272304110062, 66.87800951220194, 86.91849691025911, 90.68322944927033, 62.14982631787907, 49.41727859454698, 87.32337204484416, 83.87258592795605, 101.31098938650352, 54.85254267660547, 86.6659079417128, 79.02270915550987, 40.92854009097099, 82.83319803010066, 95.60855536843015, 88.82846551855395, 75.69101301440963, 98.09623264392076, 70.27975415091682, 103.27419242348813, 96.020505513867, 84.56977777637789, 91.46049435321372, 80.11863522702734, 82.37691206875807, 76.99470033060385, 73.51867676162001, 69.51664510047418, 97.39013981377111, 93.38754773166204, 91.60354657563568, 94.6326000689382, 64.94256612686337, 53.403100934036345, 82.78750296625687, 91.84129411905356, 87.4036609889573, 81.54612624190574, 60.00003898627564, 90.38243940843698, 60.17796205971801, 59.61065033935476], "policy_hider_policy_reward": [41.07172355091892, -7.14609415538318, 4.324560045709837, -0.7613955697403471, -19.616643400182856, -15.969189028167586, 1.1370453462671344, -11.72736769695733, -13.3785125201235, -13.671590385109406, -1.9764771386494329, -6.432773769651055, 2.7043660975923243, -2.9763296912849566, 3.061820026280904, -2.608804908921441, -9.604198140796324, 17.830112961483312, -1.4730772605045945, -9.06340226412815, -10.409574524520691, 3.939210690872446, -3.0741623152790982, -10.199251763413072, 13.042050542724581, 41.41518306852577, -13.495754447571134, -12.023358157968195, 10.478441178916519, 23.618537685272983, -12.228040900543105, -4.710665660529145, -10.178070906010609, -8.578454849847077, 4.680951915866616, -2.9014556594178575, 5.7192739914743775, -5.196232632803389, -14.348666221635629, -12.139931344681248, -11.599216807268705, -4.575266761049222, -5.429136903587877, 17.03208255321602, 1.8627254219341178, -17.00486412441856, 36.873388768110644, -17.48846763261638, 7.1620595514971885, 16.234596612613014, -9.136689769734973, -6.2347648131022115, 38.12944358224338, 9.64627079287175, 1.164662096762589, 9.91979070592804, -9.990346677428416, 4.499186124616565, -5.259580175624749, -10.004149684604823, 39.44028589234843, -21.299676416066927, 3.802297163315186, 5.1763132398472305, -2.108573041559032, -9.861355723494869, 5.275933635216325, -7.689338653501854, -1.7176269466231808, -3.625688307970178, -9.11621431150569, -2.0030914974936724, 37.7240775485702, -1.6169810988929352, 42.86931405748767, 40.99070041895948, -4.189441930384916, -6.639868362174253, 25.8884598191965, -1.7120662133689406, -15.563570592863979, 4.546653015158824, -8.022196025452951, -15.121007683147504, -11.97749521105568, 1.727482624627441, 24.876126746159805, 9.7022459447587, 4.001888723099484, -5.571735979903419, 13.921415618552054, 40.55901486508322, -2.4122918741381447, -16.051040672433306, -16.050375215762287, 21.54910000316025, -4.009676366974, 16.244661537714965, -13.120150799253304, -8.56905992829284, -6.949393550834822, -9.321371586924673, 18.87276590204653, -4.948164808165558, -8.849855662176918, 2.502439545767424, -10.173374670771176, -3.2472198573335995, -13.711410202399819, -1.865952757160887, -16.551582059847167, 26.319874350487435, -8.119924399302361, 4.771935529233765, 39.36148268995063, -11.369632794463325, 3.7001344760669514, -17.67672304110063, 14.114030988565688, 5.047990487798067, -7.411490377825998, -4.35762904543388, -3.3812598742635624, -7.7272294492703555, -7.773826317879062, 42.83815652832538, 15.441407788808382, 20.78726910286634, -11.577372044844191, 3.45953170258579, 4.383635283553842, -9.39206384194469, -9.759518200259357, -15.01498938650347, 8.83345732339454, 28.245630622165653, -0.2649351281207874, -11.261788862401657, 6.9926625481342075, 6.603018599365403, 22.045849978831843, 25.023253011272615, 4.793592798844606, -1.9771980301007457, -21.9949280163923, -6.39113249725516, -0.9856567571390913, -9.80739860737038, 30.71963089005078, -17.595013014409652, -5.9760010722306625, -11.984394162441065, 22.0974372385104, -5.953754150916852, -21.588192423488152, -3.931015995769681, 3.713825788491834, -15.784505513866955, -10.561429977926858, -7.870107673133148, -9.91706650127482, -17.176182851034945, -1.8926216921009582, 2.793855821904993, 7.622175496946506, -12.790912068758056, 1.1484936629206879, 3.5544744694427557, -10.802676761619995, 24.145324924638523, 37.78778165531127, -10.930645100474162, -8.606566140908424, -12.466069753984007, 1.8269219136456216, -21.271547731662032, -9.986495333640026, -13.813758427213553, -7.156062073262407, -19.594458675338135, 0.343433873136597, 19.04762063811901, 37.4061185853056, 0.6928990659636599, 0.14589840384175445, -3.3215029662568996, -13.105583027956328, -12.197775903610792, -13.297660988957324, 3.6146067088035547, -11.090126241905738, 15.072127943390473, 11.550468327294892, 10.438404327788897, -12.24412924917802, -7.740203624766238, 42.09440880382239, -4.671962059718034, -2.1046503393547633, 33.26721697923053]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1251730335693344, "mean_inference_ms": 0.7687389971516612, "mean_action_processing_ms": 0.13245329909620623, "mean_env_wait_ms": 2.163359878597524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024641752243041992, "StateBufferConnector_ms": 0.002444148063659668, "ViewRequirementAgentConnector_ms": 0.05844581127166748}, "num_episodes": 30, "episode_return_max": 97.93085068245001, "episode_return_min": 64.15048736498056, "episode_return_mean": 80.98557489779392, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 311293, "num_agent_steps_trained": 311293, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 184.679282362082, "num_env_steps_trained_throughput_per_sec": 184.679282362082, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 311293, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 311293, "timers": {"training_iteration_time_ms": 20612.259, "restore_workers_time_ms": 0.006, "training_step_time_ms": 20612.241, "sample_time_ms": 18633.04, "learn_time_ms": 1978.96, "learn_throughput": 2021.264, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 311293, "num_agent_steps_trained": 311293}, "done": false, "training_iteration": 26, "trial_id": "default", "date": "2025-10-13_04-27-49", "timestamp": 1760344069, "time_this_iter_s": 21.65978693962097, "time_total_s": 494.27217173576355, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 494.27217173576355, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 33.76129032258064, "ram_util_percent": 35.56451612903225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.3234414264559744, "policy_loss": -0.010864409880014136, "vf_loss": 6.688258585333824, "vf_explained_var": 0.006371270306408406, "kl": 0.0071688528609030935, "entropy": 9.82624823153019, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8480.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.00010000000000000002, "total_loss": 1.6670467328640723, "policy_loss": -0.013769476547566873, "vf_loss": 3.3804741974799866, "vf_explained_var": 0.6776592161386243, "kl": 0.00737819695720736, "entropy": 9.420887970155285, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.54838709677419, "num_grad_updates_lifetime": 16650.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 323201, "num_agent_steps_trained": 323201}, "env_runners": {"episode_reward_max": 97.93085068245001, "episode_reward_min": 64.15048736498056, "episode_reward_mean": 81.79773989065912, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 14.070836206002797, "hider_policy": -21.9949280163923}, "policy_reward_max": {"seeker_policy": 107.56474958108842, "hider_policy": 43.655422796075605}, "policy_reward_mean": {"seeker_policy": 77.57999849042125, "hider_policy": 2.1088707001189366}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.0862858923484, 80.36231323984725, 70.22367682255573, 81.19193363521627, 75.52493976822265, 78.31125370300306, 92.42007754857019, 97.93085068245001, 77.67972538201751, 87.93445981919649, 71.97778956899886, 64.15048736498056, 78.2434826246274, 88.52670013499299, 81.22788872309955, 97.38501486508325, 78.13453207564277, 90.23510000316027, 86.15066153771487, 69.57694007170718, 72.36332061264157, 86.38876590204653, 81.02843954576743, 71.74971400893273, 71.4200472428391, 87.34587435048746, 83.42793552923374, 95.69748268995068, 82.24613447606698, 86.0400309885656, 75.1493774869993, 79.57474012573634, 97.21415652832532, 85.64595548622168, 79.20553170258576, 78.86415736956518, 76.53648179974066, 91.93163062216563, 75.13918395119026, 92.61839030300948, 87.99764308107548, 85.64959279884457, 67.22249485478275, 78.03541015404443, 88.81563089005074, 80.13583740924898, 86.4234372385103, 77.75498400423031, 83.94982578849184, 66.13824012531784, 64.36724500090396, 81.01986935683134, 77.20817549694648, 81.69766846296726, 86.86132492463841, 96.3737816553113, 76.31750391887861, 73.94292191364565, 67.80329281478211, 67.88207932033768, 84.333620638119, 91.50211858530551, 79.61189840384168, 66.53793518748637, 77.72060670880352, 85.52812794339047, 81.98891164135956, 70.3981065344927, 97.60040880382238, 90.77321697923061, 69.9071613909078, 74.52377585215902, 80.02754931652385, 94.79889838038768, 77.83651714125095, 89.83098324973498, 94.17469805534196, 78.27528482451086, 85.23062811801084, 73.25455925318748, 76.40082654063845, 83.02778793871278, 96.33314359811601, 73.44544591640198, 65.40453909010367, 76.03972697701786, 96.05667715427096, 80.96289868094587, 89.5557273700203, 69.454836615928, 81.3470287191793, 73.35590419953766, 91.0251465503159, 87.49806714106622, 87.02795812701943, 85.51041580048734, 87.27925893981755, 85.77537199404135, 84.1583745130011, 97.80142279607557], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [77.9456764160669, 71.3837028366848, 82.19360558760962, 83.60533865350183, 80.86825502281603, 89.43055951200243, 56.31298109889291, 14.070836206002797, 88.50903567457671, 63.758066213368934, 82.994707146704, 87.29369107358102, 88.49349521105569, 53.94832744407447, 82.79773597990344, 42.90458438144795, 96.59786462221427, 84.73637521576232, 73.91567636697395, 91.26615079925328, 88.63408575040113, 72.46416480816553, 87.37585566217697, 85.1703085370375, 86.99741020239975, 77.57758205984716, 86.77592439930228, 67.70563279446333, 96.22272304110062, 66.87800951220194, 86.91849691025911, 90.68322944927033, 62.14982631787907, 49.41727859454698, 87.32337204484416, 83.87258592795605, 101.31098938650352, 54.85254267660547, 86.6659079417128, 79.02270915550987, 40.92854009097099, 82.83319803010066, 95.60855536843015, 88.82846551855395, 75.69101301440963, 98.09623264392076, 70.27975415091682, 103.27419242348813, 96.020505513867, 84.56977777637789, 91.46049435321372, 80.11863522702734, 82.37691206875807, 76.99470033060385, 73.51867676162001, 69.51664510047418, 97.39013981377111, 93.38754773166204, 91.60354657563568, 94.6326000689382, 64.94256612686337, 53.403100934036345, 82.78750296625687, 91.84129411905356, 87.4036609889573, 81.54612624190574, 60.00003898627564, 90.38243940843698, 60.17796205971801, 59.61065033935476, 62.16390756707653, 85.10900251716464, 70.86174900473935, 53.17510065130798, 88.58814350284445, 76.98748848982109, 19.78470594863572, 72.96894602663312, 74.19253947777784, 75.25361692520549, 106.59846224109825, 80.54188870923976, 30.623910252469642, 93.16886071842096, 89.73177159123813, 95.94709811715703, 96.551965653548, 70.0821876149391, 71.49022808696475, 88.11119251414111, 96.55367067486965, 87.28577173589494, 52.1052896317233, 59.620152187949415, 107.56474958108842, 94.20910687686886, 57.60902492739967, 62.521114905973185, 69.68397756525457, 58.643449976403964], "policy_hider_policy_reward": [39.44028589234843, -21.299676416066927, 3.802297163315186, 5.1763132398472305, -2.108573041559032, -9.861355723494869, 5.275933635216325, -7.689338653501854, -1.7176269466231808, -3.625688307970178, -9.11621431150569, -2.0030914974936724, 37.7240775485702, -1.6169810988929352, 42.86931405748767, 40.99070041895948, -4.189441930384916, -6.639868362174253, 25.8884598191965, -1.7120662133689406, -15.563570592863979, 4.546653015158824, -8.022196025452951, -15.121007683147504, -11.97749521105568, 1.727482624627441, 24.876126746159805, 9.7022459447587, 4.001888723099484, -5.571735979903419, 13.921415618552054, 40.55901486508322, -2.4122918741381447, -16.051040672433306, -16.050375215762287, 21.54910000316025, -4.009676366974, 16.244661537714965, -13.120150799253304, -8.56905992829284, -6.949393550834822, -9.321371586924673, 18.87276590204653, -4.948164808165558, -8.849855662176918, 2.502439545767424, -10.173374670771176, -3.2472198573335995, -13.711410202399819, -1.865952757160887, -16.551582059847167, 26.319874350487435, -8.119924399302361, 4.771935529233765, 39.36148268995063, -11.369632794463325, 3.7001344760669514, -17.67672304110063, 14.114030988565688, 5.047990487798067, -7.411490377825998, -4.35762904543388, -3.3812598742635624, -7.7272294492703555, -7.773826317879062, 42.83815652832538, 15.441407788808382, 20.78726910286634, -11.577372044844191, 3.45953170258579, 4.383635283553842, -9.39206384194469, -9.759518200259357, -15.01498938650347, 8.83345732339454, 28.245630622165653, -0.2649351281207874, -11.261788862401657, 6.9926625481342075, 6.603018599365403, 22.045849978831843, 25.023253011272615, 4.793592798844606, -1.9771980301007457, -21.9949280163923, -6.39113249725516, -0.9856567571390913, -9.80739860737038, 30.71963089005078, -17.595013014409652, -5.9760010722306625, -11.984394162441065, 22.0974372385104, -5.953754150916852, -21.588192423488152, -3.931015995769681, 3.713825788491834, -15.784505513866955, -10.561429977926858, -7.870107673133148, -9.91706650127482, -17.176182851034945, -1.8926216921009582, 2.793855821904993, 7.622175496946506, -12.790912068758056, 1.1484936629206879, 3.5544744694427557, -10.802676761619995, 24.145324924638523, 37.78778165531127, -10.930645100474162, -8.606566140908424, -12.466069753984007, 1.8269219136456216, -21.271547731662032, -9.986495333640026, -13.813758427213553, -7.156062073262407, -19.594458675338135, 0.343433873136597, 19.04762063811901, 37.4061185853056, 0.6928990659636599, 0.14589840384175445, -3.3215029662568996, -13.105583027956328, -12.197775903610792, -13.297660988957324, 3.6146067088035547, -11.090126241905738, 15.072127943390473, 11.550468327294892, 10.438404327788897, -12.24412924917802, -7.740203624766238, 42.09440880382239, -4.671962059718034, -2.1046503393547633, 33.26721697923053, 2.528082047815032, 5.21517177601628, -6.242136828717485, -4.343089836288144, 2.401549316523918, 6.764250995260672, 1.4608993486920168, 40.16289838038767, 0.8057585323864158, -11.55738489397986, -13.781488489821129, 26.624983249734992, 37.453082450313985, 36.936909656392245, -3.8285952875083074, 9.134934085385963, 14.224628118010779, -3.1865394777778566, -6.237088267932587, 4.2380305959146005, -19.80246224109824, -10.395173459361578, 8.84178793871281, -6.355888709239763, 24.112089747530355, 41.59714359811595, -20.59286071842094, 0.8694459164019894, -15.572061056697471, -8.755171444436918, -1.2671539310345585, -18.640217209104527, 9.68165712397836, -10.176945623255325, -13.536187614939127, 24.416898680945984, 32.34972737002032, -14.28422808696477, -9.664753172553146, -8.991602725659982, -12.06767067486965, -3.1389712808207055, -2.351756062320075, -11.578111474037167, 2.3007103682767007, 36.619146550315925, 23.101019515638487, 4.776895437478218, -10.404257370785217, -10.132534083283803, -18.97310687686879, 10.274415800487246, 5.646975072600343, 24.02325893981759, 6.857188574047405, 16.397068514020788, 12.592374513000982, 1.8820224347454912, -4.497449976403977, 43.655422796075605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1277850393117632, "mean_inference_ms": 0.7728037292392019, "mean_action_processing_ms": 0.13282966145185846, "mean_env_wait_ms": 2.1825879056356596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024541616439819336, "StateBufferConnector_ms": 0.0024563074111938477, "ViewRequirementAgentConnector_ms": 0.058759450912475586}, "num_episodes": 30, "episode_return_max": 97.93085068245001, "episode_return_min": 64.15048736498056, "episode_return_mean": 81.79773989065912, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 323201, "num_agent_steps_trained": 323201, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 184.31032550781637, "num_env_steps_trained_throughput_per_sec": 184.31032550781637, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 323201, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 323201, "timers": {"training_iteration_time_ms": 20900.641, "restore_workers_time_ms": 0.006, "training_step_time_ms": 20900.623, "sample_time_ms": 18932.094, "learn_time_ms": 1968.285, "learn_throughput": 2032.226, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 323201, "num_agent_steps_trained": 323201}, "done": false, "training_iteration": 27, "trial_id": "default", "date": "2025-10-13_04-28-10", "timestamp": 1760344090, "time_this_iter_s": 21.70313858985901, "time_total_s": 515.9753103256226, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 515.9753103256226, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 35.045161290322575, "ram_util_percent": 35.70322580645162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.186777260899544, "policy_loss": -0.009596328355837614, "vf_loss": 6.412124152481556, "vf_explained_var": 0.016636629402637482, "kl": 0.008588557866079405, "entropy": 9.69184367954731, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8800.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.5926090333196852, "policy_loss": -0.011299940237834576, "vf_loss": 3.226552347531394, "vf_explained_var": 0.7111336533039335, "kl": 0.0067064207740836716, "entropy": 9.36719929377238, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17275.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 335201, "num_agent_steps_trained": 335201}, "env_runners": {"episode_reward_max": 98.30125798801845, "episode_reward_min": 64.36724500090396, "episode_reward_mean": 81.41439428568123, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 19.78470594863572, "hider_policy": -22.84597073473953}, "policy_reward_max": {"seeker_policy": 107.56474958108842, "hider_policy": 44.215257988018514}, "policy_reward_mean": {"seeker_policy": 77.78017990816136, "hider_policy": 1.8171071887599337}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.0400309885656, 75.1493774869993, 79.57474012573634, 97.21415652832532, 85.64595548622168, 79.20553170258576, 78.86415736956518, 76.53648179974066, 91.93163062216563, 75.13918395119026, 92.61839030300948, 87.99764308107548, 85.64959279884457, 67.22249485478275, 78.03541015404443, 88.81563089005074, 80.13583740924898, 86.4234372385103, 77.75498400423031, 83.94982578849184, 66.13824012531784, 64.36724500090396, 81.01986935683134, 77.20817549694648, 81.69766846296726, 86.86132492463841, 96.3737816553113, 76.31750391887861, 73.94292191364565, 67.80329281478211, 67.88207932033768, 84.333620638119, 91.50211858530551, 79.61189840384168, 66.53793518748637, 77.72060670880352, 85.52812794339047, 81.98891164135956, 70.3981065344927, 97.60040880382238, 90.77321697923061, 69.9071613909078, 74.52377585215902, 80.02754931652385, 94.79889838038768, 77.83651714125095, 89.83098324973498, 94.17469805534196, 78.27528482451086, 85.23062811801084, 73.25455925318748, 76.40082654063845, 83.02778793871278, 96.33314359811601, 73.44544591640198, 65.40453909010367, 76.03972697701786, 96.05667715427096, 80.96289868094587, 89.5557273700203, 69.454836615928, 81.3470287191793, 73.35590419953766, 91.0251465503159, 87.49806714106622, 87.02795812701943, 85.51041580048734, 87.27925893981755, 85.77537199404135, 84.1583745130011, 97.80142279607557, 80.55740375266326, 86.98447713211196, 85.26224421044064, 94.32365876044436, 69.10723542304743, 73.4362902343196, 96.41180381810008, 79.02464483541824, 70.79361443117159, 93.80646462215567, 68.66843523612, 73.9643476166254, 71.38924951449764, 78.49503053440048, 75.90307558179282, 79.34315572878013, 78.04243792240439, 76.77961382463381, 86.34431590853829, 79.71956285356268, 86.73184344003025, 81.83653607117394, 67.00730912157552, 80.84335847315481, 98.30125798801845, 75.48434184354807, 87.36905714558482, 88.78546954796133, 71.89103175133617], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [66.87800951220194, 86.91849691025911, 90.68322944927033, 62.14982631787907, 49.41727859454698, 87.32337204484416, 83.87258592795605, 101.31098938650352, 54.85254267660547, 86.6659079417128, 79.02270915550987, 40.92854009097099, 82.83319803010066, 95.60855536843015, 88.82846551855395, 75.69101301440963, 98.09623264392076, 70.27975415091682, 103.27419242348813, 96.020505513867, 84.56977777637789, 91.46049435321372, 80.11863522702734, 82.37691206875807, 76.99470033060385, 73.51867676162001, 69.51664510047418, 97.39013981377111, 93.38754773166204, 91.60354657563568, 94.6326000689382, 64.94256612686337, 53.403100934036345, 82.78750296625687, 91.84129411905356, 87.4036609889573, 81.54612624190574, 60.00003898627564, 90.38243940843698, 60.17796205971801, 59.61065033935476, 62.16390756707653, 85.10900251716464, 70.86174900473935, 53.17510065130798, 88.58814350284445, 76.98748848982109, 19.78470594863572, 72.96894602663312, 74.19253947777784, 75.25361692520549, 106.59846224109825, 80.54188870923976, 30.623910252469642, 93.16886071842096, 89.73177159123813, 95.94709811715703, 96.551965653548, 70.0821876149391, 71.49022808696475, 88.11119251414111, 96.55367067486965, 87.28577173589494, 52.1052896317233, 59.620152187949415, 107.56474958108842, 94.20910687686886, 57.60902492739967, 62.521114905973185, 69.68397756525457, 58.643449976403964, 63.01700103150754, 60.50896196350024, 61.36558842018484, 33.121004759925405, 90.57689000049174, 89.25390965483797, 51.52899391254298, 90.05733438244584, 87.54878021540011, 62.77284525583478, 101.28523131013938, 80.21676488575027, 89.37560525463735, 78.52853770136767, 90.46777637368277, 83.6139926234193, 85.75828116785117, 85.61088825223653, 78.92920626524625, 77.1580265881389, 96.19197073473954, 76.96497111266237, 92.36562561865485, 82.24188000720973, 75.83821547562535, 85.36977285584501, 45.59668979941498, 72.52869651713371, 94.1750523509723], "policy_hider_policy_reward": [14.114030988565688, 5.047990487798067, -7.411490377825998, -4.35762904543388, -3.3812598742635624, -7.7272294492703555, -7.773826317879062, 42.83815652832538, 15.441407788808382, 20.78726910286634, -11.577372044844191, 3.45953170258579, 4.383635283553842, -9.39206384194469, -9.759518200259357, -15.01498938650347, 8.83345732339454, 28.245630622165653, -0.2649351281207874, -11.261788862401657, 6.9926625481342075, 6.603018599365403, 22.045849978831843, 25.023253011272615, 4.793592798844606, -1.9771980301007457, -21.9949280163923, -6.39113249725516, -0.9856567571390913, -9.80739860737038, 30.71963089005078, -17.595013014409652, -5.9760010722306625, -11.984394162441065, 22.0974372385104, -5.953754150916852, -21.588192423488152, -3.931015995769681, 3.713825788491834, -15.784505513866955, -10.561429977926858, -7.870107673133148, -9.91706650127482, -17.176182851034945, -1.8926216921009582, 2.793855821904993, 7.622175496946506, -12.790912068758056, 1.1484936629206879, 3.5544744694427557, -10.802676761619995, 24.145324924638523, 37.78778165531127, -10.930645100474162, -8.606566140908424, -12.466069753984007, 1.8269219136456216, -21.271547731662032, -9.986495333640026, -13.813758427213553, -7.156062073262407, -19.594458675338135, 0.343433873136597, 19.04762063811901, 37.4061185853056, 0.6928990659636599, 0.14589840384175445, -3.3215029662568996, -13.105583027956328, -12.197775903610792, -13.297660988957324, 3.6146067088035547, -11.090126241905738, 15.072127943390473, 11.550468327294892, 10.438404327788897, -12.24412924917802, -7.740203624766238, 42.09440880382239, -4.671962059718034, -2.1046503393547633, 33.26721697923053, 2.528082047815032, 5.21517177601628, -6.242136828717485, -4.343089836288144, 2.401549316523918, 6.764250995260672, 1.4608993486920168, 40.16289838038767, 0.8057585323864158, -11.55738489397986, -13.781488489821129, 26.624983249734992, 37.453082450313985, 36.936909656392245, -3.8285952875083074, 9.134934085385963, 14.224628118010779, -3.1865394777778566, -6.237088267932587, 4.2380305959146005, -19.80246224109824, -10.395173459361578, 8.84178793871281, -6.355888709239763, 24.112089747530355, 41.59714359811595, -20.59286071842094, 0.8694459164019894, -15.572061056697471, -8.755171444436918, -1.2671539310345585, -18.640217209104527, 9.68165712397836, -10.176945623255325, -13.536187614939127, 24.416898680945984, 32.34972737002032, -14.28422808696477, -9.664753172553146, -8.991602725659982, -12.06767067486965, -3.1389712808207055, -2.351756062320075, -11.578111474037167, 2.3007103682767007, 36.619146550315925, 23.101019515638487, 4.776895437478218, -10.404257370785217, -10.132534083283803, -18.97310687686879, 10.274415800487246, 5.646975072600343, 24.02325893981759, 6.857188574047405, 16.397068514020788, 12.592374513000982, 1.8820224347454912, -4.497449976403977, 43.655422796075605, -6.090401031507565, 23.63080375266324, 10.025741395184715, 16.44977377342693, 3.750411579815145, 20.146244210440678, 39.86210344712263, 21.340550553396334, -6.25876457695262, -15.210890000491796, -12.017909654837952, -3.799709765680413, 3.937006087457026, 40.94580381810009, 4.4186448354182515, -15.451334382445864, -8.231665327763086, -8.523500456465444, -8.776845255834818, 39.810464622155685, -11.437564763879992, -21.17923131013933, -6.620764885750235, 0.3683476166254114, -12.829605254637386, -5.156750485502307, 5.185005206723894, -5.218512373691052, -4.07630978940571, -10.488391002484274, 5.163942139701076, -9.43477903434034, -0.09485033576518069, -7.620992909681525, -10.461647842928958, 1.6303734153262204, 3.3961026672947856, 4.019006975997299, 0.4352118856079469, 2.1263243798158613, 13.385843440030175, -22.84597073473953, -3.838971112662349, 8.710536071173959, -4.8733073512350416, -20.485009145844273, -3.2194139694680697, 1.8208924354131593, -21.7522154756254, 44.215257988018514, -0.17898209217662936, -9.706448920120271, 8.599310200585018, 33.17305714558479, -9.502696517133705, 25.759469547961356, -18.399052350972283, -3.8849682486638217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1307098964489235, "mean_inference_ms": 0.7763379401078635, "mean_action_processing_ms": 0.13318920886683952, "mean_env_wait_ms": 2.202422837044511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002478480339050293, "StateBufferConnector_ms": 0.0024749040603637695, "ViewRequirementAgentConnector_ms": 0.05910921096801758}, "num_episodes": 29, "episode_return_max": 98.30125798801845, "episode_return_min": 64.36724500090396, "episode_return_mean": 81.41439428568123, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 335201, "num_agent_steps_trained": 335201, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 180.2807544589577, "num_env_steps_trained_throughput_per_sec": 180.2807544589577, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 335201, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 335201, "timers": {"training_iteration_time_ms": 21200.186, "restore_workers_time_ms": 0.006, "training_step_time_ms": 21200.167, "sample_time_ms": 19238.607, "learn_time_ms": 1961.314, "learn_throughput": 2039.449, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 335201, "num_agent_steps_trained": 335201}, "done": false, "training_iteration": 28, "trial_id": "default", "date": "2025-10-13_04-28-32", "timestamp": 1760344112, "time_this_iter_s": 22.188238859176636, "time_total_s": 538.1635491847992, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 538.1635491847992, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 34.63225806451614, "ram_util_percent": 35.65161290322581}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.1825183726847173, "policy_loss": -0.009908521655597724, "vf_loss": 6.404406933486461, "vf_explained_var": 0.017741947248578072, "kl": 0.00753480328944541, "entropy": 9.77951602935791, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.594902745693449, "policy_loss": -0.01264124463297545, "vf_loss": 3.233516902772207, "vf_explained_var": 0.6943149095489866, "kl": 0.007161418878672191, "entropy": 9.214465581803095, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17905.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 347201, "num_agent_steps_trained": 347201}, "env_runners": {"episode_reward_max": 98.30125798801845, "episode_reward_min": 65.40453909010367, "episode_reward_mean": 81.7131476353224, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 19.78470594863572, "hider_policy": -22.84597073473953}, "policy_reward_max": {"seeker_policy": 107.56474958108842, "hider_policy": 44.215257988018514}, "policy_reward_mean": {"seeker_policy": 76.04150061437903, "hider_policy": 2.8358235104716827}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.88207932033768, 84.333620638119, 91.50211858530551, 79.61189840384168, 66.53793518748637, 77.72060670880352, 85.52812794339047, 81.98891164135956, 70.3981065344927, 97.60040880382238, 90.77321697923061, 69.9071613909078, 74.52377585215902, 80.02754931652385, 94.79889838038768, 77.83651714125095, 89.83098324973498, 94.17469805534196, 78.27528482451086, 85.23062811801084, 73.25455925318748, 76.40082654063845, 83.02778793871278, 96.33314359811601, 73.44544591640198, 65.40453909010367, 76.03972697701786, 96.05667715427096, 80.96289868094587, 89.5557273700203, 69.454836615928, 81.3470287191793, 73.35590419953766, 91.0251465503159, 87.49806714106622, 87.02795812701943, 85.51041580048734, 87.27925893981755, 85.77537199404135, 84.1583745130011, 97.80142279607557, 80.55740375266326, 86.98447713211196, 85.26224421044064, 94.32365876044436, 69.10723542304743, 73.4362902343196, 96.41180381810008, 79.02464483541824, 70.79361443117159, 93.80646462215567, 68.66843523612, 73.9643476166254, 71.38924951449764, 78.49503053440048, 75.90307558179282, 79.34315572878013, 78.04243792240439, 76.77961382463381, 86.34431590853829, 79.71956285356268, 86.73184344003025, 81.83653607117394, 67.00730912157552, 80.84335847315481, 98.30125798801845, 75.48434184354807, 87.36905714558482, 88.78546954796133, 71.89103175133617, 82.41444786235195, 73.98006650160114, 89.89192691280186, 89.14339179450609, 75.88176593549512, 86.6704864382611, 71.60441470105998, 76.27730799389956, 86.3494878920737, 70.738337446303, 90.39919828283486, 89.13381310346288, 80.98755801875943, 91.54044943605683, 72.79285219097098, 77.41115051457828, 90.38073986498772, 94.1465467177251, 98.28590205888659, 77.34461992743111, 74.22518820363237, 75.47198806109324, 85.52352355115916, 69.2886672217052, 85.22931797858666, 96.5334640154872, 74.59839452910242, 82.2562352482224, 67.21690079944068, 79.79170801524918], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [94.6326000689382, 64.94256612686337, 53.403100934036345, 82.78750296625687, 91.84129411905356, 87.4036609889573, 81.54612624190574, 60.00003898627564, 90.38243940843698, 60.17796205971801, 59.61065033935476, 62.16390756707653, 85.10900251716464, 70.86174900473935, 53.17510065130798, 88.58814350284445, 76.98748848982109, 19.78470594863572, 72.96894602663312, 74.19253947777784, 75.25361692520549, 106.59846224109825, 80.54188870923976, 30.623910252469642, 93.16886071842096, 89.73177159123813, 95.94709811715703, 96.551965653548, 70.0821876149391, 71.49022808696475, 88.11119251414111, 96.55367067486965, 87.28577173589494, 52.1052896317233, 59.620152187949415, 107.56474958108842, 94.20910687686886, 57.60902492739967, 62.521114905973185, 69.68397756525457, 58.643449976403964, 63.01700103150754, 60.50896196350024, 61.36558842018484, 33.121004759925405, 90.57689000049174, 89.25390965483797, 51.52899391254298, 90.05733438244584, 87.54878021540011, 62.77284525583478, 101.28523131013938, 80.21676488575027, 89.37560525463735, 78.52853770136767, 90.46777637368277, 83.6139926234193, 85.75828116785117, 85.61088825223653, 78.92920626524625, 77.1580265881389, 96.19197073473954, 76.96497111266237, 92.36562561865485, 82.24188000720973, 75.83821547562535, 85.36977285584501, 45.59668979941498, 72.52869651713371, 94.1750523509723, 84.36331510219199, 84.65522682450687, 54.02310157357553, 78.82742913903917, 82.51886367455421, 70.46473856648457, 85.84516271473376, 66.01388828998928, 83.61788663841796, 88.55190470075443, 56.952400400421446, 87.72648918943428, 71.88263508119998, 22.68481220226694, 75.44391855503305, 77.85731790500958, 73.5604459946148, 32.756314267471666, 68.10119349689019, 91.63540245006998, 88.77816860322817, 90.07268312418883, 83.19854928970344, 96.26972733388433, 71.39770035920252, 69.80182399873198, 83.383208703167, 82.17165123970835, 81.46930983946206, 83.69928177492338], "policy_hider_policy_reward": [-7.156062073262407, -19.594458675338135, 0.343433873136597, 19.04762063811901, 37.4061185853056, 0.6928990659636599, 0.14589840384175445, -3.3215029662568996, -13.105583027956328, -12.197775903610792, -13.297660988957324, 3.6146067088035547, -11.090126241905738, 15.072127943390473, 11.550468327294892, 10.438404327788897, -12.24412924917802, -7.740203624766238, 42.09440880382239, -4.671962059718034, -2.1046503393547633, 33.26721697923053, 2.528082047815032, 5.21517177601628, -6.242136828717485, -4.343089836288144, 2.401549316523918, 6.764250995260672, 1.4608993486920168, 40.16289838038767, 0.8057585323864158, -11.55738489397986, -13.781488489821129, 26.624983249734992, 37.453082450313985, 36.936909656392245, -3.8285952875083074, 9.134934085385963, 14.224628118010779, -3.1865394777778566, -6.237088267932587, 4.2380305959146005, -19.80246224109824, -10.395173459361578, 8.84178793871281, -6.355888709239763, 24.112089747530355, 41.59714359811595, -20.59286071842094, 0.8694459164019894, -15.572061056697471, -8.755171444436918, -1.2671539310345585, -18.640217209104527, 9.68165712397836, -10.176945623255325, -13.536187614939127, 24.416898680945984, 32.34972737002032, -14.28422808696477, -9.664753172553146, -8.991602725659982, -12.06767067486965, -3.1389712808207055, -2.351756062320075, -11.578111474037167, 2.3007103682767007, 36.619146550315925, 23.101019515638487, 4.776895437478218, -10.404257370785217, -10.132534083283803, -18.97310687686879, 10.274415800487246, 5.646975072600343, 24.02325893981759, 6.857188574047405, 16.397068514020788, 12.592374513000982, 1.8820224347454912, -4.497449976403977, 43.655422796075605, -6.090401031507565, 23.63080375266324, 10.025741395184715, 16.44977377342693, 3.750411579815145, 20.146244210440678, 39.86210344712263, 21.340550553396334, -6.25876457695262, -15.210890000491796, -12.017909654837952, -3.799709765680413, 3.937006087457026, 40.94580381810009, 4.4186448354182515, -15.451334382445864, -8.231665327763086, -8.523500456465444, -8.776845255834818, 39.810464622155685, -11.437564763879992, -21.17923131013933, -6.620764885750235, 0.3683476166254114, -12.829605254637386, -5.156750485502307, 5.185005206723894, -5.218512373691052, -4.07630978940571, -10.488391002484274, 5.163942139701076, -9.43477903434034, -0.09485033576518069, -7.620992909681525, -10.461647842928958, 1.6303734153262204, 3.3961026672947856, 4.019006975997299, 0.4352118856079469, 2.1263243798158613, 13.385843440030175, -22.84597073473953, -3.838971112662349, 8.710536071173959, -4.8733073512350416, -20.485009145844273, -3.2194139694680697, 1.8208924354131593, -21.7522154756254, 44.215257988018514, -0.17898209217662936, -9.706448920120271, 8.599310200585018, 33.17305714558479, -9.502696517133705, 25.759469547961356, -18.399052350972283, -3.8849682486638217, 4.692166758475084, -6.641033998315144, -6.706405875166455, -3.968754447739246, 23.560160631612018, 12.308664707614367, -13.16142913903924, 23.477391794506197, -0.9969609267733303, -5.640136812285785, -3.3687385664846183, 19.57448643826116, -12.98039268576833, -1.2603553279054631, 6.483658038004793, 3.7797616659055193, -17.23188663841802, 19.963487892073747, -2.2076625536969265, -15.605904700754394, 10.937846074629844, 22.508951807783653, 22.487813103462916, -21.0804891894343, 2.3674557771985643, 6.737467160360944, 36.687726436238975, 32.16791079755091, 1.9396824700493638, -4.590748834111425, -0.9913226088013376, 0.5451552183699722, -13.514445994614794, 30.334739864987757, 22.655985795993647, 38.734246654259806, 42.45990205888652, -12.275193496890191, -14.389402450069941, 0.09861992743110469, -0.07081179636727732, -14.482168603228189, -7.658643505430828, -6.942051557664753, 8.477523551159159, -6.152549289703414, -20.686314720297318, -6.294745391881724, 15.350653203848365, -1.5190355844642054, 36.89746401548726, -10.165823998731996, -0.6022021802589753, -8.182611993805642, 15.07023524822236, -14.985651239708284, -7.864247482038075, -6.388161557983298, -7.880384465797033, 3.9728107061228233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1341118433677326, "mean_inference_ms": 0.7800515585817839, "mean_action_processing_ms": 0.13355543941266565, "mean_env_wait_ms": 2.2230280270580294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025025606155395508, "StateBufferConnector_ms": 0.002455472946166992, "ViewRequirementAgentConnector_ms": 0.05967390537261963}, "num_episodes": 30, "episode_return_max": 98.30125798801845, "episode_return_min": 65.40453909010367, "episode_return_mean": 81.7131476353224, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 347201, "num_agent_steps_trained": 347201, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 178.03878241123425, "num_env_steps_trained_throughput_per_sec": 178.03878241123425, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 347201, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 347201, "timers": {"training_iteration_time_ms": 21494.394, "restore_workers_time_ms": 0.006, "training_step_time_ms": 21494.376, "sample_time_ms": 19534.304, "learn_time_ms": 1959.811, "learn_throughput": 2041.014, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 347201, "num_agent_steps_trained": 347201}, "done": false, "training_iteration": 29, "trial_id": "default", "date": "2025-10-13_04-28-55", "timestamp": 1760344135, "time_this_iter_s": 22.467622995376587, "time_total_s": 560.6311721801758, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 560.6311721801758, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 32.575, "ram_util_percent": 35.728125000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.2016041800379753, "policy_loss": -0.009245810587890447, "vf_loss": 6.441419829428196, "vf_explained_var": 0.010775524005293847, "kl": 0.008038190223283035, "entropy": 9.863064455986024, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9440.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.6365326771660456, "policy_loss": -0.011835392533121483, "vf_loss": 3.315457508488307, "vf_explained_var": 0.7383898475813487, "kl": 0.007217978084579418, "entropy": 9.360677614666166, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 18535.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 359201, "num_agent_steps_trained": 359201}, "env_runners": {"episode_reward_max": 98.30125798801845, "episode_reward_min": 62.99395440908664, "episode_reward_mean": 81.42717435669014, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 22.68481220226694, "hider_policy": -22.84597073473953}, "policy_reward_max": {"seeker_policy": 107.56474958108842, "hider_policy": 44.215257988018514}, "policy_reward_mean": {"seeker_policy": 77.70553847505572, "hider_policy": 1.8608179408172103}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.5557273700203, 69.454836615928, 81.3470287191793, 73.35590419953766, 91.0251465503159, 87.49806714106622, 87.02795812701943, 85.51041580048734, 87.27925893981755, 85.77537199404135, 84.1583745130011, 97.80142279607557, 80.55740375266326, 86.98447713211196, 85.26224421044064, 94.32365876044436, 69.10723542304743, 73.4362902343196, 96.41180381810008, 79.02464483541824, 70.79361443117159, 93.80646462215567, 68.66843523612, 73.9643476166254, 71.38924951449764, 78.49503053440048, 75.90307558179282, 79.34315572878013, 78.04243792240439, 76.77961382463381, 86.34431590853829, 79.71956285356268, 86.73184344003025, 81.83653607117394, 67.00730912157552, 80.84335847315481, 98.30125798801845, 75.48434184354807, 87.36905714558482, 88.78546954796133, 71.89103175133617, 82.41444786235195, 73.98006650160114, 89.89192691280186, 89.14339179450609, 75.88176593549512, 86.6704864382611, 71.60441470105998, 76.27730799389956, 86.3494878920737, 70.738337446303, 90.39919828283486, 89.13381310346288, 80.98755801875943, 91.54044943605683, 72.79285219097098, 77.41115051457828, 90.38073986498772, 94.1465467177251, 98.28590205888659, 77.34461992743111, 74.22518820363237, 75.47198806109324, 85.52352355115916, 69.2886672217052, 85.22931797858666, 96.5334640154872, 74.59839452910242, 82.2562352482224, 67.21690079944068, 79.79170801524918, 74.73310979927128, 74.14402224974147, 76.50652231813933, 85.88345628346931, 76.34557238164969, 79.76394417655186, 74.93276306815855, 76.24168966698713, 62.99395440908664, 69.48149030344877, 87.01045653735905, 76.43398408249548, 70.75407356170498, 81.69070423342103, 92.26493708344233, 85.32112144338116, 86.81931310859612, 87.98947444972357, 88.72262723985548, 89.92872502280761, 86.46738725351004, 73.96454153863229, 88.559059876485, 79.37125313823957, 73.53699808016508, 78.9138156296651, 89.45087464447975, 69.669365276786, 92.91556750393315], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [71.49022808696475, 88.11119251414111, 96.55367067486965, 87.28577173589494, 52.1052896317233, 59.620152187949415, 107.56474958108842, 94.20910687686886, 57.60902492739967, 62.521114905973185, 69.68397756525457, 58.643449976403964, 63.01700103150754, 60.50896196350024, 61.36558842018484, 33.121004759925405, 90.57689000049174, 89.25390965483797, 51.52899391254298, 90.05733438244584, 87.54878021540011, 62.77284525583478, 101.28523131013938, 80.21676488575027, 89.37560525463735, 78.52853770136767, 90.46777637368277, 83.6139926234193, 85.75828116785117, 85.61088825223653, 78.92920626524625, 77.1580265881389, 96.19197073473954, 76.96497111266237, 92.36562561865485, 82.24188000720973, 75.83821547562535, 85.36977285584501, 45.59668979941498, 72.52869651713371, 94.1750523509723, 84.36331510219199, 84.65522682450687, 54.02310157357553, 78.82742913903917, 82.51886367455421, 70.46473856648457, 85.84516271473376, 66.01388828998928, 83.61788663841796, 88.55190470075443, 56.952400400421446, 87.72648918943428, 71.88263508119998, 22.68481220226694, 75.44391855503305, 77.85731790500958, 73.5604459946148, 32.756314267471666, 68.10119349689019, 91.63540245006998, 88.77816860322817, 90.07268312418883, 83.19854928970344, 96.26972733388433, 71.39770035920252, 69.80182399873198, 83.383208703167, 82.17165123970835, 81.46930983946206, 83.69928177492338, 94.46027704944423, 97.32637763189625, 85.8865539661872, 88.3266632968803, 85.69969561535014, 90.92349162698292, 68.9558373711899, 76.92905591330191, 93.67517104369712, 97.26566882448826, 77.40577575730812, 86.01989194807996, 86.81656684014997, 85.68344406456646, 67.68218994277474, 84.42197207884821, 80.07756850705732, 67.46557220333075, 79.12002512400218, 65.0197620186178, 71.81011762302137, 90.74725925064746, 33.044955241521734, 87.72166561273316, 77.5781122418082, 89.03208978657618, 63.41170779307618, 95.92008593998021, 67.03551900326431], "policy_hider_policy_reward": [32.34972737002032, -14.28422808696477, -9.664753172553146, -8.991602725659982, -12.06767067486965, -3.1389712808207055, -2.351756062320075, -11.578111474037167, 2.3007103682767007, 36.619146550315925, 23.101019515638487, 4.776895437478218, -10.404257370785217, -10.132534083283803, -18.97310687686879, 10.274415800487246, 5.646975072600343, 24.02325893981759, 6.857188574047405, 16.397068514020788, 12.592374513000982, 1.8820224347454912, -4.497449976403977, 43.655422796075605, -6.090401031507565, 23.63080375266324, 10.025741395184715, 16.44977377342693, 3.750411579815145, 20.146244210440678, 39.86210344712263, 21.340550553396334, -6.25876457695262, -15.210890000491796, -12.017909654837952, -3.799709765680413, 3.937006087457026, 40.94580381810009, 4.4186448354182515, -15.451334382445864, -8.231665327763086, -8.523500456465444, -8.776845255834818, 39.810464622155685, -11.437564763879992, -21.17923131013933, -6.620764885750235, 0.3683476166254114, -12.829605254637386, -5.156750485502307, 5.185005206723894, -5.218512373691052, -4.07630978940571, -10.488391002484274, 5.163942139701076, -9.43477903434034, -0.09485033576518069, -7.620992909681525, -10.461647842928958, 1.6303734153262204, 3.3961026672947856, 4.019006975997299, 0.4352118856079469, 2.1263243798158613, 13.385843440030175, -22.84597073473953, -3.838971112662349, 8.710536071173959, -4.8733073512350416, -20.485009145844273, -3.2194139694680697, 1.8208924354131593, -21.7522154756254, 44.215257988018514, -0.17898209217662936, -9.706448920120271, 8.599310200585018, 33.17305714558479, -9.502696517133705, 25.759469547961356, -18.399052350972283, -3.8849682486638217, 4.692166758475084, -6.641033998315144, -6.706405875166455, -3.968754447739246, 23.560160631612018, 12.308664707614367, -13.16142913903924, 23.477391794506197, -0.9969609267733303, -5.640136812285785, -3.3687385664846183, 19.57448643826116, -12.98039268576833, -1.2603553279054631, 6.483658038004793, 3.7797616659055193, -17.23188663841802, 19.963487892073747, -2.2076625536969265, -15.605904700754394, 10.937846074629844, 22.508951807783653, 22.487813103462916, -21.0804891894343, 2.3674557771985643, 6.737467160360944, 36.687726436238975, 32.16791079755091, 1.9396824700493638, -4.590748834111425, -0.9913226088013376, 0.5451552183699722, -13.514445994614794, 30.334739864987757, 22.655985795993647, 38.734246654259806, 42.45990205888652, -12.275193496890191, -14.389402450069941, 0.09861992743110469, -0.07081179636727732, -14.482168603228189, -7.658643505430828, -6.942051557664753, 8.477523551159159, -6.152549289703414, -20.686314720297318, -6.294745391881724, 15.350653203848365, -1.5190355844642054, 36.89746401548726, -10.165823998731996, -0.6022021802589753, -8.182611993805642, 15.07023524822236, -14.985651239708284, -7.864247482038075, -6.388161557983298, -7.880384465797033, 3.9728107061228233, -1.822890200728761, -17.904277049444218, -3.6110172946171577, -19.571338087537576, -10.83736578186025, 1.457334133812444, 12.837456283469344, -15.280663296880252, -3.4936956153501684, -5.8604276183502915, -9.15749162698295, -2.002055823448087, 2.195422159178303, 3.781503537790321, -3.213055913301899, 2.525689666987121, -14.442740257535284, -16.23847637707523, -18.393865545250748, -9.390312975788781, -4.831668716537514, 14.436349496588445, -8.483570366204413, -1.1023374993800263, -12.272082902796287, -3.790410375648749, -8.537444064566493, 4.544704233421036, 36.758937083442255, -12.176189942774775, 11.985121443381196, -11.085972078848243, -17.431568507057253, 24.173313108596023, -5.809572203330742, 26.33347444972353, 28.67662723985549, -19.07402512400219, -5.2537620186177465, 30.162725022807564, 16.341387253510117, -1.6841176230213888, -14.501259250647468, -2.2814584613677167, 26.390781620891914, 29.123323014071392, -2.9647468617603767, -5.385665612733201, 0.26099808016506626, -4.302112241808157, -10.636089786576214, 0.5178156296650991, 32.11487464447983, -6.075707793076164, -13.389409912170443, -12.861310751023744, -12.579519003264322, 38.45956750393316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1372746638545461, "mean_inference_ms": 0.7835015169001167, "mean_action_processing_ms": 0.1339091920536996, "mean_env_wait_ms": 2.2427913255107144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025135278701782227, "StateBufferConnector_ms": 0.002447843551635742, "ViewRequirementAgentConnector_ms": 0.06021261215209961}, "num_episodes": 29, "episode_return_max": 98.30125798801845, "episode_return_min": 62.99395440908664, "episode_return_mean": 81.42717435669014, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 359201, "num_agent_steps_trained": 359201, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.74050313686905, "num_env_steps_trained_throughput_per_sec": 179.74050313686905, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 359201, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 359201, "timers": {"training_iteration_time_ms": 21715.382, "restore_workers_time_ms": 0.006, "training_step_time_ms": 21715.364, "sample_time_ms": 19768.992, "learn_time_ms": 1946.114, "learn_throughput": 2055.378, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 359201, "num_agent_steps_trained": 359201}, "done": false, "training_iteration": 30, "trial_id": "default", "date": "2025-10-13_04-29-17", "timestamp": 1760344157, "time_this_iter_s": 22.25489902496338, "time_total_s": 582.8860712051392, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 582.8860712051392, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 33.53125, "ram_util_percent": 35.715625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.2009604282677175, "policy_loss": -0.014116623616428115, "vf_loss": 6.449651557207107, "vf_explained_var": 0.022947314381599426, "kl": 0.007776164971264238, "entropy": 9.751784694194793, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9760.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.7563040703062027, "policy_loss": -0.012455857701466552, "vf_loss": 3.5560794009102716, "vf_explained_var": 0.6677755947150882, "kl": 0.007457029196509222, "entropy": 9.279768644060407, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19165.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 371201, "num_agent_steps_trained": 371201}, "env_runners": {"episode_reward_max": 103.06326672685812, "episode_reward_min": 62.99395440908664, "episode_reward_mean": 81.2949677605754, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 22.68481220226694, "hider_policy": -24.070627130174124}, "policy_reward_max": {"seeker_policy": 107.15662713017407, "hider_policy": 48.91726672685808}, "policy_reward_mean": {"seeker_policy": 78.01845318280667, "hider_policy": 1.6382572888843745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.34431590853829, 79.71956285356268, 86.73184344003025, 81.83653607117394, 67.00730912157552, 80.84335847315481, 98.30125798801845, 75.48434184354807, 87.36905714558482, 88.78546954796133, 71.89103175133617, 82.41444786235195, 73.98006650160114, 89.89192691280186, 89.14339179450609, 75.88176593549512, 86.6704864382611, 71.60441470105998, 76.27730799389956, 86.3494878920737, 70.738337446303, 90.39919828283486, 89.13381310346288, 80.98755801875943, 91.54044943605683, 72.79285219097098, 77.41115051457828, 90.38073986498772, 94.1465467177251, 98.28590205888659, 77.34461992743111, 74.22518820363237, 75.47198806109324, 85.52352355115916, 69.2886672217052, 85.22931797858666, 96.5334640154872, 74.59839452910242, 82.2562352482224, 67.21690079944068, 79.79170801524918, 74.73310979927128, 74.14402224974147, 76.50652231813933, 85.88345628346931, 76.34557238164969, 79.76394417655186, 74.93276306815855, 76.24168966698713, 62.99395440908664, 69.48149030344877, 87.01045653735905, 76.43398408249548, 70.75407356170498, 81.69070423342103, 92.26493708344233, 85.32112144338116, 86.81931310859612, 87.98947444972357, 88.72262723985548, 89.92872502280761, 86.46738725351004, 73.96454153863229, 88.559059876485, 79.37125313823957, 73.53699808016508, 78.9138156296651, 89.45087464447975, 69.669365276786, 92.91556750393315, 75.48279573937381, 98.07480224603184, 69.05698447271818, 74.11337165534816, 103.06326672685812, 73.00039812123646, 77.82463060307752, 67.77045791603648, 90.21600677489182, 89.2879676897419, 81.01072214767949, 88.00433764380516, 92.01941714748399, 95.4519164703135, 80.64769472737953, 75.52887883555232, 93.58390662355228, 82.56777080943911, 73.20644107445314, 81.76877604511401, 80.12050682042417, 66.97910953733039, 83.70320799955738, 82.75764958280304, 80.82705161730095, 79.02253957684063, 77.4706066994507, 67.45946938722028, 80.7981235968332, 78.04322804629639], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [78.92920626524625, 77.1580265881389, 96.19197073473954, 76.96497111266237, 92.36562561865485, 82.24188000720973, 75.83821547562535, 85.36977285584501, 45.59668979941498, 72.52869651713371, 94.1750523509723, 84.36331510219199, 84.65522682450687, 54.02310157357553, 78.82742913903917, 82.51886367455421, 70.46473856648457, 85.84516271473376, 66.01388828998928, 83.61788663841796, 88.55190470075443, 56.952400400421446, 87.72648918943428, 71.88263508119998, 22.68481220226694, 75.44391855503305, 77.85731790500958, 73.5604459946148, 32.756314267471666, 68.10119349689019, 91.63540245006998, 88.77816860322817, 90.07268312418883, 83.19854928970344, 96.26972733388433, 71.39770035920252, 69.80182399873198, 83.383208703167, 82.17165123970835, 81.46930983946206, 83.69928177492338, 94.46027704944423, 97.32637763189625, 85.8865539661872, 88.3266632968803, 85.69969561535014, 90.92349162698292, 68.9558373711899, 76.92905591330191, 93.67517104369712, 97.26566882448826, 77.40577575730812, 86.01989194807996, 86.81656684014997, 85.68344406456646, 67.68218994277474, 84.42197207884821, 80.07756850705732, 67.46557220333075, 79.12002512400218, 65.0197620186178, 71.81011762302137, 90.74725925064746, 33.044955241521734, 87.72166561273316, 77.5781122418082, 89.03208978657618, 63.41170779307618, 95.92008593998021, 67.03551900326431, 101.74975285474216, 70.9501402491821, 92.40985523310695, 75.6051885741868, 53.527341685671686, 107.15662713017407, 70.68311778286518, 85.13724948752332, 55.51554937886338, 64.66607267584487, 81.13411245154576, 73.9562435439466, 62.260133554859365, 37.426740596932184, 64.36052565259243, 80.97867018602179, 34.75450252008919, 83.28250177281782, 90.07464988673472, 85.45804215838017, 80.82943739563653, 77.6614025897532, 87.65990154516034, 94.82421718871488, 74.68198290974884, 96.1509157485512, 82.52841352002012, 93.68554730007592, 79.87087522029573, 82.31787581134465], "policy_hider_policy_reward": [3.3961026672947856, 4.019006975997299, 0.4352118856079469, 2.1263243798158613, 13.385843440030175, -22.84597073473953, -3.838971112662349, 8.710536071173959, -4.8733073512350416, -20.485009145844273, -3.2194139694680697, 1.8208924354131593, -21.7522154756254, 44.215257988018514, -0.17898209217662936, -9.706448920120271, 8.599310200585018, 33.17305714558479, -9.502696517133705, 25.759469547961356, -18.399052350972283, -3.8849682486638217, 4.692166758475084, -6.641033998315144, -6.706405875166455, -3.968754447739246, 23.560160631612018, 12.308664707614367, -13.16142913903924, 23.477391794506197, -0.9969609267733303, -5.640136812285785, -3.3687385664846183, 19.57448643826116, -12.98039268576833, -1.2603553279054631, 6.483658038004793, 3.7797616659055193, -17.23188663841802, 19.963487892073747, -2.2076625536969265, -15.605904700754394, 10.937846074629844, 22.508951807783653, 22.487813103462916, -21.0804891894343, 2.3674557771985643, 6.737467160360944, 36.687726436238975, 32.16791079755091, 1.9396824700493638, -4.590748834111425, -0.9913226088013376, 0.5451552183699722, -13.514445994614794, 30.334739864987757, 22.655985795993647, 38.734246654259806, 42.45990205888652, -12.275193496890191, -14.389402450069941, 0.09861992743110469, -0.07081179636727732, -14.482168603228189, -7.658643505430828, -6.942051557664753, 8.477523551159159, -6.152549289703414, -20.686314720297318, -6.294745391881724, 15.350653203848365, -1.5190355844642054, 36.89746401548726, -10.165823998731996, -0.6022021802589753, -8.182611993805642, 15.07023524822236, -14.985651239708284, -7.864247482038075, -6.388161557983298, -7.880384465797033, 3.9728107061228233, -1.822890200728761, -17.904277049444218, -3.6110172946171577, -19.571338087537576, -10.83736578186025, 1.457334133812444, 12.837456283469344, -15.280663296880252, -3.4936956153501684, -5.8604276183502915, -9.15749162698295, -2.002055823448087, 2.195422159178303, 3.781503537790321, -3.213055913301899, 2.525689666987121, -14.442740257535284, -16.23847637707523, -18.393865545250748, -9.390312975788781, -4.831668716537514, 14.436349496588445, -8.483570366204413, -1.1023374993800263, -12.272082902796287, -3.790410375648749, -8.537444064566493, 4.544704233421036, 36.758937083442255, -12.176189942774775, 11.985121443381196, -11.085972078848243, -17.431568507057253, 24.173313108596023, -5.809572203330742, 26.33347444972353, 28.67662723985549, -19.07402512400219, -5.2537620186177465, 30.162725022807564, 16.341387253510117, -1.6841176230213888, -14.501259250647468, -2.2814584613677167, 26.390781620891914, 29.123323014071392, -2.9647468617603767, -5.385665612733201, 0.26099808016506626, -4.302112241808157, -10.636089786576214, 0.5178156296650991, 32.11487464447983, -6.075707793076164, -13.389409912170443, -12.861310751023744, -12.579519003264322, 38.45956750393316, -9.913204260626177, -16.353752854742144, 43.308802246031824, -16.184140249182114, -10.946634888538096, -12.406235871850683, 2.97812557041914, -4.469942489257786, 0.6186583143283089, 48.91726672685808, -10.085601878763512, -24.070627130174124, -0.8471177828652015, 7.988630603077546, -6.281075419310153, -11.085716152176618, 35.270006774891854, -0.5695493788634058, -8.020072675844872, 32.64196768974189, 3.081297966698852, -3.204688270565122, -14.620243543946627, 28.66833764380524, -1.4641335548593215, 31.223417147484017, 17.449259403067824, 40.57591647031353, 6.678915195588873, 9.608253879198212, -4.3426701860217864, -1.1071211644475147, 27.022791577890136, 31.806612525572955, -5.596501772817767, 4.881770809439017, -3.582708286628263, -13.285500525653418, 1.5146298988740892, -5.203896012140213, -5.323437395636493, 4.614506820424155, 2.8609724003235577, -13.543265452746331, 9.527207999557362, -13.483901545160341, -15.21821718871487, 3.1516495828030284, 4.251774537902635, 1.8932941696494645, -21.754915748551227, 4.626539576840683, 1.8246066994507526, -6.882413520020139, -19.36574296392779, -6.860334948927941, 0.7451247797042821, 0.18212359683314966, -4.631875811344621, 0.3572280462963726]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1410644194529065, "mean_inference_ms": 0.7870302557281064, "mean_action_processing_ms": 0.13427883087363873, "mean_env_wait_ms": 2.2643084181083974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00240170955657959, "StateBufferConnector_ms": 0.00238037109375, "ViewRequirementAgentConnector_ms": 0.05863165855407715}, "num_episodes": 30, "episode_return_max": 103.06326672685812, "episode_return_min": 62.99395440908664, "episode_return_mean": 81.2949677605754, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 371201, "num_agent_steps_trained": 371201, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 170.48371889252024, "num_env_steps_trained_throughput_per_sec": 170.48371889252024, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 371201, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 371201, "timers": {"training_iteration_time_ms": 21758.179, "restore_workers_time_ms": 0.006, "training_step_time_ms": 21758.161, "sample_time_ms": 19780.965, "learn_time_ms": 1976.938, "learn_throughput": 2023.331, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 371201, "num_agent_steps_trained": 371201}, "done": false, "training_iteration": 31, "trial_id": "default", "date": "2025-10-13_04-29-41", "timestamp": 1760344181, "time_this_iter_s": 23.463276863098145, "time_total_s": 606.3493480682373, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 606.3493480682373, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 36.16470588235294, "ram_util_percent": 35.752941176470586}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.1818030782043936, "policy_loss": -0.008291051247215363, "vf_loss": 6.399704203009605, "vf_explained_var": -0.014646741934120655, "kl": 0.006820033968610138, "entropy": 9.760623773932457, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.6786427808186364, "policy_loss": -0.011411440013981764, "vf_loss": 3.3986262836153545, "vf_explained_var": 0.7044510788387722, "kl": 0.007113391243281485, "entropy": 9.258918460967049, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19795.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 383201, "num_agent_steps_trained": 383201}, "env_runners": {"episode_reward_max": 103.06326672685812, "episode_reward_min": 62.99395440908664, "episode_reward_mean": 80.34580373715212, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 33.044955241521734, "hider_policy": -24.070627130174124}, "policy_reward_max": {"seeker_policy": 107.15662713017407, "hider_policy": 48.91726672685808}, "policy_reward_mean": {"seeker_policy": 80.66514845135653, "hider_policy": -0.15967235710219377}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.34461992743111, 74.22518820363237, 75.47198806109324, 85.52352355115916, 69.2886672217052, 85.22931797858666, 96.5334640154872, 74.59839452910242, 82.2562352482224, 67.21690079944068, 79.79170801524918, 74.73310979927128, 74.14402224974147, 76.50652231813933, 85.88345628346931, 76.34557238164969, 79.76394417655186, 74.93276306815855, 76.24168966698713, 62.99395440908664, 69.48149030344877, 87.01045653735905, 76.43398408249548, 70.75407356170498, 81.69070423342103, 92.26493708344233, 85.32112144338116, 86.81931310859612, 87.98947444972357, 88.72262723985548, 89.92872502280761, 86.46738725351004, 73.96454153863229, 88.559059876485, 79.37125313823957, 73.53699808016508, 78.9138156296651, 89.45087464447975, 69.669365276786, 92.91556750393315, 75.48279573937381, 98.07480224603184, 69.05698447271818, 74.11337165534816, 103.06326672685812, 73.00039812123646, 77.82463060307752, 67.77045791603648, 90.21600677489182, 89.2879676897419, 81.01072214767949, 88.00433764380516, 92.01941714748399, 95.4519164703135, 80.64769472737953, 75.52887883555232, 93.58390662355228, 82.56777080943911, 73.20644107445314, 81.76877604511401, 80.12050682042417, 66.97910953733039, 83.70320799955738, 82.75764958280304, 80.82705161730095, 79.02253957684063, 77.4706066994507, 67.45946938722028, 80.7981235968332, 78.04322804629639, 69.63151900696822, 87.90190124229042, 85.20116486495169, 70.60638446511409, 76.63680512644294, 76.97355072992062, 78.87906667611107, 89.16005682356497, 71.53697075323, 69.81995343116006, 77.0450435970947, 70.73117260512552, 86.23169962426412, 99.24168322760511, 76.00401472644555, 97.6937639630915, 81.94513489814594, 96.59976993520249, 81.73125796980756, 68.66183159641324, 78.98926781988966, 74.61719475065387, 82.62072133965167, 75.25453244994173, 71.1869592775127, 81.48188722235683, 79.56559759256221, 78.46476590356939, 77.55414341923613, 85.45971043044716], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [91.63540245006998, 88.77816860322817, 90.07268312418883, 83.19854928970344, 96.26972733388433, 71.39770035920252, 69.80182399873198, 83.383208703167, 82.17165123970835, 81.46930983946206, 83.69928177492338, 94.46027704944423, 97.32637763189625, 85.8865539661872, 88.3266632968803, 85.69969561535014, 90.92349162698292, 68.9558373711899, 76.92905591330191, 93.67517104369712, 97.26566882448826, 77.40577575730812, 86.01989194807996, 86.81656684014997, 85.68344406456646, 67.68218994277474, 84.42197207884821, 80.07756850705732, 67.46557220333075, 79.12002512400218, 65.0197620186178, 71.81011762302137, 90.74725925064746, 33.044955241521734, 87.72166561273316, 77.5781122418082, 89.03208978657618, 63.41170779307618, 95.92008593998021, 67.03551900326431, 101.74975285474216, 70.9501402491821, 92.40985523310695, 75.6051885741868, 53.527341685671686, 107.15662713017407, 70.68311778286518, 85.13724948752332, 55.51554937886338, 64.66607267584487, 81.13411245154576, 73.9562435439466, 62.260133554859365, 37.426740596932184, 64.36052565259243, 80.97867018602179, 34.75450252008919, 83.28250177281782, 90.07464988673472, 85.45804215838017, 80.82943739563653, 77.6614025897532, 87.65990154516034, 94.82421718871488, 74.68198290974884, 96.1509157485512, 82.52841352002012, 93.68554730007592, 79.87087522029573, 82.31787581134465, 94.76998638047277, 48.448268912804124, 85.9832834853726, 88.70408435616423, 89.13444283517441, 95.3709187917733, 86.97647876005271, 57.37745800411627, 88.91851553324732, 89.7804237667065, 84.08912230096584, 87.31030425980676, 71.91827790228035, 54.30567096792539, 102.49524303668306, 59.45550363698042, 75.40854387190045, 66.45869629268513, 95.61182627052357, 78.91485549615689, 87.14340481668265, 77.11566255321249, 83.63563794202864, 90.51124842958718, 87.14488162795344, 99.11470399875223, 94.84355799082171, 105.55338378804254, 82.59453748869936, 78.78775499964466], "policy_hider_policy_reward": [-14.389402450069941, 0.09861992743110469, -0.07081179636727732, -14.482168603228189, -7.658643505430828, -6.942051557664753, 8.477523551159159, -6.152549289703414, -20.686314720297318, -6.294745391881724, 15.350653203848365, -1.5190355844642054, 36.89746401548726, -10.165823998731996, -0.6022021802589753, -8.182611993805642, 15.07023524822236, -14.985651239708284, -7.864247482038075, -6.388161557983298, -7.880384465797033, 3.9728107061228233, -1.822890200728761, -17.904277049444218, -3.6110172946171577, -19.571338087537576, -10.83736578186025, 1.457334133812444, 12.837456283469344, -15.280663296880252, -3.4936956153501684, -5.8604276183502915, -9.15749162698295, -2.002055823448087, 2.195422159178303, 3.781503537790321, -3.213055913301899, 2.525689666987121, -14.442740257535284, -16.23847637707523, -18.393865545250748, -9.390312975788781, -4.831668716537514, 14.436349496588445, -8.483570366204413, -1.1023374993800263, -12.272082902796287, -3.790410375648749, -8.537444064566493, 4.544704233421036, 36.758937083442255, -12.176189942774775, 11.985121443381196, -11.085972078848243, -17.431568507057253, 24.173313108596023, -5.809572203330742, 26.33347444972353, 28.67662723985549, -19.07402512400219, -5.2537620186177465, 30.162725022807564, 16.341387253510117, -1.6841176230213888, -14.501259250647468, -2.2814584613677167, 26.390781620891914, 29.123323014071392, -2.9647468617603767, -5.385665612733201, 0.26099808016506626, -4.302112241808157, -10.636089786576214, 0.5178156296650991, 32.11487464447983, -6.075707793076164, -13.389409912170443, -12.861310751023744, -12.579519003264322, 38.45956750393316, -9.913204260626177, -16.353752854742144, 43.308802246031824, -16.184140249182114, -10.946634888538096, -12.406235871850683, 2.97812557041914, -4.469942489257786, 0.6186583143283089, 48.91726672685808, -10.085601878763512, -24.070627130174124, -0.8471177828652015, 7.988630603077546, -6.281075419310153, -11.085716152176618, 35.270006774891854, -0.5695493788634058, -8.020072675844872, 32.64196768974189, 3.081297966698852, -3.204688270565122, -14.620243543946627, 28.66833764380524, -1.4641335548593215, 31.223417147484017, 17.449259403067824, 40.57591647031353, 6.678915195588873, 9.608253879198212, -4.3426701860217864, -1.1071211644475147, 27.022791577890136, 31.806612525572955, -5.596501772817767, 4.881770809439017, -3.582708286628263, -13.285500525653418, 1.5146298988740892, -5.203896012140213, -5.323437395636493, 4.614506820424155, 2.8609724003235577, -13.543265452746331, 9.527207999557362, -13.483901545160341, -15.21821718871487, 3.1516495828030284, 4.251774537902635, 1.8932941696494645, -21.754915748551227, 4.626539576840683, 1.8246066994507526, -6.882413520020139, -19.36574296392779, -6.860334948927941, 0.7451247797042821, 0.18212359683314966, -4.631875811344621, 0.3572280462963726, -13.933986380472797, -11.204480993031785, 18.054604495114404, 21.399027834371875, 15.22516486495176, -16.007283485372604, -8.976697571777613, -9.121002319272542, -13.488442835174427, 0.9908051264429721, -16.264918791773308, -2.1324492700793676, -4.836747000282005, -3.2606650836596605, -1.4814580041163006, 33.26405682356507, -11.992882949371134, -5.388661830646179, -4.169936390555311, -15.790533944991134, -6.533122300965846, -0.5109564029052647, -10.524304259806787, -6.054827394874452, -4.322277902280396, 18.635699624264156, 44.775683227605114, 0.1603290320746221, -16.092261549500563, -10.398966760736888, 43.33776396309152, -5.0995036369804065, 5.7291348981459365, 0.8074561280995372, -12.092696292685124, 42.23376993520246, 2.655257969807598, -16.535826270523575, 1.931144503843101, -12.184168403586755, -14.417404816682653, 6.263267819889685, 10.089020509472567, -12.587488312031164, 8.194721339651617, -9.209637942028634, -12.470148204932045, -2.7865677747133666, -7.029227177308821, -8.92869517313188, -1.2741127776431034, -16.358703998752286, -2.080402407437785, -13.19755799082169, -20.4373837880425, -6.651234096430568, -6.72853748869932, 1.6881434192360512, 13.793710430447156, -7.1217549996446605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.145110299026516, "mean_inference_ms": 0.7904308678989368, "mean_action_processing_ms": 0.13462937484494872, "mean_env_wait_ms": 2.2859000215024214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025249719619750977, "StateBufferConnector_ms": 0.0024296045303344727, "ViewRequirementAgentConnector_ms": 0.06052863597869873}, "num_episodes": 30, "episode_return_max": 103.06326672685812, "episode_return_min": 62.99395440908664, "episode_return_mean": 80.34580373715212, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 383201, "num_agent_steps_trained": 383201, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.07711470404885, "num_env_steps_trained_throughput_per_sec": 172.07711470404885, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 383201, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 383201, "timers": {"training_iteration_time_ms": 21922.228, "restore_workers_time_ms": 0.006, "training_step_time_ms": 21922.209, "sample_time_ms": 19961.484, "learn_time_ms": 1960.464, "learn_throughput": 2040.333, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 383201, "num_agent_steps_trained": 383201}, "done": false, "training_iteration": 32, "trial_id": "default", "date": "2025-10-13_04-30-04", "timestamp": 1760344204, "time_this_iter_s": 23.246026039123535, "time_total_s": 629.5953741073608, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 629.5953741073608, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 34.84848484848485, "ram_util_percent": 35.78484848484848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.093043553829193, "policy_loss": -0.010775938104779925, "vf_loss": 6.227507741749287, "vf_explained_var": -0.0004720240831375122, "kl": 0.007234579342093714, "entropy": 9.937189915776253, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10400.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.4790021414794619, "policy_loss": -0.013083771078862131, "vf_loss": 3.002289831449115, "vf_explained_var": 0.7188061157862345, "kl": 0.0075160043269058025, "entropy": 9.059002540225075, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 20425.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 395201, "num_agent_steps_trained": 395201}, "env_runners": {"episode_reward_max": 105.17912609818282, "episode_reward_min": 66.2348835031051, "episode_reward_mean": 80.77487693940441, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 33.044955241521734, "hider_policy": -24.78542233130809}, "policy_reward_max": {"seeker_policy": 109.69142233130809, "hider_policy": 50.7431260981829}, "policy_reward_mean": {"seeker_policy": 78.4967175390041, "hider_policy": 1.1390797002001696}, "custom_metrics": {}, "hist_stats": {"episode_reward": [88.72262723985548, 89.92872502280761, 86.46738725351004, 73.96454153863229, 88.559059876485, 79.37125313823957, 73.53699808016508, 78.9138156296651, 89.45087464447975, 69.669365276786, 92.91556750393315, 75.48279573937381, 98.07480224603184, 69.05698447271818, 74.11337165534816, 103.06326672685812, 73.00039812123646, 77.82463060307752, 67.77045791603648, 90.21600677489182, 89.2879676897419, 81.01072214767949, 88.00433764380516, 92.01941714748399, 95.4519164703135, 80.64769472737953, 75.52887883555232, 93.58390662355228, 82.56777080943911, 73.20644107445314, 81.76877604511401, 80.12050682042417, 66.97910953733039, 83.70320799955738, 82.75764958280304, 80.82705161730095, 79.02253957684063, 77.4706066994507, 67.45946938722028, 80.7981235968332, 78.04322804629639, 69.63151900696822, 87.90190124229042, 85.20116486495169, 70.60638446511409, 76.63680512644294, 76.97355072992062, 78.87906667611107, 89.16005682356497, 71.53697075323, 69.81995343116006, 77.0450435970947, 70.73117260512552, 86.23169962426412, 99.24168322760511, 76.00401472644555, 97.6937639630915, 81.94513489814594, 96.59976993520249, 81.73125796980756, 68.66183159641324, 78.98926781988966, 74.61719475065387, 82.62072133965167, 75.25453244994173, 71.1869592775127, 81.48188722235683, 79.56559759256221, 78.46476590356939, 77.55414341923613, 85.45971043044716, 73.33289869811263, 89.13475445051351, 92.2481160664324, 95.16939824187291, 76.3154461696305, 73.16870225191708, 80.12238392921205, 83.39930504940259, 76.12860562261895, 70.82684963220366, 89.04903182379185, 67.34617731849909, 105.17912609818282, 77.73320288523277, 100.33282861349228, 71.4802973594326, 72.92028421362534, 72.27069415095995, 76.26206193013408, 90.95510625128782, 79.19846671134991, 79.71644417743487, 66.2348835031051, 71.14778664418765, 76.55874552732251, 80.85182940437622, 79.27056486774136, 82.90162507576254, 80.44230026513284], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [79.12002512400218, 65.0197620186178, 71.81011762302137, 90.74725925064746, 33.044955241521734, 87.72166561273316, 77.5781122418082, 89.03208978657618, 63.41170779307618, 95.92008593998021, 67.03551900326431, 101.74975285474216, 70.9501402491821, 92.40985523310695, 75.6051885741868, 53.527341685671686, 107.15662713017407, 70.68311778286518, 85.13724948752332, 55.51554937886338, 64.66607267584487, 81.13411245154576, 73.9562435439466, 62.260133554859365, 37.426740596932184, 64.36052565259243, 80.97867018602179, 34.75450252008919, 83.28250177281782, 90.07464988673472, 85.45804215838017, 80.82943739563653, 77.6614025897532, 87.65990154516034, 94.82421718871488, 74.68198290974884, 96.1509157485512, 82.52841352002012, 93.68554730007592, 79.87087522029573, 82.31787581134465, 94.76998638047277, 48.448268912804124, 85.9832834853726, 88.70408435616423, 89.13444283517441, 95.3709187917733, 86.97647876005271, 57.37745800411627, 88.91851553324732, 89.7804237667065, 84.08912230096584, 87.31030425980676, 71.91827790228035, 54.30567096792539, 102.49524303668306, 59.45550363698042, 75.40854387190045, 66.45869629268513, 95.61182627052357, 78.91485549615689, 87.14340481668265, 77.11566255321249, 83.63563794202864, 90.51124842958718, 87.14488162795344, 99.11470399875223, 94.84355799082171, 105.55338378804254, 82.59453748869936, 78.78775499964466, 90.93533231992147, 54.79132511195072, 74.09663684532345, 70.31878073411916, 90.26186145034997, 80.67436904254471, 68.83393875925141, 74.18097569139057, 94.8133077580967, 87.60433945213401, 38.96212202516032, 93.55285051494045, 56.33482234855815, 66.27003574090772, 37.02714569021192, 78.39525201340855, 85.97152646460155, 79.30291952899506, 87.18743288532683, 66.00653611084562, 78.12333653917422, 69.42703991931316, 88.99191789617822, 90.09540689601528, 88.13965455636762, 72.76644292786345, 109.69142233130809, 82.04028658830462, 65.25917101999846], "policy_hider_policy_reward": [28.67662723985549, -19.07402512400219, -5.2537620186177465, 30.162725022807564, 16.341387253510117, -1.6841176230213888, -14.501259250647468, -2.2814584613677167, 26.390781620891914, 29.123323014071392, -2.9647468617603767, -5.385665612733201, 0.26099808016506626, -4.302112241808157, -10.636089786576214, 0.5178156296650991, 32.11487464447983, -6.075707793076164, -13.389409912170443, -12.861310751023744, -12.579519003264322, 38.45956750393316, -9.913204260626177, -16.353752854742144, 43.308802246031824, -16.184140249182114, -10.946634888538096, -12.406235871850683, 2.97812557041914, -4.469942489257786, 0.6186583143283089, 48.91726672685808, -10.085601878763512, -24.070627130174124, -0.8471177828652015, 7.988630603077546, -6.281075419310153, -11.085716152176618, 35.270006774891854, -0.5695493788634058, -8.020072675844872, 32.64196768974189, 3.081297966698852, -3.204688270565122, -14.620243543946627, 28.66833764380524, -1.4641335548593215, 31.223417147484017, 17.449259403067824, 40.57591647031353, 6.678915195588873, 9.608253879198212, -4.3426701860217864, -1.1071211644475147, 27.022791577890136, 31.806612525572955, -5.596501772817767, 4.881770809439017, -3.582708286628263, -13.285500525653418, 1.5146298988740892, -5.203896012140213, -5.323437395636493, 4.614506820424155, 2.8609724003235577, -13.543265452746331, 9.527207999557362, -13.483901545160341, -15.21821718871487, 3.1516495828030284, 4.251774537902635, 1.8932941696494645, -21.754915748551227, 4.626539576840683, 1.8246066994507526, -6.882413520020139, -19.36574296392779, -6.860334948927941, 0.7451247797042821, 0.18212359683314966, -4.631875811344621, 0.3572280462963726, -13.933986380472797, -11.204480993031785, 18.054604495114404, 21.399027834371875, 15.22516486495176, -16.007283485372604, -8.976697571777613, -9.121002319272542, -13.488442835174427, 0.9908051264429721, -16.264918791773308, -2.1324492700793676, -4.836747000282005, -3.2606650836596605, -1.4814580041163006, 33.26405682356507, -11.992882949371134, -5.388661830646179, -4.169936390555311, -15.790533944991134, -6.533122300965846, -0.5109564029052647, -10.524304259806787, -6.054827394874452, -4.322277902280396, 18.635699624264156, 44.775683227605114, 0.1603290320746221, -16.092261549500563, -10.398966760736888, 43.33776396309152, -5.0995036369804065, 5.7291348981459365, 0.8074561280995372, -12.092696292685124, 42.23376993520246, 2.655257969807598, -16.535826270523575, 1.931144503843101, -12.184168403586755, -14.417404816682653, 6.263267819889685, 10.089020509472567, -12.587488312031164, 8.194721339651617, -9.209637942028634, -12.470148204932045, -2.7865677747133666, -7.029227177308821, -8.92869517313188, -1.2741127776431034, -16.358703998752286, -2.080402407437785, -13.19755799082169, -20.4373837880425, -6.651234096430568, -6.72853748869932, 1.6881434192360512, 13.793710430447156, -7.1217549996446605, -4.449635054820571, -13.152798566988231, 31.11783384200323, 3.2255954965595834, -20.10063684532347, 38.252116066432436, 40.8633982418729, -16.012780734119094, -3.0926427128369367, -10.853772567882508, -4.661211235671679, -2.8444555549559216, 17.546383929212077, -6.257938759251434, 4.2180604360675975, 5.000268921944378, -17.217307758096684, -1.4673943773810423, -9.350675110795788, -7.4268147091346295, 30.72303182379183, 19.363877974839664, -14.14459300611755, -12.062080190323869, 50.7431260981829, -1.8988223485581486, -3.9365090458886534, 15.399676190213704, 17.248854309788054, 46.05682861349232, 0.3494373139553681, -7.264391967931285, -11.206658446638873, -1.844583804337353, 2.9718470521488722, -10.00407243018396, -6.402690492425825, -4.5226804627669095, -8.010536110845617, 32.959106251287736, 1.149560340701892, -0.07443016852623142, 6.206556487091476, 4.0828477710303215, -9.436721187991884, -13.320313205081233, -13.08940689601529, -5.858213355812303, -14.286314169382747, 2.7054051403377137, -5.608000958763168, 13.693387435275925, -5.63543513225857, -24.78542233130809, 10.525625075762541, -9.66428658830462, 24.53630026513285, -9.3531710199985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1494488833247676, "mean_inference_ms": 0.7938152509828069, "mean_action_processing_ms": 0.13495144640721737, "mean_env_wait_ms": 2.3083481927893916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002562999725341797, "StateBufferConnector_ms": 0.0024962425231933594, "ViewRequirementAgentConnector_ms": 0.06127762794494629}, "num_episodes": 29, "episode_return_max": 105.17912609818282, "episode_return_min": 66.2348835031051, "episode_return_mean": 80.77487693940441, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 395201, "num_agent_steps_trained": 395201, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 166.82655704588367, "num_env_steps_trained_throughput_per_sec": 166.82655704588367, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 395201, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 395201, "timers": {"training_iteration_time_ms": 22288.014, "restore_workers_time_ms": 0.006, "training_step_time_ms": 22287.996, "sample_time_ms": 20334.853, "learn_time_ms": 1952.852, "learn_throughput": 2048.287, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 395201, "num_agent_steps_trained": 395201}, "done": false, "training_iteration": 33, "trial_id": "default", "date": "2025-10-13_04-30-28", "timestamp": 1760344228, "time_this_iter_s": 23.977627992630005, "time_total_s": 653.5730020999908, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 653.5730020999908, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 35.19117647058823, "ram_util_percent": 35.73529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.1701082684099675, "policy_loss": -0.01184045736445114, "vf_loss": 6.3841346353292465, "vf_explained_var": -0.03498224224895239, "kl": 0.0074182931135511445, "entropy": 10.121493282914162, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10720.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.5407033519139366, "policy_loss": -0.0115870831567528, "vf_loss": 3.1229530994854278, "vf_explained_var": 0.6560441037965199, "kl": 0.007047059475579413, "entropy": 9.186116210998051, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.39682539682539, "num_grad_updates_lifetime": 21055.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 407164, "num_agent_steps_trained": 407164}, "env_runners": {"episode_reward_max": 105.17912609818282, "episode_reward_min": 66.2348835031051, "episode_reward_mean": 80.20015758421279, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 37.02714569021192, "hider_policy": -24.78542233130809}, "policy_reward_max": {"seeker_policy": 110.84885169646024, "hider_policy": 50.7431260981829}, "policy_reward_mean": {"seeker_policy": 81.10825611693146, "hider_policy": -0.4540492663593257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [81.76877604511401, 80.12050682042417, 66.97910953733039, 83.70320799955738, 82.75764958280304, 80.82705161730095, 79.02253957684063, 77.4706066994507, 67.45946938722028, 80.7981235968332, 78.04322804629639, 69.63151900696822, 87.90190124229042, 85.20116486495169, 70.60638446511409, 76.63680512644294, 76.97355072992062, 78.87906667611107, 89.16005682356497, 71.53697075323, 69.81995343116006, 77.0450435970947, 70.73117260512552, 86.23169962426412, 99.24168322760511, 76.00401472644555, 97.6937639630915, 81.94513489814594, 96.59976993520249, 81.73125796980756, 68.66183159641324, 78.98926781988966, 74.61719475065387, 82.62072133965167, 75.25453244994173, 71.1869592775127, 81.48188722235683, 79.56559759256221, 78.46476590356939, 77.55414341923613, 85.45971043044716, 73.33289869811263, 89.13475445051351, 92.2481160664324, 95.16939824187291, 76.3154461696305, 73.16870225191708, 80.12238392921205, 83.39930504940259, 76.12860562261895, 70.82684963220366, 89.04903182379185, 67.34617731849909, 105.17912609818282, 77.73320288523277, 100.33282861349228, 71.4802973594326, 72.92028421362534, 72.27069415095995, 76.26206193013408, 90.95510625128782, 79.19846671134991, 79.71644417743487, 66.2348835031051, 71.14778664418765, 76.55874552732251, 80.85182940437622, 79.27056486774136, 82.90162507576254, 80.44230026513284, 73.47592295089831, 72.42645140345019, 86.27162047090805, 84.1886639033184, 83.93039213354996, 75.79951227853581, 95.32924201453316, 86.30960979763881, 83.79432294728133, 91.85188552305603, 100.67571516237292, 86.58971662401144, 87.57714443742606, 76.01425775535893, 77.15245773434249, 75.54153773728184, 68.98415450275519, 77.85262764635881, 72.53231531360804, 68.63215267361008, 80.20571131297082, 78.29298916818556, 85.73510897799001, 77.31993220899426, 71.05180696359257, 88.02863155812061, 96.37935626075227, 66.975989372801, 85.83056819309184, 79.19025008357532], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [85.45804215838017, 80.82943739563653, 77.6614025897532, 87.65990154516034, 94.82421718871488, 74.68198290974884, 96.1509157485512, 82.52841352002012, 93.68554730007592, 79.87087522029573, 82.31787581134465, 94.76998638047277, 48.448268912804124, 85.9832834853726, 88.70408435616423, 89.13444283517441, 95.3709187917733, 86.97647876005271, 57.37745800411627, 88.91851553324732, 89.7804237667065, 84.08912230096584, 87.31030425980676, 71.91827790228035, 54.30567096792539, 102.49524303668306, 59.45550363698042, 75.40854387190045, 66.45869629268513, 95.61182627052357, 78.91485549615689, 87.14340481668265, 77.11566255321249, 83.63563794202864, 90.51124842958718, 87.14488162795344, 99.11470399875223, 94.84355799082171, 105.55338378804254, 82.59453748869936, 78.78775499964466, 90.93533231992147, 54.79132511195072, 74.09663684532345, 70.31878073411916, 90.26186145034997, 80.67436904254471, 68.83393875925141, 74.18097569139057, 94.8133077580967, 87.60433945213401, 38.96212202516032, 93.55285051494045, 56.33482234855815, 66.27003574090772, 37.02714569021192, 78.39525201340855, 85.97152646460155, 79.30291952899506, 87.18743288532683, 66.00653611084562, 78.12333653917422, 69.42703991931316, 88.99191789617822, 90.09540689601528, 88.13965455636762, 72.76644292786345, 109.69142233130809, 82.04028658830462, 65.25917101999846, 90.82221532973034, 96.49606888584773, 79.46648685191226, 110.84885169646024, 77.80170095982555, 86.42470080369792, 64.28143704416924, 76.76451758796476, 66.48393080788252, 58.940502173506594, 62.01040154514973, 75.0141026009742, 69.98639076231765, 92.25190879462848, 97.04451876763837, 72.2766238735504, 75.49684919688747, 106.0861955501827, 84.31283543615025, 81.28205625093118, 87.20826039835408, 89.40175716816721, 62.75485552008209, 90.16626164151772, 91.6430140650132, 62.59924697212972, 65.06467251435663, 103.3183059806249, 84.18993338219174, 106.78553008384115], "policy_hider_policy_reward": [1.5146298988740892, -5.203896012140213, -5.323437395636493, 4.614506820424155, 2.8609724003235577, -13.543265452746331, 9.527207999557362, -13.483901545160341, -15.21821718871487, 3.1516495828030284, 4.251774537902635, 1.8932941696494645, -21.754915748551227, 4.626539576840683, 1.8246066994507526, -6.882413520020139, -19.36574296392779, -6.860334948927941, 0.7451247797042821, 0.18212359683314966, -4.631875811344621, 0.3572280462963726, -13.933986380472797, -11.204480993031785, 18.054604495114404, 21.399027834371875, 15.22516486495176, -16.007283485372604, -8.976697571777613, -9.121002319272542, -13.488442835174427, 0.9908051264429721, -16.264918791773308, -2.1324492700793676, -4.836747000282005, -3.2606650836596605, -1.4814580041163006, 33.26405682356507, -11.992882949371134, -5.388661830646179, -4.169936390555311, -15.790533944991134, -6.533122300965846, -0.5109564029052647, -10.524304259806787, -6.054827394874452, -4.322277902280396, 18.635699624264156, 44.775683227605114, 0.1603290320746221, -16.092261549500563, -10.398966760736888, 43.33776396309152, -5.0995036369804065, 5.7291348981459365, 0.8074561280995372, -12.092696292685124, 42.23376993520246, 2.655257969807598, -16.535826270523575, 1.931144503843101, -12.184168403586755, -14.417404816682653, 6.263267819889685, 10.089020509472567, -12.587488312031164, 8.194721339651617, -9.209637942028634, -12.470148204932045, -2.7865677747133666, -7.029227177308821, -8.92869517313188, -1.2741127776431034, -16.358703998752286, -2.080402407437785, -13.19755799082169, -20.4373837880425, -6.651234096430568, -6.72853748869932, 1.6881434192360512, 13.793710430447156, -7.1217549996446605, -4.449635054820571, -13.152798566988231, 31.11783384200323, 3.2255954965595834, -20.10063684532347, 38.252116066432436, 40.8633982418729, -16.012780734119094, -3.0926427128369367, -10.853772567882508, -4.661211235671679, -2.8444555549559216, 17.546383929212077, -6.257938759251434, 4.2180604360675975, 5.000268921944378, -17.217307758096684, -1.4673943773810423, -9.350675110795788, -7.4268147091346295, 30.72303182379183, 19.363877974839664, -14.14459300611755, -12.062080190323869, 50.7431260981829, -1.8988223485581486, -3.9365090458886534, 15.399676190213704, 17.248854309788054, 46.05682861349232, 0.3494373139553681, -7.264391967931285, -11.206658446638873, -1.844583804337353, 2.9718470521488722, -10.00407243018396, -6.402690492425825, -4.5226804627669095, -8.010536110845617, 32.959106251287736, 1.149560340701892, -0.07443016852623142, 6.206556487091476, 4.0828477710303215, -9.436721187991884, -13.320313205081233, -13.08940689601529, -5.858213355812303, -14.286314169382747, 2.7054051403377137, -5.608000958763168, 13.693387435275925, -5.63543513225857, -24.78542233130809, 10.525625075762541, -9.66428658830462, 24.53630026513285, -9.3531710199985, -12.20559469964506, -5.140697679186962, -14.180002316470597, -9.889615165926903, 13.045620470908107, -6.240486851912306, -14.24844094163576, -12.411746851506079, 0.42429904017444275, 5.704392133549887, -5.751029924084281, -4.8741586010777995, 39.683242014533114, -8.63543704416922, 18.943609797638818, -9.398517587964747, 3.7735134789604388, 13.536878660438362, -1.104502173506605, 34.01588552305596, 45.82971516237284, -7.164401545149701, 12.233716624011395, -0.6581026009741886, -0.8103907623175992, 18.40114443742606, -14.085908794628484, -2.1517422446410652, -12.458518767638358, -7.433542265657507, -0.5757652968245258, 3.840679160555986, -8.544142782039527, 2.0314480879072883, -7.233372353641113, -21.00019555018271, -17.566835436150228, 5.78631531360799, -3.126385078618218, -9.523518498702831, -0.28028868702911014, -6.722260398354077, -14.84753876239776, 3.7387707624161464, 12.17926170643967, 10.800991751468294, 1.1139322089941963, -13.96026164151769, -7.4835165522376155, -13.107690549183062, -6.923246972129734, 32.352631558120585, 41.25335626075229, -9.938672514356671, -13.325358028071829, -23.016958579752036, -16.023933382191764, 17.664568193091846, -15.895749916424741, -11.699530083841125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1557862319571124, "mean_inference_ms": 0.797157029813771, "mean_action_processing_ms": 0.1352538115094185, "mean_env_wait_ms": 2.3325739366027753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025953054428100586, "StateBufferConnector_ms": 0.002506256103515625, "ViewRequirementAgentConnector_ms": 0.06193900108337402}, "num_episodes": 30, "episode_return_max": 105.17912609818282, "episode_return_min": 66.2348835031051, "episode_return_mean": 80.20015758421279, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 407164, "num_agent_steps_trained": 407164, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.08643040340152, "num_env_steps_trained_throughput_per_sec": 161.08643040340152, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 407164, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 407164, "timers": {"training_iteration_time_ms": 22688.709, "restore_workers_time_ms": 0.006, "training_step_time_ms": 22688.69, "sample_time_ms": 20750.191, "learn_time_ms": 1938.215, "learn_throughput": 2063.755, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 407164, "num_agent_steps_trained": 407164}, "done": false, "training_iteration": 34, "trial_id": "default", "date": "2025-10-13_04-30-53", "timestamp": 1760344253, "time_this_iter_s": 24.831973791122437, "time_total_s": 678.4049758911133, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 678.4049758911133, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 34.94000000000001, "ram_util_percent": 35.71142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.033544833958149, "policy_loss": -0.011195376896648668, "vf_loss": 6.111786353588104, "vf_explained_var": -0.0495539627969265, "kl": 0.0090846231702643, "entropy": 11.156507298350334, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.5538998497856988, "policy_loss": -0.009709227368945167, "vf_loss": 3.1451433666168698, "vf_explained_var": 0.6743779845654019, "kl": 0.007376691265089362, "entropy": 8.962604622613815, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21685.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 419164, "num_agent_steps_trained": 419164}, "env_runners": {"episode_reward_max": 105.17912609818282, "episode_reward_min": 64.99420889694333, "episode_reward_mean": 79.45733437045347, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 37.02714569021192, "hider_policy": -24.78542233130809}, "policy_reward_max": {"seeker_policy": 110.84885169646024, "hider_policy": 50.7431260981829}, "policy_reward_mean": {"seeker_policy": 81.456653038493, "hider_policy": -0.9996593340197645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.66183159641324, 78.98926781988966, 74.61719475065387, 82.62072133965167, 75.25453244994173, 71.1869592775127, 81.48188722235683, 79.56559759256221, 78.46476590356939, 77.55414341923613, 85.45971043044716, 73.33289869811263, 89.13475445051351, 92.2481160664324, 95.16939824187291, 76.3154461696305, 73.16870225191708, 80.12238392921205, 83.39930504940259, 76.12860562261895, 70.82684963220366, 89.04903182379185, 67.34617731849909, 105.17912609818282, 77.73320288523277, 100.33282861349228, 71.4802973594326, 72.92028421362534, 72.27069415095995, 76.26206193013408, 90.95510625128782, 79.19846671134991, 79.71644417743487, 66.2348835031051, 71.14778664418765, 76.55874552732251, 80.85182940437622, 79.27056486774136, 82.90162507576254, 80.44230026513284, 73.47592295089831, 72.42645140345019, 86.27162047090805, 84.1886639033184, 83.93039213354996, 75.79951227853581, 95.32924201453316, 86.30960979763881, 83.79432294728133, 91.85188552305603, 100.67571516237292, 86.58971662401144, 87.57714443742606, 76.01425775535893, 77.15245773434249, 75.54153773728184, 68.98415450275519, 77.85262764635881, 72.53231531360804, 68.63215267361008, 80.20571131297082, 78.29298916818556, 85.73510897799001, 77.31993220899426, 71.05180696359257, 88.02863155812061, 96.37935626075227, 66.975989372801, 85.83056819309184, 79.19025008357532, 65.97877554872986, 64.99420889694333, 83.52238515252145, 87.20015781578398, 66.45123202689524, 82.55209368530474, 80.30459170246007, 70.98484501379698, 75.1710462271012, 72.18783747744583, 74.05050954909187, 84.19187318822165, 77.67666095871533, 77.37314086865032, 73.96653079785266, 86.96651069257153, 75.44501133058294, 90.59625620323752, 70.02467079135495, 89.96996028924717, 82.1296635599038, 82.10773300699182, 80.7443376929954, 74.39276978094229, 82.02488965536953, 77.23978583143769, 77.04565734676888, 68.4547085916941, 78.51833434050255, 75.97268317665919], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [78.91485549615689, 87.14340481668265, 77.11566255321249, 83.63563794202864, 90.51124842958718, 87.14488162795344, 99.11470399875223, 94.84355799082171, 105.55338378804254, 82.59453748869936, 78.78775499964466, 90.93533231992147, 54.79132511195072, 74.09663684532345, 70.31878073411916, 90.26186145034997, 80.67436904254471, 68.83393875925141, 74.18097569139057, 94.8133077580967, 87.60433945213401, 38.96212202516032, 93.55285051494045, 56.33482234855815, 66.27003574090772, 37.02714569021192, 78.39525201340855, 85.97152646460155, 79.30291952899506, 87.18743288532683, 66.00653611084562, 78.12333653917422, 69.42703991931316, 88.99191789617822, 90.09540689601528, 88.13965455636762, 72.76644292786345, 109.69142233130809, 82.04028658830462, 65.25917101999846, 90.82221532973034, 96.49606888584773, 79.46648685191226, 110.84885169646024, 77.80170095982555, 86.42470080369792, 64.28143704416924, 76.76451758796476, 66.48393080788252, 58.940502173506594, 62.01040154514973, 75.0141026009742, 69.98639076231765, 92.25190879462848, 97.04451876763837, 72.2766238735504, 75.49684919688747, 106.0861955501827, 84.31283543615025, 81.28205625093118, 87.20826039835408, 89.40175716816721, 62.75485552008209, 90.16626164151772, 91.6430140650132, 62.59924697212972, 65.06467251435663, 103.3183059806249, 84.18993338219174, 106.78553008384115, 95.33605546465868, 94.1881370819668, 75.34933635824272, 69.71619540347793, 79.82089943373771, 82.35894872270917, 81.1706306549245, 84.37561314103408, 84.78060580841054, 77.8026184711786, 93.8042140754231, 66.12155676330507, 81.58870499652727, 85.93368087284263, 87.96559909978322, 68.65748883491818, 77.40825886471029, 72.36201172530633, 95.32841091790378, 58.5350968219346, 78.98224780396586, 72.26536731227223, 91.10558286768652, 91.26168237929491, 72.48161965589617, 107.6025258204971, 88.05278092006493, 85.98933510039332, 96.81117125604774, 95.86897628035672], "policy_hider_policy_reward": [1.931144503843101, -12.184168403586755, -14.417404816682653, 6.263267819889685, 10.089020509472567, -12.587488312031164, 8.194721339651617, -9.209637942028634, -12.470148204932045, -2.7865677747133666, -7.029227177308821, -8.92869517313188, -1.2741127776431034, -16.358703998752286, -2.080402407437785, -13.19755799082169, -20.4373837880425, -6.651234096430568, -6.72853748869932, 1.6881434192360512, 13.793710430447156, -7.1217549996446605, -4.449635054820571, -13.152798566988231, 31.11783384200323, 3.2255954965595834, -20.10063684532347, 38.252116066432436, 40.8633982418729, -16.012780734119094, -3.0926427128369367, -10.853772567882508, -4.661211235671679, -2.8444555549559216, 17.546383929212077, -6.257938759251434, 4.2180604360675975, 5.000268921944378, -17.217307758096684, -1.4673943773810423, -9.350675110795788, -7.4268147091346295, 30.72303182379183, 19.363877974839664, -14.14459300611755, -12.062080190323869, 50.7431260981829, -1.8988223485581486, -3.9365090458886534, 15.399676190213704, 17.248854309788054, 46.05682861349232, 0.3494373139553681, -7.264391967931285, -11.206658446638873, -1.844583804337353, 2.9718470521488722, -10.00407243018396, -6.402690492425825, -4.5226804627669095, -8.010536110845617, 32.959106251287736, 1.149560340701892, -0.07443016852623142, 6.206556487091476, 4.0828477710303215, -9.436721187991884, -13.320313205081233, -13.08940689601529, -5.858213355812303, -14.286314169382747, 2.7054051403377137, -5.608000958763168, 13.693387435275925, -5.63543513225857, -24.78542233130809, 10.525625075762541, -9.66428658830462, 24.53630026513285, -9.3531710199985, -12.20559469964506, -5.140697679186962, -14.180002316470597, -9.889615165926903, 13.045620470908107, -6.240486851912306, -14.24844094163576, -12.411746851506079, 0.42429904017444275, 5.704392133549887, -5.751029924084281, -4.8741586010777995, 39.683242014533114, -8.63543704416922, 18.943609797638818, -9.398517587964747, 3.7735134789604388, 13.536878660438362, -1.104502173506605, 34.01588552305596, 45.82971516237284, -7.164401545149701, 12.233716624011395, -0.6581026009741886, -0.8103907623175992, 18.40114443742606, -14.085908794628484, -2.1517422446410652, -12.458518767638358, -7.433542265657507, -0.5757652968245258, 3.840679160555986, -8.544142782039527, 2.0314480879072883, -7.233372353641113, -21.00019555018271, -17.566835436150228, 5.78631531360799, -3.126385078618218, -9.523518498702831, -0.28028868702911014, -6.722260398354077, -14.84753876239776, 3.7387707624161464, 12.17926170643967, 10.800991751468294, 1.1139322089941963, -13.96026164151769, -7.4835165522376155, -13.107690549183062, -6.923246972129734, 32.352631558120585, 41.25335626075229, -9.938672514356671, -13.325358028071829, -23.016958579752036, -16.023933382191764, 17.664568193091846, -15.895749916424741, -11.699530083841125, -13.576732522692861, -15.78054739323596, -11.465009190640913, -17.72891899438253, 15.276385152521396, -7.103336358242716, -5.570195403477943, 23.05415781578406, -7.13462684778938, -6.235040559053051, -11.112948722709135, 11.306093685304717, 1.3385917024600504, -2.204630654924479, -6.0628052575547, -7.327962869682418, -7.352020291750888, -2.2575392895585082, -7.7349034141779915, 2.1201224204451803, -3.0154904509080738, -16.738214075423095, -1.9755567633050637, 20.045873188221663, 0.4811643716516768, -4.393208409463632, -5.027080601523901, -3.53345940266841, -3.9326147100357587, -10.066453591894788, -5.851488834918241, 24.160510692571613, 0.5442262807976959, -2.5074738149250204, -11.216011725306378, 29.450256203237554, -13.567504935012222, -11.736235191536666, 36.42396028924717, -4.989096821934596, 3.415268720840338, -0.2678529649024255, -0.07936731227224471, 9.921733006991841, -10.559582867686526, 0.19833769299545628, -15.862432346550968, -1.0064802518016105, 14.47888965536958, -4.935619655896173, -6.586214168562298, -23.776525820497106, -9.866780920064924, -1.1403426532310994, -8.163139055908527, -9.371487452790735, -17.671721700993867, -0.6211152145512837, -3.1690507437586812, -16.727242359938803]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1803120448068156, "mean_inference_ms": 0.7992266470008275, "mean_action_processing_ms": 0.135467934266223, "mean_env_wait_ms": 2.3565538816192357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022428035736083984, "StateBufferConnector_ms": 0.002268075942993164, "ViewRequirementAgentConnector_ms": 0.05526852607727051}, "num_episodes": 30, "episode_return_max": 105.17912609818282, "episode_return_min": 64.99420889694333, "episode_return_mean": 79.45733437045347, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 419164, "num_agent_steps_trained": 419164, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.7034369898187, "num_env_steps_trained_throughput_per_sec": 125.7034369898187, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 419164, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 419164, "timers": {"training_iteration_time_ms": 23760.805, "restore_workers_time_ms": 0.006, "training_step_time_ms": 23760.787, "sample_time_ms": 21828.433, "learn_time_ms": 1932.066, "learn_throughput": 2070.322, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 419164, "num_agent_steps_trained": 419164}, "done": false, "training_iteration": 35, "trial_id": "default", "date": "2025-10-13_04-31-25", "timestamp": 1760344285, "time_this_iter_s": 31.821537971496582, "time_total_s": 710.2265138626099, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 710.2265138626099, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 31.910869565217393, "ram_util_percent": 35.247826086956536}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.236847299337387, "policy_loss": -0.010976257197398809, "vf_loss": 6.516737388074398, "vf_explained_var": -0.013222677260637283, "kl": 0.00883402346261744, "entropy": 10.548590472340583, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11360.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.639809376852853, "policy_loss": -0.012717265473116957, "vf_loss": 3.3235563618796213, "vf_explained_var": 0.6500866208757673, "kl": 0.0061988337151094456, "entropy": 9.251541831001402, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.55555555555556, "num_grad_updates_lifetime": 22315.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 431137, "num_agent_steps_trained": 431137}, "env_runners": {"episode_reward_max": 112.71614463221702, "episode_reward_min": 64.99420889694333, "episode_reward_mean": 79.82848786066467, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 10.928910518530392, "hider_policy": -24.78542233130809}, "policy_reward_max": {"seeker_policy": 110.84885169646024, "hider_policy": 52.840144632216926}, "policy_reward_mean": {"seeker_policy": 81.28347406558532, "hider_policy": -0.7274931024603206}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.26206193013408, 90.95510625128782, 79.19846671134991, 79.71644417743487, 66.2348835031051, 71.14778664418765, 76.55874552732251, 80.85182940437622, 79.27056486774136, 82.90162507576254, 80.44230026513284, 73.47592295089831, 72.42645140345019, 86.27162047090805, 84.1886639033184, 83.93039213354996, 75.79951227853581, 95.32924201453316, 86.30960979763881, 83.79432294728133, 91.85188552305603, 100.67571516237292, 86.58971662401144, 87.57714443742606, 76.01425775535893, 77.15245773434249, 75.54153773728184, 68.98415450275519, 77.85262764635881, 72.53231531360804, 68.63215267361008, 80.20571131297082, 78.29298916818556, 85.73510897799001, 77.31993220899426, 71.05180696359257, 88.02863155812061, 96.37935626075227, 66.975989372801, 85.83056819309184, 79.19025008357532, 65.97877554872986, 64.99420889694333, 83.52238515252145, 87.20015781578398, 66.45123202689524, 82.55209368530474, 80.30459170246007, 70.98484501379698, 75.1710462271012, 72.18783747744583, 74.05050954909187, 84.19187318822165, 77.67666095871533, 77.37314086865032, 73.96653079785266, 86.96651069257153, 75.44501133058294, 90.59625620323752, 70.02467079135495, 89.96996028924717, 82.1296635599038, 82.10773300699182, 80.7443376929954, 74.39276978094229, 82.02488965536953, 77.23978583143769, 77.04565734676888, 68.4547085916941, 78.51833434050255, 75.97268317665919, 88.60886030807114, 83.39721509377195, 85.56887768910882, 75.9925242355821, 81.32355345848077, 86.72758786066908, 71.25105376371572, 71.60619961367628, 74.57248147983636, 112.71614463221702, 72.58797826637674, 73.17187009828481, 71.06704882580397, 76.03409532796148, 65.77892360600958, 82.0848187089035, 99.91714645976926, 78.60668545892933, 75.2067822396267, 92.00475774816033, 82.78370268090761, 82.81815585199256, 76.1104829046601, 90.22981453631076, 80.98438431884797, 75.71111523422458, 80.83156001958481, 86.26553268381144, 83.17071029319398], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [87.18743288532683, 66.00653611084562, 78.12333653917422, 69.42703991931316, 88.99191789617822, 90.09540689601528, 88.13965455636762, 72.76644292786345, 109.69142233130809, 82.04028658830462, 65.25917101999846, 90.82221532973034, 96.49606888584773, 79.46648685191226, 110.84885169646024, 77.80170095982555, 86.42470080369792, 64.28143704416924, 76.76451758796476, 66.48393080788252, 58.940502173506594, 62.01040154514973, 75.0141026009742, 69.98639076231765, 92.25190879462848, 97.04451876763837, 72.2766238735504, 75.49684919688747, 106.0861955501827, 84.31283543615025, 81.28205625093118, 87.20826039835408, 89.40175716816721, 62.75485552008209, 90.16626164151772, 91.6430140650132, 62.59924697212972, 65.06467251435663, 103.3183059806249, 84.18993338219174, 106.78553008384115, 95.33605546465868, 94.1881370819668, 75.34933635824272, 69.71619540347793, 79.82089943373771, 82.35894872270917, 81.1706306549245, 84.37561314103408, 84.78060580841054, 77.8026184711786, 93.8042140754231, 66.12155676330507, 81.58870499652727, 85.93368087284263, 87.96559909978322, 68.65748883491818, 77.40825886471029, 72.36201172530633, 95.32841091790378, 58.5350968219346, 78.98224780396586, 72.26536731227223, 91.10558286768652, 91.26168237929491, 72.48161965589617, 107.6025258204971, 88.05278092006493, 85.98933510039332, 96.81117125604774, 95.86897628035672, 50.47682368693845, 78.09745778284737, 64.13171596127683, 86.94449756741011, 76.69173463674434, 66.88225059810536, 100.68938579002716, 96.28205075039642, 85.80191331878254, 10.928910518530392, 90.80976761777609, 89.11609648906017, 88.43315496259359, 90.88009653213179, 92.42184047660336, 90.28348749215897, 88.9066727482906, 79.43315142180396, 85.17447041645657, 61.322952499848434, 67.3620240270814, 94.69245966698742, 82.79926043110562, 56.41490947581249, 59.18897254622285, 89.0701656272078, 83.51398828576868, 85.01384142084058, 78.60522058387123], "policy_hider_policy_reward": [-6.402690492425825, -4.5226804627669095, -8.010536110845617, 32.959106251287736, 1.149560340701892, -0.07443016852623142, 6.206556487091476, 4.0828477710303215, -9.436721187991884, -13.320313205081233, -13.08940689601529, -5.858213355812303, -14.286314169382747, 2.7054051403377137, -5.608000958763168, 13.693387435275925, -5.63543513225857, -24.78542233130809, 10.525625075762541, -9.66428658830462, 24.53630026513285, -9.3531710199985, -12.20559469964506, -5.140697679186962, -14.180002316470597, -9.889615165926903, 13.045620470908107, -6.240486851912306, -14.24844094163576, -12.411746851506079, 0.42429904017444275, 5.704392133549887, -5.751029924084281, -4.8741586010777995, 39.683242014533114, -8.63543704416922, 18.943609797638818, -9.398517587964747, 3.7735134789604388, 13.536878660438362, -1.104502173506605, 34.01588552305596, 45.82971516237284, -7.164401545149701, 12.233716624011395, -0.6581026009741886, -0.8103907623175992, 18.40114443742606, -14.085908794628484, -2.1517422446410652, -12.458518767638358, -7.433542265657507, -0.5757652968245258, 3.840679160555986, -8.544142782039527, 2.0314480879072883, -7.233372353641113, -21.00019555018271, -17.566835436150228, 5.78631531360799, -3.126385078618218, -9.523518498702831, -0.28028868702911014, -6.722260398354077, -14.84753876239776, 3.7387707624161464, 12.17926170643967, 10.800991751468294, 1.1139322089941963, -13.96026164151769, -7.4835165522376155, -13.107690549183062, -6.923246972129734, 32.352631558120585, 41.25335626075229, -9.938672514356671, -13.325358028071829, -23.016958579752036, -16.023933382191764, 17.664568193091846, -15.895749916424741, -11.699530083841125, -13.576732522692861, -15.78054739323596, -11.465009190640913, -17.72891899438253, 15.276385152521396, -7.103336358242716, -5.570195403477943, 23.05415781578406, -7.13462684778938, -6.235040559053051, -11.112948722709135, 11.306093685304717, 1.3385917024600504, -2.204630654924479, -6.0628052575547, -7.327962869682418, -7.352020291750888, -2.2575392895585082, -7.7349034141779915, 2.1201224204451803, -3.0154904509080738, -16.738214075423095, -1.9755567633050637, 20.045873188221663, 0.4811643716516768, -4.393208409463632, -5.027080601523901, -3.53345940266841, -3.9326147100357587, -10.066453591894788, -5.851488834918241, 24.160510692571613, 0.5442262807976959, -2.5074738149250204, -11.216011725306378, 29.450256203237554, -13.567504935012222, -11.736235191536666, 36.42396028924717, -4.989096821934596, 3.415268720840338, -0.2678529649024255, -0.07936731227224471, 9.921733006991841, -10.559582867686526, 0.19833769299545628, -15.862432346550968, -1.0064802518016105, 14.47888965536958, -4.935619655896173, -6.586214168562298, -23.776525820497106, -9.866780920064924, -1.1403426532310994, -8.163139055908527, -9.371487452790735, -17.671721700993867, -0.6211152145512837, -3.1690507437586812, -16.727242359938803, 36.87186030807116, 1.2601763130615697, 6.894806539831995, -1.59504922890739, 4.06864031315689, 17.36852141467513, -3.1530499594742545, -7.798923372353793, 1.8793321265206162, 2.7524866952158877, 23.66158786066912, -3.816250598105341, -8.738791051492505, -20.699540974818845, -6.219800386323649, -18.45605075039644, -9.755913318782556, -1.4735185201636332, 52.840144632216926, 48.94708948146961, -10.02119576909014, -8.200593582309152, -12.455695224813724, -3.4885311659615867, -8.957154962593643, -8.408951174196055, -3.1019046720384376, -11.744096532131833, -8.50714472673956, -18.1357721438542, -9.657487492158952, 1.4588187089034501, -15.647333352578341, 26.657807064057064, -11.677151421803929, 10.850685458929332, -11.078470416456591, 1.1107822396268523, -5.496952499848454, 36.1787577481604, 13.62728969660593, 1.7943889572202674, -18.29645966698743, 6.4221558519925575, -5.408026553151171, -1.2807509732943627, 32.97381453631069, 0.8410905241874878, 24.738384318848087, -2.942972546222824, -0.20488476577531237, -13.15416562720784, 8.405560019584842, -11.087988285768697, -20.317841420840583, 21.56953268381146, 11.30471029319401, -6.739220583871255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.208735478533109, "mean_inference_ms": 0.8007962387689624, "mean_action_processing_ms": 0.135647430210411, "mean_env_wait_ms": 2.380428535532655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021611452102661133, "StateBufferConnector_ms": 0.002179741859436035, "ViewRequirementAgentConnector_ms": 0.0525665283203125}, "num_episodes": 29, "episode_return_max": 112.71614463221702, "episode_return_min": 64.99420889694333, "episode_return_mean": 79.82848786066467, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 431137, "num_agent_steps_trained": 431137, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.83105219814772, "num_env_steps_trained_throughput_per_sec": 146.83105219814772, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 431137, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 431137, "timers": {"training_iteration_time_ms": 24319.107, "restore_workers_time_ms": 0.006, "training_step_time_ms": 24319.089, "sample_time_ms": 22381.574, "learn_time_ms": 1937.231, "learn_throughput": 2064.803, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 431137, "num_agent_steps_trained": 431137}, "done": false, "training_iteration": 36, "trial_id": "default", "date": "2025-10-13_04-31-52", "timestamp": 1760344312, "time_this_iter_s": 27.24283194541931, "time_total_s": 737.4693458080292, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 737.4693458080292, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 37.02894736842106, "ram_util_percent": 35.5921052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 2.9455229051411154, "policy_loss": -0.011580822689575143, "vf_loss": 5.934658472239971, "vf_explained_var": -0.05862942636013031, "kl": 0.009383466571284875, "entropy": 10.22919034063816, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11680.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.5213177419844128, "policy_loss": -0.013669077202027279, "vf_loss": 3.0887143437824554, "vf_explained_var": 0.6748962279350038, "kl": 0.007508362797655156, "entropy": 9.370354370843797, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 22945.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 443137, "num_agent_steps_trained": 443137}, "env_runners": {"episode_reward_max": 112.71614463221702, "episode_reward_min": 64.99420889694333, "episode_reward_mean": 80.51156542769635, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 10.928910518530392, "hider_policy": -23.776525820497106}, "policy_reward_max": {"seeker_policy": 107.6025258204971, "hider_policy": 52.840144632216926}, "policy_reward_mean": {"seeker_policy": 80.02419065331604, "hider_policy": 0.24368738719016933}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.63215267361008, 80.20571131297082, 78.29298916818556, 85.73510897799001, 77.31993220899426, 71.05180696359257, 88.02863155812061, 96.37935626075227, 66.975989372801, 85.83056819309184, 79.19025008357532, 65.97877554872986, 64.99420889694333, 83.52238515252145, 87.20015781578398, 66.45123202689524, 82.55209368530474, 80.30459170246007, 70.98484501379698, 75.1710462271012, 72.18783747744583, 74.05050954909187, 84.19187318822165, 77.67666095871533, 77.37314086865032, 73.96653079785266, 86.96651069257153, 75.44501133058294, 90.59625620323752, 70.02467079135495, 89.96996028924717, 82.1296635599038, 82.10773300699182, 80.7443376929954, 74.39276978094229, 82.02488965536953, 77.23978583143769, 77.04565734676888, 68.4547085916941, 78.51833434050255, 75.97268317665919, 88.60886030807114, 83.39721509377195, 85.56887768910882, 75.9925242355821, 81.32355345848077, 86.72758786066908, 71.25105376371572, 71.60619961367628, 74.57248147983636, 112.71614463221702, 72.58797826637674, 73.17187009828481, 71.06704882580397, 76.03409532796148, 65.77892360600958, 82.0848187089035, 99.91714645976926, 78.60668545892933, 75.2067822396267, 92.00475774816033, 82.78370268090761, 82.81815585199256, 76.1104829046601, 90.22981453631076, 80.98438431884797, 75.71111523422458, 80.83156001958481, 86.26553268381144, 83.17071029319398, 76.6459920491937, 79.71007560861358, 86.85249467243698, 73.13216749427542, 84.67449920475583, 74.24123444244516, 72.5264996612055, 85.19182916824592, 77.98213600936046, 83.20083660962366, 87.83219238676345, 81.64551766506291, 77.70282560079838, 80.29049527074287, 79.28053146571874, 86.762765180011, 85.94706556540137, 99.11883510590688, 100.02754077854674, 81.02548056095763, 80.42547108313057, 87.27935227073016, 82.73927408019011, 80.26838635652119, 85.02981825071639, 90.18691502849666, 74.55510902295595, 74.93645930336157, 88.39464751579264, 90.53867398572783], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [81.28205625093118, 87.20826039835408, 89.40175716816721, 62.75485552008209, 90.16626164151772, 91.6430140650132, 62.59924697212972, 65.06467251435663, 103.3183059806249, 84.18993338219174, 106.78553008384115, 95.33605546465868, 94.1881370819668, 75.34933635824272, 69.71619540347793, 79.82089943373771, 82.35894872270917, 81.1706306549245, 84.37561314103408, 84.78060580841054, 77.8026184711786, 93.8042140754231, 66.12155676330507, 81.58870499652727, 85.93368087284263, 87.96559909978322, 68.65748883491818, 77.40825886471029, 72.36201172530633, 95.32841091790378, 58.5350968219346, 78.98224780396586, 72.26536731227223, 91.10558286768652, 91.26168237929491, 72.48161965589617, 107.6025258204971, 88.05278092006493, 85.98933510039332, 96.81117125604774, 95.86897628035672, 50.47682368693845, 78.09745778284737, 64.13171596127683, 86.94449756741011, 76.69173463674434, 66.88225059810536, 100.68938579002716, 96.28205075039642, 85.80191331878254, 10.928910518530392, 90.80976761777609, 89.11609648906017, 88.43315496259359, 90.88009653213179, 92.42184047660336, 90.28348749215897, 88.9066727482906, 79.43315142180396, 85.17447041645657, 61.322952499848434, 67.3620240270814, 94.69245966698742, 82.79926043110562, 56.41490947581249, 59.18897254622285, 89.0701656272078, 83.51398828576868, 85.01384142084058, 78.60522058387123, 93.616591656278, 82.68990208728576, 62.137587437869655, 85.98641204350186, 68.66599487396755, 76.6788183044524, 88.25723156921813, 70.93861035371857, 77.75469252487183, 72.37944392588146, 55.08832852501872, 76.02027486592178, 87.99580501988628, 76.84084262404143, 87.53386215377165, 80.52522110520005, 85.17145192050675, 64.77113739304185, 64.3551535210946, 78.04710850679133, 88.92239179190642, 62.918770738344534, 79.25993350243616, 93.98012864355417, 80.20160585061012, 47.66866819701528, 94.51906298285238, 101.06842869464765, 66.81359952578326, 63.80348477277299], "policy_hider_policy_reward": [-3.126385078618218, -9.523518498702831, -0.28028868702911014, -6.722260398354077, -14.84753876239776, 3.7387707624161464, 12.17926170643967, 10.800991751468294, 1.1139322089941963, -13.96026164151769, -7.4835165522376155, -13.107690549183062, -6.923246972129734, 32.352631558120585, 41.25335626075229, -9.938672514356671, -13.325358028071829, -23.016958579752036, -16.023933382191764, 17.664568193091846, -15.895749916424741, -11.699530083841125, -13.576732522692861, -15.78054739323596, -11.465009190640913, -17.72891899438253, 15.276385152521396, -7.103336358242716, -5.570195403477943, 23.05415781578406, -7.13462684778938, -6.235040559053051, -11.112948722709135, 11.306093685304717, 1.3385917024600504, -2.204630654924479, -6.0628052575547, -7.327962869682418, -7.352020291750888, -2.2575392895585082, -7.7349034141779915, 2.1201224204451803, -3.0154904509080738, -16.738214075423095, -1.9755567633050637, 20.045873188221663, 0.4811643716516768, -4.393208409463632, -5.027080601523901, -3.53345940266841, -3.9326147100357587, -10.066453591894788, -5.851488834918241, 24.160510692571613, 0.5442262807976959, -2.5074738149250204, -11.216011725306378, 29.450256203237554, -13.567504935012222, -11.736235191536666, 36.42396028924717, -4.989096821934596, 3.415268720840338, -0.2678529649024255, -0.07936731227224471, 9.921733006991841, -10.559582867686526, 0.19833769299545628, -15.862432346550968, -1.0064802518016105, 14.47888965536958, -4.935619655896173, -6.586214168562298, -23.776525820497106, -9.866780920064924, -1.1403426532310994, -8.163139055908527, -9.371487452790735, -17.671721700993867, -0.6211152145512837, -3.1690507437586812, -16.727242359938803, 36.87186030807116, 1.2601763130615697, 6.894806539831995, -1.59504922890739, 4.06864031315689, 17.36852141467513, -3.1530499594742545, -7.798923372353793, 1.8793321265206162, 2.7524866952158877, 23.66158786066912, -3.816250598105341, -8.738791051492505, -20.699540974818845, -6.219800386323649, -18.45605075039644, -9.755913318782556, -1.4735185201636332, 52.840144632216926, 48.94708948146961, -10.02119576909014, -8.200593582309152, -12.455695224813724, -3.4885311659615867, -8.957154962593643, -8.408951174196055, -3.1019046720384376, -11.744096532131833, -8.50714472673956, -18.1357721438542, -9.657487492158952, 1.4588187089034501, -15.647333352578341, 26.657807064057064, -11.677151421803929, 10.850685458929332, -11.078470416456591, 1.1107822396268523, -5.496952499848454, 36.1787577481604, 13.62728969660593, 1.7943889572202674, -18.29645966698743, 6.4221558519925575, -5.408026553151171, -1.2807509732943627, 32.97381453631069, 0.8410905241874878, 24.738384318848087, -2.942972546222824, -0.20488476577531237, -13.15416562720784, 8.405560019584842, -11.087988285768697, -20.317841420840583, 21.56953268381146, 11.30471029319401, -6.739220583871255, -8.730007950806261, -8.240591656278044, 3.974075608613503, -6.953902087285703, 24.346494672436965, 0.36841256213035667, -6.2238325057246335, -6.630412043501838, 16.07849920475582, -0.0699948739675232, -2.463969093344422, 0.02638523133720021, -3.1886664639799336, -12.54206544403272, 4.761107813211573, 9.492111001315752, -16.96869252487179, 17.196136009360472, 3.439489025558784, 7.381903658183426, 18.257617036295052, 14.486246825449719, 6.651348315772142, -1.0261055166310071, -6.849366112665622, -3.4436133064222627, 4.739590783755206, -1.2899381370537697, -0.7209344555865376, -7.53239623246633, 22.276765180010944, -16.039221105199992, -8.215451920506759, 8.991065565401346, 44.15283510590701, -9.805137393041848, 45.1815407785467, -9.509153521094607, 4.6430518955648195, -1.6646798413984596, -15.032782386120438, 6.535861677344584, 9.74941106681166, 14.611170465574014, 6.731023672925164, -3.2516830951711198, 10.062386356521161, -23.774128643554125, -11.475605850610105, 16.30381825071636, 12.407331802984718, 30.110915028496635, -16.223062982852365, -3.7408909770440686, -3.239540696638472, -22.892428694647627, 22.468647515792654, -0.8875995257832903, 31.85267398572776, -5.11748477277299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2370241281540464, "mean_inference_ms": 0.8026832939926465, "mean_action_processing_ms": 0.13585320090188355, "mean_env_wait_ms": 2.407034366231894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021899938583374023, "StateBufferConnector_ms": 0.002160310745239258, "ViewRequirementAgentConnector_ms": 0.05254709720611572}, "num_episodes": 30, "episode_return_max": 112.71614463221702, "episode_return_min": 64.99420889694333, "episode_return_mean": 80.51156542769635, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 443137, "num_agent_steps_trained": 443137, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.49524979066166, "num_env_steps_trained_throughput_per_sec": 151.49524979066166, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 443137, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 443137, "timers": {"training_iteration_time_ms": 24789.201, "restore_workers_time_ms": 0.006, "training_step_time_ms": 24789.183, "sample_time_ms": 22851.92, "learn_time_ms": 1936.974, "learn_throughput": 2065.077, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 443137, "num_agent_steps_trained": 443137}, "done": false, "training_iteration": 37, "trial_id": "default", "date": "2025-10-13_04-32-19", "timestamp": 1760344339, "time_this_iter_s": 26.404165029525757, "time_total_s": 763.8735108375549, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 763.8735108375549, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 39.07631578947369, "ram_util_percent": 35.84736842105262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.027516409009695, "policy_loss": -0.010396840250177775, "vf_loss": 6.095711025595665, "vf_explained_var": -0.010977440141141414, "kl": 0.00902317164809585, "entropy": 9.94576229453087, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.4791781779319522, "policy_loss": -0.01160555772468566, "vf_loss": 3.0003518549222794, "vf_explained_var": 0.7070145916371119, "kl": 0.007670477154441376, "entropy": 9.392197864774674, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23575.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 455137, "num_agent_steps_trained": 455137}, "env_runners": {"episode_reward_max": 112.71614463221702, "episode_reward_min": 65.77892360600958, "episode_reward_mean": 81.04153627461817, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 10.928910518530392, "hider_policy": -24.148545387519228}, "policy_reward_max": {"seeker_policy": 107.6025258204971, "hider_policy": 52.840144632216926}, "policy_reward_mean": {"seeker_policy": 78.98467927488866, "hider_policy": 1.028428499864762}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.02467079135495, 89.96996028924717, 82.1296635599038, 82.10773300699182, 80.7443376929954, 74.39276978094229, 82.02488965536953, 77.23978583143769, 77.04565734676888, 68.4547085916941, 78.51833434050255, 75.97268317665919, 88.60886030807114, 83.39721509377195, 85.56887768910882, 75.9925242355821, 81.32355345848077, 86.72758786066908, 71.25105376371572, 71.60619961367628, 74.57248147983636, 112.71614463221702, 72.58797826637674, 73.17187009828481, 71.06704882580397, 76.03409532796148, 65.77892360600958, 82.0848187089035, 99.91714645976926, 78.60668545892933, 75.2067822396267, 92.00475774816033, 82.78370268090761, 82.81815585199256, 76.1104829046601, 90.22981453631076, 80.98438431884797, 75.71111523422458, 80.83156001958481, 86.26553268381144, 83.17071029319398, 76.6459920491937, 79.71007560861358, 86.85249467243698, 73.13216749427542, 84.67449920475583, 74.24123444244516, 72.5264996612055, 85.19182916824592, 77.98213600936046, 83.20083660962366, 87.83219238676345, 81.64551766506291, 77.70282560079838, 80.29049527074287, 79.28053146571874, 86.762765180011, 85.94706556540137, 99.11883510590688, 100.02754077854674, 81.02548056095763, 80.42547108313057, 87.27935227073016, 82.73927408019011, 80.26838635652119, 85.02981825071639, 90.18691502849666, 74.55510902295595, 74.93645930336157, 88.39464751579264, 90.53867398572783, 74.96235168714944, 88.4575313439262, 94.55054154241586, 73.79387980890787, 84.43073911218171, 75.58080293158375, 71.43184567347834, 71.8011942257507, 73.90052971798254, 81.47667139701457, 71.362032204357, 71.57442467549572, 95.11827278643744, 70.82825916526406, 94.26054571698174, 89.64459295011389, 70.10845381780831, 78.17473665112028, 85.07201060220588, 77.92548532663102, 69.0731758212707, 89.07653659643016, 93.77659891055727, 93.63117718709057, 72.81768805983398, 82.61936510599031, 83.61585284005808, 70.9949793498639, 70.19297339386965], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [95.32841091790378, 58.5350968219346, 78.98224780396586, 72.26536731227223, 91.10558286768652, 91.26168237929491, 72.48161965589617, 107.6025258204971, 88.05278092006493, 85.98933510039332, 96.81117125604774, 95.86897628035672, 50.47682368693845, 78.09745778284737, 64.13171596127683, 86.94449756741011, 76.69173463674434, 66.88225059810536, 100.68938579002716, 96.28205075039642, 85.80191331878254, 10.928910518530392, 90.80976761777609, 89.11609648906017, 88.43315496259359, 90.88009653213179, 92.42184047660336, 90.28348749215897, 88.9066727482906, 79.43315142180396, 85.17447041645657, 61.322952499848434, 67.3620240270814, 94.69245966698742, 82.79926043110562, 56.41490947581249, 59.18897254622285, 89.0701656272078, 83.51398828576868, 85.01384142084058, 78.60522058387123, 93.616591656278, 82.68990208728576, 62.137587437869655, 85.98641204350186, 68.66599487396755, 76.6788183044524, 88.25723156921813, 70.93861035371857, 77.75469252487183, 72.37944392588146, 55.08832852501872, 76.02027486592178, 87.99580501988628, 76.84084262404143, 87.53386215377165, 80.52522110520005, 85.17145192050675, 64.77113739304185, 64.3551535210946, 78.04710850679133, 88.92239179190642, 62.918770738344534, 79.25993350243616, 93.98012864355417, 80.20160585061012, 47.66866819701528, 94.51906298285238, 101.06842869464765, 66.81359952578326, 63.80348477277299, 90.95262007234732, 67.60887610250545, 37.84193267924831, 95.69055286021334, 70.37952611836818, 81.02138887588383, 101.8345453875192, 82.35545295486388, 85.89954772867843, 97.14275053563455, 84.67954399499129, 100.7790412605248, 63.247550420826734, 90.2340801828684, 28.77644897579021, 64.66926898054261, 82.4305846171556, 86.41350502664625, 57.44276722927807, 82.44142459546818, 90.38261170976651, 70.50312121334936, 64.8771251495572, 64.59356735015955, 95.64806454551237, 83.34745278622768, 87.08602404188223, 89.4293665285119, 81.49456998330669], "policy_hider_policy_reward": [-13.567504935012222, -11.736235191536666, 36.42396028924717, -4.989096821934596, 3.415268720840338, -0.2678529649024255, -0.07936731227224471, 9.921733006991841, -10.559582867686526, 0.19833769299545628, -15.862432346550968, -1.0064802518016105, 14.47888965536958, -4.935619655896173, -6.586214168562298, -23.776525820497106, -9.866780920064924, -1.1403426532310994, -8.163139055908527, -9.371487452790735, -17.671721700993867, -0.6211152145512837, -3.1690507437586812, -16.727242359938803, 36.87186030807116, 1.2601763130615697, 6.894806539831995, -1.59504922890739, 4.06864031315689, 17.36852141467513, -3.1530499594742545, -7.798923372353793, 1.8793321265206162, 2.7524866952158877, 23.66158786066912, -3.816250598105341, -8.738791051492505, -20.699540974818845, -6.219800386323649, -18.45605075039644, -9.755913318782556, -1.4735185201636332, 52.840144632216926, 48.94708948146961, -10.02119576909014, -8.200593582309152, -12.455695224813724, -3.4885311659615867, -8.957154962593643, -8.408951174196055, -3.1019046720384376, -11.744096532131833, -8.50714472673956, -18.1357721438542, -9.657487492158952, 1.4588187089034501, -15.647333352578341, 26.657807064057064, -11.677151421803929, 10.850685458929332, -11.078470416456591, 1.1107822396268523, -5.496952499848454, 36.1787577481604, 13.62728969660593, 1.7943889572202674, -18.29645966698743, 6.4221558519925575, -5.408026553151171, -1.2807509732943627, 32.97381453631069, 0.8410905241874878, 24.738384318848087, -2.942972546222824, -0.20488476577531237, -13.15416562720784, 8.405560019584842, -11.087988285768697, -20.317841420840583, 21.56953268381146, 11.30471029319401, -6.739220583871255, -8.730007950806261, -8.240591656278044, 3.974075608613503, -6.953902087285703, 24.346494672436965, 0.36841256213035667, -6.2238325057246335, -6.630412043501838, 16.07849920475582, -0.0699948739675232, -2.463969093344422, 0.02638523133720021, -3.1886664639799336, -12.54206544403272, 4.761107813211573, 9.492111001315752, -16.96869252487179, 17.196136009360472, 3.439489025558784, 7.381903658183426, 18.257617036295052, 14.486246825449719, 6.651348315772142, -1.0261055166310071, -6.849366112665622, -3.4436133064222627, 4.739590783755206, -1.2899381370537697, -0.7209344555865376, -7.53239623246633, 22.276765180010944, -16.039221105199992, -8.215451920506759, 8.991065565401346, 44.15283510590701, -9.805137393041848, 45.1815407785467, -9.509153521094607, 4.6430518955648195, -1.6646798413984596, -15.032782386120438, 6.535861677344584, 9.74941106681166, 14.611170465574014, 6.731023672925164, -3.2516830951711198, 10.062386356521161, -23.774128643554125, -11.475605850610105, 16.30381825071636, 12.407331802984718, 30.110915028496635, -16.223062982852365, -3.7408909770440686, -3.239540696638472, -22.892428694647627, 22.468647515792654, -0.8875995257832903, 31.85267398572776, -5.11748477277299, -5.169921585066811, -10.820346800131102, 0.598080890288091, 20.25057435113264, 39.384541542415825, 17.324067320751677, -15.9757798705, -5.9208931808054075, -5.053526118368167, 19.10473911218173, -9.745388875883883, 4.304802931583782, -24.148545387519228, -6.2541543265216015, 2.8245047059511874, -13.378763435064412, -5.595431481611474, -6.403586529084413, 4.470671397014604, -20.136750535634565, -4.146921904627895, -9.17058988600638, -23.40304126052479, -5.801575324504281, 40.722272786437394, -8.851550420826742, -4.366845322560179, -15.038975695044153, 39.215879238279534, 26.268217502912126, 31.008592950113883, -6.033268980542613, -5.109640306509105, -7.212490492838186, -1.1212633488797357, -7.117505026646247, 23.55601060220594, 4.0732327707219005, -1.480514673368943, -3.0354245954681676, -14.219148780502715, -7.090287107993029, 28.52053659643016, -9.947121213349337, -10.561125149557208, 39.46059891055722, -7.887567350159554, 36.925177187090625, -9.092064545512363, -13.738311940166017, 8.293365105990235, -9.021452786227663, -2.37002404188226, -1.100147159941823, -10.661020650136024, -7.773366528511911, 8.72250049692445, -20.024097086361508]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2524084180601596, "mean_inference_ms": 0.805777002376405, "mean_action_processing_ms": 0.13614240181368018, "mean_env_wait_ms": 2.4348349712750195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024383068084716797, "StateBufferConnector_ms": 0.0024302005767822266, "ViewRequirementAgentConnector_ms": 0.0590512752532959}, "num_episodes": 29, "episode_return_max": 112.71614463221702, "episode_return_min": 65.77892360600958, "episode_return_mean": 81.04153627461817, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 455137, "num_agent_steps_trained": 455137, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.77817233253194, "num_env_steps_trained_throughput_per_sec": 150.77817233253194, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 455137, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 455137, "timers": {"training_iteration_time_ms": 25223.343, "restore_workers_time_ms": 0.006, "training_step_time_ms": 25223.325, "sample_time_ms": 23277.7, "learn_time_ms": 1945.348, "learn_throughput": 2056.187, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 455137, "num_agent_steps_trained": 455137}, "done": false, "training_iteration": 38, "trial_id": "default", "date": "2025-10-13_04-32-45", "timestamp": 1760344365, "time_this_iter_s": 26.529644012451172, "time_total_s": 790.4031548500061, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 790.4031548500061, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 40.88947368421053, "ram_util_percent": 36.12631578947368}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.1747057430446146, "policy_loss": -0.008905046466679778, "vf_loss": 6.387625873088837, "vf_explained_var": -0.013907908089458942, "kl": 0.007465356687862491, "entropy": 10.205060297250748, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12320.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.5239651955309368, "policy_loss": -0.01412495318504553, "vf_loss": 3.094758566220601, "vf_explained_var": 0.7111440475024874, "kl": 0.00956589903145208, "entropy": 9.289133825756254, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 24205.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 467137, "num_agent_steps_trained": 467137}, "env_runners": {"episode_reward_max": 100.02754077854674, "episode_reward_min": 65.1289339632113, "episode_reward_mean": 81.39733879332692, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 28.77644897579021, "hider_policy": -24.714720182335103}, "policy_reward_max": {"seeker_policy": 105.70072018233512, "hider_policy": 45.1815407785467}, "policy_reward_mean": {"seeker_policy": 76.99319465249876, "hider_policy": 2.2020720704140704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.2067822396267, 92.00475774816033, 82.78370268090761, 82.81815585199256, 76.1104829046601, 90.22981453631076, 80.98438431884797, 75.71111523422458, 80.83156001958481, 86.26553268381144, 83.17071029319398, 76.6459920491937, 79.71007560861358, 86.85249467243698, 73.13216749427542, 84.67449920475583, 74.24123444244516, 72.5264996612055, 85.19182916824592, 77.98213600936046, 83.20083660962366, 87.83219238676345, 81.64551766506291, 77.70282560079838, 80.29049527074287, 79.28053146571874, 86.762765180011, 85.94706556540137, 99.11883510590688, 100.02754077854674, 81.02548056095763, 80.42547108313057, 87.27935227073016, 82.73927408019011, 80.26838635652119, 85.02981825071639, 90.18691502849666, 74.55510902295595, 74.93645930336157, 88.39464751579264, 90.53867398572783, 74.96235168714944, 88.4575313439262, 94.55054154241586, 73.79387980890787, 84.43073911218171, 75.58080293158375, 71.43184567347834, 71.8011942257507, 73.90052971798254, 81.47667139701457, 71.362032204357, 71.57442467549572, 95.11827278643744, 70.82825916526406, 94.26054571698174, 89.64459295011389, 70.10845381780831, 78.17473665112028, 85.07201060220588, 77.92548532663102, 69.0731758212707, 89.07653659643016, 93.77659891055727, 93.63117718709057, 72.81768805983398, 82.61936510599031, 83.61585284005808, 70.9949793498639, 70.19297339386965, 86.3416666234029, 86.32956947422119, 73.0532223934262, 79.25458493759639, 89.22568996638434, 84.1901733482585, 68.79851439673492, 77.60623416581973, 77.19644750484318, 97.65273216490193, 89.36471606306246, 84.18134075425836, 75.97536869165151, 79.42430195922424, 89.03629600409953, 78.23721890945966, 79.01254404480615, 72.2152949489482, 78.76289765330304, 82.10872422889753, 84.79571204769304, 89.92303053364442, 65.1289339632113, 70.89353546860272, 88.38479234938993, 76.70749150442431, 85.3942706658618, 68.6834457526771, 84.45055452164213, 82.88920578146204], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [85.17447041645657, 61.322952499848434, 67.3620240270814, 94.69245966698742, 82.79926043110562, 56.41490947581249, 59.18897254622285, 89.0701656272078, 83.51398828576868, 85.01384142084058, 78.60522058387123, 93.616591656278, 82.68990208728576, 62.137587437869655, 85.98641204350186, 68.66599487396755, 76.6788183044524, 88.25723156921813, 70.93861035371857, 77.75469252487183, 72.37944392588146, 55.08832852501872, 76.02027486592178, 87.99580501988628, 76.84084262404143, 87.53386215377165, 80.52522110520005, 85.17145192050675, 64.77113739304185, 64.3551535210946, 78.04710850679133, 88.92239179190642, 62.918770738344534, 79.25993350243616, 93.98012864355417, 80.20160585061012, 47.66866819701528, 94.51906298285238, 101.06842869464765, 66.81359952578326, 63.80348477277299, 90.95262007234732, 67.60887610250545, 37.84193267924831, 95.69055286021334, 70.37952611836818, 81.02138887588383, 101.8345453875192, 82.35545295486388, 85.89954772867843, 97.14275053563455, 84.67954399499129, 100.7790412605248, 63.247550420826734, 90.2340801828684, 28.77644897579021, 64.66926898054261, 82.4305846171556, 86.41350502664625, 57.44276722927807, 82.44142459546818, 90.38261170976651, 70.50312121334936, 64.8771251495572, 64.59356735015955, 95.64806454551237, 83.34745278622768, 87.08602404188223, 89.4293665285119, 81.49456998330669, 57.56917025107765, 70.06418889513576, 93.84090673239369, 89.83585005080013, 58.40653601545975, 83.92285449408955, 88.54821604125338, 61.7818914826027, 74.70020758976459, 52.71015226280572, 47.073959915212704, 88.6628497463554, 92.17735840311099, 81.43549166755517, 58.17209678784083, 69.18044690000647, 84.57582497605695, 71.5665551022999, 93.93892987853022, 55.10390427438417, 68.9189698324877, 56.48533234105299, 105.70072018233512, 96.43671169092718, 49.166100892236585, 80.24835174268651, 66.8538561805557, 97.53018827648914, 93.80224162968916, 73.93747901360679], "policy_hider_policy_reward": [-11.078470416456591, 1.1107822396268523, -5.496952499848454, 36.1787577481604, 13.62728969660593, 1.7943889572202674, -18.29645966698743, 6.4221558519925575, -5.408026553151171, -1.2807509732943627, 32.97381453631069, 0.8410905241874878, 24.738384318848087, -2.942972546222824, -0.20488476577531237, -13.15416562720784, 8.405560019584842, -11.087988285768697, -20.317841420840583, 21.56953268381146, 11.30471029319401, -6.739220583871255, -8.730007950806261, -8.240591656278044, 3.974075608613503, -6.953902087285703, 24.346494672436965, 0.36841256213035667, -6.2238325057246335, -6.630412043501838, 16.07849920475582, -0.0699948739675232, -2.463969093344422, 0.02638523133720021, -3.1886664639799336, -12.54206544403272, 4.761107813211573, 9.492111001315752, -16.96869252487179, 17.196136009360472, 3.439489025558784, 7.381903658183426, 18.257617036295052, 14.486246825449719, 6.651348315772142, -1.0261055166310071, -6.849366112665622, -3.4436133064222627, 4.739590783755206, -1.2899381370537697, -0.7209344555865376, -7.53239623246633, 22.276765180010944, -16.039221105199992, -8.215451920506759, 8.991065565401346, 44.15283510590701, -9.805137393041848, 45.1815407785467, -9.509153521094607, 4.6430518955648195, -1.6646798413984596, -15.032782386120438, 6.535861677344584, 9.74941106681166, 14.611170465574014, 6.731023672925164, -3.2516830951711198, 10.062386356521161, -23.774128643554125, -11.475605850610105, 16.30381825071636, 12.407331802984718, 30.110915028496635, -16.223062982852365, -3.7408909770440686, -3.239540696638472, -22.892428694647627, 22.468647515792654, -0.8875995257832903, 31.85267398572776, -5.11748477277299, -5.169921585066811, -10.820346800131102, 0.598080890288091, 20.25057435113264, 39.384541542415825, 17.324067320751677, -15.9757798705, -5.9208931808054075, -5.053526118368167, 19.10473911218173, -9.745388875883883, 4.304802931583782, -24.148545387519228, -6.2541543265216015, 2.8245047059511874, -13.378763435064412, -5.595431481611474, -6.403586529084413, 4.470671397014604, -20.136750535634565, -4.146921904627895, -9.17058988600638, -23.40304126052479, -5.801575324504281, 40.722272786437394, -8.851550420826742, -4.366845322560179, -15.038975695044153, 39.215879238279534, 26.268217502912126, 31.008592950113883, -6.033268980542613, -5.109640306509105, -7.212490492838186, -1.1212633488797357, -7.117505026646247, 23.55601060220594, 4.0732327707219005, -1.480514673368943, -3.0354245954681676, -14.219148780502715, -7.090287107993029, 28.52053659643016, -9.947121213349337, -10.561125149557208, 39.46059891055722, -7.887567350159554, 36.925177187090625, -9.092064545512363, -13.738311940166017, 8.293365105990235, -9.021452786227663, -2.37002404188226, -1.100147159941823, -10.661020650136024, -7.773366528511911, 8.72250049692445, -20.024097086361508, 15.35221070893939, 13.42028566338586, -1.1381888951357089, 17.403569474221126, -5.582777606573809, -15.204906732393738, -9.60079649641399, -0.9804686167897396, -3.630536015459753, 34.4496899663844, -10.876854494089567, 11.14417334825849, -9.385113231236739, -10.364588413281751, 5.810234165819712, 10.014108517397306, 2.7457924102354485, -0.24955249515682598, 43.70673216490184, 1.235847737194262, 35.0687160630625, 7.222040084787293, 7.615340754258309, -12.096849746355407, -15.971358403110958, -0.2306313083484484, -4.869491667555188, 2.8583019592241734, -0.736096787840839, 31.600296004099548, 12.170498771864201, -3.1137267624109866, -8.969824976056966, 3.406544044806213, 12.518870044106846, -11.870130197458568, -0.27310234669688493, -14.902929878530232, 18.6868614183747, 8.31795853613873, 4.1521793870978785, 11.724562828107436, 5.310667658947012, 28.127030533644437, -15.857066036788714, -24.714720182335103, -16.700711690927164, -8.842464531397281, 16.16585645826599, 23.052834998887356, -7.279237764400811, 3.7383775261386076, 20.248270665861813, -1.7078561805556882, -15.15433530918597, -13.692407214626083, 10.304554521642128, -19.656241629689195, 2.2007100839804923, 6.751016683874732]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.262589981325047, "mean_inference_ms": 0.809611855534356, "mean_action_processing_ms": 0.13645514481797666, "mean_env_wait_ms": 2.466459117877486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027800798416137695, "StateBufferConnector_ms": 0.002675652503967285, "ViewRequirementAgentConnector_ms": 0.06591880321502686}, "num_episodes": 30, "episode_return_max": 100.02754077854674, "episode_return_min": 65.1289339632113, "episode_return_mean": 81.39733879332692, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 467137, "num_agent_steps_trained": 467137, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 134.94313696342132, "num_env_steps_trained_throughput_per_sec": 134.94313696342132, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 467137, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 467137, "timers": {"training_iteration_time_ms": 25940.854, "restore_workers_time_ms": 0.006, "training_step_time_ms": 25940.835, "sample_time_ms": 23955.908, "learn_time_ms": 1984.663, "learn_throughput": 2015.455, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 467137, "num_agent_steps_trained": 467137}, "done": false, "training_iteration": 39, "trial_id": "default", "date": "2025-10-13_04-33-15", "timestamp": 1760344395, "time_this_iter_s": 29.642759323120117, "time_total_s": 820.0459141731262, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 820.0459141731262, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 50.62380952380953, "ram_util_percent": 36.121428571428574}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 2.950477991998196, "policy_loss": -0.011091007864160929, "vf_loss": 5.945029909908771, "vf_explained_var": -0.03388762529939413, "kl": 0.011181971064638828, "entropy": 10.950344502925873, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12640.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.5441822856191605, "policy_loss": -0.01406558002788751, "vf_loss": 3.134947969421508, "vf_explained_var": 0.5715120746975854, "kl": 0.007688090542716197, "entropy": 9.226121625446138, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 24835.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 479137, "num_agent_steps_trained": 479137}, "env_runners": {"episode_reward_max": 99.93139518966166, "episode_reward_min": 64.63695982586077, "episode_reward_mean": 81.34076487573093, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 28.77644897579021, "hider_policy": -24.714720182335103}, "policy_reward_max": {"seeker_policy": 105.70072018233512, "hider_policy": 43.70673216490184}, "policy_reward_mean": {"seeker_policy": 77.2055683230675, "hider_policy": 2.0675982763317218}, "custom_metrics": {}, "hist_stats": {"episode_reward": [81.02548056095763, 80.42547108313057, 87.27935227073016, 82.73927408019011, 80.26838635652119, 85.02981825071639, 90.18691502849666, 74.55510902295595, 74.93645930336157, 88.39464751579264, 90.53867398572783, 74.96235168714944, 88.4575313439262, 94.55054154241586, 73.79387980890787, 84.43073911218171, 75.58080293158375, 71.43184567347834, 71.8011942257507, 73.90052971798254, 81.47667139701457, 71.362032204357, 71.57442467549572, 95.11827278643744, 70.82825916526406, 94.26054571698174, 89.64459295011389, 70.10845381780831, 78.17473665112028, 85.07201060220588, 77.92548532663102, 69.0731758212707, 89.07653659643016, 93.77659891055727, 93.63117718709057, 72.81768805983398, 82.61936510599031, 83.61585284005808, 70.9949793498639, 70.19297339386965, 86.3416666234029, 86.32956947422119, 73.0532223934262, 79.25458493759639, 89.22568996638434, 84.1901733482585, 68.79851439673492, 77.60623416581973, 77.19644750484318, 97.65273216490193, 89.36471606306246, 84.18134075425836, 75.97536869165151, 79.42430195922424, 89.03629600409953, 78.23721890945966, 79.01254404480615, 72.2152949489482, 78.76289765330304, 82.10872422889753, 84.79571204769304, 89.92303053364442, 65.1289339632113, 70.89353546860272, 88.38479234938993, 76.70749150442431, 85.3942706658618, 68.6834457526771, 84.45055452164213, 82.88920578146204, 70.12712819085124, 92.90008184150815, 75.26721013875091, 94.75772863204695, 75.01210061129103, 80.09775729837105, 94.27529106443808, 82.61961210550325, 80.37548725187808, 76.90499673339632, 83.35455684163915, 84.86162399891664, 91.65707070009873, 64.63695982586077, 72.36518946166952, 86.16046061547328, 80.51197765298345, 79.76268549771365, 86.56588066233944, 80.92287885807661, 73.74803598628652, 81.10562153380022, 93.09087137457287, 82.62470570422732, 79.99715695990405, 80.04459549415625, 82.18159890706774, 99.93139518966166, 92.66239072384633, 74.70209083450368], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [78.04710850679133, 88.92239179190642, 62.918770738344534, 79.25993350243616, 93.98012864355417, 80.20160585061012, 47.66866819701528, 94.51906298285238, 101.06842869464765, 66.81359952578326, 63.80348477277299, 90.95262007234732, 67.60887610250545, 37.84193267924831, 95.69055286021334, 70.37952611836818, 81.02138887588383, 101.8345453875192, 82.35545295486388, 85.89954772867843, 97.14275053563455, 84.67954399499129, 100.7790412605248, 63.247550420826734, 90.2340801828684, 28.77644897579021, 64.66926898054261, 82.4305846171556, 86.41350502664625, 57.44276722927807, 82.44142459546818, 90.38261170976651, 70.50312121334936, 64.8771251495572, 64.59356735015955, 95.64806454551237, 83.34745278622768, 87.08602404188223, 89.4293665285119, 81.49456998330669, 57.56917025107765, 70.06418889513576, 93.84090673239369, 89.83585005080013, 58.40653601545975, 83.92285449408955, 88.54821604125338, 61.7818914826027, 74.70020758976459, 52.71015226280572, 47.073959915212704, 88.6628497463554, 92.17735840311099, 81.43549166755517, 58.17209678784083, 69.18044690000647, 84.57582497605695, 71.5665551022999, 93.93892987853022, 55.10390427438417, 68.9189698324877, 56.48533234105299, 105.70072018233512, 96.43671169092718, 49.166100892236585, 80.24835174268651, 66.8538561805557, 97.53018827648914, 93.80224162968916, 73.93747901360679, 83.53046124820352, 54.197640051241805, 91.70115915080999, 53.838727681175996, 92.08064553875523, 69.67127009673918, 54.969547528532864, 79.24789822358673, 85.19485360952716, 89.32514942919836, 93.53897076108221, 78.2405450876594, 68.23234878773563, 86.42012421395592, 97.65603337804593, 59.86769038253943, 88.86565280788425, 80.94244351955935, 82.38554762835744, 71.13287429483039, 86.57477232207826, 88.51177827177739, 64.8764028771898, 67.86763237234105, 89.15378771442539, 80.23983422715948, 66.73468845969307, 58.01319216324269, 67.25786521959664, 91.53345689668014], "policy_hider_policy_reward": [4.6430518955648195, -1.6646798413984596, -15.032782386120438, 6.535861677344584, 9.74941106681166, 14.611170465574014, 6.731023672925164, -3.2516830951711198, 10.062386356521161, -23.774128643554125, -11.475605850610105, 16.30381825071636, 12.407331802984718, 30.110915028496635, -16.223062982852365, -3.7408909770440686, -3.239540696638472, -22.892428694647627, 22.468647515792654, -0.8875995257832903, 31.85267398572776, -5.11748477277299, -5.169921585066811, -10.820346800131102, 0.598080890288091, 20.25057435113264, 39.384541542415825, 17.324067320751677, -15.9757798705, -5.9208931808054075, -5.053526118368167, 19.10473911218173, -9.745388875883883, 4.304802931583782, -24.148545387519228, -6.2541543265216015, 2.8245047059511874, -13.378763435064412, -5.595431481611474, -6.403586529084413, 4.470671397014604, -20.136750535634565, -4.146921904627895, -9.17058988600638, -23.40304126052479, -5.801575324504281, 40.722272786437394, -8.851550420826742, -4.366845322560179, -15.038975695044153, 39.215879238279534, 26.268217502912126, 31.008592950113883, -6.033268980542613, -5.109640306509105, -7.212490492838186, -1.1212633488797357, -7.117505026646247, 23.55601060220594, 4.0732327707219005, -1.480514673368943, -3.0354245954681676, -14.219148780502715, -7.090287107993029, 28.52053659643016, -9.947121213349337, -10.561125149557208, 39.46059891055722, -7.887567350159554, 36.925177187090625, -9.092064545512363, -13.738311940166017, 8.293365105990235, -9.021452786227663, -2.37002404188226, -1.100147159941823, -10.661020650136024, -7.773366528511911, 8.72250049692445, -20.024097086361508, 15.35221070893939, 13.42028566338586, -1.1381888951357089, 17.403569474221126, -5.582777606573809, -15.204906732393738, -9.60079649641399, -0.9804686167897396, -3.630536015459753, 34.4496899663844, -10.876854494089567, 11.14417334825849, -9.385113231236739, -10.364588413281751, 5.810234165819712, 10.014108517397306, 2.7457924102354485, -0.24955249515682598, 43.70673216490184, 1.235847737194262, 35.0687160630625, 7.222040084787293, 7.615340754258309, -12.096849746355407, -15.971358403110958, -0.2306313083484484, -4.869491667555188, 2.8583019592241734, -0.736096787840839, 31.600296004099548, 12.170498771864201, -3.1137267624109866, -8.969824976056966, 3.406544044806213, 12.518870044106846, -11.870130197458568, -0.27310234669688493, -14.902929878530232, 18.6868614183747, 8.31795853613873, 4.1521793870978785, 11.724562828107436, 5.310667658947012, 28.127030533644437, -15.857066036788714, -24.714720182335103, -16.700711690927164, -8.842464531397281, 16.16585645826599, 23.052834998887356, -7.279237764400811, 3.7383775261386076, 20.248270665861813, -1.7078561805556882, -15.15433530918597, -13.692407214626083, 10.304554521642128, -19.656241629689195, 2.2007100839804923, 6.751016683874732, -8.381640481076543, -5.021692576275787, 38.79408184150811, -0.0916400512417992, -9.578918469702298, -6.8550305423567774, 1.227272318824009, 39.69172863204692, -9.321821795796575, -7.746723131667551, 1.4947299032608048, 8.93175729837113, 37.709291064438176, 1.5964524714671486, 6.0736121055033, -2.701898223586776, -4.9357091695952136, 0.11634281194615727, -17.579149429198374, 5.158996733396363, -9.092970761082237, -1.0914431583608446, 10.196741158353825, -3.5756622470965107, -9.74634878773564, 33.17107070009879, -14.041139799306903, -7.742024588788199, -6.120810538330469, -19.17003337804591, 27.174460615473198, -0.881690382539416, -11.249652807884196, 2.895977652983498, -9.156443519559364, 7.976685497713716, -17.619547628357438, 21.799880662339444, 7.266878858076601, 2.5231257051696163, -4.593170299719813, -8.233566036071931, -11.47577827177739, 4.0696215338001664, 38.464871374572844, -10.250402877189794, 6.678705704227384, 8.078367627658954, 2.6911569599041694, -11.847787714425438, 8.218595494156315, -8.413834227159496, 10.690188303199031, 4.756722144175601, 0.612807836757318, 41.30539518966158, -6.421865219596659, 31.826390723846277, -7.869723354198905, -8.961642707977521]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2891500790223105, "mean_inference_ms": 0.8133130712275519, "mean_action_processing_ms": 0.13674487165681776, "mean_env_wait_ms": 2.508223798061563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002758502960205078, "StateBufferConnector_ms": 0.002663850784301758, "ViewRequirementAgentConnector_ms": 0.06559360027313232}, "num_episodes": 30, "episode_return_max": 99.93139518966166, "episode_return_min": 64.63695982586077, "episode_return_mean": 81.34076487573093, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 479137, "num_agent_steps_trained": 479137, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 93.91937349793984, "num_env_steps_trained_throughput_per_sec": 93.91937349793984, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 479137, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 479137, "timers": {"training_iteration_time_ms": 27974.396, "restore_workers_time_ms": 0.006, "training_step_time_ms": 27974.377, "sample_time_ms": 25956.567, "learn_time_ms": 2017.542, "learn_throughput": 1982.61, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 479137, "num_agent_steps_trained": 479137}, "done": false, "training_iteration": 40, "trial_id": "default", "date": "2025-10-13_04-33-58", "timestamp": 1760344438, "time_this_iter_s": 42.590346336364746, "time_total_s": 862.636260509491, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 862.636260509491, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 53.895, "ram_util_percent": 35.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.0879080034792423, "policy_loss": -0.013506415736628696, "vf_loss": 6.224198749661445, "vf_explained_var": 0.050116087310016155, "kl": 0.009331628904487991, "entropy": 10.688619881868362, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 1.4239114688502417, "policy_loss": -0.015841165165756902, "vf_loss": 2.897677637281872, "vf_explained_var": 0.7040027498252808, "kl": 0.008719517893491938, "entropy": 9.086184326050773, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25465.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 491137, "num_agent_steps_trained": 491137}, "env_runners": {"episode_reward_max": 99.93139518966166, "episode_reward_min": 64.63695982586077, "episode_reward_mean": 81.35710908269161, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 47.073959915212704, "hider_policy": -24.714720182335103}, "policy_reward_max": {"seeker_policy": 111.17607563631272, "hider_policy": 45.563903882218845}, "policy_reward_mean": {"seeker_policy": 78.07621001605303, "hider_policy": 1.6404495333192972}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.07201060220588, 77.92548532663102, 69.0731758212707, 89.07653659643016, 93.77659891055727, 93.63117718709057, 72.81768805983398, 82.61936510599031, 83.61585284005808, 70.9949793498639, 70.19297339386965, 86.3416666234029, 86.32956947422119, 73.0532223934262, 79.25458493759639, 89.22568996638434, 84.1901733482585, 68.79851439673492, 77.60623416581973, 77.19644750484318, 97.65273216490193, 89.36471606306246, 84.18134075425836, 75.97536869165151, 79.42430195922424, 89.03629600409953, 78.23721890945966, 79.01254404480615, 72.2152949489482, 78.76289765330304, 82.10872422889753, 84.79571204769304, 89.92303053364442, 65.1289339632113, 70.89353546860272, 88.38479234938993, 76.70749150442431, 85.3942706658618, 68.6834457526771, 84.45055452164213, 82.88920578146204, 70.12712819085124, 92.90008184150815, 75.26721013875091, 94.75772863204695, 75.01210061129103, 80.09775729837105, 94.27529106443808, 82.61961210550325, 80.37548725187808, 76.90499673339632, 83.35455684163915, 84.86162399891664, 91.65707070009873, 64.63695982586077, 72.36518946166952, 86.16046061547328, 80.51197765298345, 79.76268549771365, 86.56588066233944, 80.92287885807661, 73.74803598628652, 81.10562153380022, 93.09087137457287, 82.62470570422732, 79.99715695990405, 80.04459549415625, 82.18159890706774, 99.93139518966166, 92.66239072384633, 74.70209083450368, 67.17333492650823, 84.80166447534262, 70.17936007308118, 83.25292045917891, 85.95898472293894, 76.26543837487398, 74.49131169671828, 90.62628606958256, 81.12590359575138, 80.6975240395726, 92.23595684062805, 72.99215672982602, 72.42651764074061, 99.64990388221891, 76.62432845399704, 72.38393280319958, 74.89813421896253, 76.62263823253122, 83.8456516463276, 88.11432563931677, 92.0360181025203, 80.31532479369324, 81.33173139219106, 83.2435502782422, 91.47875153149089, 84.63468177989279, 80.79492505943024, 80.28613724544621, 69.98401885841342], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [57.44276722927807, 82.44142459546818, 90.38261170976651, 70.50312121334936, 64.8771251495572, 64.59356735015955, 95.64806454551237, 83.34745278622768, 87.08602404188223, 89.4293665285119, 81.49456998330669, 57.56917025107765, 70.06418889513576, 93.84090673239369, 89.83585005080013, 58.40653601545975, 83.92285449408955, 88.54821604125338, 61.7818914826027, 74.70020758976459, 52.71015226280572, 47.073959915212704, 88.6628497463554, 92.17735840311099, 81.43549166755517, 58.17209678784083, 69.18044690000647, 84.57582497605695, 71.5665551022999, 93.93892987853022, 55.10390427438417, 68.9189698324877, 56.48533234105299, 105.70072018233512, 96.43671169092718, 49.166100892236585, 80.24835174268651, 66.8538561805557, 97.53018827648914, 93.80224162968916, 73.93747901360679, 83.53046124820352, 54.197640051241805, 91.70115915080999, 53.838727681175996, 92.08064553875523, 69.67127009673918, 54.969547528532864, 79.24789822358673, 85.19485360952716, 89.32514942919836, 93.53897076108221, 78.2405450876594, 68.23234878773563, 86.42012421395592, 97.65603337804593, 59.86769038253943, 88.86565280788425, 80.94244351955935, 82.38554762835744, 71.13287429483039, 86.57477232207826, 88.51177827177739, 64.8764028771898, 67.86763237234105, 89.15378771442539, 80.23983422715948, 66.73468845969307, 58.01319216324269, 67.25786521959664, 91.53345689668014, 86.76738196800095, 82.28477671051489, 88.03277144984679, 100.50051777758193, 70.43278971069167, 84.20595714341174, 85.38507672557007, 65.42141387703764, 87.77726608129284, 79.96592018012898, 71.98459500855138, 80.17976869961659, 91.89423237637367, 67.11857597572686, 90.4937598373608, 99.33998651611007, 82.16447430793832, 81.80006362330408, 64.20815184973918, 73.92203305061989, 57.28232991881979, 81.12995595123378, 88.08447130534648, 111.17607563631272, 49.250481554343885, 73.07275724807157, 90.57326513565404, 88.49247802511186, 83.2832416355619], "policy_hider_policy_reward": [23.55601060220594, 4.0732327707219005, -1.480514673368943, -3.0354245954681676, -14.219148780502715, -7.090287107993029, 28.52053659643016, -9.947121213349337, -10.561125149557208, 39.46059891055722, -7.887567350159554, 36.925177187090625, -9.092064545512363, -13.738311940166017, 8.293365105990235, -9.021452786227663, -2.37002404188226, -1.100147159941823, -10.661020650136024, -7.773366528511911, 8.72250049692445, -20.024097086361508, 15.35221070893939, 13.42028566338586, -1.1381888951357089, 17.403569474221126, -5.582777606573809, -15.204906732393738, -9.60079649641399, -0.9804686167897396, -3.630536015459753, 34.4496899663844, -10.876854494089567, 11.14417334825849, -9.385113231236739, -10.364588413281751, 5.810234165819712, 10.014108517397306, 2.7457924102354485, -0.24955249515682598, 43.70673216490184, 1.235847737194262, 35.0687160630625, 7.222040084787293, 7.615340754258309, -12.096849746355407, -15.971358403110958, -0.2306313083484484, -4.869491667555188, 2.8583019592241734, -0.736096787840839, 31.600296004099548, 12.170498771864201, -3.1137267624109866, -8.969824976056966, 3.406544044806213, 12.518870044106846, -11.870130197458568, -0.27310234669688493, -14.902929878530232, 18.6868614183747, 8.31795853613873, 4.1521793870978785, 11.724562828107436, 5.310667658947012, 28.127030533644437, -15.857066036788714, -24.714720182335103, -16.700711690927164, -8.842464531397281, 16.16585645826599, 23.052834998887356, -7.279237764400811, 3.7383775261386076, 20.248270665861813, -1.7078561805556882, -15.15433530918597, -13.692407214626083, 10.304554521642128, -19.656241629689195, 2.2007100839804923, 6.751016683874732, -8.381640481076543, -5.021692576275787, 38.79408184150811, -0.0916400512417992, -9.578918469702298, -6.8550305423567774, 1.227272318824009, 39.69172863204692, -9.321821795796575, -7.746723131667551, 1.4947299032608048, 8.93175729837113, 37.709291064438176, 1.5964524714671486, 6.0736121055033, -2.701898223586776, -4.9357091695952136, 0.11634281194615727, -17.579149429198374, 5.158996733396363, -9.092970761082237, -1.0914431583608446, 10.196741158353825, -3.5756622470965107, -9.74634878773564, 33.17107070009879, -14.041139799306903, -7.742024588788199, -6.120810538330469, -19.17003337804591, 27.174460615473198, -0.881690382539416, -11.249652807884196, 2.895977652983498, -9.156443519559364, 7.976685497713716, -17.619547628357438, 21.799880662339444, 7.266878858076601, 2.5231257051696163, -4.593170299719813, -8.233566036071931, -11.47577827177739, 4.0696215338001664, 38.464871374572844, -10.250402877189794, 6.678705704227384, 8.078367627658954, 2.6911569599041694, -11.847787714425438, 8.218595494156315, -8.413834227159496, 10.690188303199031, 4.756722144175601, 0.612807836757318, 41.30539518966158, -6.421865219596659, 31.826390723846277, -7.869723354198905, -8.961642707977521, -12.018981942320456, -7.57506509917227, 0.5156644753426917, 2.0012232894850697, -9.972300325618354, -7.881111051147248, 0.47692045917895204, -17.724517777582015, 7.230071302505815, 8.296123709741435, -4.819262849980083, -3.121255918557698, -1.813344644646323, -9.0804203842055, 29.210286069582544, -4.005413877037653, -11.671266081292876, 5.019903595751374, -7.019920180128963, 7.751524039572653, -18.43859500855135, 38.68995684062794, -4.249746947534156, -2.9378650222564415, -3.7794823592593536, -15.688232376373687, 45.563903882218845, -13.032575975726841, -6.82167154600288, -7.047759837360837, -8.742067196800383, -18.213986516110136, -10.027357799994201, 2.761017711018394, 4.42663823253114, -9.604063623304103, 2.737848150260807, 16.899651646327595, 24.878325639316916, -10.686033050619912, -2.9863299188198087, 37.7400181025203, -6.83205131004395, 6.017420152503445, 0.5557313921910851, -7.308471305346465, -24.330075636312763, -3.602449721757838, 35.382751531490854, 6.84551844565611, -2.986757248071558, 14.548681779892734, 1.8289250594301918, -11.60726513565403, -1.4598627545537648, -6.746478025111883, -1.471981141586579, -11.827241635561894]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3146336731939123, "mean_inference_ms": 0.8167887344990783, "mean_action_processing_ms": 0.1369712725681747, "mean_env_wait_ms": 2.5489039232673965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027654170989990234, "StateBufferConnector_ms": 0.002789139747619629, "ViewRequirementAgentConnector_ms": 0.0656881332397461}, "num_episodes": 29, "episode_return_max": 99.93139518966166, "episode_return_min": 64.63695982586077, "episode_return_mean": 81.35710908269161, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 491137, "num_agent_steps_trained": 491137, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 142.1634863620477, "num_env_steps_trained_throughput_per_sec": 142.1634863620477, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 491137, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 491137, "timers": {"training_iteration_time_ms": 28441.792, "restore_workers_time_ms": 0.006, "training_step_time_ms": 28441.774, "sample_time_ms": 26408.944, "learn_time_ms": 2032.561, "learn_throughput": 1967.96, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 491137, "num_agent_steps_trained": 491137}, "done": false, "training_iteration": 41, "trial_id": "default", "date": "2025-10-13_04-34-26", "timestamp": 1760344466, "time_this_iter_s": 28.137259006500244, "time_total_s": 890.7735195159912, "pid": 47496, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16d890ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16d890c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 890.7735195159912, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 54.12682926829269, "ram_util_percent": 36.0780487804878}}
