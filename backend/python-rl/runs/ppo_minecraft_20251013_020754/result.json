{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.497980905336047, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.00030000000000000003, "total_loss": 2.8197518942848085, "policy_loss": -0.008000695145141984, "vf_loss": 5.8540995510797655, "vf_explained_var": 0.00018076253315759083, "kl": 0.0036193772149292476, "entropy": 10.00210848157368, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.07936507936508, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0003, "total_loss": 2.434731150045991, "policy_loss": -0.005508630073745735, "vf_loss": 5.078437188267708, "vf_explained_var": 0.08883562460541725, "kl": 0.004251612437900576, "entropy": 9.98291252553463, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 11943, "num_agent_steps_trained": 11943}, "env_runners": {"episode_reward_max": 238.79000000000028, "episode_reward_min": 155.9470000000001, "episode_reward_mean": 205.9023103448276, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 3915, "policy_reward_min": {"seeker_policy": 11.280000000000001, "hider_policy": 42.48699999999999}, "policy_reward_max": {"seeker_policy": 61.18000000000013, "hider_policy": 124.68000000000032}, "policy_reward_mean": {"seeker_policy": 43.007586206896576, "hider_policy": 81.44736206896555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [206.63999999999902, 201.23999999999907, 192.33999999999958, 191.68999999999963, 217.1400000000003, 228.83999999999975, 220.3899999999997, 155.9470000000001, 198.88999999999965, 207.2399999999997, 210.0899999999999, 230.89000000000058, 205.5400000000003, 198.34000000000034, 223.88999999999996, 199.69, 190.18999999999983, 209.14000000000007, 205.18999999999994, 238.79000000000028, 202.54000000000008, 193.64000000000004, 211.89000000000044, 222.99000000000055, 217.74000000000044, 211.3900000000003, 196.09000000000026, 189.79000000000025, 192.9900000000003], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [36.88000000000004, 45.28000000000006, 53.78000000000007, 59.380000000000045, 37.180000000000014, 19.679999999999996, 29.579999999999952, 37.88, 52.48000000000001, 44.58000000000005, 42.279999999999994, 24.27999999999998, 46.28000000000005, 49.18000000000007, 27.979999999999947, 50.180000000000064, 60.98000000000006, 43.08000000000001, 47.78000000000003, 11.280000000000001, 50.88000000000004, 51.98000000000005, 40.18000000000004, 28.679999999999968, 37.77999999999999, 42.88000000000005, 53.48000000000007, 61.18000000000013, 60.180000000000064], "policy_hider_policy_reward": [68.88000000000007, 100.87999999999988, 74.87999999999998, 81.07999999999996, 64.98000000000005, 73.58000000000006, 67.43, 64.88000000000012, 104.33000000000024, 75.63000000000007, 87.83000000000011, 121.32999999999973, 83.73000000000009, 107.07999999999984, 75.58000000000004, 42.48699999999999, 65.37999999999998, 81.02999999999984, 79.58000000000006, 83.08000000000001, 81.68000000000008, 86.12999999999985, 118.68000000000032, 87.93000000000013, 77.48000000000005, 81.7800000000001, 71.48000000000002, 77.68000000000006, 87.88000000000012, 108.02999999999977, 77.63000000000007, 71.88000000000001, 67.42999999999999, 61.78000000000008, 79.73000000000009, 86.32999999999981, 73.38000000000001, 84.02999999999989, 124.68000000000032, 102.8299999999999, 81.73000000000006, 69.93000000000004, 75.63000000000005, 66.03000000000002, 83.7800000000001, 87.93000000000013, 79.7300000000001, 114.58000000000028, 94.08000000000017, 85.88000000000011, 89.68000000000006, 78.82999999999991, 75.43, 67.17999999999998, 67.43, 61.17999999999998, 65.38000000000001, 67.43000000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4906105355184338, "mean_inference_ms": 0.79879525958583, "mean_action_processing_ms": 0.1284504079782972, "mean_env_wait_ms": 1.6898512989245367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025362804018217943, "StateBufferConnector_ms": 0.002146589344945447, "ViewRequirementAgentConnector_ms": 0.050829196798390354}, "num_episodes": 29, "episode_return_max": 238.79000000000028, "episode_return_min": 155.9470000000001, "episode_return_mean": 205.9023103448276, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11943, "num_agent_steps_trained": 11943, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.15042238225465, "num_env_steps_trained_throughput_per_sec": 218.15042238225465, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 11943, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 11943, "timers": {"training_iteration_time_ms": 18335.993, "restore_workers_time_ms": 0.011, "training_step_time_ms": 18335.946, "sample_time_ms": 16485.221, "learn_time_ms": 1850.505, "learn_throughput": 2161.572, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 11943, "num_agent_steps_trained": 11943}, "done": false, "training_iteration": 1, "trial_id": "default", "date": "2025-10-13_02-08-13", "timestamp": 1760335693, "time_this_iter_s": 18.33634305000305, "time_total_s": 18.33634305000305, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.33634305000305, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 32.81111111111111, "ram_util_percent": 34.592592592592595}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.00030000000000000003, "total_loss": 2.875990929300823, "policy_loss": -0.0073850133921951056, "vf_loss": 5.965808178886535, "vf_explained_var": 0.0532874395923009, "kl": 0.004141001274444091, "entropy": 9.994226003071619, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.15873015873017, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.0003, "total_loss": 2.404272462427616, "policy_loss": -0.012011823382636067, "vf_loss": 5.032477282732725, "vf_explained_var": 0.19075374025851488, "kl": 0.00498717080417138, "entropy": 10.045309260487556, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 23891, "num_agent_steps_trained": 23891}, "env_runners": {"episode_reward_max": 238.79000000000028, "episode_reward_min": 155.9470000000001, "episode_reward_mean": 207.43676271186456, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 7965, "policy_reward_min": {"seeker_policy": 11.280000000000001, "hider_policy": 41.58199999999999}, "policy_reward_max": {"seeker_policy": 68.47999999999996, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 42.63762711864409, "hider_policy": 82.39956779661024}, "custom_metrics": {}, "hist_stats": {"episode_reward": [206.63999999999902, 201.23999999999907, 192.33999999999958, 191.68999999999963, 217.1400000000003, 228.83999999999975, 220.3899999999997, 155.9470000000001, 198.88999999999965, 207.2399999999997, 210.0899999999999, 230.89000000000058, 205.5400000000003, 198.34000000000034, 223.88999999999996, 199.69, 190.18999999999983, 209.14000000000007, 205.18999999999994, 238.79000000000028, 202.54000000000008, 193.64000000000004, 211.89000000000044, 222.99000000000055, 217.74000000000044, 211.3900000000003, 196.09000000000026, 189.79000000000025, 192.9900000000003, 208.39000000000033, 208.1900000000002, 180.49000000000007, 237.99000000000066, 192.19000000000008, 225.7900000000004, 200.14000000000024, 229.19000000000034, 209.59000000000023, 199.49000000000032, 233.6900000000005, 223.94000000000042, 212.54000000000036, 214.74000000000044, 198.49000000000026, 217.94000000000045, 202.09000000000026, 206.64000000000033, 211.84000000000037, 156.69199999999998, 223.69000000000042, 206.54000000000028, 200.8400000000004, 224.54000000000048, 204.44000000000034, 216.0400000000004, 219.79000000000042, 196.39000000000024, 200.9900000000003, 204.29000000000036], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [36.88000000000004, 45.28000000000006, 53.78000000000007, 59.380000000000045, 37.180000000000014, 19.679999999999996, 29.579999999999952, 37.88, 52.48000000000001, 44.58000000000005, 42.279999999999994, 24.27999999999998, 46.28000000000005, 49.18000000000007, 27.979999999999947, 50.180000000000064, 60.98000000000006, 43.08000000000001, 47.78000000000003, 11.280000000000001, 50.88000000000004, 51.98000000000005, 40.18000000000004, 28.679999999999968, 37.77999999999999, 42.88000000000005, 53.48000000000007, 61.18000000000013, 60.180000000000064, 38.98000000000002, 45.380000000000045, 68.47999999999996, 19.08000000000003, 57.980000000000075, 30.17999999999998, 51.680000000000064, 23.279999999999998, 40.28000000000004, 54.78000000000008, 23.179999999999993, 32.07999999999995, 42.87999999999999, 38.88, 53.480000000000054, 33.97999999999993, 49.08000000000006, 47.68000000000002, 40.08000000000005, 39.980000000000025, 29.679999999999954, 45.28000000000003, 53.78000000000004, 30.479999999999933, 51.280000000000044, 36.38000000000002, 33.77999999999997, 57.48000000000005, 51.88000000000005, 46.98000000000004], "policy_hider_policy_reward": [68.88000000000007, 100.87999999999988, 74.87999999999998, 81.07999999999996, 64.98000000000005, 73.58000000000006, 67.43, 64.88000000000012, 104.33000000000024, 75.63000000000007, 87.83000000000011, 121.32999999999973, 83.73000000000009, 107.07999999999984, 75.58000000000004, 42.48699999999999, 65.37999999999998, 81.02999999999984, 79.58000000000006, 83.08000000000001, 81.68000000000008, 86.12999999999985, 118.68000000000032, 87.93000000000013, 77.48000000000005, 81.7800000000001, 71.48000000000002, 77.68000000000006, 87.88000000000012, 108.02999999999977, 77.63000000000007, 71.88000000000001, 67.42999999999999, 61.78000000000008, 79.73000000000009, 86.32999999999981, 73.38000000000001, 84.02999999999989, 124.68000000000032, 102.8299999999999, 81.73000000000006, 69.93000000000004, 75.63000000000005, 66.03000000000002, 83.7800000000001, 87.93000000000013, 79.7300000000001, 114.58000000000028, 94.08000000000017, 85.88000000000011, 89.68000000000006, 78.82999999999991, 75.43, 67.17999999999998, 67.43, 61.17999999999998, 65.38000000000001, 67.43000000000002, 75.43000000000002, 93.98000000000016, 83.38000000000002, 79.43, 57.18000000000001, 54.83000000000002, 124.83000000000035, 94.08000000000017, 67.02999999999993, 67.17999999999998, 79.33000000000001, 116.28000000000023, 64.88000000000001, 83.58000000000006, 85.43000000000004, 120.48000000000027, 81.58000000000006, 87.73000000000009, 79.53000000000004, 65.17999999999998, 120.53000000000029, 89.98000000000015, 112.33000000000023, 79.53000000000004, 85.83000000000011, 83.83000000000011, 89.98000000000015, 85.88000000000014, 81.68000000000009, 63.32999999999996, 104.23000000000022, 79.73000000000008, 83.8300000000001, 69.17999999999998, 85.68000000000008, 73.27999999999999, 83.83000000000011, 87.93000000000013, 41.58199999999999, 75.12999999999995, 69.27999999999996, 124.73000000000033, 73.33000000000001, 87.93000000000015, 79.63000000000005, 67.43, 95.98000000000015, 98.08000000000017, 63.23000000000002, 89.93000000000012, 98.03000000000017, 81.63000000000005, 61.23, 124.78000000000034, 61.28, 77.63000000000007, 59.23000000000001, 89.88000000000014, 81.7800000000001, 75.53000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4298743229467195, "mean_inference_ms": 0.8006859865127256, "mean_action_processing_ms": 0.13028113926606213, "mean_env_wait_ms": 1.6930542857822557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024353043507721463, "StateBufferConnector_ms": 0.0021554655947927702, "ViewRequirementAgentConnector_ms": 0.05098359059479277}, "num_episodes": 30, "episode_return_max": 238.79000000000028, "episode_return_min": 155.9470000000001, "episode_return_mean": 207.43676271186456, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23891, "num_agent_steps_trained": 23891, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.7428175031957, "num_env_steps_trained_throughput_per_sec": 226.7428175031957, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 23891, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 23891, "timers": {"training_iteration_time_ms": 17988.565, "restore_workers_time_ms": 0.01, "training_step_time_ms": 17988.528, "sample_time_ms": 16059.683, "learn_time_ms": 1928.587, "learn_throughput": 2074.058, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 23891, "num_agent_steps_trained": 23891}, "done": false, "training_iteration": 2, "trial_id": "default", "date": "2025-10-13_02-08-31", "timestamp": 1760335711, "time_this_iter_s": 17.64153289794922, "time_total_s": 35.97787594795227, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.97787594795227, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 40.88399999999999, "ram_util_percent": 35.064}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 2.936465569147988, "policy_loss": -0.011166419055948536, "vf_loss": 6.096762869850037, "vf_explained_var": 0.06063447774402679, "kl": 0.006869277963588757, "entropy": 10.109290831429618, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.306515922769904, "policy_loss": -0.013212701879092492, "vf_loss": 4.839673564583063, "vf_explained_var": 0.11359084099531173, "kl": 0.0067624960748162415, "entropy": 10.044628819823265, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 800.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 35891, "num_agent_steps_trained": 35891}, "env_runners": {"episode_reward_max": 244.6900000000006, "episode_reward_min": 155.9470000000001, "episode_reward_mean": 208.14862500000024, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 11880, "policy_reward_min": {"seeker_policy": 9.980000000000008, "hider_policy": 41.58199999999999}, "policy_reward_max": {"seeker_policy": 68.47999999999996, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 42.68568181818184, "hider_policy": 82.73147159090917}, "custom_metrics": {}, "hist_stats": {"episode_reward": [206.63999999999902, 201.23999999999907, 192.33999999999958, 191.68999999999963, 217.1400000000003, 228.83999999999975, 220.3899999999997, 155.9470000000001, 198.88999999999965, 207.2399999999997, 210.0899999999999, 230.89000000000058, 205.5400000000003, 198.34000000000034, 223.88999999999996, 199.69, 190.18999999999983, 209.14000000000007, 205.18999999999994, 238.79000000000028, 202.54000000000008, 193.64000000000004, 211.89000000000044, 222.99000000000055, 217.74000000000044, 211.3900000000003, 196.09000000000026, 189.79000000000025, 192.9900000000003, 208.39000000000033, 208.1900000000002, 180.49000000000007, 237.99000000000066, 192.19000000000008, 225.7900000000004, 200.14000000000024, 229.19000000000034, 209.59000000000023, 199.49000000000032, 233.6900000000005, 223.94000000000042, 212.54000000000036, 214.74000000000044, 198.49000000000026, 217.94000000000045, 202.09000000000026, 206.64000000000033, 211.84000000000037, 156.69199999999998, 223.69000000000042, 206.54000000000028, 200.8400000000004, 224.54000000000048, 204.44000000000034, 216.0400000000004, 219.79000000000042, 196.39000000000024, 200.9900000000003, 204.29000000000036, 201.34000000000034, 223.19000000000034, 228.54000000000042, 201.6900000000003, 188.04000000000008, 205.44000000000014, 244.6900000000006, 207.59000000000026, 204.44000000000037, 202.1400000000003, 220.64000000000033, 219.09000000000032, 212.7900000000004, 213.79000000000045, 212.04000000000042, 196.3400000000001, 223.69000000000037, 213.69000000000034, 203.7900000000003, 200.79000000000028, 207.29000000000033, 204.04000000000036, 208.79000000000028, 210.89000000000036, 208.79000000000025, 205.74000000000038, 206.89000000000036, 194.69000000000017, 207.44000000000025], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [36.88000000000004, 45.28000000000006, 53.78000000000007, 59.380000000000045, 37.180000000000014, 19.679999999999996, 29.579999999999952, 37.88, 52.48000000000001, 44.58000000000005, 42.279999999999994, 24.27999999999998, 46.28000000000005, 49.18000000000007, 27.979999999999947, 50.180000000000064, 60.98000000000006, 43.08000000000001, 47.78000000000003, 11.280000000000001, 50.88000000000004, 51.98000000000005, 40.18000000000004, 28.679999999999968, 37.77999999999999, 42.88000000000005, 53.48000000000007, 61.18000000000013, 60.180000000000064, 38.98000000000002, 45.380000000000045, 68.47999999999996, 19.08000000000003, 57.980000000000075, 30.17999999999998, 51.680000000000064, 23.279999999999998, 40.28000000000004, 54.78000000000008, 23.179999999999993, 32.07999999999995, 42.87999999999999, 38.88, 53.480000000000054, 33.97999999999993, 49.08000000000006, 47.68000000000002, 40.08000000000005, 39.980000000000025, 29.679999999999954, 45.28000000000003, 53.78000000000004, 30.479999999999933, 51.280000000000044, 36.38000000000002, 33.77999999999997, 57.48000000000005, 51.88000000000005, 46.98000000000004, 52.18000000000006, 29.679999999999957, 24.379999999999967, 48.780000000000086, 63.88000000000005, 48.58000000000001, 9.980000000000008, 42.38, 49.08000000000005, 51.08000000000007, 26.979999999999972, 31.479999999999936, 37.28000000000002, 40.28000000000004, 36.18000000000003, 56.08000000000005, 30.079999999999945, 40.180000000000014, 48.58, 51.88000000000003, 45.88000000000001, 46.68000000000002, 45.48000000000002, 43.48, 45.48000000000001, 48.680000000000035, 45.780000000000086, 53.880000000000045, 46.38], "policy_hider_policy_reward": [68.88000000000007, 100.87999999999988, 74.87999999999998, 81.07999999999996, 64.98000000000005, 73.58000000000006, 67.43, 64.88000000000012, 104.33000000000024, 75.63000000000007, 87.83000000000011, 121.32999999999973, 83.73000000000009, 107.07999999999984, 75.58000000000004, 42.48699999999999, 65.37999999999998, 81.02999999999984, 79.58000000000006, 83.08000000000001, 81.68000000000008, 86.12999999999985, 118.68000000000032, 87.93000000000013, 77.48000000000005, 81.7800000000001, 71.48000000000002, 77.68000000000006, 87.88000000000012, 108.02999999999977, 77.63000000000007, 71.88000000000001, 67.42999999999999, 61.78000000000008, 79.73000000000009, 86.32999999999981, 73.38000000000001, 84.02999999999989, 124.68000000000032, 102.8299999999999, 81.73000000000006, 69.93000000000004, 75.63000000000005, 66.03000000000002, 83.7800000000001, 87.93000000000013, 79.7300000000001, 114.58000000000028, 94.08000000000017, 85.88000000000011, 89.68000000000006, 78.82999999999991, 75.43, 67.17999999999998, 67.43, 61.17999999999998, 65.38000000000001, 67.43000000000002, 75.43000000000002, 93.98000000000016, 83.38000000000002, 79.43, 57.18000000000001, 54.83000000000002, 124.83000000000035, 94.08000000000017, 67.02999999999993, 67.17999999999998, 79.33000000000001, 116.28000000000023, 64.88000000000001, 83.58000000000006, 85.43000000000004, 120.48000000000027, 81.58000000000006, 87.73000000000009, 79.53000000000004, 65.17999999999998, 120.53000000000029, 89.98000000000015, 112.33000000000023, 79.53000000000004, 85.83000000000011, 83.83000000000011, 89.98000000000015, 85.88000000000014, 81.68000000000009, 63.32999999999996, 104.23000000000022, 79.73000000000008, 83.8300000000001, 69.17999999999998, 85.68000000000008, 73.27999999999999, 83.83000000000011, 87.93000000000013, 41.58199999999999, 75.12999999999995, 69.27999999999996, 124.73000000000033, 73.33000000000001, 87.93000000000015, 79.63000000000005, 67.43, 95.98000000000015, 98.08000000000017, 63.23000000000002, 89.93000000000012, 98.03000000000017, 81.63000000000005, 61.23, 124.78000000000034, 61.28, 77.63000000000007, 59.23000000000001, 89.88000000000014, 81.7800000000001, 75.53000000000004, 83.83000000000011, 65.33, 118.1800000000002, 75.32999999999998, 79.33, 124.83000000000035, 75.63000000000008, 77.27999999999997, 64.93, 59.23000000000002, 91.68000000000009, 65.17999999999998, 124.53000000000029, 110.1800000000002, 79.63000000000007, 85.58000000000006, 75.63000000000007, 79.73000000000009, 69.27999999999997, 81.78000000000009, 69.28, 124.38000000000025, 95.88000000000012, 91.73000000000009, 106.38000000000024, 69.12999999999995, 99.93000000000013, 73.58000000000006, 85.88000000000014, 89.98000000000016, 75.38, 64.88000000000002, 85.73000000000009, 107.88000000000012, 89.73000000000009, 83.7800000000001, 79.58000000000006, 75.63000000000007, 81.63000000000005, 67.27999999999997, 73.48000000000003, 87.93000000000013, 61.23, 96.1300000000002, 79.73000000000008, 83.58000000000006, 89.98000000000015, 77.43000000000002, 85.88000000000012, 77.43000000000002, 73.48000000000002, 83.58000000000004, 85.8300000000001, 75.27999999999997, 75.63000000000008, 65.18, 85.68000000000009, 75.38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.377961759464078, "mean_inference_ms": 0.8067131626682623, "mean_action_processing_ms": 0.13169122530852423, "mean_env_wait_ms": 1.7020540255301178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024916096167130904, "StateBufferConnector_ms": 0.002176111394708807, "ViewRequirementAgentConnector_ms": 0.05217316475781528}, "num_episodes": 29, "episode_return_max": 244.6900000000006, "episode_return_min": 155.9470000000001, "episode_return_mean": 208.14862500000024, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35891, "num_agent_steps_trained": 35891, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 229.99303627833314, "num_env_steps_trained_throughput_per_sec": 229.99303627833314, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 35891, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 35891, "timers": {"training_iteration_time_ms": 17789.656, "restore_workers_time_ms": 0.009, "training_step_time_ms": 17789.624, "sample_time_ms": 15838.739, "learn_time_ms": 1950.63, "learn_throughput": 2050.62, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 35891, "num_agent_steps_trained": 35891}, "done": false, "training_iteration": 3, "trial_id": "default", "date": "2025-10-13_02-08-48", "timestamp": 1760335728, "time_this_iter_s": 17.39233899116516, "time_total_s": 53.37021493911743, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 53.37021493911743, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 47.225, "ram_util_percent": 35.479166666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 3.053922586970859, "policy_loss": -0.012538859917457023, "vf_loss": 6.336229654342409, "vf_explained_var": 0.0882570847632393, "kl": 0.006878816327428347, "entropy": 10.199734145875961, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2205.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.670902778208256, "policy_loss": -0.01598976304376265, "vf_loss": 5.573962553590536, "vf_explained_var": 0.18869324512779712, "kl": 0.008203781134885471, "entropy": 10.049893298745156, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1120.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 47891, "num_agent_steps_trained": 47891}, "env_runners": {"episode_reward_max": 244.6900000000006, "episode_reward_min": 156.69199999999998, "episode_reward_mean": 208.58202000000026, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 9.980000000000008, "hider_policy": 41.58199999999999}, "policy_reward_max": {"seeker_policy": 73.37999999999997, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 43.36000000000003, "hider_policy": 82.61101000000008}, "custom_metrics": {}, "hist_stats": {"episode_reward": [205.18999999999994, 238.79000000000028, 202.54000000000008, 193.64000000000004, 211.89000000000044, 222.99000000000055, 217.74000000000044, 211.3900000000003, 196.09000000000026, 189.79000000000025, 192.9900000000003, 208.39000000000033, 208.1900000000002, 180.49000000000007, 237.99000000000066, 192.19000000000008, 225.7900000000004, 200.14000000000024, 229.19000000000034, 209.59000000000023, 199.49000000000032, 233.6900000000005, 223.94000000000042, 212.54000000000036, 214.74000000000044, 198.49000000000026, 217.94000000000045, 202.09000000000026, 206.64000000000033, 211.84000000000037, 156.69199999999998, 223.69000000000042, 206.54000000000028, 200.8400000000004, 224.54000000000048, 204.44000000000034, 216.0400000000004, 219.79000000000042, 196.39000000000024, 200.9900000000003, 204.29000000000036, 201.34000000000034, 223.19000000000034, 228.54000000000042, 201.6900000000003, 188.04000000000008, 205.44000000000014, 244.6900000000006, 207.59000000000026, 204.44000000000037, 202.1400000000003, 220.64000000000033, 219.09000000000032, 212.7900000000004, 213.79000000000045, 212.04000000000042, 196.3400000000001, 223.69000000000037, 213.69000000000034, 203.7900000000003, 200.79000000000028, 207.29000000000033, 204.04000000000036, 208.79000000000028, 210.89000000000036, 208.79000000000025, 205.74000000000038, 206.89000000000036, 194.69000000000017, 207.44000000000025, 217.24000000000026, 198.19000000000014, 199.14000000000013, 197.54000000000016, 224.8400000000004, 231.04000000000048, 204.74000000000018, 218.34000000000026, 198.8900000000002, 203.99000000000026, 218.64000000000033, 227.54000000000042, 185.49000000000018, 211.5400000000004, 209.49000000000026, 213.49000000000038, 207.14000000000044, 200.99000000000032, 207.4400000000004, 179.49000000000015, 198.64000000000033, 196.5400000000002, 226.39000000000038, 219.3400000000005, 241.7400000000006, 196.9400000000003, 202.4900000000003, 193.14000000000027, 179.8900000000002, 218.94000000000045], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [47.78000000000003, 11.280000000000001, 50.88000000000004, 51.98000000000005, 40.18000000000004, 28.679999999999968, 37.77999999999999, 42.88000000000005, 53.48000000000007, 61.18000000000013, 60.180000000000064, 38.98000000000002, 45.380000000000045, 68.47999999999996, 19.08000000000003, 57.980000000000075, 30.17999999999998, 51.680000000000064, 23.279999999999998, 40.28000000000004, 54.78000000000008, 23.179999999999993, 32.07999999999995, 42.87999999999999, 38.88, 53.480000000000054, 33.97999999999993, 49.08000000000006, 47.68000000000002, 40.08000000000005, 39.980000000000025, 29.679999999999954, 45.28000000000003, 53.78000000000004, 30.479999999999933, 51.280000000000044, 36.38000000000002, 33.77999999999997, 57.48000000000005, 51.88000000000005, 46.98000000000004, 52.18000000000006, 29.679999999999957, 24.379999999999967, 48.780000000000086, 63.88000000000005, 48.58000000000001, 9.980000000000008, 42.38, 49.08000000000005, 51.08000000000007, 26.979999999999972, 31.479999999999936, 37.28000000000002, 40.28000000000004, 36.18000000000003, 56.08000000000005, 30.079999999999945, 40.180000000000014, 48.58, 51.88000000000003, 45.88000000000001, 46.68000000000002, 45.48000000000002, 43.48, 45.48000000000001, 48.680000000000035, 45.780000000000086, 53.880000000000045, 46.38, 35.78, 53.880000000000045, 52.68000000000005, 51.18000000000007, 22.98000000000001, 22.879999999999985, 47.98000000000003, 34.77999999999998, 54.18000000000004, 49.28000000000003, 34.97999999999998, 21.679999999999964, 63.580000000000126, 40.080000000000055, 42.38000000000003, 38.080000000000005, 45.980000000000054, 51.87999999999998, 46.080000000000034, 73.37999999999997, 55.58000000000005, 54.1800000000001, 26.57999999999995, 33.580000000000005, 14.980000000000043, 57.98000000000004, 49.18000000000002, 58.28000000000007, 71.68000000000005, 34.87999999999995], "policy_hider_policy_reward": [73.38000000000001, 84.02999999999989, 124.68000000000032, 102.8299999999999, 81.73000000000006, 69.93000000000004, 75.63000000000005, 66.03000000000002, 83.7800000000001, 87.93000000000013, 79.7300000000001, 114.58000000000028, 94.08000000000017, 85.88000000000011, 89.68000000000006, 78.82999999999991, 75.43, 67.17999999999998, 67.43, 61.17999999999998, 65.38000000000001, 67.43000000000002, 75.43000000000002, 93.98000000000016, 83.38000000000002, 79.43, 57.18000000000001, 54.83000000000002, 124.83000000000035, 94.08000000000017, 67.02999999999993, 67.17999999999998, 79.33000000000001, 116.28000000000023, 64.88000000000001, 83.58000000000006, 85.43000000000004, 120.48000000000027, 81.58000000000006, 87.73000000000009, 79.53000000000004, 65.17999999999998, 120.53000000000029, 89.98000000000015, 112.33000000000023, 79.53000000000004, 85.83000000000011, 83.83000000000011, 89.98000000000015, 85.88000000000014, 81.68000000000009, 63.32999999999996, 104.23000000000022, 79.73000000000008, 83.8300000000001, 69.17999999999998, 85.68000000000008, 73.27999999999999, 83.83000000000011, 87.93000000000013, 41.58199999999999, 75.12999999999995, 69.27999999999996, 124.73000000000033, 73.33000000000001, 87.93000000000015, 79.63000000000005, 67.43, 95.98000000000015, 98.08000000000017, 63.23000000000002, 89.93000000000012, 98.03000000000017, 81.63000000000005, 61.23, 124.78000000000034, 61.28, 77.63000000000007, 59.23000000000001, 89.88000000000014, 81.7800000000001, 75.53000000000004, 83.83000000000011, 65.33, 118.1800000000002, 75.32999999999998, 79.33, 124.83000000000035, 75.63000000000008, 77.27999999999997, 64.93, 59.23000000000002, 91.68000000000009, 65.17999999999998, 124.53000000000029, 110.1800000000002, 79.63000000000007, 85.58000000000006, 75.63000000000007, 79.73000000000009, 69.27999999999997, 81.78000000000009, 69.28, 124.38000000000025, 95.88000000000012, 91.73000000000009, 106.38000000000024, 69.12999999999995, 99.93000000000013, 73.58000000000006, 85.88000000000014, 89.98000000000016, 75.38, 64.88000000000002, 85.73000000000009, 107.88000000000012, 89.73000000000009, 83.7800000000001, 79.58000000000006, 75.63000000000007, 81.63000000000005, 67.27999999999997, 73.48000000000003, 87.93000000000013, 61.23, 96.1300000000002, 79.73000000000008, 83.58000000000006, 89.98000000000015, 77.43000000000002, 85.88000000000012, 77.43000000000002, 73.48000000000002, 83.58000000000004, 85.8300000000001, 75.27999999999997, 75.63000000000008, 65.18, 85.68000000000009, 75.38, 112.33000000000024, 69.12999999999997, 79.38000000000002, 64.93000000000002, 93.78000000000011, 52.67999999999999, 71.17999999999995, 75.17999999999995, 91.73000000000009, 110.1300000000002, 114.5800000000003, 93.58000000000006, 73.38, 83.38000000000001, 83.58000000000004, 99.98000000000016, 67.43000000000002, 77.27999999999999, 79.48000000000003, 75.22999999999996, 116.63000000000031, 67.03, 81.48000000000002, 124.38000000000025, 58.879999999999995, 63.030000000000015, 93.78000000000009, 77.68000000000009, 83.58000000000006, 83.53000000000004, 83.63000000000008, 91.78000000000009, 89.88000000000012, 71.27999999999997, 79.63000000000007, 69.48000000000003, 87.7800000000001, 73.58000000000006, 57.13, 48.97999999999997, 75.63000000000005, 67.43, 69.33, 73.02999999999992, 122.63000000000031, 77.17999999999994, 73.58000000000006, 112.1800000000002, 124.83000000000035, 101.93000000000013, 87.93000000000013, 51.03, 63.330000000000005, 89.98000000000016, 67.43, 67.43000000000002, 53.080000000000005, 55.129999999999995, 112.53000000000029, 71.53000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.359503895973412, "mean_inference_ms": 0.8140990634261434, "mean_action_processing_ms": 0.13332561580321445, "mean_env_wait_ms": 1.7149416784050708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025873184204101562, "StateBufferConnector_ms": 0.002232670783996582, "ViewRequirementAgentConnector_ms": 0.05450129508972168}, "num_episodes": 30, "episode_return_max": 244.6900000000006, "episode_return_min": 156.69199999999998, "episode_return_mean": 208.58202000000026, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47891, "num_agent_steps_trained": 47891, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 200.34692279471534, "num_env_steps_trained_throughput_per_sec": 200.34692279471534, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 47891, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 47891, "timers": {"training_iteration_time_ms": 18333.587, "restore_workers_time_ms": 0.014, "training_step_time_ms": 18333.548, "sample_time_ms": 16387.998, "learn_time_ms": 1945.312, "learn_throughput": 2056.226, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 47891, "num_agent_steps_trained": 47891}, "done": false, "training_iteration": 4, "trial_id": "default", "date": "2025-10-13_02-09-08", "timestamp": 1760335748, "time_this_iter_s": 19.965904712677002, "time_total_s": 73.33611965179443, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 73.33611965179443, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 43.21724137931034, "ram_util_percent": 35.87931034482759}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 2.9600244718884663, "policy_loss": -0.008321114197846443, "vf_loss": 6.14279912918333, "vf_explained_var": -0.020261813250799027, "kl": 0.008184398176650762, "entropy": 10.346318599155971, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.460518418252468, "policy_loss": -0.01475393778673606, "vf_loss": 5.152829977869987, "vf_explained_var": -0.004323399066925049, "kl": 0.010039568591619771, "entropy": 10.164459615945816, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 59891, "num_agent_steps_trained": 59891}, "env_runners": {"episode_reward_max": 244.6900000000006, "episode_reward_min": 156.69199999999998, "episode_reward_mean": 207.81302000000036, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 9.980000000000008, "hider_policy": 41.58199999999999}, "policy_reward_max": {"seeker_policy": 73.37999999999997, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 44.32500000000002, "hider_policy": 81.74401000000007}, "custom_metrics": {}, "hist_stats": {"episode_reward": [156.69199999999998, 223.69000000000042, 206.54000000000028, 200.8400000000004, 224.54000000000048, 204.44000000000034, 216.0400000000004, 219.79000000000042, 196.39000000000024, 200.9900000000003, 204.29000000000036, 201.34000000000034, 223.19000000000034, 228.54000000000042, 201.6900000000003, 188.04000000000008, 205.44000000000014, 244.6900000000006, 207.59000000000026, 204.44000000000037, 202.1400000000003, 220.64000000000033, 219.09000000000032, 212.7900000000004, 213.79000000000045, 212.04000000000042, 196.3400000000001, 223.69000000000037, 213.69000000000034, 203.7900000000003, 200.79000000000028, 207.29000000000033, 204.04000000000036, 208.79000000000028, 210.89000000000036, 208.79000000000025, 205.74000000000038, 206.89000000000036, 194.69000000000017, 207.44000000000025, 217.24000000000026, 198.19000000000014, 199.14000000000013, 197.54000000000016, 224.8400000000004, 231.04000000000048, 204.74000000000018, 218.34000000000026, 198.8900000000002, 203.99000000000026, 218.64000000000033, 227.54000000000042, 185.49000000000018, 211.5400000000004, 209.49000000000026, 213.49000000000038, 207.14000000000044, 200.99000000000032, 207.4400000000004, 179.49000000000015, 198.64000000000033, 196.5400000000002, 226.39000000000038, 219.3400000000005, 241.7400000000006, 196.9400000000003, 202.4900000000003, 193.14000000000027, 179.8900000000002, 218.94000000000045, 184.6400000000001, 197.29000000000036, 211.49000000000044, 204.09000000000023, 204.09000000000037, 198.39000000000047, 232.3400000000006, 194.14000000000016, 200.9400000000003, 207.74000000000032, 207.09000000000032, 211.29000000000048, 200.19000000000034, 194.39000000000033, 211.54000000000045, 205.74000000000035, 196.04000000000028, 219.6900000000005, 201.54000000000033, 207.44000000000034, 215.69000000000045, 223.04000000000048, 221.09000000000052, 200.59000000000037, 206.69000000000037, 205.1900000000004, 211.74000000000032, 227.79000000000053, 213.04000000000048, 204.54000000000045], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [39.980000000000025, 29.679999999999954, 45.28000000000003, 53.78000000000004, 30.479999999999933, 51.280000000000044, 36.38000000000002, 33.77999999999997, 57.48000000000005, 51.88000000000005, 46.98000000000004, 52.18000000000006, 29.679999999999957, 24.379999999999967, 48.780000000000086, 63.88000000000005, 48.58000000000001, 9.980000000000008, 42.38, 49.08000000000005, 51.08000000000007, 26.979999999999972, 31.479999999999936, 37.28000000000002, 40.28000000000004, 36.18000000000003, 56.08000000000005, 30.079999999999945, 40.180000000000014, 48.58, 51.88000000000003, 45.88000000000001, 46.68000000000002, 45.48000000000002, 43.48, 45.48000000000001, 48.680000000000035, 45.780000000000086, 53.880000000000045, 46.38, 35.78, 53.880000000000045, 52.68000000000005, 51.18000000000007, 22.98000000000001, 22.879999999999985, 47.98000000000003, 34.77999999999998, 54.18000000000004, 49.28000000000003, 34.97999999999998, 21.679999999999964, 63.580000000000126, 40.080000000000055, 42.38000000000003, 38.080000000000005, 45.980000000000054, 51.87999999999998, 46.080000000000034, 73.37999999999997, 55.58000000000005, 54.1800000000001, 26.57999999999995, 33.580000000000005, 14.980000000000043, 57.98000000000004, 49.18000000000002, 58.28000000000007, 71.68000000000005, 34.87999999999995, 66.18000000000009, 56.28000000000005, 41.77999999999999, 50.77999999999997, 46.68000000000008, 53.28000000000008, 23.679999999999964, 59.28000000000006, 53.78000000000004, 44.18, 45.58000000000001, 41.58000000000003, 55.08000000000005, 61.58000000000006, 39.77999999999999, 46.2800000000001, 57.08000000000008, 33.57999999999996, 50.28000000000011, 43.88000000000004, 37.77999999999998, 30.779999999999937, 34.979999999999976, 51.38000000000006, 45.180000000000014, 47.780000000000065, 39.979999999999954, 25.279999999999948, 41.280000000000044, 49.18000000000005], "policy_hider_policy_reward": [41.58199999999999, 75.12999999999995, 69.27999999999996, 124.73000000000033, 73.33000000000001, 87.93000000000015, 79.63000000000005, 67.43, 95.98000000000015, 98.08000000000017, 63.23000000000002, 89.93000000000012, 98.03000000000017, 81.63000000000005, 61.23, 124.78000000000034, 61.28, 77.63000000000007, 59.23000000000001, 89.88000000000014, 81.7800000000001, 75.53000000000004, 83.83000000000011, 65.33, 118.1800000000002, 75.32999999999998, 79.33, 124.83000000000035, 75.63000000000008, 77.27999999999997, 64.93, 59.23000000000002, 91.68000000000009, 65.17999999999998, 124.53000000000029, 110.1800000000002, 79.63000000000007, 85.58000000000006, 75.63000000000007, 79.73000000000009, 69.27999999999997, 81.78000000000009, 69.28, 124.38000000000025, 95.88000000000012, 91.73000000000009, 106.38000000000024, 69.12999999999995, 99.93000000000013, 73.58000000000006, 85.88000000000014, 89.98000000000016, 75.38, 64.88000000000002, 85.73000000000009, 107.88000000000012, 89.73000000000009, 83.7800000000001, 79.58000000000006, 75.63000000000007, 81.63000000000005, 67.27999999999997, 73.48000000000003, 87.93000000000013, 61.23, 96.1300000000002, 79.73000000000008, 83.58000000000006, 89.98000000000015, 77.43000000000002, 85.88000000000012, 77.43000000000002, 73.48000000000002, 83.58000000000004, 85.8300000000001, 75.27999999999997, 75.63000000000008, 65.18, 85.68000000000009, 75.38, 112.33000000000024, 69.12999999999997, 79.38000000000002, 64.93000000000002, 93.78000000000011, 52.67999999999999, 71.17999999999995, 75.17999999999995, 91.73000000000009, 110.1300000000002, 114.5800000000003, 93.58000000000006, 73.38, 83.38000000000001, 83.58000000000004, 99.98000000000016, 67.43000000000002, 77.27999999999999, 79.48000000000003, 75.22999999999996, 116.63000000000031, 67.03, 81.48000000000002, 124.38000000000025, 58.879999999999995, 63.030000000000015, 93.78000000000009, 77.68000000000009, 83.58000000000006, 83.53000000000004, 83.63000000000008, 91.78000000000009, 89.88000000000012, 71.27999999999997, 79.63000000000007, 69.48000000000003, 87.7800000000001, 73.58000000000006, 57.13, 48.97999999999997, 75.63000000000005, 67.43, 69.33, 73.02999999999992, 122.63000000000031, 77.17999999999994, 73.58000000000006, 112.1800000000002, 124.83000000000035, 101.93000000000013, 87.93000000000013, 51.03, 63.330000000000005, 89.98000000000016, 67.43, 67.43000000000002, 53.080000000000005, 55.129999999999995, 112.53000000000029, 71.53000000000004, 51.02999999999999, 67.43, 73.58000000000006, 67.43, 106.38000000000024, 63.33000000000001, 79.73000000000008, 73.58000000000004, 65.38, 92.03000000000014, 67.43, 77.68000000000006, 102.28000000000021, 106.38000000000024, 71.53000000000006, 63.33000000000001, 61.279999999999966, 85.88000000000011, 75.63000000000005, 87.93000000000013, 77.68000000000008, 83.83000000000013, 75.63000000000007, 94.08000000000017, 77.68000000000008, 67.43, 61.280000000000015, 71.53000000000004, 83.83000000000011, 87.93000000000013, 83.8300000000001, 75.63000000000005, 71.53000000000003, 67.43000000000002, 116.63000000000031, 69.48000000000003, 71.53000000000004, 79.73000000000009, 79.7300000000001, 83.83000000000013, 75.63000000000005, 102.28000000000021, 102.28000000000021, 89.98000000000016, 106.38000000000024, 79.7300000000001, 75.63000000000007, 73.58000000000004, 81.78000000000011, 79.73000000000009, 85.88000000000012, 71.53000000000004, 77.68000000000008, 94.08000000000018, 77.68000000000006, 124.83000000000035, 89.98000000000013, 81.7800000000001, 71.53000000000003, 83.83000000000011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.528221695631022, "mean_inference_ms": 0.8308223387333683, "mean_action_processing_ms": 0.13641470785915558, "mean_env_wait_ms": 1.7435431103782935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026034116744995117, "StateBufferConnector_ms": 0.0023103952407836914, "ViewRequirementAgentConnector_ms": 0.05745553970336914}, "num_episodes": 30, "episode_return_max": 244.6900000000006, "episode_return_min": 156.69199999999998, "episode_return_mean": 207.81302000000036, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59891, "num_agent_steps_trained": 59891, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 116.38370051477602, "num_env_steps_trained_throughput_per_sec": 116.38370051477602, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 59891, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 59891, "timers": {"training_iteration_time_ms": 21540.685, "restore_workers_time_ms": 0.012, "training_step_time_ms": 21540.651, "sample_time_ms": 19113.766, "learn_time_ms": 2426.623, "learn_throughput": 1648.382, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 59891, "num_agent_steps_trained": 59891}, "done": false, "training_iteration": 5, "trial_id": "default", "date": "2025-10-13_02-09-42", "timestamp": 1760335782, "time_this_iter_s": 34.369667053222656, "time_total_s": 107.70578670501709, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 107.70578670501709, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 51.448979591836725, "ram_util_percent": 35.751020408163264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 3.0784034906871733, "policy_loss": -0.009178425955571352, "vf_loss": 6.381625828667293, "vf_explained_var": -0.029428887556469628, "kl": 0.007384838337647037, "entropy": 10.360024757990761, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 3465.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.4488928113132715, "policy_loss": -0.012819318000401836, "vf_loss": 5.1256006009876725, "vf_explained_var": 0.09859881345182657, "kl": 0.008219723098820023, "entropy": 10.149915212392807, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1760.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 71891, "num_agent_steps_trained": 71891}, "env_runners": {"episode_reward_max": 241.94000000000062, "episode_reward_min": 179.49000000000015, "episode_reward_mean": 208.4390000000003, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 12.780000000000012, "hider_policy": 48.97999999999997}, "policy_reward_max": {"seeker_policy": 73.37999999999997, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 44.43200000000002, "hider_policy": 82.00350000000009}, "custom_metrics": {}, "hist_stats": {"episode_reward": [203.7900000000003, 200.79000000000028, 207.29000000000033, 204.04000000000036, 208.79000000000028, 210.89000000000036, 208.79000000000025, 205.74000000000038, 206.89000000000036, 194.69000000000017, 207.44000000000025, 217.24000000000026, 198.19000000000014, 199.14000000000013, 197.54000000000016, 224.8400000000004, 231.04000000000048, 204.74000000000018, 218.34000000000026, 198.8900000000002, 203.99000000000026, 218.64000000000033, 227.54000000000042, 185.49000000000018, 211.5400000000004, 209.49000000000026, 213.49000000000038, 207.14000000000044, 200.99000000000032, 207.4400000000004, 179.49000000000015, 198.64000000000033, 196.5400000000002, 226.39000000000038, 219.3400000000005, 241.7400000000006, 196.9400000000003, 202.4900000000003, 193.14000000000027, 179.8900000000002, 218.94000000000045, 184.6400000000001, 197.29000000000036, 211.49000000000044, 204.09000000000023, 204.09000000000037, 198.39000000000047, 232.3400000000006, 194.14000000000016, 200.9400000000003, 207.74000000000032, 207.09000000000032, 211.29000000000048, 200.19000000000034, 194.39000000000033, 211.54000000000045, 205.74000000000035, 196.04000000000028, 219.6900000000005, 201.54000000000033, 207.44000000000034, 215.69000000000045, 223.04000000000048, 221.09000000000052, 200.59000000000037, 206.69000000000037, 205.1900000000004, 211.74000000000032, 227.79000000000053, 213.04000000000048, 204.54000000000045, 201.5400000000003, 207.6900000000004, 227.5400000000005, 232.34000000000057, 202.24000000000032, 225.64000000000047, 216.6400000000005, 241.94000000000062, 213.74000000000046, 209.39000000000038, 191.89000000000024, 195.04000000000033, 204.49000000000032, 202.34000000000037, 204.04000000000042, 230.1400000000005, 210.44000000000037, 199.94000000000028, 219.84000000000046, 226.0900000000005, 214.14000000000038, 201.6900000000004, 200.89000000000027, 190.04000000000036, 235.79000000000062, 222.8900000000004, 206.1900000000003, 204.54000000000028, 196.89000000000027], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [48.58, 51.88000000000003, 45.88000000000001, 46.68000000000002, 45.48000000000002, 43.48, 45.48000000000001, 48.680000000000035, 45.780000000000086, 53.880000000000045, 46.38, 35.78, 53.880000000000045, 52.68000000000005, 51.18000000000007, 22.98000000000001, 22.879999999999985, 47.98000000000003, 34.77999999999998, 54.18000000000004, 49.28000000000003, 34.97999999999998, 21.679999999999964, 63.580000000000126, 40.080000000000055, 42.38000000000003, 38.080000000000005, 45.980000000000054, 51.87999999999998, 46.080000000000034, 73.37999999999997, 55.58000000000005, 54.1800000000001, 26.57999999999995, 33.580000000000005, 14.980000000000043, 57.98000000000004, 49.18000000000002, 58.28000000000007, 71.68000000000005, 34.87999999999995, 66.18000000000009, 56.28000000000005, 41.77999999999999, 50.77999999999997, 46.68000000000008, 53.28000000000008, 23.679999999999964, 59.28000000000006, 53.78000000000004, 44.18, 45.58000000000001, 41.58000000000003, 55.08000000000005, 61.58000000000006, 39.77999999999999, 46.2800000000001, 57.08000000000008, 33.57999999999996, 50.28000000000011, 43.88000000000004, 37.77999999999998, 30.779999999999937, 34.979999999999976, 51.38000000000006, 45.180000000000014, 47.780000000000065, 39.979999999999954, 25.279999999999948, 41.280000000000044, 49.18000000000005, 50.280000000000065, 46.18000000000004, 27.079999999999995, 23.679999999999975, 50.98000000000002, 29.279999999999944, 36.67999999999999, 12.780000000000012, 37.879999999999995, 43.78000000000001, 59.080000000000084, 51.9800000000001, 42.98000000000003, 51.08000000000004, 48.68000000000005, 25.57999999999996, 42.77999999999999, 52.78000000000003, 35.77999999999996, 27.679999999999968, 38.28000000000001, 52.480000000000075, 51.68000000000008, 63.38000000000009, 16.880000000000013, 32.67999999999997, 48.77999999999997, 49.18000000000003, 55.88000000000007], "policy_hider_policy_reward": [79.58000000000006, 75.63000000000007, 81.63000000000005, 67.27999999999997, 73.48000000000003, 87.93000000000013, 61.23, 96.1300000000002, 79.73000000000008, 83.58000000000006, 89.98000000000015, 77.43000000000002, 85.88000000000012, 77.43000000000002, 73.48000000000002, 83.58000000000004, 85.8300000000001, 75.27999999999997, 75.63000000000008, 65.18, 85.68000000000009, 75.38, 112.33000000000024, 69.12999999999997, 79.38000000000002, 64.93000000000002, 93.78000000000011, 52.67999999999999, 71.17999999999995, 75.17999999999995, 91.73000000000009, 110.1300000000002, 114.5800000000003, 93.58000000000006, 73.38, 83.38000000000001, 83.58000000000004, 99.98000000000016, 67.43000000000002, 77.27999999999999, 79.48000000000003, 75.22999999999996, 116.63000000000031, 67.03, 81.48000000000002, 124.38000000000025, 58.879999999999995, 63.030000000000015, 93.78000000000009, 77.68000000000009, 83.58000000000006, 83.53000000000004, 83.63000000000008, 91.78000000000009, 89.88000000000012, 71.27999999999997, 79.63000000000007, 69.48000000000003, 87.7800000000001, 73.58000000000006, 57.13, 48.97999999999997, 75.63000000000005, 67.43, 69.33, 73.02999999999992, 122.63000000000031, 77.17999999999994, 73.58000000000006, 112.1800000000002, 124.83000000000035, 101.93000000000013, 87.93000000000013, 51.03, 63.330000000000005, 89.98000000000016, 67.43, 67.43000000000002, 53.080000000000005, 55.129999999999995, 112.53000000000029, 71.53000000000004, 51.02999999999999, 67.43, 73.58000000000006, 67.43, 106.38000000000024, 63.33000000000001, 79.73000000000008, 73.58000000000004, 65.38, 92.03000000000014, 67.43, 77.68000000000006, 102.28000000000021, 106.38000000000024, 71.53000000000006, 63.33000000000001, 61.279999999999966, 85.88000000000011, 75.63000000000005, 87.93000000000013, 77.68000000000008, 83.83000000000013, 75.63000000000007, 94.08000000000017, 77.68000000000008, 67.43, 61.280000000000015, 71.53000000000004, 83.83000000000011, 87.93000000000013, 83.8300000000001, 75.63000000000005, 71.53000000000003, 67.43000000000002, 116.63000000000031, 69.48000000000003, 71.53000000000004, 79.73000000000009, 79.7300000000001, 83.83000000000013, 75.63000000000005, 102.28000000000021, 102.28000000000021, 89.98000000000016, 106.38000000000024, 79.7300000000001, 75.63000000000007, 73.58000000000004, 81.78000000000011, 79.73000000000009, 85.88000000000012, 71.53000000000004, 77.68000000000008, 94.08000000000018, 77.68000000000006, 124.83000000000035, 89.98000000000013, 81.7800000000001, 71.53000000000003, 83.83000000000011, 85.88000000000012, 65.38000000000001, 83.8300000000001, 77.68000000000006, 77.68000000000008, 122.78000000000034, 83.83000000000013, 124.83000000000035, 75.63000000000007, 75.63000000000008, 124.83000000000035, 71.53000000000002, 71.53000000000003, 108.43000000000026, 112.53000000000029, 116.63000000000031, 79.73000000000009, 96.13000000000018, 81.7800000000001, 83.83000000000011, 67.43000000000002, 65.37999999999998, 67.43, 75.63000000000007, 67.43, 94.08000000000018, 81.78000000000009, 69.48000000000003, 75.63000000000005, 79.73000000000008, 124.83000000000035, 79.73000000000008, 96.13000000000018, 71.53000000000003, 75.63000000000008, 71.53000000000006, 65.38, 118.68000000000032, 122.78000000000034, 75.63000000000005, 69.48000000000003, 106.38000000000025, 75.63000000000005, 73.58000000000003, 63.33, 85.88000000000014, 59.23000000000001, 67.43000000000002, 94.08000000000018, 124.83000000000035, 124.83000000000035, 65.38000000000001, 92.03000000000017, 65.38000000000001, 81.7800000000001, 73.58000000000007, 73.58000000000006, 67.43000000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.835461365976762, "mean_inference_ms": 0.8417252239585082, "mean_action_processing_ms": 0.1382781873037511, "mean_env_wait_ms": 1.7673132374726577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002531766891479492, "StateBufferConnector_ms": 0.002315044403076172, "ViewRequirementAgentConnector_ms": 0.056803345680236816}, "num_episodes": 29, "episode_return_max": 241.94000000000062, "episode_return_min": 179.49000000000015, "episode_return_mean": 208.4390000000003, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71891, "num_agent_steps_trained": 71891, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 131.97247811821515, "num_env_steps_trained_throughput_per_sec": 131.97247811821515, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 71891, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 71891, "timers": {"training_iteration_time_ms": 23002.13, "restore_workers_time_ms": 0.011, "training_step_time_ms": 23002.098, "sample_time_ms": 20665.101, "learn_time_ms": 2336.743, "learn_throughput": 1711.785, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 71891, "num_agent_steps_trained": 71891}, "done": false, "training_iteration": 6, "trial_id": "default", "date": "2025-10-13_02-10-13", "timestamp": 1760335813, "time_this_iter_s": 30.309937953948975, "time_total_s": 138.01572465896606, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 138.01572465896606, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 22.67209302325581, "ram_util_percent": 34.23488372093023}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 3.0081633072050793, "policy_loss": -0.012342896579306513, "vf_loss": 6.246703745826842, "vf_explained_var": 0.10202389823065863, "kl": 0.007940589555500862, "entropy": 10.324270345294286, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.6984126984127, "num_grad_updates_lifetime": 4095.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.514182274416089, "policy_loss": -0.017483200286369537, "vf_loss": 5.269010692834854, "vf_explained_var": 0.14168720860034228, "kl": 0.01059747679557863, "entropy": 10.33697585761547, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2080.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 83873, "num_agent_steps_trained": 83873}, "env_runners": {"episode_reward_max": 241.94000000000062, "episode_reward_min": 179.49000000000015, "episode_reward_mean": 208.2856800000003, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 12.780000000000012, "hider_policy": 48.97999999999997}, "policy_reward_max": {"seeker_policy": 73.37999999999997, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 44.22700000000003, "hider_policy": 82.02934000000009}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.49000000000015, 198.64000000000033, 196.5400000000002, 226.39000000000038, 219.3400000000005, 241.7400000000006, 196.9400000000003, 202.4900000000003, 193.14000000000027, 179.8900000000002, 218.94000000000045, 184.6400000000001, 197.29000000000036, 211.49000000000044, 204.09000000000023, 204.09000000000037, 198.39000000000047, 232.3400000000006, 194.14000000000016, 200.9400000000003, 207.74000000000032, 207.09000000000032, 211.29000000000048, 200.19000000000034, 194.39000000000033, 211.54000000000045, 205.74000000000035, 196.04000000000028, 219.6900000000005, 201.54000000000033, 207.44000000000034, 215.69000000000045, 223.04000000000048, 221.09000000000052, 200.59000000000037, 206.69000000000037, 205.1900000000004, 211.74000000000032, 227.79000000000053, 213.04000000000048, 204.54000000000045, 201.5400000000003, 207.6900000000004, 227.5400000000005, 232.34000000000057, 202.24000000000032, 225.64000000000047, 216.6400000000005, 241.94000000000062, 213.74000000000046, 209.39000000000038, 191.89000000000024, 195.04000000000033, 204.49000000000032, 202.34000000000037, 204.04000000000042, 230.1400000000005, 210.44000000000037, 199.94000000000028, 219.84000000000046, 226.0900000000005, 214.14000000000038, 201.6900000000004, 200.89000000000027, 190.04000000000036, 235.79000000000062, 222.8900000000004, 206.1900000000003, 204.54000000000028, 196.89000000000027, 189.03999999999903, 196.9899999999994, 212.64, 190.29, 195.98999999999998, 235.8900000000005, 199.84000000000023, 208.3900000000002, 195.64000000000024, 198.24000000000018, 204.69000000000045, 202.84000000000012, 196.79000000000025, 201.2400000000002, 198.29000000000008, 208.73999999999998, 231.59000000000026, 191.39000000000004, 206.79000000000025, 229.59000000000034, 231.5900000000004, 215.79000000000042, 205.7400000000002, 200.94000000000025, 208.59000000000034, 192.65800000000024, 228.14000000000058, 222.74000000000052, 227.5900000000006, 190.8400000000003], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [73.37999999999997, 55.58000000000005, 54.1800000000001, 26.57999999999995, 33.580000000000005, 14.980000000000043, 57.98000000000004, 49.18000000000002, 58.28000000000007, 71.68000000000005, 34.87999999999995, 66.18000000000009, 56.28000000000005, 41.77999999999999, 50.77999999999997, 46.68000000000008, 53.28000000000008, 23.679999999999964, 59.28000000000006, 53.78000000000004, 44.18, 45.58000000000001, 41.58000000000003, 55.08000000000005, 61.58000000000006, 39.77999999999999, 46.2800000000001, 57.08000000000008, 33.57999999999996, 50.28000000000011, 43.88000000000004, 37.77999999999998, 30.779999999999937, 34.979999999999976, 51.38000000000006, 45.180000000000014, 47.780000000000065, 39.979999999999954, 25.279999999999948, 41.280000000000044, 49.18000000000005, 50.280000000000065, 46.18000000000004, 27.079999999999995, 23.679999999999975, 50.98000000000002, 29.279999999999944, 36.67999999999999, 12.780000000000012, 37.879999999999995, 43.78000000000001, 59.080000000000084, 51.9800000000001, 42.98000000000003, 51.08000000000004, 48.68000000000005, 25.57999999999996, 42.77999999999999, 52.78000000000003, 35.77999999999996, 27.679999999999968, 38.28000000000001, 52.480000000000075, 51.68000000000008, 63.38000000000009, 16.880000000000013, 32.67999999999997, 48.77999999999997, 49.18000000000003, 55.88000000000007, 55.28000000000006, 49.58000000000002, 38.58000000000001, 58.88000000000009, 56.48000000000004, 19.480000000000008, 53.180000000000035, 47.48000000000003, 50.98000000000009, 55.78, 47.280000000000044, 47.98000000000005, 55.78000000000006, 52.480000000000025, 50.58000000000013, 42.58000000000002, 22.279999999999987, 59.98000000000012, 46.28000000000004, 23.979999999999944, 21.679999999999986, 36.280000000000044, 46.68, 45.98000000000002, 47.480000000000025, 43.88, 27.67999999999996, 30.47999999999994, 20.98, 55.980000000000054], "policy_hider_policy_reward": [57.13, 48.97999999999997, 75.63000000000005, 67.43, 69.33, 73.02999999999992, 122.63000000000031, 77.17999999999994, 73.58000000000006, 112.1800000000002, 124.83000000000035, 101.93000000000013, 87.93000000000013, 51.03, 63.330000000000005, 89.98000000000016, 67.43, 67.43000000000002, 53.080000000000005, 55.129999999999995, 112.53000000000029, 71.53000000000004, 51.02999999999999, 67.43, 73.58000000000006, 67.43, 106.38000000000024, 63.33000000000001, 79.73000000000008, 73.58000000000004, 65.38, 92.03000000000014, 67.43, 77.68000000000006, 102.28000000000021, 106.38000000000024, 71.53000000000006, 63.33000000000001, 61.279999999999966, 85.88000000000011, 75.63000000000005, 87.93000000000013, 77.68000000000008, 83.83000000000013, 75.63000000000007, 94.08000000000017, 77.68000000000008, 67.43, 61.280000000000015, 71.53000000000004, 83.83000000000011, 87.93000000000013, 83.8300000000001, 75.63000000000005, 71.53000000000003, 67.43000000000002, 116.63000000000031, 69.48000000000003, 71.53000000000004, 79.73000000000009, 79.7300000000001, 83.83000000000013, 75.63000000000005, 102.28000000000021, 102.28000000000021, 89.98000000000016, 106.38000000000024, 79.7300000000001, 75.63000000000007, 73.58000000000004, 81.78000000000011, 79.73000000000009, 85.88000000000012, 71.53000000000004, 77.68000000000008, 94.08000000000018, 77.68000000000006, 124.83000000000035, 89.98000000000013, 81.7800000000001, 71.53000000000003, 83.83000000000011, 85.88000000000012, 65.38000000000001, 83.8300000000001, 77.68000000000006, 77.68000000000008, 122.78000000000034, 83.83000000000013, 124.83000000000035, 75.63000000000007, 75.63000000000008, 124.83000000000035, 71.53000000000002, 71.53000000000003, 108.43000000000026, 112.53000000000029, 116.63000000000031, 79.73000000000009, 96.13000000000018, 81.7800000000001, 83.83000000000011, 67.43000000000002, 65.37999999999998, 67.43, 75.63000000000007, 67.43, 94.08000000000018, 81.78000000000009, 69.48000000000003, 75.63000000000005, 79.73000000000008, 124.83000000000035, 79.73000000000008, 96.13000000000018, 71.53000000000003, 75.63000000000008, 71.53000000000006, 65.38, 118.68000000000032, 122.78000000000034, 75.63000000000005, 69.48000000000003, 106.38000000000025, 75.63000000000005, 73.58000000000003, 63.33, 85.88000000000014, 59.23000000000001, 67.43000000000002, 94.08000000000018, 124.83000000000035, 124.83000000000035, 65.38000000000001, 92.03000000000017, 65.38000000000001, 81.7800000000001, 73.58000000000007, 73.58000000000006, 67.43000000000002, 60.88000000000012, 72.88, 60.88000000000007, 86.52999999999984, 70.97999999999993, 103.07999999999996, 62.930000000000014, 68.47999999999999, 64.98, 74.52999999999993, 124.83000000000035, 91.58000000000006, 79.22999999999998, 67.43000000000002, 83.83000000000013, 77.07999999999994, 66.97999999999998, 77.68000000000006, 67.43000000000002, 75.02999999999993, 83.83000000000011, 73.58000000000003, 75.12999999999995, 79.73000000000009, 75.63000000000007, 65.37999999999997, 60.83000000000004, 87.93000000000013, 77.12999999999994, 70.57999999999997, 91.33, 74.82999999999991, 116.03000000000017, 93.27999999999999, 64.83000000000001, 66.58000000000001, 66.97999999999998, 93.53000000000004, 87.43, 118.1800000000002, 124.38000000000025, 85.53000000000004, 85.88000000000011, 93.63000000000007, 75.58000000000006, 83.48000000000005, 79.73000000000009, 75.22999999999998, 91.88000000000012, 69.22999999999998, 85.88000000000012, 62.897999999999996, 124.83000000000035, 75.63000000000005, 79.73000000000009, 112.53000000000027, 108.43000000000025, 98.1800000000002, 69.48000000000003, 65.38000000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.112777944770564, "mean_inference_ms": 0.8460087957111913, "mean_action_processing_ms": 0.13957133407299183, "mean_env_wait_ms": 1.785145757797103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002416253089904785, "StateBufferConnector_ms": 0.002300858497619629, "ViewRequirementAgentConnector_ms": 0.055036067962646484}, "num_episodes": 30, "episode_return_max": 241.94000000000062, "episode_return_min": 179.49000000000015, "episode_return_mean": 208.2856800000003, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83873, "num_agent_steps_trained": 83873, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.1645247121207, "num_env_steps_trained_throughput_per_sec": 209.1645247121207, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 83873, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 83873, "timers": {"training_iteration_time_ms": 22448.07, "restore_workers_time_ms": 0.011, "training_step_time_ms": 22448.039, "sample_time_ms": 20194.727, "learn_time_ms": 2253.07, "learn_throughput": 1775.355, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 83873, "num_agent_steps_trained": 83873}, "done": false, "training_iteration": 7, "trial_id": "default", "date": "2025-10-13_02-10-32", "timestamp": 1760335832, "time_this_iter_s": 19.124258995056152, "time_total_s": 157.13998365402222, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 157.13998365402222, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.35555555555555, "ram_util_percent": 34.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.05, "cur_lr": 0.0003, "total_loss": 3.0869822890527785, "policy_loss": -0.012613402349093267, "vf_loss": 6.40595690127342, "vf_explained_var": 0.013917450078072087, "kl": 0.008781138304696103, "entropy": 10.382182075131324, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4720.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.226278594881296, "policy_loss": -0.016394906226196326, "vf_loss": 4.69062856733799, "vf_explained_var": 0.1529623694717884, "kl": 0.009016801740699552, "entropy": 10.309161338210107, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 95809, "num_agent_steps_trained": 95809}, "env_runners": {"episode_reward_max": 247.5899999999995, "episode_reward_min": 148.85400000000007, "episode_reward_mean": 210.51682000000034, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 3.380000000000009, "hider_policy": 35.14399999999999}, "policy_reward_max": {"seeker_policy": 63.38000000000009, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 41.28100000000002, "hider_policy": 84.61791000000011}, "custom_metrics": {}, "hist_stats": {"episode_reward": [207.44000000000034, 215.69000000000045, 223.04000000000048, 221.09000000000052, 200.59000000000037, 206.69000000000037, 205.1900000000004, 211.74000000000032, 227.79000000000053, 213.04000000000048, 204.54000000000045, 201.5400000000003, 207.6900000000004, 227.5400000000005, 232.34000000000057, 202.24000000000032, 225.64000000000047, 216.6400000000005, 241.94000000000062, 213.74000000000046, 209.39000000000038, 191.89000000000024, 195.04000000000033, 204.49000000000032, 202.34000000000037, 204.04000000000042, 230.1400000000005, 210.44000000000037, 199.94000000000028, 219.84000000000046, 226.0900000000005, 214.14000000000038, 201.6900000000004, 200.89000000000027, 190.04000000000036, 235.79000000000062, 222.8900000000004, 206.1900000000003, 204.54000000000028, 196.89000000000027, 189.03999999999903, 196.9899999999994, 212.64, 190.29, 195.98999999999998, 235.8900000000005, 199.84000000000023, 208.3900000000002, 195.64000000000024, 198.24000000000018, 204.69000000000045, 202.84000000000012, 196.79000000000025, 201.2400000000002, 198.29000000000008, 208.73999999999998, 231.59000000000026, 191.39000000000004, 206.79000000000025, 229.59000000000034, 231.5900000000004, 215.79000000000042, 205.7400000000002, 200.94000000000025, 208.59000000000034, 192.65800000000024, 228.14000000000058, 222.74000000000052, 227.5900000000006, 190.8400000000003, 196.99000000000015, 207.09000000000034, 230.94000000000054, 216.7900000000005, 234.29000000000053, 202.19000000000025, 213.04000000000036, 225.44000000000054, 229.94000000000057, 204.74000000000026, 247.5899999999995, 202.29000000000033, 201.84000000000032, 198.44000000000034, 212.24000000000046, 204.04000000000025, 228.44000000000054, 209.29000000000033, 220.1400000000004, 219.74000000000046, 148.85400000000007, 218.24000000000035, 219.74000000000032, 194.7900000000002, 222.14000000000033, 226.19000000000045, 208.59000000000034, 206.29000000000025, 208.1900000000004, 200.7900000000003], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [43.88000000000004, 37.77999999999998, 30.779999999999937, 34.979999999999976, 51.38000000000006, 45.180000000000014, 47.780000000000065, 39.979999999999954, 25.279999999999948, 41.280000000000044, 49.18000000000005, 50.280000000000065, 46.18000000000004, 27.079999999999995, 23.679999999999975, 50.98000000000002, 29.279999999999944, 36.67999999999999, 12.780000000000012, 37.879999999999995, 43.78000000000001, 59.080000000000084, 51.9800000000001, 42.98000000000003, 51.08000000000004, 48.68000000000005, 25.57999999999996, 42.77999999999999, 52.78000000000003, 35.77999999999996, 27.679999999999968, 38.28000000000001, 52.480000000000075, 51.68000000000008, 63.38000000000009, 16.880000000000013, 32.67999999999997, 48.77999999999997, 49.18000000000003, 55.88000000000007, 55.28000000000006, 49.58000000000002, 38.58000000000001, 58.88000000000009, 56.48000000000004, 19.480000000000008, 53.180000000000035, 47.48000000000003, 50.98000000000009, 55.78, 47.280000000000044, 47.98000000000005, 55.78000000000006, 52.480000000000025, 50.58000000000013, 42.58000000000002, 22.279999999999987, 59.98000000000012, 46.28000000000004, 23.979999999999944, 21.679999999999986, 36.280000000000044, 46.68, 45.98000000000002, 47.480000000000025, 43.88, 27.67999999999996, 30.47999999999994, 20.98, 55.980000000000054, 55.98000000000002, 45.58000000000001, 22.27999999999999, 38.87999999999999, 19.47999999999999, 48.880000000000045, 41.28000000000002, 29.07999999999994, 25.379999999999963, 49.379999999999995, 3.380000000000009, 44.980000000000025, 50.58000000000005, 53.480000000000054, 40.580000000000034, 50.78000000000003, 26.079999999999966, 43.68000000000001, 34.07999999999996, 33.679999999999964, 38.07999999999996, 36.48, 33.77999999999999, 58.08000000000005, 32.27999999999996, 25.87999999999998, 42.97999999999997, 40.98000000000005, 44.780000000000044, 51.58000000000002], "policy_hider_policy_reward": [79.7300000000001, 83.83000000000013, 75.63000000000005, 102.28000000000021, 102.28000000000021, 89.98000000000016, 106.38000000000024, 79.7300000000001, 75.63000000000007, 73.58000000000004, 81.78000000000011, 79.73000000000009, 85.88000000000012, 71.53000000000004, 77.68000000000008, 94.08000000000018, 77.68000000000006, 124.83000000000035, 89.98000000000013, 81.7800000000001, 71.53000000000003, 83.83000000000011, 85.88000000000012, 65.38000000000001, 83.8300000000001, 77.68000000000006, 77.68000000000008, 122.78000000000034, 83.83000000000013, 124.83000000000035, 75.63000000000007, 75.63000000000008, 124.83000000000035, 71.53000000000002, 71.53000000000003, 108.43000000000026, 112.53000000000029, 116.63000000000031, 79.73000000000009, 96.13000000000018, 81.7800000000001, 83.83000000000011, 67.43000000000002, 65.37999999999998, 67.43, 75.63000000000007, 67.43, 94.08000000000018, 81.78000000000009, 69.48000000000003, 75.63000000000005, 79.73000000000008, 124.83000000000035, 79.73000000000008, 96.13000000000018, 71.53000000000003, 75.63000000000008, 71.53000000000006, 65.38, 118.68000000000032, 122.78000000000034, 75.63000000000005, 69.48000000000003, 106.38000000000025, 75.63000000000005, 73.58000000000003, 63.33, 85.88000000000014, 59.23000000000001, 67.43000000000002, 94.08000000000018, 124.83000000000035, 124.83000000000035, 65.38000000000001, 92.03000000000017, 65.38000000000001, 81.7800000000001, 73.58000000000007, 73.58000000000006, 67.43000000000002, 60.88000000000012, 72.88, 60.88000000000007, 86.52999999999984, 70.97999999999993, 103.07999999999996, 62.930000000000014, 68.47999999999999, 64.98, 74.52999999999993, 124.83000000000035, 91.58000000000006, 79.22999999999998, 67.43000000000002, 83.83000000000013, 77.07999999999994, 66.97999999999998, 77.68000000000006, 67.43000000000002, 75.02999999999993, 83.83000000000011, 73.58000000000003, 75.12999999999995, 79.73000000000009, 75.63000000000007, 65.37999999999997, 60.83000000000004, 87.93000000000013, 77.12999999999994, 70.57999999999997, 91.33, 74.82999999999991, 116.03000000000017, 93.27999999999999, 64.83000000000001, 66.58000000000001, 66.97999999999998, 93.53000000000004, 87.43, 118.1800000000002, 124.38000000000025, 85.53000000000004, 85.88000000000011, 93.63000000000007, 75.58000000000006, 83.48000000000005, 79.73000000000009, 75.22999999999998, 91.88000000000012, 69.22999999999998, 85.88000000000012, 62.897999999999996, 124.83000000000035, 75.63000000000005, 79.73000000000009, 112.53000000000027, 108.43000000000025, 98.1800000000002, 69.48000000000003, 65.38000000000001, 71.53000000000006, 69.48000000000003, 85.88000000000012, 75.63000000000007, 120.73000000000033, 87.93000000000013, 104.33000000000023, 73.58000000000004, 89.98000000000016, 124.83000000000035, 79.73000000000009, 73.58000000000007, 89.98000000000015, 81.7800000000001, 79.73000000000008, 116.63000000000031, 79.73000000000009, 124.83000000000035, 83.83000000000011, 71.53000000000003, 122.32999999999979, 121.8799999999997, 79.68000000000008, 77.63000000000007, 83.83000000000011, 67.43, 81.73000000000009, 63.23000000000001, 61.22999999999999, 110.43000000000025, 77.68000000000008, 75.58000000000007, 120.5800000000003, 81.7800000000001, 87.93000000000015, 77.68000000000008, 61.23, 124.83000000000035, 92.03000000000017, 94.03000000000017, 75.63000000000008, 35.14399999999999, 112.38000000000025, 69.38000000000001, 98.1800000000002, 87.78000000000011, 71.33000000000001, 65.38000000000001, 65.12999999999998, 124.73000000000033, 81.68000000000006, 118.63000000000031, 79.73000000000009, 85.88000000000014, 77.48000000000003, 87.83000000000013, 95.98000000000015, 67.43, 67.43, 81.78000000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2740317429082624, "mean_inference_ms": 0.8412368031386809, "mean_action_processing_ms": 0.13956498795402403, "mean_env_wait_ms": 1.7932145486999411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002313852310180664, "StateBufferConnector_ms": 0.0022449493408203125, "ViewRequirementAgentConnector_ms": 0.054641127586364746}, "num_episodes": 30, "episode_return_max": 247.5899999999995, "episode_return_min": 148.85400000000007, "episode_return_mean": 210.51682000000034, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95809, "num_agent_steps_trained": 95809, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 175.85106016793858, "num_env_steps_trained_throughput_per_sec": 175.85106016793858, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 95809, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 95809, "timers": {"training_iteration_time_ms": 22485.377, "restore_workers_time_ms": 0.011, "training_step_time_ms": 22485.348, "sample_time_ms": 20304.361, "learn_time_ms": 2180.753, "learn_throughput": 1834.228, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 95809, "num_agent_steps_trained": 95809}, "done": false, "training_iteration": 8, "trial_id": "default", "date": "2025-10-13_02-10-55", "timestamp": 1760335855, "time_this_iter_s": 22.74708390235901, "time_total_s": 179.88706755638123, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 179.88706755638123, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 23.0, "ram_util_percent": 34.256249999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 2.9330864130504546, "policy_loss": -0.012916884483355614, "vf_loss": 6.098723371445186, "vf_explained_var": 0.03007358227457319, "kl": 0.008698298086411748, "entropy": 10.379331588745117, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.85714285714286, "num_grad_updates_lifetime": 5345.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.5161820389330387, "policy_loss": -0.02177066828298848, "vf_loss": 5.280553787946701, "vf_explained_var": 0.25845485385507344, "kl": 0.01081769902820046, "entropy": 10.286505472660064, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2720.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 107801, "num_agent_steps_trained": 107801}, "env_runners": {"episode_reward_max": 247.5899999999995, "episode_reward_min": 148.85400000000007, "episode_reward_mean": 209.30849000000026, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 3.380000000000009, "hider_policy": 35.14399999999999}, "policy_reward_max": {"seeker_policy": 63.38000000000009, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 42.33803000000002, "hider_policy": 83.48523000000009}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.84000000000046, 226.0900000000005, 214.14000000000038, 201.6900000000004, 200.89000000000027, 190.04000000000036, 235.79000000000062, 222.8900000000004, 206.1900000000003, 204.54000000000028, 196.89000000000027, 189.03999999999903, 196.9899999999994, 212.64, 190.29, 195.98999999999998, 235.8900000000005, 199.84000000000023, 208.3900000000002, 195.64000000000024, 198.24000000000018, 204.69000000000045, 202.84000000000012, 196.79000000000025, 201.2400000000002, 198.29000000000008, 208.73999999999998, 231.59000000000026, 191.39000000000004, 206.79000000000025, 229.59000000000034, 231.5900000000004, 215.79000000000042, 205.7400000000002, 200.94000000000025, 208.59000000000034, 192.65800000000024, 228.14000000000058, 222.74000000000052, 227.5900000000006, 190.8400000000003, 196.99000000000015, 207.09000000000034, 230.94000000000054, 216.7900000000005, 234.29000000000053, 202.19000000000025, 213.04000000000036, 225.44000000000054, 229.94000000000057, 204.74000000000026, 247.5899999999995, 202.29000000000033, 201.84000000000032, 198.44000000000034, 212.24000000000046, 204.04000000000025, 228.44000000000054, 209.29000000000033, 220.1400000000004, 219.74000000000046, 148.85400000000007, 218.24000000000035, 219.74000000000032, 194.7900000000002, 222.14000000000033, 226.19000000000045, 208.59000000000034, 206.29000000000025, 208.1900000000004, 200.7900000000003, 197.49900000000028, 201.19000000000028, 207.69000000000037, 217.6400000000004, 192.94000000000025, 244.8400000000001, 217.14000000000038, 211.34000000000037, 204.2900000000004, 217.19000000000054, 227.49000000000046, 199.24000000000026, 219.09000000000043, 196.84000000000032, 209.3400000000004, 200.6900000000003, 201.44000000000037, 206.99000000000035, 212.29000000000053, 202.5900000000004, 206.19000000000028, 229.09000000000054, 213.64000000000038, 193.49800000000022, 212.54000000000025, 209.8400000000004, 186.6400000000002, 192.69000000000023, 201.1400000000003], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [35.77999999999996, 27.679999999999968, 38.28000000000001, 52.480000000000075, 51.68000000000008, 63.38000000000009, 16.880000000000013, 32.67999999999997, 48.77999999999997, 49.18000000000003, 55.88000000000007, 55.28000000000006, 49.58000000000002, 38.58000000000001, 58.88000000000009, 56.48000000000004, 19.480000000000008, 53.180000000000035, 47.48000000000003, 50.98000000000009, 55.78, 47.280000000000044, 47.98000000000005, 55.78000000000006, 52.480000000000025, 50.58000000000013, 42.58000000000002, 22.279999999999987, 59.98000000000012, 46.28000000000004, 23.979999999999944, 21.679999999999986, 36.280000000000044, 46.68, 45.98000000000002, 47.480000000000025, 43.88, 27.67999999999996, 30.47999999999994, 20.98, 55.980000000000054, 55.98000000000002, 45.58000000000001, 22.27999999999999, 38.87999999999999, 19.47999999999999, 48.880000000000045, 41.28000000000002, 29.07999999999994, 25.379999999999963, 49.379999999999995, 3.380000000000009, 44.980000000000025, 50.58000000000005, 53.480000000000054, 40.580000000000034, 50.78000000000003, 26.079999999999966, 43.68000000000001, 34.07999999999996, 33.679999999999964, 38.07999999999996, 36.48, 33.77999999999999, 58.08000000000005, 32.27999999999996, 25.87999999999998, 42.97999999999997, 40.98000000000005, 44.780000000000044, 51.58000000000002, 50.48300000000001, 51.98000000000004, 46.17999999999999, 37.67999999999996, 53.9800000000001, 8.179999999999996, 37.17999999999999, 41.68, 48.98000000000006, 35.27999999999997, 27.27999999999997, 54.28000000000005, 35.17999999999995, 55.88000000000009, 45.78000000000001, 51.58000000000004, 52.280000000000065, 45.58, 42.57999999999999, 49.280000000000065, 46.77999999999999, 26.679999999999957, 37.879999999999974, 52.68000000000001, 39.07999999999999, 46.480000000000075, 59.980000000000125, 59.88000000000006, 45.980000000000054], "policy_hider_policy_reward": [65.38, 118.68000000000032, 122.78000000000034, 75.63000000000005, 69.48000000000003, 106.38000000000025, 75.63000000000005, 73.58000000000003, 63.33, 85.88000000000014, 59.23000000000001, 67.43000000000002, 94.08000000000018, 124.83000000000035, 124.83000000000035, 65.38000000000001, 92.03000000000017, 65.38000000000001, 81.7800000000001, 73.58000000000007, 73.58000000000006, 67.43000000000002, 60.88000000000012, 72.88, 60.88000000000007, 86.52999999999984, 70.97999999999993, 103.07999999999996, 62.930000000000014, 68.47999999999999, 64.98, 74.52999999999993, 124.83000000000035, 91.58000000000006, 79.22999999999998, 67.43000000000002, 83.83000000000013, 77.07999999999994, 66.97999999999998, 77.68000000000006, 67.43000000000002, 75.02999999999993, 83.83000000000011, 73.58000000000003, 75.12999999999995, 79.73000000000009, 75.63000000000007, 65.37999999999997, 60.83000000000004, 87.93000000000013, 77.12999999999994, 70.57999999999997, 91.33, 74.82999999999991, 116.03000000000017, 93.27999999999999, 64.83000000000001, 66.58000000000001, 66.97999999999998, 93.53000000000004, 87.43, 118.1800000000002, 124.38000000000025, 85.53000000000004, 85.88000000000011, 93.63000000000007, 75.58000000000006, 83.48000000000005, 79.73000000000009, 75.22999999999998, 91.88000000000012, 69.22999999999998, 85.88000000000012, 62.897999999999996, 124.83000000000035, 75.63000000000005, 79.73000000000009, 112.53000000000027, 108.43000000000025, 98.1800000000002, 69.48000000000003, 65.38000000000001, 71.53000000000006, 69.48000000000003, 85.88000000000012, 75.63000000000007, 120.73000000000033, 87.93000000000013, 104.33000000000023, 73.58000000000004, 89.98000000000016, 124.83000000000035, 79.73000000000009, 73.58000000000007, 89.98000000000015, 81.7800000000001, 79.73000000000008, 116.63000000000031, 79.73000000000009, 124.83000000000035, 83.83000000000011, 71.53000000000003, 122.32999999999979, 121.8799999999997, 79.68000000000008, 77.63000000000007, 83.83000000000011, 67.43, 81.73000000000009, 63.23000000000001, 61.22999999999999, 110.43000000000025, 77.68000000000008, 75.58000000000007, 120.5800000000003, 81.7800000000001, 87.93000000000015, 77.68000000000008, 61.23, 124.83000000000035, 92.03000000000017, 94.03000000000017, 75.63000000000008, 35.14399999999999, 112.38000000000025, 69.38000000000001, 98.1800000000002, 87.78000000000011, 71.33000000000001, 65.38000000000001, 65.12999999999998, 124.73000000000033, 81.68000000000006, 118.63000000000031, 79.73000000000009, 85.88000000000014, 77.48000000000003, 87.83000000000013, 95.98000000000015, 67.43, 67.43, 81.78000000000009, 78.63300000000008, 68.38300000000001, 73.58000000000007, 75.63000000000007, 85.88000000000011, 75.63000000000005, 81.78000000000009, 98.18000000000018, 67.42999999999999, 71.53000000000004, 119.33000000000001, 117.33000000000001, 98.1800000000002, 81.78000000000009, 71.53000000000004, 98.1300000000002, 65.32999999999998, 89.98000000000015, 96.13000000000017, 85.78000000000009, 124.63000000000031, 75.58000000000004, 85.83000000000013, 59.12999999999999, 124.68000000000032, 59.22999999999999, 69.43, 71.53000000000002, 77.68000000000008, 85.88000000000012, 81.7800000000001, 67.32999999999998, 77.63000000000005, 71.53000000000004, 81.78000000000009, 79.63000000000007, 85.88000000000012, 83.83000000000011, 79.73000000000009, 73.58000000000003, 81.7800000000001, 77.63000000000008, 100.23000000000022, 102.18000000000019, 85.78000000000009, 89.98000000000012, 67.43000000000002, 73.38800000000003, 89.78000000000009, 83.68000000000008, 69.37999999999998, 93.98000000000015, 59.22999999999998, 67.43, 67.43, 65.37999999999998, 77.68000000000008, 77.48000000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.276269564222248, "mean_inference_ms": 0.8323702382265514, "mean_action_processing_ms": 0.13905810163241636, "mean_env_wait_ms": 1.7971627374653236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002232670783996582, "StateBufferConnector_ms": 0.0021817684173583984, "ViewRequirementAgentConnector_ms": 0.05156815052032471}, "num_episodes": 29, "episode_return_max": 247.5899999999995, "episode_return_min": 148.85400000000007, "episode_return_mean": 209.30849000000026, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107801, "num_agent_steps_trained": 107801, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.6268488514244, "num_env_steps_trained_throughput_per_sec": 203.6268488514244, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 107801, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 107801, "timers": {"training_iteration_time_ms": 22169.644, "restore_workers_time_ms": 0.01, "training_step_time_ms": 22169.616, "sample_time_ms": 20028.708, "learn_time_ms": 2140.659, "learn_throughput": 1868.583, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 107801, "num_agent_steps_trained": 107801}, "done": false, "training_iteration": 9, "trial_id": "default", "date": "2025-10-13_02-11-14", "timestamp": 1760335874, "time_this_iter_s": 19.644306898117065, "time_total_s": 199.5313744544983, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 199.5313744544983, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 27.514285714285712, "ram_util_percent": 34.38214285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 3.0762090179655286, "policy_loss": -0.014182893381941886, "vf_loss": 6.386146817888532, "vf_explained_var": 0.02181079359281631, "kl": 0.010763470263894343, "entropy": 10.32196810434735, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.6984126984127, "num_grad_updates_lifetime": 5975.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.5041279759258033, "policy_loss": -0.02093776762849302, "vf_loss": 5.255262818932533, "vf_explained_var": 0.1394314721226692, "kl": 0.009116601242482184, "entropy": 10.30214994251728, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3040.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 119783, "num_agent_steps_trained": 119783}, "env_runners": {"episode_reward_max": 247.5899999999995, "episode_reward_min": 148.85400000000007, "episode_reward_mean": 209.3926700000003, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 3.380000000000009, "hider_policy": 35.14399999999999}, "policy_reward_max": {"seeker_policy": 59.980000000000125, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 42.310030000000026, "hider_policy": 83.54132000000008}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.59000000000034, 231.5900000000004, 215.79000000000042, 205.7400000000002, 200.94000000000025, 208.59000000000034, 192.65800000000024, 228.14000000000058, 222.74000000000052, 227.5900000000006, 190.8400000000003, 196.99000000000015, 207.09000000000034, 230.94000000000054, 216.7900000000005, 234.29000000000053, 202.19000000000025, 213.04000000000036, 225.44000000000054, 229.94000000000057, 204.74000000000026, 247.5899999999995, 202.29000000000033, 201.84000000000032, 198.44000000000034, 212.24000000000046, 204.04000000000025, 228.44000000000054, 209.29000000000033, 220.1400000000004, 219.74000000000046, 148.85400000000007, 218.24000000000035, 219.74000000000032, 194.7900000000002, 222.14000000000033, 226.19000000000045, 208.59000000000034, 206.29000000000025, 208.1900000000004, 200.7900000000003, 197.49900000000028, 201.19000000000028, 207.69000000000037, 217.6400000000004, 192.94000000000025, 244.8400000000001, 217.14000000000038, 211.34000000000037, 204.2900000000004, 217.19000000000054, 227.49000000000046, 199.24000000000026, 219.09000000000043, 196.84000000000032, 209.3400000000004, 200.6900000000003, 201.44000000000037, 206.99000000000035, 212.29000000000053, 202.5900000000004, 206.19000000000028, 229.09000000000054, 213.64000000000038, 193.49800000000022, 212.54000000000025, 209.8400000000004, 186.6400000000002, 192.69000000000023, 201.1400000000003, 212.4400000000003, 201.54000000000016, 211.9400000000003, 201.5900000000003, 202.94000000000025, 198.29000000000016, 194.85800000000023, 207.04000000000022, 198.14000000000013, 217.39000000000044, 200.2400000000003, 196.24000000000015, 209.5400000000004, 201.39000000000036, 233.24000000000052, 212.3400000000004, 204.74000000000032, 197.99000000000032, 199.34000000000034, 198.99000000000024, 215.04000000000033, 204.84000000000034, 217.14000000000047, 216.34000000000037, 211.24000000000035, 195.34000000000026, 227.59000000000046, 200.14000000000033, 212.6900000000003, 192.14000000000019], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [23.979999999999944, 21.679999999999986, 36.280000000000044, 46.68, 45.98000000000002, 47.480000000000025, 43.88, 27.67999999999996, 30.47999999999994, 20.98, 55.980000000000054, 55.98000000000002, 45.58000000000001, 22.27999999999999, 38.87999999999999, 19.47999999999999, 48.880000000000045, 41.28000000000002, 29.07999999999994, 25.379999999999963, 49.379999999999995, 3.380000000000009, 44.980000000000025, 50.58000000000005, 53.480000000000054, 40.580000000000034, 50.78000000000003, 26.079999999999966, 43.68000000000001, 34.07999999999996, 33.679999999999964, 38.07999999999996, 36.48, 33.77999999999999, 58.08000000000005, 32.27999999999996, 25.87999999999998, 42.97999999999997, 40.98000000000005, 44.780000000000044, 51.58000000000002, 50.48300000000001, 51.98000000000004, 46.17999999999999, 37.67999999999996, 53.9800000000001, 8.179999999999996, 37.17999999999999, 41.68, 48.98000000000006, 35.27999999999997, 27.27999999999997, 54.28000000000005, 35.17999999999995, 55.88000000000009, 45.78000000000001, 51.58000000000004, 52.280000000000065, 45.58, 42.57999999999999, 49.280000000000065, 46.77999999999999, 26.679999999999957, 37.879999999999974, 52.68000000000001, 39.07999999999999, 46.480000000000075, 59.980000000000125, 59.88000000000006, 45.980000000000054, 44.97999999999998, 52.88000000000004, 40.579999999999984, 50.480000000000054, 51.880000000000024, 53.48000000000007, 40.07999999999999, 47.98000000000001, 53.48000000000005, 35.67999999999997, 51.3800000000001, 57.480000000000054, 44.18000000000002, 52.18, 20.779999999999987, 40.680000000000014, 45.48000000000006, 48.9800000000001, 54.380000000000045, 51.98000000000008, 37.27999999999998, 47.480000000000025, 35.37999999999996, 38.58, 41.67999999999998, 58.480000000000075, 29.179999999999982, 53.080000000000055, 41.17999999999998, 59.48000000000005], "policy_hider_policy_reward": [87.43, 118.1800000000002, 124.38000000000025, 85.53000000000004, 85.88000000000011, 93.63000000000007, 75.58000000000006, 83.48000000000005, 79.73000000000009, 75.22999999999998, 91.88000000000012, 69.22999999999998, 85.88000000000012, 62.897999999999996, 124.83000000000035, 75.63000000000005, 79.73000000000009, 112.53000000000027, 108.43000000000025, 98.1800000000002, 69.48000000000003, 65.38000000000001, 71.53000000000006, 69.48000000000003, 85.88000000000012, 75.63000000000007, 120.73000000000033, 87.93000000000013, 104.33000000000023, 73.58000000000004, 89.98000000000016, 124.83000000000035, 79.73000000000009, 73.58000000000007, 89.98000000000015, 81.7800000000001, 79.73000000000008, 116.63000000000031, 79.73000000000009, 124.83000000000035, 83.83000000000011, 71.53000000000003, 122.32999999999979, 121.8799999999997, 79.68000000000008, 77.63000000000007, 83.83000000000011, 67.43, 81.73000000000009, 63.23000000000001, 61.22999999999999, 110.43000000000025, 77.68000000000008, 75.58000000000007, 120.5800000000003, 81.7800000000001, 87.93000000000015, 77.68000000000008, 61.23, 124.83000000000035, 92.03000000000017, 94.03000000000017, 75.63000000000008, 35.14399999999999, 112.38000000000025, 69.38000000000001, 98.1800000000002, 87.78000000000011, 71.33000000000001, 65.38000000000001, 65.12999999999998, 124.73000000000033, 81.68000000000006, 118.63000000000031, 79.73000000000009, 85.88000000000014, 77.48000000000003, 87.83000000000013, 95.98000000000015, 67.43, 67.43, 81.78000000000009, 78.63300000000008, 68.38300000000001, 73.58000000000007, 75.63000000000007, 85.88000000000011, 75.63000000000005, 81.78000000000009, 98.18000000000018, 67.42999999999999, 71.53000000000004, 119.33000000000001, 117.33000000000001, 98.1800000000002, 81.78000000000009, 71.53000000000004, 98.1300000000002, 65.32999999999998, 89.98000000000015, 96.13000000000017, 85.78000000000009, 124.63000000000031, 75.58000000000004, 85.83000000000013, 59.12999999999999, 124.68000000000032, 59.22999999999999, 69.43, 71.53000000000002, 77.68000000000008, 85.88000000000012, 81.7800000000001, 67.32999999999998, 77.63000000000005, 71.53000000000004, 81.78000000000009, 79.63000000000007, 85.88000000000012, 83.83000000000011, 79.73000000000009, 73.58000000000003, 81.7800000000001, 77.63000000000008, 100.23000000000022, 102.18000000000019, 85.78000000000009, 89.98000000000012, 67.43000000000002, 73.38800000000003, 89.78000000000009, 83.68000000000008, 69.37999999999998, 93.98000000000015, 59.22999999999998, 67.43, 67.43, 65.37999999999998, 77.68000000000008, 77.48000000000003, 59.22999999999999, 108.2300000000002, 69.27999999999999, 79.38000000000001, 122.63000000000031, 48.73000000000002, 79.73000000000009, 71.38000000000001, 75.43000000000002, 75.63000000000007, 59.08000000000001, 85.73000000000009, 69.32999999999998, 85.44800000000012, 93.93000000000015, 65.13000000000001, 65.17999999999999, 79.48000000000003, 73.43, 108.28000000000021, 75.38, 73.48000000000002, 69.33, 69.43000000000002, 85.68000000000008, 79.68000000000008, 79.73000000000009, 69.48000000000003, 87.63000000000007, 124.83000000000035, 96.03000000000016, 75.63000000000007, 77.58000000000007, 81.68000000000009, 63.22999999999999, 85.78000000000011, 71.38, 73.58000000000004, 67.32999999999998, 79.68000000000008, 104.23000000000022, 73.53000000000006, 77.68000000000008, 79.68000000000008, 77.53000000000003, 104.2300000000002, 98.03000000000017, 79.73000000000008, 77.58000000000006, 91.98000000000016, 67.43, 69.43000000000002, 79.7300000000001, 118.68000000000032, 67.43, 79.63000000000007, 77.58000000000006, 93.93000000000013, 71.48000000000005, 61.18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2187260126683146, "mean_inference_ms": 0.8248418831974668, "mean_action_processing_ms": 0.13868044328927023, "mean_env_wait_ms": 1.804036376049612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002242445945739746, "StateBufferConnector_ms": 0.0021246671676635742, "ViewRequirementAgentConnector_ms": 0.05070614814758301}, "num_episodes": 30, "episode_return_max": 247.5899999999995, "episode_return_min": 148.85400000000007, "episode_return_mean": 209.3926700000003, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 119783, "num_agent_steps_trained": 119783, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 228.7361459250472, "num_env_steps_trained_throughput_per_sec": 228.7361459250472, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 119783, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 119783, "timers": {"training_iteration_time_ms": 21701.42, "restore_workers_time_ms": 0.01, "training_step_time_ms": 21701.393, "sample_time_ms": 19583.528, "learn_time_ms": 2117.626, "learn_throughput": 1888.908, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 119783, "num_agent_steps_trained": 119783}, "done": false, "training_iteration": 10, "trial_id": "default", "date": "2025-10-13_02-11-32", "timestamp": 1760335892, "time_this_iter_s": 17.487948894500732, "time_total_s": 217.01932334899902, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 217.01932334899902, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 32.476000000000006, "ram_util_percent": 34.536}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 2.920259489710369, "policy_loss": -0.011041055531019256, "vf_loss": 6.0726670121389725, "vf_explained_var": -0.019986104870599413, "kl": 0.009672799379921595, "entropy": 10.55166031519572, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6605.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.448486639559269, "policy_loss": -0.01800883330142824, "vf_loss": 5.140759107470513, "vf_explained_var": -0.02227818574756384, "kl": 0.011483782414779894, "entropy": 10.445825645327568, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 131783, "num_agent_steps_trained": 131783}, "env_runners": {"episode_reward_max": 244.8400000000001, "episode_reward_min": 148.85400000000007, "episode_reward_mean": 206.26299000000031, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 8.179999999999996, "hider_policy": 35.14399999999999}, "policy_reward_max": {"seeker_policy": 59.980000000000125, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 45.580030000000036, "hider_policy": 80.34148000000009}, "custom_metrics": {}, "hist_stats": {"episode_reward": [220.1400000000004, 219.74000000000046, 148.85400000000007, 218.24000000000035, 219.74000000000032, 194.7900000000002, 222.14000000000033, 226.19000000000045, 208.59000000000034, 206.29000000000025, 208.1900000000004, 200.7900000000003, 197.49900000000028, 201.19000000000028, 207.69000000000037, 217.6400000000004, 192.94000000000025, 244.8400000000001, 217.14000000000038, 211.34000000000037, 204.2900000000004, 217.19000000000054, 227.49000000000046, 199.24000000000026, 219.09000000000043, 196.84000000000032, 209.3400000000004, 200.6900000000003, 201.44000000000037, 206.99000000000035, 212.29000000000053, 202.5900000000004, 206.19000000000028, 229.09000000000054, 213.64000000000038, 193.49800000000022, 212.54000000000025, 209.8400000000004, 186.6400000000002, 192.69000000000023, 201.1400000000003, 212.4400000000003, 201.54000000000016, 211.9400000000003, 201.5900000000003, 202.94000000000025, 198.29000000000016, 194.85800000000023, 207.04000000000022, 198.14000000000013, 217.39000000000044, 200.2400000000003, 196.24000000000015, 209.5400000000004, 201.39000000000036, 233.24000000000052, 212.3400000000004, 204.74000000000032, 197.99000000000032, 199.34000000000034, 198.99000000000024, 215.04000000000033, 204.84000000000034, 217.14000000000047, 216.34000000000037, 211.24000000000035, 195.34000000000026, 227.59000000000046, 200.14000000000033, 212.6900000000003, 192.14000000000019, 207.79000000000036, 198.59000000000026, 195.6400000000004, 200.5900000000003, 212.04000000000036, 202.39000000000036, 196.24000000000035, 197.94000000000037, 201.09000000000026, 198.7400000000004, 209.0400000000004, 203.29000000000022, 201.44000000000037, 200.04000000000033, 215.04000000000045, 198.64000000000033, 203.39000000000033, 196.3900000000003, 205.84000000000032, 233.54000000000062, 213.54000000000033, 200.79000000000045, 207.34000000000046, 196.3900000000002, 196.5400000000004, 219.74000000000058, 194.19000000000028, 202.39000000000033, 198.2400000000003], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [34.07999999999996, 33.679999999999964, 38.07999999999996, 36.48, 33.77999999999999, 58.08000000000005, 32.27999999999996, 25.87999999999998, 42.97999999999997, 40.98000000000005, 44.780000000000044, 51.58000000000002, 50.48300000000001, 51.98000000000004, 46.17999999999999, 37.67999999999996, 53.9800000000001, 8.179999999999996, 37.17999999999999, 41.68, 48.98000000000006, 35.27999999999997, 27.27999999999997, 54.28000000000005, 35.17999999999995, 55.88000000000009, 45.78000000000001, 51.58000000000004, 52.280000000000065, 45.58, 42.57999999999999, 49.280000000000065, 46.77999999999999, 26.679999999999957, 37.879999999999974, 52.68000000000001, 39.07999999999999, 46.480000000000075, 59.980000000000125, 59.88000000000006, 45.980000000000054, 44.97999999999998, 52.88000000000004, 40.579999999999984, 50.480000000000054, 51.880000000000024, 53.48000000000007, 40.07999999999999, 47.98000000000001, 53.48000000000005, 35.67999999999997, 51.3800000000001, 57.480000000000054, 44.18000000000002, 52.18, 20.779999999999987, 40.680000000000014, 45.48000000000006, 48.9800000000001, 54.380000000000045, 51.98000000000008, 37.27999999999998, 47.480000000000025, 35.37999999999996, 38.58, 41.67999999999998, 58.480000000000075, 29.179999999999982, 53.080000000000055, 41.17999999999998, 59.48000000000005, 46.28000000000002, 53.48000000000004, 56.680000000000064, 51.38000000000002, 40.28000000000001, 44.98000000000002, 57.28000000000002, 54.88000000000006, 51.88000000000005, 55.68000000000006, 45.480000000000004, 49.97999999999998, 46.080000000000034, 52.88000000000006, 39.180000000000014, 55.58000000000002, 50.08000000000003, 55.380000000000095, 46.38000000000001, 20.779999999999944, 41.78000000000001, 51.58000000000007, 47.88000000000007, 55.38000000000001, 57.580000000000055, 35.679999999999964, 53.18000000000004, 44.980000000000075, 55.18000000000008], "policy_hider_policy_reward": [61.23, 124.83000000000035, 92.03000000000017, 94.03000000000017, 75.63000000000008, 35.14399999999999, 112.38000000000025, 69.38000000000001, 98.1800000000002, 87.78000000000011, 71.33000000000001, 65.38000000000001, 65.12999999999998, 124.73000000000033, 81.68000000000006, 118.63000000000031, 79.73000000000009, 85.88000000000014, 77.48000000000003, 87.83000000000013, 95.98000000000015, 67.43, 67.43, 81.78000000000009, 78.63300000000008, 68.38300000000001, 73.58000000000007, 75.63000000000007, 85.88000000000011, 75.63000000000005, 81.78000000000009, 98.18000000000018, 67.42999999999999, 71.53000000000004, 119.33000000000001, 117.33000000000001, 98.1800000000002, 81.78000000000009, 71.53000000000004, 98.1300000000002, 65.32999999999998, 89.98000000000015, 96.13000000000017, 85.78000000000009, 124.63000000000031, 75.58000000000004, 85.83000000000013, 59.12999999999999, 124.68000000000032, 59.22999999999999, 69.43, 71.53000000000002, 77.68000000000008, 85.88000000000012, 81.7800000000001, 67.32999999999998, 77.63000000000005, 71.53000000000004, 81.78000000000009, 79.63000000000007, 85.88000000000012, 83.83000000000011, 79.73000000000009, 73.58000000000003, 81.7800000000001, 77.63000000000008, 100.23000000000022, 102.18000000000019, 85.78000000000009, 89.98000000000012, 67.43000000000002, 73.38800000000003, 89.78000000000009, 83.68000000000008, 69.37999999999998, 93.98000000000015, 59.22999999999998, 67.43, 67.43, 65.37999999999998, 77.68000000000008, 77.48000000000003, 59.22999999999999, 108.2300000000002, 69.27999999999999, 79.38000000000001, 122.63000000000031, 48.73000000000002, 79.73000000000009, 71.38000000000001, 75.43000000000002, 75.63000000000007, 59.08000000000001, 85.73000000000009, 69.32999999999998, 85.44800000000012, 93.93000000000015, 65.13000000000001, 65.17999999999999, 79.48000000000003, 73.43, 108.28000000000021, 75.38, 73.48000000000002, 69.33, 69.43000000000002, 85.68000000000008, 79.68000000000008, 79.73000000000009, 69.48000000000003, 87.63000000000007, 124.83000000000035, 96.03000000000016, 75.63000000000007, 77.58000000000007, 81.68000000000009, 63.22999999999999, 85.78000000000011, 71.38, 73.58000000000004, 67.32999999999998, 79.68000000000008, 104.23000000000022, 73.53000000000006, 77.68000000000008, 79.68000000000008, 77.53000000000003, 104.2300000000002, 98.03000000000017, 79.73000000000008, 77.58000000000006, 91.98000000000016, 67.43, 69.43000000000002, 79.7300000000001, 118.68000000000032, 67.43, 79.63000000000007, 77.58000000000006, 93.93000000000013, 71.48000000000005, 61.18, 81.7800000000001, 79.73000000000009, 71.53000000000006, 73.58000000000003, 81.7800000000001, 57.18000000000002, 75.63000000000005, 73.58000000000006, 87.93000000000013, 83.83000000000013, 69.48000000000003, 87.93000000000013, 61.28000000000001, 77.68000000000006, 67.43000000000002, 75.63000000000005, 81.78000000000011, 67.42999999999999, 71.53000000000004, 71.53000000000003, 81.7800000000001, 81.7800000000001, 69.48000000000002, 83.83000000000011, 81.78000000000009, 73.58000000000006, 69.48000000000002, 77.68000000000006, 87.93000000000013, 87.93000000000015, 77.68000000000008, 65.38, 73.58000000000004, 79.73000000000009, 67.43, 73.58000000000004, 83.83000000000011, 75.63000000000008, 122.78000000000034, 89.98000000000013, 92.03000000000017, 79.73000000000009, 79.73000000000008, 69.48, 87.93000000000012, 71.53000000000003, 67.43000000000002, 73.58000000000004, 71.53000000000003, 67.43000000000002, 106.38000000000024, 77.68000000000006, 61.28000000000001, 79.73000000000009, 85.88000000000012, 71.53000000000004, 73.58000000000006, 69.48000000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2249305514208353, "mean_inference_ms": 0.820051698534223, "mean_action_processing_ms": 0.13861090174132915, "mean_env_wait_ms": 1.8152816626638453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022420883178710938, "StateBufferConnector_ms": 0.0021108388900756836, "ViewRequirementAgentConnector_ms": 0.051285505294799805}, "num_episodes": 29, "episode_return_max": 244.8400000000001, "episode_return_min": 148.85400000000007, "episode_return_mean": 206.26299000000031, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131783, "num_agent_steps_trained": 131783, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.6581678327289, "num_env_steps_trained_throughput_per_sec": 129.6581678327289, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 131783, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 131783, "timers": {"training_iteration_time_ms": 22952.857, "restore_workers_time_ms": 0.009, "training_step_time_ms": 22952.833, "sample_time_ms": 20829.19, "learn_time_ms": 2123.408, "learn_throughput": 1883.764, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 131783, "num_agent_steps_trained": 131783}, "done": false, "training_iteration": 11, "trial_id": "default", "date": "2025-10-13_02-12-03", "timestamp": 1760335923, "time_this_iter_s": 30.850927114486694, "time_total_s": 247.87025046348572, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 247.87025046348572, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.884444444444448, "ram_util_percent": 34.07333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 3.02971656625233, "policy_loss": -0.013145108585290256, "vf_loss": 6.294471601455931, "vf_explained_var": -0.01350964449700855, "kl": 0.0101150628306699, "entropy": 10.48798853707692, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 7235.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.480330316349864, "policy_loss": -0.01961220786033664, "vf_loss": 5.2087078303098675, "vf_explained_var": -0.013348058424890041, "kl": 0.012847831947556232, "entropy": 10.505378642678261, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3680.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 143783, "num_agent_steps_trained": 143783}, "env_runners": {"episode_reward_max": 245.94000000000074, "episode_reward_min": 186.6400000000002, "episode_reward_mean": 205.98276000000038, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 8.580000000000021, "hider_policy": 48.73000000000002}, "policy_reward_max": {"seeker_policy": 60.780000000000065, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 46.52000000000002, "hider_policy": 79.73138000000009}, "custom_metrics": {}, "hist_stats": {"episode_reward": [212.29000000000053, 202.5900000000004, 206.19000000000028, 229.09000000000054, 213.64000000000038, 193.49800000000022, 212.54000000000025, 209.8400000000004, 186.6400000000002, 192.69000000000023, 201.1400000000003, 212.4400000000003, 201.54000000000016, 211.9400000000003, 201.5900000000003, 202.94000000000025, 198.29000000000016, 194.85800000000023, 207.04000000000022, 198.14000000000013, 217.39000000000044, 200.2400000000003, 196.24000000000015, 209.5400000000004, 201.39000000000036, 233.24000000000052, 212.3400000000004, 204.74000000000032, 197.99000000000032, 199.34000000000034, 198.99000000000024, 215.04000000000033, 204.84000000000034, 217.14000000000047, 216.34000000000037, 211.24000000000035, 195.34000000000026, 227.59000000000046, 200.14000000000033, 212.6900000000003, 192.14000000000019, 207.79000000000036, 198.59000000000026, 195.6400000000004, 200.5900000000003, 212.04000000000036, 202.39000000000036, 196.24000000000035, 197.94000000000037, 201.09000000000026, 198.7400000000004, 209.0400000000004, 203.29000000000022, 201.44000000000037, 200.04000000000033, 215.04000000000045, 198.64000000000033, 203.39000000000033, 196.3900000000003, 205.84000000000032, 233.54000000000062, 213.54000000000033, 200.79000000000045, 207.34000000000046, 196.3900000000002, 196.5400000000004, 219.74000000000058, 194.19000000000028, 202.39000000000033, 198.2400000000003, 204.54000000000033, 208.4400000000004, 202.79000000000036, 226.04000000000048, 199.8400000000003, 194.14000000000016, 216.54000000000048, 192.09000000000026, 227.24000000000044, 227.59000000000054, 191.99000000000026, 193.1400000000003, 201.09000000000026, 207.49000000000038, 202.99000000000035, 209.94000000000037, 208.0400000000003, 199.14000000000036, 217.1400000000004, 208.19000000000042, 211.29000000000036, 196.09000000000026, 218.29000000000048, 194.64000000000024, 226.94000000000054, 205.5900000000004, 245.94000000000074, 207.29000000000042, 202.54000000000028, 191.5400000000003], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [42.57999999999999, 49.280000000000065, 46.77999999999999, 26.679999999999957, 37.879999999999974, 52.68000000000001, 39.07999999999999, 46.480000000000075, 59.980000000000125, 59.88000000000006, 45.980000000000054, 44.97999999999998, 52.88000000000004, 40.579999999999984, 50.480000000000054, 51.880000000000024, 53.48000000000007, 40.07999999999999, 47.98000000000001, 53.48000000000005, 35.67999999999997, 51.3800000000001, 57.480000000000054, 44.18000000000002, 52.18, 20.779999999999987, 40.680000000000014, 45.48000000000006, 48.9800000000001, 54.380000000000045, 51.98000000000008, 37.27999999999998, 47.480000000000025, 35.37999999999996, 38.58, 41.67999999999998, 58.480000000000075, 29.179999999999982, 53.080000000000055, 41.17999999999998, 59.48000000000005, 46.28000000000002, 53.48000000000004, 56.680000000000064, 51.38000000000002, 40.28000000000001, 44.98000000000002, 57.28000000000002, 54.88000000000006, 51.88000000000005, 55.68000000000006, 45.480000000000004, 49.97999999999998, 46.080000000000034, 52.88000000000006, 39.180000000000014, 55.58000000000002, 50.08000000000003, 55.380000000000095, 46.38000000000001, 20.779999999999944, 41.78000000000001, 51.58000000000007, 47.88000000000007, 55.38000000000001, 57.580000000000055, 35.679999999999964, 53.18000000000004, 44.980000000000075, 55.18000000000008, 49.18000000000003, 44.88000000000003, 49.48000000000003, 29.67999999999996, 52.68000000000003, 59.28000000000006, 36.580000000000005, 59.28000000000011, 26.77999999999998, 20.979999999999986, 59.18000000000006, 58.28000000000008, 51.88000000000003, 45.980000000000025, 49.68000000000005, 42.28, 44.48, 56.08000000000004, 37.18, 46.680000000000014, 41.57999999999999, 50.98000000000008, 36.27999999999999, 55.68000000000008, 26.479999999999947, 48.18000000000004, 8.580000000000021, 45.78000000000004, 51.279999999999994, 60.780000000000065], "policy_hider_policy_reward": [85.88000000000012, 83.83000000000011, 79.73000000000009, 73.58000000000003, 81.7800000000001, 77.63000000000008, 100.23000000000022, 102.18000000000019, 85.78000000000009, 89.98000000000012, 67.43000000000002, 73.38800000000003, 89.78000000000009, 83.68000000000008, 69.37999999999998, 93.98000000000015, 59.22999999999998, 67.43, 67.43, 65.37999999999998, 77.68000000000008, 77.48000000000003, 59.22999999999999, 108.2300000000002, 69.27999999999999, 79.38000000000001, 122.63000000000031, 48.73000000000002, 79.73000000000009, 71.38000000000001, 75.43000000000002, 75.63000000000007, 59.08000000000001, 85.73000000000009, 69.32999999999998, 85.44800000000012, 93.93000000000015, 65.13000000000001, 65.17999999999999, 79.48000000000003, 73.43, 108.28000000000021, 75.38, 73.48000000000002, 69.33, 69.43000000000002, 85.68000000000008, 79.68000000000008, 79.73000000000009, 69.48000000000003, 87.63000000000007, 124.83000000000035, 96.03000000000016, 75.63000000000007, 77.58000000000007, 81.68000000000009, 63.22999999999999, 85.78000000000011, 71.38, 73.58000000000004, 67.32999999999998, 79.68000000000008, 104.23000000000022, 73.53000000000006, 77.68000000000008, 79.68000000000008, 77.53000000000003, 104.2300000000002, 98.03000000000017, 79.73000000000008, 77.58000000000006, 91.98000000000016, 67.43, 69.43000000000002, 79.7300000000001, 118.68000000000032, 67.43, 79.63000000000007, 77.58000000000006, 93.93000000000013, 71.48000000000005, 61.18, 81.7800000000001, 79.73000000000009, 71.53000000000006, 73.58000000000003, 81.7800000000001, 57.18000000000002, 75.63000000000005, 73.58000000000006, 87.93000000000013, 83.83000000000013, 69.48000000000003, 87.93000000000013, 61.28000000000001, 77.68000000000006, 67.43000000000002, 75.63000000000005, 81.78000000000011, 67.42999999999999, 71.53000000000004, 71.53000000000003, 81.7800000000001, 81.7800000000001, 69.48000000000002, 83.83000000000011, 81.78000000000009, 73.58000000000006, 69.48000000000002, 77.68000000000006, 87.93000000000013, 87.93000000000015, 77.68000000000008, 65.38, 73.58000000000004, 79.73000000000009, 67.43, 73.58000000000004, 83.83000000000011, 75.63000000000008, 122.78000000000034, 89.98000000000013, 92.03000000000017, 79.73000000000009, 79.73000000000008, 69.48, 87.93000000000012, 71.53000000000003, 67.43000000000002, 73.58000000000004, 71.53000000000003, 67.43000000000002, 106.38000000000024, 77.68000000000006, 61.28000000000001, 79.73000000000009, 85.88000000000012, 71.53000000000004, 73.58000000000006, 69.48000000000003, 85.88000000000014, 69.48000000000003, 75.63000000000005, 87.93000000000013, 67.43000000000002, 85.88000000000011, 71.53000000000004, 124.83000000000035, 79.73000000000009, 67.43000000000004, 69.48000000000005, 65.38000000000002, 94.08000000000015, 85.88000000000014, 69.48000000000003, 63.33, 75.63000000000007, 124.83000000000035, 81.7800000000001, 124.83000000000035, 67.43000000000002, 65.38, 65.38, 69.48000000000002, 81.7800000000001, 67.43000000000002, 75.63000000000007, 85.88000000000012, 87.93000000000013, 65.38000000000001, 79.7300000000001, 87.93000000000013, 79.73000000000009, 83.83000000000011, 69.48, 73.58000000000003, 81.7800000000001, 98.1800000000002, 83.83000000000011, 77.68000000000008, 81.7800000000001, 87.93000000000013, 75.63000000000008, 69.48000000000002, 75.63000000000007, 106.38000000000022, 61.28, 77.68000000000006, 96.13000000000018, 104.33000000000024, 77.68000000000008, 79.73000000000008, 124.83000000000035, 112.53000000000029, 85.88000000000014, 75.63000000000005, 71.53000000000004, 79.7300000000001, 61.28, 69.48000000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2948801867155377, "mean_inference_ms": 0.8173782053197116, "mean_action_processing_ms": 0.13870438373313454, "mean_env_wait_ms": 1.8293998965353615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022034645080566406, "StateBufferConnector_ms": 0.002138376235961914, "ViewRequirementAgentConnector_ms": 0.05193126201629639}, "num_episodes": 30, "episode_return_max": 245.94000000000074, "episode_return_min": 186.6400000000002, "episode_return_mean": 205.98276000000038, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143783, "num_agent_steps_trained": 143783, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.4175150791558, "num_env_steps_trained_throughput_per_sec": 125.4175150791558, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 143783, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 143783, "timers": {"training_iteration_time_ms": 24378.091, "restore_workers_time_ms": 0.009, "training_step_time_ms": 24378.068, "sample_time_ms": 22256.502, "learn_time_ms": 2121.339, "learn_throughput": 1885.601, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 143783, "num_agent_steps_trained": 143783}, "done": false, "training_iteration": 12, "trial_id": "default", "date": "2025-10-13_02-12-35", "timestamp": 1760335955, "time_this_iter_s": 31.894159078598022, "time_total_s": 279.76440954208374, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 279.76440954208374, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 21.49777777777778, "ram_util_percent": 34.12888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 3.0349588884247676, "policy_loss": -0.016033071665359395, "vf_loss": 6.3107619005536275, "vf_explained_var": 0.05796635150909424, "kl": 0.010355125690050485, "entropy": 10.490673943171425, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.98412698412699, "num_grad_updates_lifetime": 7865.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.3888529021292926, "policy_loss": -0.0200273351627402, "vf_loss": 5.029619824886322, "vf_explained_var": 0.19923360645771027, "kl": 0.010362956552506887, "entropy": 10.644782742857933, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4000.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 155720, "num_agent_steps_trained": 155720}, "env_runners": {"episode_reward_max": 245.94000000000074, "episode_reward_min": 146.95300000000006, "episode_reward_mean": 205.59163000000032, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 8.580000000000021, "hider_policy": 32.09299999999999}, "policy_reward_max": {"seeker_policy": 68.88000000000002, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 46.17700000000003, "hider_policy": 79.70731500000008}, "custom_metrics": {}, "hist_stats": {"episode_reward": [198.99000000000024, 215.04000000000033, 204.84000000000034, 217.14000000000047, 216.34000000000037, 211.24000000000035, 195.34000000000026, 227.59000000000046, 200.14000000000033, 212.6900000000003, 192.14000000000019, 207.79000000000036, 198.59000000000026, 195.6400000000004, 200.5900000000003, 212.04000000000036, 202.39000000000036, 196.24000000000035, 197.94000000000037, 201.09000000000026, 198.7400000000004, 209.0400000000004, 203.29000000000022, 201.44000000000037, 200.04000000000033, 215.04000000000045, 198.64000000000033, 203.39000000000033, 196.3900000000003, 205.84000000000032, 233.54000000000062, 213.54000000000033, 200.79000000000045, 207.34000000000046, 196.3900000000002, 196.5400000000004, 219.74000000000058, 194.19000000000028, 202.39000000000033, 198.2400000000003, 204.54000000000033, 208.4400000000004, 202.79000000000036, 226.04000000000048, 199.8400000000003, 194.14000000000016, 216.54000000000048, 192.09000000000026, 227.24000000000044, 227.59000000000054, 191.99000000000026, 193.1400000000003, 201.09000000000026, 207.49000000000038, 202.99000000000035, 209.94000000000037, 208.0400000000003, 199.14000000000036, 217.1400000000004, 208.19000000000042, 211.29000000000036, 196.09000000000026, 218.29000000000048, 194.64000000000024, 226.94000000000054, 205.5900000000004, 245.94000000000074, 207.29000000000042, 202.54000000000028, 191.5400000000003, 225.03999999999934, 207.49000000000018, 218.69000000000042, 230.1900000000004, 197.64000000000013, 204.39000000000027, 201.24000000000024, 183.24000000000012, 208.09000000000026, 208.34000000000032, 202.19000000000017, 202.49000000000018, 207.29000000000025, 190.04000000000013, 196.39000000000027, 211.59000000000032, 205.2400000000003, 146.95300000000006, 201.44000000000028, 223.69000000000042, 198.89000000000019, 199.09000000000015, 204.4900000000003, 214.69000000000028, 195.49000000000012, 208.7400000000003, 203.1900000000003, 195.8400000000003, 230.19000000000054, 199.99000000000026], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [51.98000000000008, 37.27999999999998, 47.480000000000025, 35.37999999999996, 38.58, 41.67999999999998, 58.480000000000075, 29.179999999999982, 53.080000000000055, 41.17999999999998, 59.48000000000005, 46.28000000000002, 53.48000000000004, 56.680000000000064, 51.38000000000002, 40.28000000000001, 44.98000000000002, 57.28000000000002, 54.88000000000006, 51.88000000000005, 55.68000000000006, 45.480000000000004, 49.97999999999998, 46.080000000000034, 52.88000000000006, 39.180000000000014, 55.58000000000002, 50.08000000000003, 55.380000000000095, 46.38000000000001, 20.779999999999944, 41.78000000000001, 51.58000000000007, 47.88000000000007, 55.38000000000001, 57.580000000000055, 35.679999999999964, 53.18000000000004, 44.980000000000075, 55.18000000000008, 49.18000000000003, 44.88000000000003, 49.48000000000003, 29.67999999999996, 52.68000000000003, 59.28000000000006, 36.580000000000005, 59.28000000000011, 26.77999999999998, 20.979999999999986, 59.18000000000006, 58.28000000000008, 51.88000000000003, 45.980000000000025, 49.68000000000005, 42.28, 44.48, 56.08000000000004, 37.18, 46.680000000000014, 41.57999999999999, 50.98000000000008, 36.27999999999999, 55.68000000000008, 26.479999999999947, 48.18000000000004, 8.580000000000021, 45.78000000000004, 51.279999999999994, 60.780000000000065, 17.979999999999936, 44.68, 37.07999999999996, 22.37999999999997, 55.28000000000006, 47.48000000000007, 50.580000000000055, 68.88000000000002, 45.18000000000005, 38.98000000000001, 49.38000000000003, 47.58000000000006, 44.179999999999986, 61.78000000000005, 55.780000000000086, 40.28, 47.98000000000007, 39.48000000000001, 52.68000000000003, 29.479999999999965, 52.080000000000005, 50.380000000000024, 49.28, 35.279999999999966, 57.08000000000005, 43.58, 43.98000000000004, 56.88000000000005, 23.57999999999999, 50.78000000000001], "policy_hider_policy_reward": [67.32999999999998, 79.68000000000008, 104.23000000000022, 73.53000000000006, 77.68000000000008, 79.68000000000008, 77.53000000000003, 104.2300000000002, 98.03000000000017, 79.73000000000008, 77.58000000000006, 91.98000000000016, 67.43, 69.43000000000002, 79.7300000000001, 118.68000000000032, 67.43, 79.63000000000007, 77.58000000000006, 93.93000000000013, 71.48000000000005, 61.18, 81.7800000000001, 79.73000000000009, 71.53000000000006, 73.58000000000003, 81.7800000000001, 57.18000000000002, 75.63000000000005, 73.58000000000006, 87.93000000000013, 83.83000000000013, 69.48000000000003, 87.93000000000013, 61.28000000000001, 77.68000000000006, 67.43000000000002, 75.63000000000005, 81.78000000000011, 67.42999999999999, 71.53000000000004, 71.53000000000003, 81.7800000000001, 81.7800000000001, 69.48000000000002, 83.83000000000011, 81.78000000000009, 73.58000000000006, 69.48000000000002, 77.68000000000006, 87.93000000000013, 87.93000000000015, 77.68000000000008, 65.38, 73.58000000000004, 79.73000000000009, 67.43, 73.58000000000004, 83.83000000000011, 75.63000000000008, 122.78000000000034, 89.98000000000013, 92.03000000000017, 79.73000000000009, 79.73000000000008, 69.48, 87.93000000000012, 71.53000000000003, 67.43000000000002, 73.58000000000004, 71.53000000000003, 67.43000000000002, 106.38000000000024, 77.68000000000006, 61.28000000000001, 79.73000000000009, 85.88000000000012, 71.53000000000004, 73.58000000000006, 69.48000000000003, 85.88000000000014, 69.48000000000003, 75.63000000000005, 87.93000000000013, 67.43000000000002, 85.88000000000011, 71.53000000000004, 124.83000000000035, 79.73000000000009, 67.43000000000004, 69.48000000000005, 65.38000000000002, 94.08000000000015, 85.88000000000014, 69.48000000000003, 63.33, 75.63000000000007, 124.83000000000035, 81.7800000000001, 124.83000000000035, 67.43000000000002, 65.38, 65.38, 69.48000000000002, 81.7800000000001, 67.43000000000002, 75.63000000000007, 85.88000000000012, 87.93000000000013, 65.38000000000001, 79.7300000000001, 87.93000000000013, 79.73000000000009, 83.83000000000011, 69.48, 73.58000000000003, 81.7800000000001, 98.1800000000002, 83.83000000000011, 77.68000000000008, 81.7800000000001, 87.93000000000013, 75.63000000000008, 69.48000000000002, 75.63000000000007, 106.38000000000022, 61.28, 77.68000000000006, 96.13000000000018, 104.33000000000024, 77.68000000000008, 79.73000000000008, 124.83000000000035, 112.53000000000029, 85.88000000000014, 75.63000000000005, 71.53000000000004, 79.7300000000001, 61.28, 69.48000000000002, 99.47999999999986, 107.57999999999981, 85.48000000000003, 77.32999999999998, 97.7800000000001, 83.8300000000001, 112.08000000000017, 95.7300000000001, 65.02999999999999, 77.33, 75.38000000000001, 81.53000000000004, 89.63000000000008, 61.03000000000001, 57.180000000000014, 57.18, 79.38000000000001, 83.53000000000004, 83.83000000000011, 85.53000000000004, 85.43000000000002, 67.38000000000001, 71.17999999999996, 83.73000000000008, 67.12999999999995, 95.98000000000015, 56.83000000000004, 71.43000000000002, 79.43, 61.17999999999999, 87.63000000000005, 83.68000000000006, 81.63000000000007, 75.63000000000008, 32.09299999999999, 75.38000000000001, 75.38000000000001, 73.38, 122.78000000000034, 71.43000000000002, 83.53000000000006, 63.28, 67.12999999999997, 81.58000000000006, 73.58000000000004, 81.63000000000007, 101.93000000000015, 77.48000000000003, 69.07999999999998, 69.33, 81.38, 83.78000000000011, 79.58000000000006, 79.63000000000005, 69.48000000000002, 69.48000000000002, 124.83000000000035, 81.78000000000011, 79.7300000000001, 69.48000000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3722712049200685, "mean_inference_ms": 0.8147806120086857, "mean_action_processing_ms": 0.1386659639534846, "mean_env_wait_ms": 1.8405490951155046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022165775299072266, "StateBufferConnector_ms": 0.0021250247955322266, "ViewRequirementAgentConnector_ms": 0.05201554298400879}, "num_episodes": 30, "episode_return_max": 245.94000000000074, "episode_return_min": 146.95300000000006, "episode_return_mean": 205.59163000000032, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155720, "num_agent_steps_trained": 155720, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.05676349421879, "num_env_steps_trained_throughput_per_sec": 214.05676349421879, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 155720, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 155720, "timers": {"training_iteration_time_ms": 24507.571, "restore_workers_time_ms": 0.009, "training_step_time_ms": 24507.548, "sample_time_ms": 22406.045, "learn_time_ms": 2101.284, "learn_throughput": 1903.598, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 155720, "num_agent_steps_trained": 155720}, "done": false, "training_iteration": 13, "trial_id": "default", "date": "2025-10-13_02-12-54", "timestamp": 1760335974, "time_this_iter_s": 18.687211990356445, "time_total_s": 298.4516215324402, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 298.4516215324402, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 31.018518518518515, "ram_util_percent": 34.522222222222226}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 2.971390002114432, "policy_loss": -0.011938087089312455, "vf_loss": 6.180448093111553, "vf_explained_var": -0.005813162099747431, "kl": 0.009934998634650161, "entropy": 10.739271107930985, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.68253968253968, "num_grad_updates_lifetime": 8495.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.4754141092300417, "policy_loss": -0.017237430920067708, "vf_loss": 5.198072184622288, "vf_explained_var": 0.024955586530268192, "kl": 0.011102894745533888, "entropy": 10.693969342112542, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 167701, "num_agent_steps_trained": 167701}, "env_runners": {"episode_reward_max": 245.94000000000074, "episode_reward_min": 146.95300000000006, "episode_reward_mean": 206.65832000000034, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 8.580000000000021, "hider_policy": 32.09299999999999}, "policy_reward_max": {"seeker_policy": 68.88000000000002, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 44.82500000000002, "hider_policy": 80.91666000000008}, "custom_metrics": {}, "hist_stats": {"episode_reward": [205.84000000000032, 233.54000000000062, 213.54000000000033, 200.79000000000045, 207.34000000000046, 196.3900000000002, 196.5400000000004, 219.74000000000058, 194.19000000000028, 202.39000000000033, 198.2400000000003, 204.54000000000033, 208.4400000000004, 202.79000000000036, 226.04000000000048, 199.8400000000003, 194.14000000000016, 216.54000000000048, 192.09000000000026, 227.24000000000044, 227.59000000000054, 191.99000000000026, 193.1400000000003, 201.09000000000026, 207.49000000000038, 202.99000000000035, 209.94000000000037, 208.0400000000003, 199.14000000000036, 217.1400000000004, 208.19000000000042, 211.29000000000036, 196.09000000000026, 218.29000000000048, 194.64000000000024, 226.94000000000054, 205.5900000000004, 245.94000000000074, 207.29000000000042, 202.54000000000028, 191.5400000000003, 225.03999999999934, 207.49000000000018, 218.69000000000042, 230.1900000000004, 197.64000000000013, 204.39000000000027, 201.24000000000024, 183.24000000000012, 208.09000000000026, 208.34000000000032, 202.19000000000017, 202.49000000000018, 207.29000000000025, 190.04000000000013, 196.39000000000027, 211.59000000000032, 205.2400000000003, 146.95300000000006, 201.44000000000028, 223.69000000000042, 198.89000000000019, 199.09000000000015, 204.4900000000003, 214.69000000000028, 195.49000000000012, 208.7400000000003, 203.1900000000003, 195.8400000000003, 230.19000000000054, 199.99000000000026, 209.99000000000038, 193.1090000000003, 221.5400000000006, 211.1900000000003, 213.74000000000044, 224.89000000000058, 194.39000000000027, 197.84000000000032, 209.59000000000043, 203.3400000000004, 210.2400000000004, 188.1900000000002, 208.89000000000033, 196.14000000000027, 210.7400000000004, 229.59000000000057, 187.0900000000002, 204.09000000000037, 226.29000000000053, 208.7900000000004, 230.74000000000058, 195.99000000000032, 199.1900000000004, 204.44000000000034, 227.44000000000057, 209.59000000000037, 213.1900000000004, 199.74000000000035, 206.49000000000035], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [46.38000000000001, 20.779999999999944, 41.78000000000001, 51.58000000000007, 47.88000000000007, 55.38000000000001, 57.580000000000055, 35.679999999999964, 53.18000000000004, 44.980000000000075, 55.18000000000008, 49.18000000000003, 44.88000000000003, 49.48000000000003, 29.67999999999996, 52.68000000000003, 59.28000000000006, 36.580000000000005, 59.28000000000011, 26.77999999999998, 20.979999999999986, 59.18000000000006, 58.28000000000008, 51.88000000000003, 45.980000000000025, 49.68000000000005, 42.28, 44.48, 56.08000000000004, 37.18, 46.680000000000014, 41.57999999999999, 50.98000000000008, 36.27999999999999, 55.68000000000008, 26.479999999999947, 48.18000000000004, 8.580000000000021, 45.78000000000004, 51.279999999999994, 60.780000000000065, 17.979999999999936, 44.68, 37.07999999999996, 22.37999999999997, 55.28000000000006, 47.48000000000007, 50.580000000000055, 68.88000000000002, 45.18000000000005, 38.98000000000001, 49.38000000000003, 47.58000000000006, 44.179999999999986, 61.78000000000005, 55.780000000000086, 40.28, 47.98000000000007, 39.48000000000001, 52.68000000000003, 29.479999999999965, 52.080000000000005, 50.380000000000024, 49.28, 35.279999999999966, 57.08000000000005, 43.58, 43.98000000000004, 56.88000000000005, 23.57999999999999, 50.78000000000001, 44.38, 41.280000000000044, 33.37999999999995, 41.47999999999999, 37.88000000000002, 30.579999999999938, 57.480000000000075, 54.78000000000007, 43.98000000000003, 47.980000000000054, 42.580000000000034, 63.58000000000005, 43.27999999999998, 57.18000000000004, 43.08000000000002, 22.979999999999993, 62.480000000000054, 46.68000000000006, 27.87999999999996, 39.079999999999984, 17.980000000000018, 54.980000000000096, 54.080000000000055, 49.08000000000005, 26.97999999999997, 43.980000000000025, 39.37999999999998, 52.580000000000034, 44.97999999999998], "policy_hider_policy_reward": [83.83000000000011, 75.63000000000008, 122.78000000000034, 89.98000000000013, 92.03000000000017, 79.73000000000009, 79.73000000000008, 69.48, 87.93000000000012, 71.53000000000003, 67.43000000000002, 73.58000000000004, 71.53000000000003, 67.43000000000002, 106.38000000000024, 77.68000000000006, 61.28000000000001, 79.73000000000009, 85.88000000000012, 71.53000000000004, 73.58000000000006, 69.48000000000003, 85.88000000000014, 69.48000000000003, 75.63000000000005, 87.93000000000013, 67.43000000000002, 85.88000000000011, 71.53000000000004, 124.83000000000035, 79.73000000000009, 67.43000000000004, 69.48000000000005, 65.38000000000002, 94.08000000000015, 85.88000000000014, 69.48000000000003, 63.33, 75.63000000000007, 124.83000000000035, 81.7800000000001, 124.83000000000035, 67.43000000000002, 65.38, 65.38, 69.48000000000002, 81.7800000000001, 67.43000000000002, 75.63000000000007, 85.88000000000012, 87.93000000000013, 65.38000000000001, 79.7300000000001, 87.93000000000013, 79.73000000000009, 83.83000000000011, 69.48, 73.58000000000003, 81.7800000000001, 98.1800000000002, 83.83000000000011, 77.68000000000008, 81.7800000000001, 87.93000000000013, 75.63000000000008, 69.48000000000002, 75.63000000000007, 106.38000000000022, 61.28, 77.68000000000006, 96.13000000000018, 104.33000000000024, 77.68000000000008, 79.73000000000008, 124.83000000000035, 112.53000000000029, 85.88000000000014, 75.63000000000005, 71.53000000000004, 79.7300000000001, 61.28, 69.48000000000002, 99.47999999999986, 107.57999999999981, 85.48000000000003, 77.32999999999998, 97.7800000000001, 83.8300000000001, 112.08000000000017, 95.7300000000001, 65.02999999999999, 77.33, 75.38000000000001, 81.53000000000004, 89.63000000000008, 61.03000000000001, 57.180000000000014, 57.18, 79.38000000000001, 83.53000000000004, 83.83000000000011, 85.53000000000004, 85.43000000000002, 67.38000000000001, 71.17999999999996, 83.73000000000008, 67.12999999999995, 95.98000000000015, 56.83000000000004, 71.43000000000002, 79.43, 61.17999999999999, 87.63000000000005, 83.68000000000006, 81.63000000000007, 75.63000000000008, 32.09299999999999, 75.38000000000001, 75.38000000000001, 73.38, 122.78000000000034, 71.43000000000002, 83.53000000000006, 63.28, 67.12999999999997, 81.58000000000006, 73.58000000000004, 81.63000000000007, 101.93000000000015, 77.48000000000003, 69.07999999999998, 69.33, 81.38, 83.78000000000011, 79.58000000000006, 79.63000000000005, 69.48000000000002, 69.48000000000002, 124.83000000000035, 81.78000000000011, 79.7300000000001, 69.48000000000002, 79.73000000000008, 85.88000000000012, 77.68000000000008, 74.14900000000004, 108.43000000000025, 79.73000000000008, 92.03000000000017, 77.68000000000006, 98.1800000000002, 77.68000000000008, 112.53000000000029, 81.78000000000009, 69.48000000000002, 67.43, 69.48000000000002, 73.58000000000004, 92.03000000000017, 73.58000000000004, 77.68000000000006, 77.68000000000008, 83.83000000000011, 83.83000000000011, 61.28000000000001, 63.33, 85.88000000000012, 79.7300000000001, 63.33, 75.63000000000007, 77.68000000000008, 89.98000000000015, 114.5800000000003, 92.03000000000016, 63.33000000000001, 61.28, 79.73000000000009, 77.68000000000009, 73.58000000000006, 124.83000000000035, 89.98000000000015, 79.73000000000008, 87.93000000000013, 124.83000000000035, 73.58000000000006, 67.43000000000002, 73.58000000000004, 71.53000000000004, 79.73000000000009, 75.63000000000007, 116.63000000000031, 83.8300000000001, 92.03000000000016, 73.58000000000004, 87.93000000000015, 85.88000000000012, 73.58000000000006, 73.58000000000006, 83.83000000000011, 77.68000000000008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4615142833045143, "mean_inference_ms": 0.8135668806930481, "mean_action_processing_ms": 0.13881445390907388, "mean_env_wait_ms": 1.8528732803712609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022139549255371094, "StateBufferConnector_ms": 0.0021437406539916992, "ViewRequirementAgentConnector_ms": 0.05161237716674805}, "num_episodes": 29, "episode_return_max": 245.94000000000074, "episode_return_min": 146.95300000000006, "episode_return_mean": 206.65832000000034, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167701, "num_agent_steps_trained": 167701, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 128.22473960441073, "num_env_steps_trained_throughput_per_sec": 128.22473960441073, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 167701, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 167701, "timers": {"training_iteration_time_ms": 25630.556, "restore_workers_time_ms": 0.006, "training_step_time_ms": 25630.538, "sample_time_ms": 23539.834, "learn_time_ms": 2090.483, "learn_throughput": 1913.433, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 167701, "num_agent_steps_trained": 167701}, "done": false, "training_iteration": 14, "trial_id": "default", "date": "2025-10-13_02-13-25", "timestamp": 1760336005, "time_this_iter_s": 31.19576096534729, "time_total_s": 329.6473824977875, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 329.6473824977875, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.075000000000003, "ram_util_percent": 34.10227272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 3.1011446407863072, "policy_loss": -0.015549360568975172, "vf_loss": 6.447600208766877, "vf_explained_var": -0.006838364922811114, "kl": 0.012235389143477266, "entropy": 10.771786839621408, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 9125.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.528196047991514, "policy_loss": -0.01985101148020476, "vf_loss": 5.310448652505874, "vf_explained_var": 0.0015680275857448578, "kl": 0.01134960200588472, "entropy": 10.774473169445992, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4640.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 179701, "num_agent_steps_trained": 179701}, "env_runners": {"episode_reward_max": 245.94000000000074, "episode_reward_min": 146.95300000000006, "episode_reward_mean": 206.46082000000033, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 8.580000000000021, "hider_policy": 32.09299999999999}, "policy_reward_max": {"seeker_policy": 68.88000000000002, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 44.93500000000002, "hider_policy": 80.76291000000009}, "custom_metrics": {}, "hist_stats": {"episode_reward": [208.19000000000042, 211.29000000000036, 196.09000000000026, 218.29000000000048, 194.64000000000024, 226.94000000000054, 205.5900000000004, 245.94000000000074, 207.29000000000042, 202.54000000000028, 191.5400000000003, 225.03999999999934, 207.49000000000018, 218.69000000000042, 230.1900000000004, 197.64000000000013, 204.39000000000027, 201.24000000000024, 183.24000000000012, 208.09000000000026, 208.34000000000032, 202.19000000000017, 202.49000000000018, 207.29000000000025, 190.04000000000013, 196.39000000000027, 211.59000000000032, 205.2400000000003, 146.95300000000006, 201.44000000000028, 223.69000000000042, 198.89000000000019, 199.09000000000015, 204.4900000000003, 214.69000000000028, 195.49000000000012, 208.7400000000003, 203.1900000000003, 195.8400000000003, 230.19000000000054, 199.99000000000026, 209.99000000000038, 193.1090000000003, 221.5400000000006, 211.1900000000003, 213.74000000000044, 224.89000000000058, 194.39000000000027, 197.84000000000032, 209.59000000000043, 203.3400000000004, 210.2400000000004, 188.1900000000002, 208.89000000000033, 196.14000000000027, 210.7400000000004, 229.59000000000057, 187.0900000000002, 204.09000000000037, 226.29000000000053, 208.7900000000004, 230.74000000000058, 195.99000000000032, 199.1900000000004, 204.44000000000034, 227.44000000000057, 209.59000000000037, 213.1900000000004, 199.74000000000035, 206.49000000000035, 191.99000000000026, 208.64000000000038, 222.4400000000004, 183.14000000000019, 206.04000000000033, 209.69000000000042, 227.7400000000005, 225.34000000000043, 212.89000000000047, 196.24000000000024, 204.49000000000035, 207.29000000000033, 188.3400000000002, 213.09000000000046, 198.4900000000003, 201.0900000000003, 201.34000000000034, 201.0400000000004, 209.54000000000028, 209.19000000000034, 196.34000000000034, 225.2400000000004, 194.4900000000003, 205.69000000000034, 205.84000000000034, 208.1400000000004, 193.14000000000024, 204.49000000000026, 195.19000000000034, 232.3900000000005], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [46.680000000000014, 41.57999999999999, 50.98000000000008, 36.27999999999999, 55.68000000000008, 26.479999999999947, 48.18000000000004, 8.580000000000021, 45.78000000000004, 51.279999999999994, 60.780000000000065, 17.979999999999936, 44.68, 37.07999999999996, 22.37999999999997, 55.28000000000006, 47.48000000000007, 50.580000000000055, 68.88000000000002, 45.18000000000005, 38.98000000000001, 49.38000000000003, 47.58000000000006, 44.179999999999986, 61.78000000000005, 55.780000000000086, 40.28, 47.98000000000007, 39.48000000000001, 52.68000000000003, 29.479999999999965, 52.080000000000005, 50.380000000000024, 49.28, 35.279999999999966, 57.08000000000005, 43.58, 43.98000000000004, 56.88000000000005, 23.57999999999999, 50.78000000000001, 44.38, 41.280000000000044, 33.37999999999995, 41.47999999999999, 37.88000000000002, 30.579999999999938, 57.480000000000075, 54.78000000000007, 43.98000000000003, 47.980000000000054, 42.580000000000034, 63.58000000000005, 43.27999999999998, 57.18000000000004, 43.08000000000002, 22.979999999999993, 62.480000000000054, 46.68000000000006, 27.87999999999996, 39.079999999999984, 17.980000000000018, 54.980000000000096, 54.080000000000055, 49.08000000000005, 26.97999999999997, 43.980000000000025, 39.37999999999998, 52.580000000000034, 44.97999999999998, 55.08000000000006, 45.08000000000002, 30.17999999999994, 68.77999999999996, 46.57999999999998, 44.08000000000003, 27.279999999999987, 28.97999999999997, 39.08000000000001, 57.28000000000002, 47.08000000000003, 45.780000000000015, 65.78000000000004, 39.280000000000015, 53.38000000000006, 51.88000000000002, 45.980000000000075, 53.88000000000006, 45.98000000000001, 43.58000000000001, 53.280000000000115, 28.879999999999985, 57.58000000000005, 48.280000000000015, 42.280000000000015, 44.58000000000002, 58.28000000000006, 47.080000000000034, 58.28000000000006, 21.679999999999996], "policy_hider_policy_reward": [83.83000000000011, 77.68000000000008, 81.7800000000001, 87.93000000000013, 75.63000000000008, 69.48000000000002, 75.63000000000007, 106.38000000000022, 61.28, 77.68000000000006, 96.13000000000018, 104.33000000000024, 77.68000000000008, 79.73000000000008, 124.83000000000035, 112.53000000000029, 85.88000000000014, 75.63000000000005, 71.53000000000004, 79.7300000000001, 61.28, 69.48000000000002, 99.47999999999986, 107.57999999999981, 85.48000000000003, 77.32999999999998, 97.7800000000001, 83.8300000000001, 112.08000000000017, 95.7300000000001, 65.02999999999999, 77.33, 75.38000000000001, 81.53000000000004, 89.63000000000008, 61.03000000000001, 57.180000000000014, 57.18, 79.38000000000001, 83.53000000000004, 83.83000000000011, 85.53000000000004, 85.43000000000002, 67.38000000000001, 71.17999999999996, 83.73000000000008, 67.12999999999995, 95.98000000000015, 56.83000000000004, 71.43000000000002, 79.43, 61.17999999999999, 87.63000000000005, 83.68000000000006, 81.63000000000007, 75.63000000000008, 32.09299999999999, 75.38000000000001, 75.38000000000001, 73.38, 122.78000000000034, 71.43000000000002, 83.53000000000006, 63.28, 67.12999999999997, 81.58000000000006, 73.58000000000004, 81.63000000000007, 101.93000000000015, 77.48000000000003, 69.07999999999998, 69.33, 81.38, 83.78000000000011, 79.58000000000006, 79.63000000000005, 69.48000000000002, 69.48000000000002, 124.83000000000035, 81.78000000000011, 79.7300000000001, 69.48000000000002, 79.73000000000008, 85.88000000000012, 77.68000000000008, 74.14900000000004, 108.43000000000025, 79.73000000000008, 92.03000000000017, 77.68000000000006, 98.1800000000002, 77.68000000000008, 112.53000000000029, 81.78000000000009, 69.48000000000002, 67.43, 69.48000000000002, 73.58000000000004, 92.03000000000017, 73.58000000000004, 77.68000000000006, 77.68000000000008, 83.83000000000011, 83.83000000000011, 61.28000000000001, 63.33, 85.88000000000012, 79.7300000000001, 63.33, 75.63000000000007, 77.68000000000008, 89.98000000000015, 114.5800000000003, 92.03000000000016, 63.33000000000001, 61.28, 79.73000000000009, 77.68000000000009, 73.58000000000006, 124.83000000000035, 89.98000000000015, 79.73000000000008, 87.93000000000013, 124.83000000000035, 73.58000000000006, 67.43000000000002, 73.58000000000004, 71.53000000000004, 79.73000000000009, 75.63000000000007, 116.63000000000031, 83.8300000000001, 92.03000000000016, 73.58000000000004, 87.93000000000015, 85.88000000000012, 73.58000000000006, 73.58000000000006, 83.83000000000011, 77.68000000000008, 61.28, 75.63000000000007, 79.73000000000009, 83.83000000000011, 124.83000000000035, 67.42999999999999, 53.07999999999998, 61.27999999999999, 81.7800000000001, 77.68000000000008, 77.68000000000005, 87.93000000000013, 124.83000000000035, 75.63000000000007, 71.53000000000003, 124.83000000000035, 85.88000000000012, 87.93000000000013, 69.48000000000005, 69.48000000000003, 83.83000000000011, 73.58000000000004, 71.53000000000003, 89.98000000000016, 55.13000000000002, 67.43000000000002, 77.68000000000006, 96.13000000000017, 81.7800000000001, 63.33000000000001, 77.68000000000006, 71.53000000000004, 83.83000000000011, 71.53000000000002, 73.58000000000004, 73.58000000000003, 83.83000000000013, 79.73000000000009, 79.73000000000009, 85.88000000000012, 67.42999999999999, 75.63000000000007, 122.78000000000034, 73.58000000000006, 85.88000000000012, 51.02999999999999, 81.78000000000011, 75.63000000000007, 81.7800000000001, 81.7800000000001, 87.93000000000015, 75.63000000000005, 65.38, 69.48000000000002, 71.53000000000004, 85.88000000000012, 67.42999999999999, 69.48000000000002, 124.83000000000035, 85.88000000000014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5353458724482016, "mean_inference_ms": 0.8126284690453514, "mean_action_processing_ms": 0.138988051432459, "mean_env_wait_ms": 1.8650785896636455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022580623626708984, "StateBufferConnector_ms": 0.0021413564682006836, "ViewRequirementAgentConnector_ms": 0.05207109451293945}, "num_episodes": 30, "episode_return_max": 245.94000000000074, "episode_return_min": 146.95300000000006, "episode_return_mean": 206.46082000000033, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179701, "num_agent_steps_trained": 179701, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.38952595170655, "num_env_steps_trained_throughput_per_sec": 125.38952595170655, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 179701, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 179701, "timers": {"training_iteration_time_ms": 25383.707, "restore_workers_time_ms": 0.006, "training_step_time_ms": 25383.69, "sample_time_ms": 23548.336, "learn_time_ms": 1835.153, "learn_throughput": 2179.655, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 179701, "num_agent_steps_trained": 179701}, "done": false, "training_iteration": 15, "trial_id": "default", "date": "2025-10-13_02-13-57", "timestamp": 1760336037, "time_this_iter_s": 31.901135683059692, "time_total_s": 361.54851818084717, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 361.54851818084717, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.40666666666667, "ram_util_percent": 34.11333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 2.920706844329834, "policy_loss": -0.013724684442896101, "vf_loss": 6.088998139850677, "vf_explained_var": -0.03286852401400369, "kl": 0.012898352779536411, "entropy": 11.07124647715735, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 9755.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.5466886553913355, "policy_loss": -0.018079144676448777, "vf_loss": 5.3464161425828935, "vf_explained_var": -0.014103132486343383, "kl": 0.013071669066448594, "entropy": 10.909387025237084, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4960.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 191701, "num_agent_steps_trained": 191701}, "env_runners": {"episode_reward_max": 232.3900000000005, "episode_reward_min": 183.14000000000019, "episode_reward_mean": 206.23769000000036, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 17.980000000000018, "hider_policy": 51.02999999999999}, "policy_reward_max": {"seeker_policy": 68.77999999999996, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 45.94000000000003, "hider_policy": 80.1488450000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [223.69000000000042, 198.89000000000019, 199.09000000000015, 204.4900000000003, 214.69000000000028, 195.49000000000012, 208.7400000000003, 203.1900000000003, 195.8400000000003, 230.19000000000054, 199.99000000000026, 209.99000000000038, 193.1090000000003, 221.5400000000006, 211.1900000000003, 213.74000000000044, 224.89000000000058, 194.39000000000027, 197.84000000000032, 209.59000000000043, 203.3400000000004, 210.2400000000004, 188.1900000000002, 208.89000000000033, 196.14000000000027, 210.7400000000004, 229.59000000000057, 187.0900000000002, 204.09000000000037, 226.29000000000053, 208.7900000000004, 230.74000000000058, 195.99000000000032, 199.1900000000004, 204.44000000000034, 227.44000000000057, 209.59000000000037, 213.1900000000004, 199.74000000000035, 206.49000000000035, 191.99000000000026, 208.64000000000038, 222.4400000000004, 183.14000000000019, 206.04000000000033, 209.69000000000042, 227.7400000000005, 225.34000000000043, 212.89000000000047, 196.24000000000024, 204.49000000000035, 207.29000000000033, 188.3400000000002, 213.09000000000046, 198.4900000000003, 201.0900000000003, 201.34000000000034, 201.0400000000004, 209.54000000000028, 209.19000000000034, 196.34000000000034, 225.2400000000004, 194.4900000000003, 205.69000000000034, 205.84000000000034, 208.1400000000004, 193.14000000000024, 204.49000000000026, 195.19000000000034, 232.3900000000005, 198.6900000000004, 201.09000000000034, 215.89000000000044, 206.64000000000036, 198.7400000000003, 202.89000000000033, 199.74000000000038, 204.04000000000036, 203.94000000000042, 212.8900000000004, 205.14000000000033, 223.74000000000052, 201.69000000000034, 198.1900000000003, 196.04000000000028, 197.0400000000003, 201.3400000000004, 205.5900000000004, 203.2400000000004, 201.09000000000032, 207.19000000000037, 199.6400000000004, 211.09000000000032, 200.14000000000036, 199.39000000000027, 209.14000000000047, 207.5400000000004, 199.09000000000037, 193.04000000000042, 230.09000000000052], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [29.479999999999965, 52.080000000000005, 50.380000000000024, 49.28, 35.279999999999966, 57.08000000000005, 43.58, 43.98000000000004, 56.88000000000005, 23.57999999999999, 50.78000000000001, 44.38, 41.280000000000044, 33.37999999999995, 41.47999999999999, 37.88000000000002, 30.579999999999938, 57.480000000000075, 54.78000000000007, 43.98000000000003, 47.980000000000054, 42.580000000000034, 63.58000000000005, 43.27999999999998, 57.18000000000004, 43.08000000000002, 22.979999999999993, 62.480000000000054, 46.68000000000006, 27.87999999999996, 39.079999999999984, 17.980000000000018, 54.980000000000096, 54.080000000000055, 49.08000000000005, 26.97999999999997, 43.980000000000025, 39.37999999999998, 52.580000000000034, 44.97999999999998, 55.08000000000006, 45.08000000000002, 30.17999999999994, 68.77999999999996, 46.57999999999998, 44.08000000000003, 27.279999999999987, 28.97999999999997, 39.08000000000001, 57.28000000000002, 47.08000000000003, 45.780000000000015, 65.78000000000004, 39.280000000000015, 53.38000000000006, 51.88000000000002, 45.980000000000075, 53.88000000000006, 45.98000000000001, 43.58000000000001, 53.280000000000115, 28.879999999999985, 57.58000000000005, 48.280000000000015, 42.280000000000015, 44.58000000000002, 58.28000000000006, 47.080000000000034, 58.28000000000006, 21.679999999999996, 53.58000000000008, 51.88000000000005, 37.97999999999999, 43.08000000000001, 55.68000000000005, 49.580000000000055, 52.580000000000034, 48.68000000000005, 48.58000000000004, 34.98000000000001, 49.78000000000002, 31.47999999999994, 48.38000000000007, 53.080000000000055, 57.08000000000002, 58.08000000000003, 50.080000000000084, 48.180000000000064, 47.88000000000003, 51.880000000000045, 45.68000000000001, 52.48000000000005, 41.37999999999997, 52.98000000000005, 54.28000000000001, 41.48000000000008, 43.98000000000003, 53.980000000000054, 58.180000000000135, 23.47999999999997], "policy_hider_policy_reward": [122.78000000000034, 71.43000000000002, 83.53000000000006, 63.28, 67.12999999999997, 81.58000000000006, 73.58000000000004, 81.63000000000007, 101.93000000000015, 77.48000000000003, 69.07999999999998, 69.33, 81.38, 83.78000000000011, 79.58000000000006, 79.63000000000005, 69.48000000000002, 69.48000000000002, 124.83000000000035, 81.78000000000011, 79.7300000000001, 69.48000000000002, 79.73000000000008, 85.88000000000012, 77.68000000000008, 74.14900000000004, 108.43000000000025, 79.73000000000008, 92.03000000000017, 77.68000000000006, 98.1800000000002, 77.68000000000008, 112.53000000000029, 81.78000000000009, 69.48000000000002, 67.43, 69.48000000000002, 73.58000000000004, 92.03000000000017, 73.58000000000004, 77.68000000000006, 77.68000000000008, 83.83000000000011, 83.83000000000011, 61.28000000000001, 63.33, 85.88000000000012, 79.7300000000001, 63.33, 75.63000000000007, 77.68000000000008, 89.98000000000015, 114.5800000000003, 92.03000000000016, 63.33000000000001, 61.28, 79.73000000000009, 77.68000000000009, 73.58000000000006, 124.83000000000035, 89.98000000000015, 79.73000000000008, 87.93000000000013, 124.83000000000035, 73.58000000000006, 67.43000000000002, 73.58000000000004, 71.53000000000004, 79.73000000000009, 75.63000000000007, 116.63000000000031, 83.8300000000001, 92.03000000000016, 73.58000000000004, 87.93000000000015, 85.88000000000012, 73.58000000000006, 73.58000000000006, 83.83000000000011, 77.68000000000008, 61.28, 75.63000000000007, 79.73000000000009, 83.83000000000011, 124.83000000000035, 67.42999999999999, 53.07999999999998, 61.27999999999999, 81.7800000000001, 77.68000000000008, 77.68000000000005, 87.93000000000013, 124.83000000000035, 75.63000000000007, 71.53000000000003, 124.83000000000035, 85.88000000000012, 87.93000000000013, 69.48000000000005, 69.48000000000003, 83.83000000000011, 73.58000000000004, 71.53000000000003, 89.98000000000016, 55.13000000000002, 67.43000000000002, 77.68000000000006, 96.13000000000017, 81.7800000000001, 63.33000000000001, 77.68000000000006, 71.53000000000004, 83.83000000000011, 71.53000000000002, 73.58000000000004, 73.58000000000003, 83.83000000000013, 79.73000000000009, 79.73000000000009, 85.88000000000012, 67.42999999999999, 75.63000000000007, 122.78000000000034, 73.58000000000006, 85.88000000000012, 51.02999999999999, 81.78000000000011, 75.63000000000007, 81.7800000000001, 81.7800000000001, 87.93000000000015, 75.63000000000005, 65.38, 69.48000000000002, 71.53000000000004, 85.88000000000012, 67.42999999999999, 69.48000000000002, 124.83000000000035, 85.88000000000014, 71.53000000000003, 73.58000000000004, 73.58000000000006, 75.63000000000007, 96.1300000000002, 81.78000000000009, 77.68000000000006, 85.88000000000011, 73.58000000000006, 69.48000000000003, 71.53000000000004, 81.78000000000011, 73.58000000000004, 73.58000000000004, 69.48000000000002, 85.88000000000014, 79.7300000000001, 75.63000000000005, 77.68000000000006, 100.23000000000022, 77.68000000000006, 77.68000000000008, 104.33000000000023, 87.93000000000015, 77.68000000000008, 75.63000000000005, 79.7300000000001, 65.37999999999997, 63.33, 75.63000000000005, 67.43, 71.53000000000003, 71.53000000000003, 79.73000000000009, 85.88000000000012, 71.53, 71.53000000000004, 83.83000000000013, 77.68000000000006, 71.53000000000004, 83.83000000000011, 77.68000000000008, 73.58000000000004, 73.58000000000006, 87.93000000000015, 81.7800000000001, 89.98000000000015, 57.18000000000001, 77.68000000000008, 67.42999999999999, 81.7800000000001, 85.88000000000011, 77.68000000000008, 85.88000000000012, 69.48000000000002, 75.63000000000005, 67.43, 67.43, 89.98000000000015, 116.63000000000031]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.63796644151509, "mean_inference_ms": 0.8124072262789581, "mean_action_processing_ms": 0.13923646914087628, "mean_env_wait_ms": 1.8791768375969857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002252817153930664, "StateBufferConnector_ms": 0.0021398067474365234, "ViewRequirementAgentConnector_ms": 0.052269577980041504}, "num_episodes": 30, "episode_return_max": 232.3900000000005, "episode_return_min": 183.14000000000019, "episode_return_mean": 206.23769000000036, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 191701, "num_agent_steps_trained": 191701, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.20117507144386, "num_env_steps_trained_throughput_per_sec": 125.20117507144386, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 191701, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 191701, "timers": {"training_iteration_time_ms": 25547.63, "restore_workers_time_ms": 0.006, "training_step_time_ms": 25547.614, "sample_time_ms": 23710.096, "learn_time_ms": 1837.322, "learn_throughput": 2177.082, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 191701, "num_agent_steps_trained": 191701}, "done": false, "training_iteration": 16, "trial_id": "default", "date": "2025-10-13_02-14-29", "timestamp": 1760336069, "time_this_iter_s": 31.949124813079834, "time_total_s": 393.497642993927, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 393.497642993927, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 21.245652173913044, "ram_util_percent": 34.14565217391305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 2.9690624940963017, "policy_loss": -0.014753031469733705, "vf_loss": 6.1887952812134275, "vf_explained_var": -0.017543389778288582, "kl": 0.014214249846026258, "entropy": 11.129283164796375, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10385.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.4814766854047776, "policy_loss": -0.020447561934997794, "vf_loss": 5.220426721870899, "vf_explained_var": -0.004929432086646557, "kl": 0.01392132781470543, "entropy": 10.898517802357674, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 203701, "num_agent_steps_trained": 203701}, "env_runners": {"episode_reward_max": 232.3900000000005, "episode_reward_min": 183.14000000000019, "episode_reward_mean": 205.07618000000028, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 17.980000000000018, "hider_policy": 51.02999999999999}, "policy_reward_max": {"seeker_policy": 68.77999999999996, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 47.17706000000004, "hider_policy": 78.94956000000009}, "custom_metrics": {}, "hist_stats": {"episode_reward": [226.29000000000053, 208.7900000000004, 230.74000000000058, 195.99000000000032, 199.1900000000004, 204.44000000000034, 227.44000000000057, 209.59000000000037, 213.1900000000004, 199.74000000000035, 206.49000000000035, 191.99000000000026, 208.64000000000038, 222.4400000000004, 183.14000000000019, 206.04000000000033, 209.69000000000042, 227.7400000000005, 225.34000000000043, 212.89000000000047, 196.24000000000024, 204.49000000000035, 207.29000000000033, 188.3400000000002, 213.09000000000046, 198.4900000000003, 201.0900000000003, 201.34000000000034, 201.0400000000004, 209.54000000000028, 209.19000000000034, 196.34000000000034, 225.2400000000004, 194.4900000000003, 205.69000000000034, 205.84000000000034, 208.1400000000004, 193.14000000000024, 204.49000000000026, 195.19000000000034, 232.3900000000005, 198.6900000000004, 201.09000000000034, 215.89000000000044, 206.64000000000036, 198.7400000000003, 202.89000000000033, 199.74000000000038, 204.04000000000036, 203.94000000000042, 212.8900000000004, 205.14000000000033, 223.74000000000052, 201.69000000000034, 198.1900000000003, 196.04000000000028, 197.0400000000003, 201.3400000000004, 205.5900000000004, 203.2400000000004, 201.09000000000032, 207.19000000000037, 199.6400000000004, 211.09000000000032, 200.14000000000036, 199.39000000000027, 209.14000000000047, 207.5400000000004, 199.09000000000037, 193.04000000000042, 230.09000000000052, 190.15800000000036, 207.19000000000025, 189.8900000000002, 200.89000000000033, 203.84000000000037, 193.8400000000003, 207.99000000000038, 200.54000000000028, 212.8900000000004, 202.64000000000027, 213.09000000000046, 202.49000000000038, 202.14000000000033, 210.34000000000034, 201.09000000000032, 212.79000000000042, 190.64000000000027, 199.69000000000034, 208.7400000000003, 204.69000000000028, 201.74000000000035, 209.1900000000003, 202.24000000000035, 229.69000000000054, 190.34000000000017, 192.44000000000037, 204.39000000000044, 193.19000000000023, 193.94000000000025], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [27.87999999999996, 39.079999999999984, 17.980000000000018, 54.980000000000096, 54.080000000000055, 49.08000000000005, 26.97999999999997, 43.980000000000025, 39.37999999999998, 52.580000000000034, 44.97999999999998, 55.08000000000006, 45.08000000000002, 30.17999999999994, 68.77999999999996, 46.57999999999998, 44.08000000000003, 27.279999999999987, 28.97999999999997, 39.08000000000001, 57.28000000000002, 47.08000000000003, 45.780000000000015, 65.78000000000004, 39.280000000000015, 53.38000000000006, 51.88000000000002, 45.980000000000075, 53.88000000000006, 45.98000000000001, 43.58000000000001, 53.280000000000115, 28.879999999999985, 57.58000000000005, 48.280000000000015, 42.280000000000015, 44.58000000000002, 58.28000000000006, 47.080000000000034, 58.28000000000006, 21.679999999999996, 53.58000000000008, 51.88000000000005, 37.97999999999999, 43.08000000000001, 55.68000000000005, 49.580000000000055, 52.580000000000034, 48.68000000000005, 48.58000000000004, 34.98000000000001, 49.78000000000002, 31.47999999999994, 48.38000000000007, 53.080000000000055, 57.08000000000002, 58.08000000000003, 50.080000000000084, 48.180000000000064, 47.88000000000003, 51.880000000000045, 45.68000000000001, 52.48000000000005, 41.37999999999997, 52.98000000000005, 54.28000000000001, 41.48000000000008, 43.98000000000003, 53.980000000000054, 58.180000000000135, 23.47999999999997, 51.48600000000002, 45.680000000000014, 61.180000000000085, 51.68000000000004, 48.48000000000003, 58.98000000000008, 46.48, 49.28000000000004, 34.97999999999998, 51.38, 39.28000000000001, 49.18000000000006, 50.88, 42.67999999999995, 51.88000000000006, 38.980000000000025, 59.880000000000095, 50.48000000000007, 45.179999999999986, 47.28000000000004, 50.480000000000075, 43.58000000000002, 50.98000000000004, 18.98, 63.68000000000004, 61.68000000000005, 46.98000000000006, 60.38000000000005, 59.080000000000034], "policy_hider_policy_reward": [73.58000000000006, 124.83000000000035, 89.98000000000015, 79.73000000000008, 87.93000000000013, 124.83000000000035, 73.58000000000006, 67.43000000000002, 73.58000000000004, 71.53000000000004, 79.73000000000009, 75.63000000000007, 116.63000000000031, 83.8300000000001, 92.03000000000016, 73.58000000000004, 87.93000000000015, 85.88000000000012, 73.58000000000006, 73.58000000000006, 83.83000000000011, 77.68000000000008, 61.28, 75.63000000000007, 79.73000000000009, 83.83000000000011, 124.83000000000035, 67.42999999999999, 53.07999999999998, 61.27999999999999, 81.7800000000001, 77.68000000000008, 77.68000000000005, 87.93000000000013, 124.83000000000035, 75.63000000000007, 71.53000000000003, 124.83000000000035, 85.88000000000012, 87.93000000000013, 69.48000000000005, 69.48000000000003, 83.83000000000011, 73.58000000000004, 71.53000000000003, 89.98000000000016, 55.13000000000002, 67.43000000000002, 77.68000000000006, 96.13000000000017, 81.7800000000001, 63.33000000000001, 77.68000000000006, 71.53000000000004, 83.83000000000011, 71.53000000000002, 73.58000000000004, 73.58000000000003, 83.83000000000013, 79.73000000000009, 79.73000000000009, 85.88000000000012, 67.42999999999999, 75.63000000000007, 122.78000000000034, 73.58000000000006, 85.88000000000012, 51.02999999999999, 81.78000000000011, 75.63000000000007, 81.7800000000001, 81.7800000000001, 87.93000000000015, 75.63000000000005, 65.38, 69.48000000000002, 71.53000000000004, 85.88000000000012, 67.42999999999999, 69.48000000000002, 124.83000000000035, 85.88000000000014, 71.53000000000003, 73.58000000000004, 73.58000000000006, 75.63000000000007, 96.1300000000002, 81.78000000000009, 77.68000000000006, 85.88000000000011, 73.58000000000006, 69.48000000000003, 71.53000000000004, 81.78000000000011, 73.58000000000004, 73.58000000000004, 69.48000000000002, 85.88000000000014, 79.7300000000001, 75.63000000000005, 77.68000000000006, 100.23000000000022, 77.68000000000006, 77.68000000000008, 104.33000000000023, 87.93000000000015, 77.68000000000008, 75.63000000000005, 79.7300000000001, 65.37999999999997, 63.33, 75.63000000000005, 67.43, 71.53000000000003, 71.53000000000003, 79.73000000000009, 85.88000000000012, 71.53, 71.53000000000004, 83.83000000000013, 77.68000000000006, 71.53000000000004, 83.83000000000011, 77.68000000000008, 73.58000000000004, 73.58000000000006, 87.93000000000015, 81.7800000000001, 89.98000000000015, 57.18000000000001, 77.68000000000008, 67.42999999999999, 81.7800000000001, 85.88000000000011, 77.68000000000008, 85.88000000000012, 69.48000000000002, 75.63000000000005, 67.43, 67.43, 89.98000000000015, 116.63000000000031, 69.33600000000001, 69.33600000000001, 85.88000000000012, 75.63000000000005, 61.28000000000001, 67.43000000000002, 75.63000000000005, 73.58000000000007, 81.78000000000009, 73.58000000000004, 63.33000000000001, 71.53000000000004, 75.63000000000007, 85.88000000000014, 83.83000000000011, 67.43000000000004, 65.38, 112.53000000000029, 89.98000000000016, 61.27999999999999, 85.8800000000001, 87.93000000000015, 69.48, 83.83000000000011, 67.43000000000002, 83.8300000000001, 89.98000000000015, 77.68000000000006, 79.73000000000009, 69.48000000000003, 77.68000000000006, 96.13000000000018, 67.42999999999999, 63.33, 79.73000000000009, 69.48, 81.7800000000001, 81.7800000000001, 87.93000000000015, 69.48000000000003, 73.58000000000006, 77.68000000000008, 73.58000000000007, 92.03000000000016, 69.48000000000005, 81.78000000000009, 124.83000000000035, 85.88000000000014, 65.38000000000001, 61.280000000000015, 73.58000000000006, 57.179999999999986, 73.58000000000004, 83.8300000000001, 65.38, 67.43000000000002, 65.38, 69.48000000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7481873995487778, "mean_inference_ms": 0.8123282810786651, "mean_action_processing_ms": 0.13940091478511862, "mean_env_wait_ms": 1.8922576695916948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021954774856567383, "StateBufferConnector_ms": 0.0021216869354248047, "ViewRequirementAgentConnector_ms": 0.051737070083618164}, "num_episodes": 29, "episode_return_max": 232.3900000000005, "episode_return_min": 183.14000000000019, "episode_return_mean": 205.07618000000028, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 203701, "num_agent_steps_trained": 203701, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 128.5297153666156, "num_env_steps_trained_throughput_per_sec": 128.5297153666156, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 203701, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 203701, "timers": {"training_iteration_time_ms": 26747.381, "restore_workers_time_ms": 0.005, "training_step_time_ms": 26747.365, "sample_time_ms": 24908.914, "learn_time_ms": 1838.254, "learn_throughput": 2175.977, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 203701, "num_agent_steps_trained": 203701}, "done": false, "training_iteration": 17, "trial_id": "default", "date": "2025-10-13_02-15-00", "timestamp": 1760336100, "time_this_iter_s": 31.12176513671875, "time_total_s": 424.61940813064575, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 424.61940813064575, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 21.561363636363634, "ram_util_percent": 34.17954545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 3.026972825375814, "policy_loss": -0.013375455869125231, "vf_loss": 6.30188989942036, "vf_explained_var": -0.009846982691023085, "kl": 0.013613474656596678, "entropy": 11.127734238760812, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.11111111111111, "num_grad_updates_lifetime": 11015.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.549586905539036, "policy_loss": -0.021656752983108162, "vf_loss": 5.360611297935248, "vf_explained_var": 0.016592174768447876, "kl": 0.013500829437293823, "entropy": 10.973702999949456, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5600.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 215646, "num_agent_steps_trained": 215646}, "env_runners": {"episode_reward_max": 251.5900000000007, "episode_reward_min": 153.89500000000007, "episode_reward_mean": 204.2222300000004, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 3.9800000000000098, "hider_policy": 42.53499999999999}, "policy_reward_max": {"seeker_policy": 63.68000000000004, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 47.51506000000002, "hider_policy": 78.35358500000008}, "custom_metrics": {}, "hist_stats": {"episode_reward": [209.19000000000034, 196.34000000000034, 225.2400000000004, 194.4900000000003, 205.69000000000034, 205.84000000000034, 208.1400000000004, 193.14000000000024, 204.49000000000026, 195.19000000000034, 232.3900000000005, 198.6900000000004, 201.09000000000034, 215.89000000000044, 206.64000000000036, 198.7400000000003, 202.89000000000033, 199.74000000000038, 204.04000000000036, 203.94000000000042, 212.8900000000004, 205.14000000000033, 223.74000000000052, 201.69000000000034, 198.1900000000003, 196.04000000000028, 197.0400000000003, 201.3400000000004, 205.5900000000004, 203.2400000000004, 201.09000000000032, 207.19000000000037, 199.6400000000004, 211.09000000000032, 200.14000000000036, 199.39000000000027, 209.14000000000047, 207.5400000000004, 199.09000000000037, 193.04000000000042, 230.09000000000052, 190.15800000000036, 207.19000000000025, 189.8900000000002, 200.89000000000033, 203.84000000000037, 193.8400000000003, 207.99000000000038, 200.54000000000028, 212.8900000000004, 202.64000000000027, 213.09000000000046, 202.49000000000038, 202.14000000000033, 210.34000000000034, 201.09000000000032, 212.79000000000042, 190.64000000000027, 199.69000000000034, 208.7400000000003, 204.69000000000028, 201.74000000000035, 209.1900000000003, 202.24000000000035, 229.69000000000054, 190.34000000000017, 192.44000000000037, 204.39000000000044, 193.19000000000023, 193.94000000000025, 208.8900000000004, 153.89500000000007, 194.39000000000024, 206.9400000000003, 219.49000000000055, 197.69000000000025, 251.5900000000007, 202.49000000000032, 210.84000000000054, 205.89000000000033, 202.49000000000035, 212.94000000000042, 203.84000000000037, 206.64000000000038, 190.39000000000024, 199.34000000000023, 206.54000000000033, 204.84000000000037, 196.7400000000003, 201.2400000000003, 202.0400000000004, 197.14000000000033, 194.69000000000025, 217.94000000000042, 201.49000000000015, 195.24000000000026, 204.1400000000003, 224.44000000000054, 205.0900000000004, 226.04000000000053], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [43.58000000000001, 53.280000000000115, 28.879999999999985, 57.58000000000005, 48.280000000000015, 42.280000000000015, 44.58000000000002, 58.28000000000006, 47.080000000000034, 58.28000000000006, 21.679999999999996, 53.58000000000008, 51.88000000000005, 37.97999999999999, 43.08000000000001, 55.68000000000005, 49.580000000000055, 52.580000000000034, 48.68000000000005, 48.58000000000004, 34.98000000000001, 49.78000000000002, 31.47999999999994, 48.38000000000007, 53.080000000000055, 57.08000000000002, 58.08000000000003, 50.080000000000084, 48.180000000000064, 47.88000000000003, 51.880000000000045, 45.68000000000001, 52.48000000000005, 41.37999999999997, 52.98000000000005, 54.28000000000001, 41.48000000000008, 43.98000000000003, 53.980000000000054, 58.180000000000135, 23.47999999999997, 51.48600000000002, 45.680000000000014, 61.180000000000085, 51.68000000000004, 48.48000000000003, 58.98000000000008, 46.48, 49.28000000000004, 34.97999999999998, 51.38, 39.28000000000001, 49.18000000000006, 50.88, 42.67999999999995, 51.88000000000006, 38.980000000000025, 59.880000000000095, 50.48000000000007, 45.179999999999986, 47.28000000000004, 50.480000000000075, 43.58000000000002, 50.98000000000004, 18.98, 63.68000000000004, 61.68000000000005, 46.98000000000006, 60.38000000000005, 59.080000000000034, 47.380000000000024, 41.880000000000024, 57.48000000000004, 47.48000000000002, 33.379999999999946, 56.68000000000007, 3.9800000000000098, 49.180000000000085, 43.180000000000035, 48.48000000000002, 49.18000000000004, 41.179999999999986, 48.48000000000003, 47.18000000000004, 61.6800000000001, 52.18000000000004, 47.08, 49.48000000000004, 53.68000000000006, 49.98000000000007, 50.78000000000006, 49.98000000000006, 57.78000000000006, 33.879999999999946, 52.279999999999994, 56.28000000000005, 48.780000000000015, 23.97999999999997, 47.680000000000035, 25.579999999999963], "policy_hider_policy_reward": [79.73000000000009, 85.88000000000012, 67.42999999999999, 75.63000000000007, 122.78000000000034, 73.58000000000006, 85.88000000000012, 51.02999999999999, 81.78000000000011, 75.63000000000007, 81.7800000000001, 81.7800000000001, 87.93000000000015, 75.63000000000005, 65.38, 69.48000000000002, 71.53000000000004, 85.88000000000012, 67.42999999999999, 69.48000000000002, 124.83000000000035, 85.88000000000014, 71.53000000000003, 73.58000000000004, 73.58000000000006, 75.63000000000007, 96.1300000000002, 81.78000000000009, 77.68000000000006, 85.88000000000011, 73.58000000000006, 69.48000000000003, 71.53000000000004, 81.78000000000011, 73.58000000000004, 73.58000000000004, 69.48000000000002, 85.88000000000014, 79.7300000000001, 75.63000000000005, 77.68000000000006, 100.23000000000022, 77.68000000000006, 77.68000000000008, 104.33000000000023, 87.93000000000015, 77.68000000000008, 75.63000000000005, 79.7300000000001, 65.37999999999997, 63.33, 75.63000000000005, 67.43, 71.53000000000003, 71.53000000000003, 79.73000000000009, 85.88000000000012, 71.53, 71.53000000000004, 83.83000000000013, 77.68000000000006, 71.53000000000004, 83.83000000000011, 77.68000000000008, 73.58000000000004, 73.58000000000006, 87.93000000000015, 81.7800000000001, 89.98000000000015, 57.18000000000001, 77.68000000000008, 67.42999999999999, 81.7800000000001, 85.88000000000011, 77.68000000000008, 85.88000000000012, 69.48000000000002, 75.63000000000005, 67.43, 67.43, 89.98000000000015, 116.63000000000031, 69.33600000000001, 69.33600000000001, 85.88000000000012, 75.63000000000005, 61.28000000000001, 67.43000000000002, 75.63000000000005, 73.58000000000007, 81.78000000000009, 73.58000000000004, 63.33000000000001, 71.53000000000004, 75.63000000000007, 85.88000000000014, 83.83000000000011, 67.43000000000004, 65.38, 112.53000000000029, 89.98000000000016, 61.27999999999999, 85.8800000000001, 87.93000000000015, 69.48, 83.83000000000011, 67.43000000000002, 83.8300000000001, 89.98000000000015, 77.68000000000006, 79.73000000000009, 69.48000000000003, 77.68000000000006, 96.13000000000018, 67.42999999999999, 63.33, 79.73000000000009, 69.48, 81.7800000000001, 81.7800000000001, 87.93000000000015, 69.48000000000003, 73.58000000000006, 77.68000000000008, 73.58000000000007, 92.03000000000016, 69.48000000000005, 81.78000000000009, 124.83000000000035, 85.88000000000014, 65.38000000000001, 61.280000000000015, 73.58000000000006, 57.179999999999986, 73.58000000000004, 83.8300000000001, 65.38, 67.43000000000002, 65.38, 69.48000000000003, 81.7800000000001, 79.73000000000009, 69.48000000000002, 42.53499999999999, 67.43, 69.48000000000003, 89.98000000000015, 69.48000000000003, 104.33000000000023, 81.7800000000001, 89.98000000000015, 51.02999999999999, 122.78000000000034, 124.83000000000035, 92.03000000000014, 61.27999999999997, 79.73000000000008, 87.93000000000012, 67.43, 89.98000000000015, 85.88000000000012, 67.43000000000002, 75.63000000000005, 96.13000000000017, 81.7800000000001, 73.58000000000003, 73.58000000000004, 85.88000000000012, 65.37999999999998, 63.33, 63.33000000000002, 83.83000000000011, 77.68000000000006, 81.78000000000009, 79.7300000000001, 75.63000000000008, 77.68000000000008, 65.38, 67.43000000000002, 83.83000000000011, 71.53000000000002, 79.73000000000009, 69.48000000000003, 77.68000000000008, 65.38, 71.53000000000004, 85.88000000000014, 98.1800000000002, 75.63000000000007, 73.58000000000007, 67.43000000000002, 71.53000000000003, 77.68000000000008, 77.68000000000008, 116.63000000000031, 83.83000000000011, 73.58000000000004, 83.83000000000011, 124.83000000000035, 75.63000000000007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8481466216637377, "mean_inference_ms": 0.8120437978037862, "mean_action_processing_ms": 0.13947008902421407, "mean_env_wait_ms": 1.905365286011017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021442174911499023, "StateBufferConnector_ms": 0.0020880699157714844, "ViewRequirementAgentConnector_ms": 0.05126321315765381}, "num_episodes": 30, "episode_return_max": 251.5900000000007, "episode_return_min": 153.89500000000007, "episode_return_mean": 204.2222300000004, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215646, "num_agent_steps_trained": 215646, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.40424071363356, "num_env_steps_trained_throughput_per_sec": 125.40424071363356, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 215646, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 215646, "timers": {"training_iteration_time_ms": 27662.413, "restore_workers_time_ms": 0.005, "training_step_time_ms": 27662.398, "sample_time_ms": 25811.381, "learn_time_ms": 1850.806, "learn_throughput": 2161.221, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 215646, "num_agent_steps_trained": 215646}, "done": false, "training_iteration": 18, "trial_id": "default", "date": "2025-10-13_02-15-32", "timestamp": 1760336132, "time_this_iter_s": 31.89748501777649, "time_total_s": 456.51689314842224, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 456.51689314842224, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.893333333333334, "ram_util_percent": 34.13555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.05, "cur_lr": 0.0003, "total_loss": 2.886018310823748, "policy_loss": -0.014325388082333149, "vf_loss": 6.026949864818204, "vf_explained_var": 0.024981017170413847, "kl": 0.012390096783846926, "entropy": 11.375073640577254, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.91935483870968, "num_grad_updates_lifetime": 11640.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.617769418656826, "policy_loss": -0.022298696379584725, "vf_loss": 5.501968301087618, "vf_explained_var": 0.04795645233243704, "kl": 0.013182950149644126, "entropy": 11.157518404722214, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5920.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 227577, "num_agent_steps_trained": 227577}, "env_runners": {"episode_reward_max": 251.5900000000007, "episode_reward_min": 145.50900000000019, "episode_reward_mean": 204.75142000000034, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 3.9800000000000098, "hider_policy": 33.99899999999999}, "policy_reward_max": {"seeker_policy": 63.68000000000004, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 46.18506000000002, "hider_policy": 79.28318000000009}, "custom_metrics": {}, "hist_stats": {"episode_reward": [203.2400000000004, 201.09000000000032, 207.19000000000037, 199.6400000000004, 211.09000000000032, 200.14000000000036, 199.39000000000027, 209.14000000000047, 207.5400000000004, 199.09000000000037, 193.04000000000042, 230.09000000000052, 190.15800000000036, 207.19000000000025, 189.8900000000002, 200.89000000000033, 203.84000000000037, 193.8400000000003, 207.99000000000038, 200.54000000000028, 212.8900000000004, 202.64000000000027, 213.09000000000046, 202.49000000000038, 202.14000000000033, 210.34000000000034, 201.09000000000032, 212.79000000000042, 190.64000000000027, 199.69000000000034, 208.7400000000003, 204.69000000000028, 201.74000000000035, 209.1900000000003, 202.24000000000035, 229.69000000000054, 190.34000000000017, 192.44000000000037, 204.39000000000044, 193.19000000000023, 193.94000000000025, 208.8900000000004, 153.89500000000007, 194.39000000000024, 206.9400000000003, 219.49000000000055, 197.69000000000025, 251.5900000000007, 202.49000000000032, 210.84000000000054, 205.89000000000033, 202.49000000000035, 212.94000000000042, 203.84000000000037, 206.64000000000038, 190.39000000000024, 199.34000000000023, 206.54000000000033, 204.84000000000037, 196.7400000000003, 201.2400000000003, 202.0400000000004, 197.14000000000033, 194.69000000000025, 217.94000000000042, 201.49000000000015, 195.24000000000026, 204.1400000000003, 224.44000000000054, 205.0900000000004, 226.04000000000053, 228.89000000000053, 201.24000000000032, 221.99000000000044, 213.4900000000004, 203.34000000000032, 189.79000000000028, 203.94000000000028, 218.94000000000048, 196.1400000000003, 194.8400000000002, 202.5900000000005, 201.94000000000028, 212.54000000000036, 197.1400000000003, 208.34000000000046, 222.3400000000005, 200.24000000000032, 199.64000000000036, 230.99000000000055, 202.4400000000003, 145.50900000000019, 231.94000000000048, 208.69000000000042, 206.7900000000004, 194.64000000000036, 215.6400000000005, 210.79000000000033, 220.44000000000045, 211.14000000000038], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [47.88000000000003, 51.880000000000045, 45.68000000000001, 52.48000000000005, 41.37999999999997, 52.98000000000005, 54.28000000000001, 41.48000000000008, 43.98000000000003, 53.980000000000054, 58.180000000000135, 23.47999999999997, 51.48600000000002, 45.680000000000014, 61.180000000000085, 51.68000000000004, 48.48000000000003, 58.98000000000008, 46.48, 49.28000000000004, 34.97999999999998, 51.38, 39.28000000000001, 49.18000000000006, 50.88, 42.67999999999995, 51.88000000000006, 38.980000000000025, 59.880000000000095, 50.48000000000007, 45.179999999999986, 47.28000000000004, 50.480000000000075, 43.58000000000002, 50.98000000000004, 18.98, 63.68000000000004, 61.68000000000005, 46.98000000000006, 60.38000000000005, 59.080000000000034, 47.380000000000024, 41.880000000000024, 57.48000000000004, 47.48000000000002, 33.379999999999946, 56.68000000000007, 3.9800000000000098, 49.180000000000085, 43.180000000000035, 48.48000000000002, 49.18000000000004, 41.179999999999986, 48.48000000000003, 47.18000000000004, 61.6800000000001, 52.18000000000004, 47.08, 49.48000000000004, 53.68000000000006, 49.98000000000007, 50.78000000000006, 49.98000000000006, 57.78000000000006, 33.879999999999946, 52.279999999999994, 56.28000000000005, 48.780000000000015, 23.97999999999997, 47.680000000000035, 25.579999999999963, 26.379999999999985, 49.98000000000002, 31.779999999999966, 39.679999999999964, 47.98000000000004, 56.98000000000006, 48.58000000000003, 34.88, 57.18000000000005, 55.88000000000005, 49.280000000000086, 50.680000000000064, 40.78000000000001, 49.98000000000006, 44.78000000000008, 25.979999999999954, 53.08000000000003, 52.48000000000003, 20.27999999999995, 51.180000000000064, 35.879999999999995, 23.27999999999998, 38.980000000000004, 45.28000000000003, 55.6800000000001, 39.779999999999994, 41.07999999999999, 32.27999999999997, 43.48000000000005], "policy_hider_policy_reward": [71.53000000000004, 83.83000000000013, 77.68000000000006, 71.53000000000004, 83.83000000000011, 77.68000000000008, 73.58000000000004, 73.58000000000006, 87.93000000000015, 81.7800000000001, 89.98000000000015, 57.18000000000001, 77.68000000000008, 67.42999999999999, 81.7800000000001, 85.88000000000011, 77.68000000000008, 85.88000000000012, 69.48000000000002, 75.63000000000005, 67.43, 67.43, 89.98000000000015, 116.63000000000031, 69.33600000000001, 69.33600000000001, 85.88000000000012, 75.63000000000005, 61.28000000000001, 67.43000000000002, 75.63000000000005, 73.58000000000007, 81.78000000000009, 73.58000000000004, 63.33000000000001, 71.53000000000004, 75.63000000000007, 85.88000000000014, 83.83000000000011, 67.43000000000004, 65.38, 112.53000000000029, 89.98000000000016, 61.27999999999999, 85.8800000000001, 87.93000000000015, 69.48, 83.83000000000011, 67.43000000000002, 83.8300000000001, 89.98000000000015, 77.68000000000006, 79.73000000000009, 69.48000000000003, 77.68000000000006, 96.13000000000018, 67.42999999999999, 63.33, 79.73000000000009, 69.48, 81.7800000000001, 81.7800000000001, 87.93000000000015, 69.48000000000003, 73.58000000000006, 77.68000000000008, 73.58000000000007, 92.03000000000016, 69.48000000000005, 81.78000000000009, 124.83000000000035, 85.88000000000014, 65.38000000000001, 61.280000000000015, 73.58000000000006, 57.179999999999986, 73.58000000000004, 83.8300000000001, 65.38, 67.43000000000002, 65.38, 69.48000000000003, 81.7800000000001, 79.73000000000009, 69.48000000000002, 42.53499999999999, 67.43, 69.48000000000003, 89.98000000000015, 69.48000000000003, 104.33000000000023, 81.7800000000001, 89.98000000000015, 51.02999999999999, 122.78000000000034, 124.83000000000035, 92.03000000000014, 61.27999999999997, 79.73000000000008, 87.93000000000012, 67.43, 89.98000000000015, 85.88000000000012, 67.43000000000002, 75.63000000000005, 96.13000000000017, 81.7800000000001, 73.58000000000003, 73.58000000000004, 85.88000000000012, 65.37999999999998, 63.33, 63.33000000000002, 83.83000000000011, 77.68000000000006, 81.78000000000009, 79.7300000000001, 75.63000000000008, 77.68000000000008, 65.38, 67.43000000000002, 83.83000000000011, 71.53000000000002, 79.73000000000009, 69.48000000000003, 77.68000000000008, 65.38, 71.53000000000004, 85.88000000000014, 98.1800000000002, 75.63000000000007, 73.58000000000007, 67.43000000000002, 71.53000000000003, 77.68000000000008, 77.68000000000008, 116.63000000000031, 83.83000000000011, 73.58000000000004, 83.83000000000011, 124.83000000000035, 75.63000000000007, 77.68000000000009, 124.83000000000035, 69.48000000000002, 81.7800000000001, 73.58000000000004, 116.63000000000031, 102.28000000000023, 71.53000000000002, 73.58000000000006, 81.7800000000001, 67.43000000000002, 65.38, 73.58000000000004, 81.78000000000011, 73.58000000000004, 110.48000000000027, 67.43000000000002, 71.53000000000004, 75.63000000000008, 63.33000000000001, 87.93000000000012, 65.38, 73.58000000000004, 77.68000000000008, 85.88000000000012, 85.8800000000001, 73.58000000000003, 73.58000000000007, 92.03000000000013, 71.53000000000003, 124.83000000000035, 71.53000000000006, 63.33, 83.83000000000011, 73.58000000000006, 73.58000000000004, 124.83000000000035, 85.88000000000011, 71.53000000000006, 79.73000000000009, 33.99899999999999, 75.63000000000007, 85.88000000000014, 122.78000000000034, 98.18000000000019, 71.53000000000003, 75.63000000000005, 85.88000000000011, 73.58000000000004, 65.38000000000001, 89.98000000000015, 85.88000000000012, 89.98000000000016, 79.73000000000009, 63.33, 124.83000000000035, 85.88000000000012, 81.7800000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9306464434870856, "mean_inference_ms": 0.812264454376536, "mean_action_processing_ms": 0.13960964151302319, "mean_env_wait_ms": 1.9170344160663064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002195119857788086, "StateBufferConnector_ms": 0.002133488655090332, "ViewRequirementAgentConnector_ms": 0.0527799129486084}, "num_episodes": 29, "episode_return_max": 251.5900000000007, "episode_return_min": 145.50900000000019, "episode_return_mean": 204.75142000000034, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227577, "num_agent_steps_trained": 227577, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 128.32500869626514, "num_env_steps_trained_throughput_per_sec": 128.32500869626514, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 227577, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 227577, "timers": {"training_iteration_time_ms": 28815.121, "restore_workers_time_ms": 0.005, "training_step_time_ms": 28815.106, "sample_time_ms": 26971.136, "learn_time_ms": 1843.776, "learn_throughput": 2169.461, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 227577, "num_agent_steps_trained": 227577}, "done": false, "training_iteration": 19, "trial_id": "default", "date": "2025-10-13_02-16-03", "timestamp": 1760336163, "time_this_iter_s": 31.171396255493164, "time_total_s": 487.6882894039154, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 487.6882894039154, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 20.38, "ram_util_percent": 34.180000000000014}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 2.9798321655818394, "policy_loss": -0.016314777989117873, "vf_loss": 6.219538939188397, "vf_explained_var": 0.028452505289562165, "kl": 0.013475054807615473, "entropy": 11.429628086090087, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12265.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.3412686184048654, "policy_loss": -0.018888206793781136, "vf_loss": 4.942148615419865, "vf_explained_var": 0.012932796962559223, "kl": 0.01351111804731324, "entropy": 11.15930480659008, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 239577, "num_agent_steps_trained": 239577}, "env_runners": {"episode_reward_max": 251.5900000000007, "episode_reward_min": 145.50900000000019, "episode_reward_mean": 205.25424000000035, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 3.9800000000000098, "hider_policy": 33.99899999999999}, "policy_reward_max": {"seeker_policy": 64.78000000000007, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 45.70100000000003, "hider_policy": 79.7766200000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [208.7400000000003, 204.69000000000028, 201.74000000000035, 209.1900000000003, 202.24000000000035, 229.69000000000054, 190.34000000000017, 192.44000000000037, 204.39000000000044, 193.19000000000023, 193.94000000000025, 208.8900000000004, 153.89500000000007, 194.39000000000024, 206.9400000000003, 219.49000000000055, 197.69000000000025, 251.5900000000007, 202.49000000000032, 210.84000000000054, 205.89000000000033, 202.49000000000035, 212.94000000000042, 203.84000000000037, 206.64000000000038, 190.39000000000024, 199.34000000000023, 206.54000000000033, 204.84000000000037, 196.7400000000003, 201.2400000000003, 202.0400000000004, 197.14000000000033, 194.69000000000025, 217.94000000000042, 201.49000000000015, 195.24000000000026, 204.1400000000003, 224.44000000000054, 205.0900000000004, 226.04000000000053, 228.89000000000053, 201.24000000000032, 221.99000000000044, 213.4900000000004, 203.34000000000032, 189.79000000000028, 203.94000000000028, 218.94000000000048, 196.1400000000003, 194.8400000000002, 202.5900000000005, 201.94000000000028, 212.54000000000036, 197.1400000000003, 208.34000000000046, 222.3400000000005, 200.24000000000032, 199.64000000000036, 230.99000000000055, 202.4400000000003, 145.50900000000019, 231.94000000000048, 208.69000000000042, 206.7900000000004, 194.64000000000036, 215.6400000000005, 210.79000000000033, 220.44000000000045, 211.14000000000038, 202.24000000000032, 199.39000000000044, 204.39000000000036, 201.3400000000004, 205.39000000000038, 196.39000000000033, 204.44000000000034, 228.64000000000055, 206.49000000000035, 203.1900000000003, 207.94000000000037, 214.8900000000004, 198.69000000000037, 222.29000000000045, 204.39000000000033, 211.9400000000003, 202.94000000000023, 208.6900000000004, 206.4900000000004, 206.59000000000037, 221.29000000000048, 209.19000000000034, 185.29000000000013, 190.3900000000002, 207.64000000000033, 214.94000000000037, 197.99000000000032, 191.19000000000028, 199.24000000000035, 199.19000000000037], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [45.179999999999986, 47.28000000000004, 50.480000000000075, 43.58000000000002, 50.98000000000004, 18.98, 63.68000000000004, 61.68000000000005, 46.98000000000006, 60.38000000000005, 59.080000000000034, 47.380000000000024, 41.880000000000024, 57.48000000000004, 47.48000000000002, 33.379999999999946, 56.68000000000007, 3.9800000000000098, 49.180000000000085, 43.180000000000035, 48.48000000000002, 49.18000000000004, 41.179999999999986, 48.48000000000003, 47.18000000000004, 61.6800000000001, 52.18000000000004, 47.08, 49.48000000000004, 53.68000000000006, 49.98000000000007, 50.78000000000006, 49.98000000000006, 57.78000000000006, 33.879999999999946, 52.279999999999994, 56.28000000000005, 48.780000000000015, 23.97999999999997, 47.680000000000035, 25.579999999999963, 26.379999999999985, 49.98000000000002, 31.779999999999966, 39.679999999999964, 47.98000000000004, 56.98000000000006, 48.58000000000003, 34.88, 57.18000000000005, 55.88000000000005, 49.280000000000086, 50.680000000000064, 40.78000000000001, 49.98000000000006, 44.78000000000008, 25.979999999999954, 53.08000000000003, 52.48000000000003, 20.27999999999995, 51.180000000000064, 35.879999999999995, 23.27999999999998, 38.980000000000004, 45.28000000000003, 55.6800000000001, 39.779999999999994, 41.07999999999999, 32.27999999999997, 43.48000000000005, 50.980000000000004, 54.280000000000065, 46.980000000000054, 50.08000000000007, 47.98000000000005, 55.380000000000074, 49.08000000000004, 19.979999999999954, 44.980000000000054, 49.880000000000045, 44.380000000000024, 36.97999999999997, 53.580000000000055, 32.079999999999956, 51.08000000000002, 40.180000000000014, 51.68000000000001, 38.98000000000001, 44.98000000000007, 40.980000000000025, 26.979999999999936, 43.579999999999984, 64.78000000000007, 61.68000000000003, 44.08000000000003, 39.079999999999984, 52.880000000000045, 62.480000000000025, 47.98000000000006, 54.08000000000005], "policy_hider_policy_reward": [81.7800000000001, 81.7800000000001, 87.93000000000015, 69.48000000000003, 73.58000000000006, 77.68000000000008, 73.58000000000007, 92.03000000000016, 69.48000000000005, 81.78000000000009, 124.83000000000035, 85.88000000000014, 65.38000000000001, 61.280000000000015, 73.58000000000006, 57.179999999999986, 73.58000000000004, 83.8300000000001, 65.38, 67.43000000000002, 65.38, 69.48000000000003, 81.7800000000001, 79.73000000000009, 69.48000000000002, 42.53499999999999, 67.43, 69.48000000000003, 89.98000000000015, 69.48000000000003, 104.33000000000023, 81.7800000000001, 89.98000000000015, 51.02999999999999, 122.78000000000034, 124.83000000000035, 92.03000000000014, 61.27999999999997, 79.73000000000008, 87.93000000000012, 67.43, 89.98000000000015, 85.88000000000012, 67.43000000000002, 75.63000000000005, 96.13000000000017, 81.7800000000001, 73.58000000000003, 73.58000000000004, 85.88000000000012, 65.37999999999998, 63.33, 63.33000000000002, 83.83000000000011, 77.68000000000006, 81.78000000000009, 79.7300000000001, 75.63000000000008, 77.68000000000008, 65.38, 67.43000000000002, 83.83000000000011, 71.53000000000002, 79.73000000000009, 69.48000000000003, 77.68000000000008, 65.38, 71.53000000000004, 85.88000000000014, 98.1800000000002, 75.63000000000007, 73.58000000000007, 67.43000000000002, 71.53000000000003, 77.68000000000008, 77.68000000000008, 116.63000000000031, 83.83000000000011, 73.58000000000004, 83.83000000000011, 124.83000000000035, 75.63000000000007, 77.68000000000009, 124.83000000000035, 69.48000000000002, 81.7800000000001, 73.58000000000004, 116.63000000000031, 102.28000000000023, 71.53000000000002, 73.58000000000006, 81.7800000000001, 67.43000000000002, 65.38, 73.58000000000004, 81.78000000000011, 73.58000000000004, 110.48000000000027, 67.43000000000002, 71.53000000000004, 75.63000000000008, 63.33000000000001, 87.93000000000012, 65.38, 73.58000000000004, 77.68000000000008, 85.88000000000012, 85.8800000000001, 73.58000000000003, 73.58000000000007, 92.03000000000013, 71.53000000000003, 124.83000000000035, 71.53000000000006, 63.33, 83.83000000000011, 73.58000000000006, 73.58000000000004, 124.83000000000035, 85.88000000000011, 71.53000000000006, 79.73000000000009, 33.99899999999999, 75.63000000000007, 85.88000000000014, 122.78000000000034, 98.18000000000019, 71.53000000000003, 75.63000000000005, 85.88000000000011, 73.58000000000004, 65.38000000000001, 89.98000000000015, 85.88000000000012, 89.98000000000016, 79.73000000000009, 63.33, 124.83000000000035, 85.88000000000012, 81.7800000000001, 77.68000000000006, 73.58000000000006, 79.73000000000008, 65.38, 89.98000000000015, 67.43, 67.42999999999998, 83.83000000000013, 83.83000000000011, 73.58000000000007, 65.38000000000001, 75.63000000000007, 77.68000000000008, 77.68000000000008, 124.83000000000035, 83.83000000000013, 81.78000000000009, 79.73000000000009, 83.83000000000013, 69.48000000000003, 73.58000000000006, 89.98000000000015, 100.23000000000019, 77.68000000000008, 69.48000000000003, 75.63000000000005, 65.38000000000001, 124.83000000000035, 73.58000000000006, 79.7300000000001, 79.73000000000009, 92.03000000000017, 75.63000000000008, 75.63000000000008, 85.88000000000012, 83.83000000000013, 77.68000000000009, 83.8300000000001, 85.88000000000012, 79.73000000000008, 69.48, 124.83000000000035, 83.83000000000011, 81.78000000000011, 51.029999999999994, 69.48000000000003, 67.43, 61.28000000000001, 77.68000000000008, 85.88000000000014, 106.38000000000025, 69.48, 75.63000000000007, 69.48000000000003, 63.33, 65.38000000000001, 73.58000000000006, 77.68000000000008, 71.53000000000004, 73.58000000000006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0071673026531993, "mean_inference_ms": 0.8131765410019104, "mean_action_processing_ms": 0.1398269216413455, "mean_env_wait_ms": 1.9288575676646815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021750926971435547, "StateBufferConnector_ms": 0.002108335494995117, "ViewRequirementAgentConnector_ms": 0.05253565311431885}, "num_episodes": 30, "episode_return_max": 251.5900000000007, "episode_return_min": 145.50900000000019, "episode_return_mean": 205.25424000000035, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239577, "num_agent_steps_trained": 239577, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.64229838315939, "num_env_steps_trained_throughput_per_sec": 125.64229838315939, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 239577, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 239577, "timers": {"training_iteration_time_ms": 30250.022, "restore_workers_time_ms": 0.005, "training_step_time_ms": 30250.008, "sample_time_ms": 28417.068, "learn_time_ms": 1832.736, "learn_throughput": 2182.529, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 239577, "num_agent_steps_trained": 239577}, "done": false, "training_iteration": 20, "trial_id": "default", "date": "2025-10-13_02-16-35", "timestamp": 1760336195, "time_this_iter_s": 31.836981058120728, "time_total_s": 519.5252704620361, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 519.5252704620361, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 26.764444444444447, "ram_util_percent": 34.17111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 3.010348335901896, "policy_loss": -0.016973319661522667, "vf_loss": 6.28451999255589, "vf_explained_var": 0.012620748886986385, "kl": 0.015135749900969537, "entropy": 11.569512521652948, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.65079365079364, "num_grad_updates_lifetime": 12895.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.409648309648037, "policy_loss": -0.015788722638535545, "vf_loss": 5.074882375448942, "vf_explained_var": 0.04468251969665289, "kl": 0.013322851352029453, "entropy": 11.267029145359993, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6560.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 251556, "num_agent_steps_trained": 251556}, "env_runners": {"episode_reward_max": 231.94000000000048, "episode_reward_min": 145.50900000000019, "episode_reward_mean": 204.97790000000037, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 19.979999999999954, "hider_policy": 33.99899999999999}, "policy_reward_max": {"seeker_policy": 68.08000000000004, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 45.97800000000003, "hider_policy": 79.4999500000001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201.2400000000003, 202.0400000000004, 197.14000000000033, 194.69000000000025, 217.94000000000042, 201.49000000000015, 195.24000000000026, 204.1400000000003, 224.44000000000054, 205.0900000000004, 226.04000000000053, 228.89000000000053, 201.24000000000032, 221.99000000000044, 213.4900000000004, 203.34000000000032, 189.79000000000028, 203.94000000000028, 218.94000000000048, 196.1400000000003, 194.8400000000002, 202.5900000000005, 201.94000000000028, 212.54000000000036, 197.1400000000003, 208.34000000000046, 222.3400000000005, 200.24000000000032, 199.64000000000036, 230.99000000000055, 202.4400000000003, 145.50900000000019, 231.94000000000048, 208.69000000000042, 206.7900000000004, 194.64000000000036, 215.6400000000005, 210.79000000000033, 220.44000000000045, 211.14000000000038, 202.24000000000032, 199.39000000000044, 204.39000000000036, 201.3400000000004, 205.39000000000038, 196.39000000000033, 204.44000000000034, 228.64000000000055, 206.49000000000035, 203.1900000000003, 207.94000000000037, 214.8900000000004, 198.69000000000037, 222.29000000000045, 204.39000000000033, 211.9400000000003, 202.94000000000023, 208.6900000000004, 206.4900000000004, 206.59000000000037, 221.29000000000048, 209.19000000000034, 185.29000000000013, 190.3900000000002, 207.64000000000033, 214.94000000000037, 197.99000000000032, 191.19000000000028, 199.24000000000035, 199.19000000000037, 201.14000000000036, 203.44000000000034, 202.89000000000036, 192.2900000000003, 209.54000000000036, 202.39000000000033, 189.09000000000037, 188.91100000000029, 195.6900000000003, 191.19000000000028, 203.19000000000028, 219.59000000000046, 220.1900000000005, 199.2400000000003, 227.64000000000047, 204.84000000000032, 202.5900000000004, 193.99000000000026, 201.64000000000036, 204.84000000000034, 208.94000000000037, 191.6900000000002, 207.94000000000045, 202.34000000000032, 209.04000000000036, 219.5400000000005, 184.4900000000002, 203.6900000000004, 214.99000000000044, 181.839999999999], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [49.98000000000007, 50.78000000000006, 49.98000000000006, 57.78000000000006, 33.879999999999946, 52.279999999999994, 56.28000000000005, 48.780000000000015, 23.97999999999997, 47.680000000000035, 25.579999999999963, 26.379999999999985, 49.98000000000002, 31.779999999999966, 39.679999999999964, 47.98000000000004, 56.98000000000006, 48.58000000000003, 34.88, 57.18000000000005, 55.88000000000005, 49.280000000000086, 50.680000000000064, 40.78000000000001, 49.98000000000006, 44.78000000000008, 25.979999999999954, 53.08000000000003, 52.48000000000003, 20.27999999999995, 51.180000000000064, 35.879999999999995, 23.27999999999998, 38.980000000000004, 45.28000000000003, 55.6800000000001, 39.779999999999994, 41.07999999999999, 32.27999999999997, 43.48000000000005, 50.980000000000004, 54.280000000000065, 46.980000000000054, 50.08000000000007, 47.98000000000005, 55.380000000000074, 49.08000000000004, 19.979999999999954, 44.980000000000054, 49.880000000000045, 44.380000000000024, 36.97999999999997, 53.580000000000055, 32.079999999999956, 51.08000000000002, 40.180000000000014, 51.68000000000001, 38.98000000000001, 44.98000000000007, 40.980000000000025, 26.979999999999936, 43.579999999999984, 64.78000000000007, 61.68000000000003, 44.08000000000003, 39.079999999999984, 52.880000000000045, 62.480000000000025, 47.98000000000006, 54.08000000000005, 49.88000000000005, 48.080000000000034, 49.58000000000002, 59.48000000000008, 41.879999999999995, 49.08000000000003, 64.48000000000006, 43.280000000000044, 54.68000000000009, 62.48000000000005, 49.88000000000004, 33.47999999999997, 34.08000000000004, 47.98000000000005, 27.17999999999998, 45.38000000000004, 49.2800000000001, 57.080000000000084, 50.38000000000005, 49.48000000000005, 45.380000000000024, 58.88000000000003, 44.38000000000006, 51.08000000000003, 41.38000000000002, 31.37999999999993, 68.08000000000004, 50.38000000000002, 37.079999999999984, 60.08000000000009], "policy_hider_policy_reward": [67.43000000000002, 83.83000000000011, 71.53000000000002, 79.73000000000009, 69.48000000000003, 77.68000000000008, 65.38, 71.53000000000004, 85.88000000000014, 98.1800000000002, 75.63000000000007, 73.58000000000007, 67.43000000000002, 71.53000000000003, 77.68000000000008, 77.68000000000008, 116.63000000000031, 83.83000000000011, 73.58000000000004, 83.83000000000011, 124.83000000000035, 75.63000000000007, 77.68000000000009, 124.83000000000035, 69.48000000000002, 81.7800000000001, 73.58000000000004, 116.63000000000031, 102.28000000000023, 71.53000000000002, 73.58000000000006, 81.7800000000001, 67.43000000000002, 65.38, 73.58000000000004, 81.78000000000011, 73.58000000000004, 110.48000000000027, 67.43000000000002, 71.53000000000004, 75.63000000000008, 63.33000000000001, 87.93000000000012, 65.38, 73.58000000000004, 77.68000000000008, 85.88000000000012, 85.8800000000001, 73.58000000000003, 73.58000000000007, 92.03000000000013, 71.53000000000003, 124.83000000000035, 71.53000000000006, 63.33, 83.83000000000011, 73.58000000000006, 73.58000000000004, 124.83000000000035, 85.88000000000011, 71.53000000000006, 79.73000000000009, 33.99899999999999, 75.63000000000007, 85.88000000000014, 122.78000000000034, 98.18000000000019, 71.53000000000003, 75.63000000000005, 85.88000000000011, 73.58000000000004, 65.38000000000001, 89.98000000000015, 85.88000000000012, 89.98000000000016, 79.73000000000009, 63.33, 124.83000000000035, 85.88000000000012, 81.7800000000001, 77.68000000000006, 73.58000000000006, 79.73000000000008, 65.38, 89.98000000000015, 67.43, 67.42999999999998, 83.83000000000013, 83.83000000000011, 73.58000000000007, 65.38000000000001, 75.63000000000007, 77.68000000000008, 77.68000000000008, 124.83000000000035, 83.83000000000013, 81.78000000000009, 79.73000000000009, 83.83000000000013, 69.48000000000003, 73.58000000000006, 89.98000000000015, 100.23000000000019, 77.68000000000008, 69.48000000000003, 75.63000000000005, 65.38000000000001, 124.83000000000035, 73.58000000000006, 79.7300000000001, 79.73000000000009, 92.03000000000017, 75.63000000000008, 75.63000000000008, 85.88000000000012, 83.83000000000013, 77.68000000000009, 83.8300000000001, 85.88000000000012, 79.73000000000008, 69.48, 124.83000000000035, 83.83000000000011, 81.78000000000011, 51.029999999999994, 69.48000000000003, 67.43, 61.28000000000001, 77.68000000000008, 85.88000000000014, 106.38000000000025, 69.48, 75.63000000000007, 69.48000000000003, 63.33, 65.38000000000001, 73.58000000000006, 77.68000000000008, 71.53000000000004, 73.58000000000006, 79.73000000000008, 71.53000000000004, 79.73000000000008, 75.63000000000007, 75.63000000000007, 77.68000000000008, 65.38000000000001, 67.43000000000002, 59.22999999999999, 108.43000000000026, 71.53000000000004, 81.7800000000001, 63.33000000000001, 61.280000000000015, 69.48000000000005, 76.15100000000007, 67.43, 73.58000000000007, 69.48000000000002, 59.230000000000004, 65.38, 87.93000000000015, 102.28000000000023, 83.8300000000001, 89.98000000000012, 96.13000000000017, 89.98000000000016, 61.27999999999999, 124.83000000000035, 75.63000000000007, 79.7300000000001, 79.7300000000001, 77.68000000000006, 75.63000000000004, 59.230000000000004, 77.68000000000006, 75.63000000000007, 75.63000000000007, 61.27999999999999, 94.08000000000017, 94.08000000000018, 69.48000000000002, 65.38000000000001, 67.43000000000004, 104.33000000000024, 59.23, 73.58000000000006, 77.68000000000008, 83.83000000000011, 83.83000000000011, 85.88000000000012, 102.28000000000021, 53.08, 63.33, 75.63000000000005, 77.68000000000008, 92.03000000000017, 85.88000000000011, 58.880000000000116, 62.88000000000008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.073698090591531, "mean_inference_ms": 0.8136276537920802, "mean_action_processing_ms": 0.13992176032872872, "mean_env_wait_ms": 1.9385652125945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002215743064880371, "StateBufferConnector_ms": 0.00217437744140625, "ViewRequirementAgentConnector_ms": 0.05344593524932861}, "num_episodes": 30, "episode_return_max": 231.94000000000048, "episode_return_min": 145.50900000000019, "episode_return_mean": 204.97790000000037, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 251556, "num_agent_steps_trained": 251556, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 128.45977941786595, "num_env_steps_trained_throughput_per_sec": 128.45977941786595, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 251556, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 251556, "timers": {"training_iteration_time_ms": 30278.802, "restore_workers_time_ms": 0.005, "training_step_time_ms": 30278.788, "sample_time_ms": 28429.825, "learn_time_ms": 1848.758, "learn_throughput": 2163.615, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 251556, "num_agent_steps_trained": 251556}, "done": false, "training_iteration": 21, "trial_id": "default", "date": "2025-10-13_02-17-07", "timestamp": 1760336227, "time_this_iter_s": 31.13877582550049, "time_total_s": 550.6640462875366, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 550.6640462875366, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 32.8, "ram_util_percent": 34.24666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 3.0699294699562922, "policy_loss": -0.022113844987359785, "vf_loss": 6.41321685579088, "vf_explained_var": 0.052890176810915505, "kl": 0.013749233907294716, "entropy": 11.52525911028423, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.55555555555556, "num_grad_updates_lifetime": 13525.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.5664974745362996, "policy_loss": -0.021427323672105557, "vf_loss": 5.398533263802529, "vf_explained_var": 0.044440067000687124, "kl": 0.01234498404232916, "entropy": 11.195908665657043, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6880.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 263529, "num_agent_steps_trained": 263529}, "env_runners": {"episode_reward_max": 240.63999999999882, "episode_reward_min": 145.50900000000019, "episode_reward_mean": 205.86167000000037, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 2.880000000000008, "hider_policy": 33.99899999999999}, "policy_reward_max": {"seeker_policy": 71.28, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 44.83200000000002, "hider_policy": 80.51483500000009}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.99000000000055, 202.4400000000003, 145.50900000000019, 231.94000000000048, 208.69000000000042, 206.7900000000004, 194.64000000000036, 215.6400000000005, 210.79000000000033, 220.44000000000045, 211.14000000000038, 202.24000000000032, 199.39000000000044, 204.39000000000036, 201.3400000000004, 205.39000000000038, 196.39000000000033, 204.44000000000034, 228.64000000000055, 206.49000000000035, 203.1900000000003, 207.94000000000037, 214.8900000000004, 198.69000000000037, 222.29000000000045, 204.39000000000033, 211.9400000000003, 202.94000000000023, 208.6900000000004, 206.4900000000004, 206.59000000000037, 221.29000000000048, 209.19000000000034, 185.29000000000013, 190.3900000000002, 207.64000000000033, 214.94000000000037, 197.99000000000032, 191.19000000000028, 199.24000000000035, 199.19000000000037, 201.14000000000036, 203.44000000000034, 202.89000000000036, 192.2900000000003, 209.54000000000036, 202.39000000000033, 189.09000000000037, 188.91100000000029, 195.6900000000003, 191.19000000000028, 203.19000000000028, 219.59000000000046, 220.1900000000005, 199.2400000000003, 227.64000000000047, 204.84000000000032, 202.5900000000004, 193.99000000000026, 201.64000000000036, 204.84000000000034, 208.94000000000037, 191.6900000000002, 207.94000000000045, 202.34000000000032, 209.04000000000036, 219.5400000000005, 184.4900000000002, 203.6900000000004, 214.99000000000044, 181.839999999999, 197.68999999999895, 188.74000000000035, 208.54000000000042, 205.74000000000038, 224.49000000000046, 203.09000000000037, 179.4900000000002, 224.7400000000005, 200.79000000000042, 203.2400000000003, 208.2400000000004, 222.14000000000053, 201.0400000000003, 203.89000000000038, 224.54000000000048, 205.99000000000046, 199.86700000000036, 223.99000000000055, 213.29000000000048, 220.24000000000052, 240.63999999999882, 224.69000000000048, 195.94000000000014, 224.24000000000046, 215.9400000000003, 197.4900000000002, 206.29000000000022, 204.19000000000025, 206.04000000000028], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [20.27999999999995, 51.180000000000064, 35.879999999999995, 23.27999999999998, 38.980000000000004, 45.28000000000003, 55.6800000000001, 39.779999999999994, 41.07999999999999, 32.27999999999997, 43.48000000000005, 50.980000000000004, 54.280000000000065, 46.980000000000054, 50.08000000000007, 47.98000000000005, 55.380000000000074, 49.08000000000004, 19.979999999999954, 44.980000000000054, 49.880000000000045, 44.380000000000024, 36.97999999999997, 53.580000000000055, 32.079999999999956, 51.08000000000002, 40.180000000000014, 51.68000000000001, 38.98000000000001, 44.98000000000007, 40.980000000000025, 26.979999999999936, 43.579999999999984, 64.78000000000007, 61.68000000000003, 44.08000000000003, 39.079999999999984, 52.880000000000045, 62.480000000000025, 47.98000000000006, 54.08000000000005, 49.88000000000005, 48.080000000000034, 49.58000000000002, 59.48000000000008, 41.879999999999995, 49.08000000000003, 64.48000000000006, 43.280000000000044, 54.68000000000009, 62.48000000000005, 49.88000000000004, 33.47999999999997, 34.08000000000004, 47.98000000000005, 27.17999999999998, 45.38000000000004, 49.2800000000001, 57.080000000000084, 50.38000000000005, 49.48000000000005, 45.380000000000024, 58.88000000000003, 44.38000000000006, 51.08000000000003, 41.38000000000002, 31.37999999999993, 68.08000000000004, 50.38000000000002, 37.079999999999984, 60.08000000000009, 49.980000000000025, 57.98000000000014, 44.98000000000004, 46.28000000000009, 30.179999999999982, 49.78000000000006, 71.28, 28.379999999999967, 51.580000000000034, 47.879999999999995, 44.680000000000035, 29.879999999999942, 49.780000000000044, 50.58000000000004, 28.179999999999982, 48.58000000000004, 25.679999999999943, 29.67999999999995, 39.48000000000002, 27.979999999999936, 2.880000000000008, 28.579999999999963, 55.380000000000045, 28.179999999999954, 38.580000000000005, 52.88000000000007, 45.28000000000002, 47.280000000000065, 46.88000000000004], "policy_hider_policy_reward": [124.83000000000035, 85.88000000000011, 71.53000000000006, 79.73000000000009, 33.99899999999999, 75.63000000000007, 85.88000000000014, 122.78000000000034, 98.18000000000019, 71.53000000000003, 75.63000000000005, 85.88000000000011, 73.58000000000004, 65.38000000000001, 89.98000000000015, 85.88000000000012, 89.98000000000016, 79.73000000000009, 63.33, 124.83000000000035, 85.88000000000012, 81.7800000000001, 77.68000000000006, 73.58000000000006, 79.73000000000008, 65.38, 89.98000000000015, 67.43, 67.42999999999998, 83.83000000000013, 83.83000000000011, 73.58000000000007, 65.38000000000001, 75.63000000000007, 77.68000000000008, 77.68000000000008, 124.83000000000035, 83.83000000000013, 81.78000000000009, 79.73000000000009, 83.83000000000013, 69.48000000000003, 73.58000000000006, 89.98000000000015, 100.23000000000019, 77.68000000000008, 69.48000000000003, 75.63000000000005, 65.38000000000001, 124.83000000000035, 73.58000000000006, 79.7300000000001, 79.73000000000009, 92.03000000000017, 75.63000000000008, 75.63000000000008, 85.88000000000012, 83.83000000000013, 77.68000000000009, 83.8300000000001, 85.88000000000012, 79.73000000000008, 69.48, 124.83000000000035, 83.83000000000011, 81.78000000000011, 51.029999999999994, 69.48000000000003, 67.43, 61.28000000000001, 77.68000000000008, 85.88000000000014, 106.38000000000025, 69.48, 75.63000000000007, 69.48000000000003, 63.33, 65.38000000000001, 73.58000000000006, 77.68000000000008, 71.53000000000004, 73.58000000000006, 79.73000000000008, 71.53000000000004, 79.73000000000008, 75.63000000000007, 75.63000000000007, 77.68000000000008, 65.38000000000001, 67.43000000000002, 59.22999999999999, 108.43000000000026, 71.53000000000004, 81.7800000000001, 63.33000000000001, 61.280000000000015, 69.48000000000005, 76.15100000000007, 67.43, 73.58000000000007, 69.48000000000002, 59.230000000000004, 65.38, 87.93000000000015, 102.28000000000023, 83.8300000000001, 89.98000000000012, 96.13000000000017, 89.98000000000016, 61.27999999999999, 124.83000000000035, 75.63000000000007, 79.7300000000001, 79.7300000000001, 77.68000000000006, 75.63000000000004, 59.230000000000004, 77.68000000000006, 75.63000000000007, 75.63000000000007, 61.27999999999999, 94.08000000000017, 94.08000000000018, 69.48000000000002, 65.38000000000001, 67.43000000000004, 104.33000000000024, 59.23, 73.58000000000006, 77.68000000000008, 83.83000000000011, 83.83000000000011, 85.88000000000012, 102.28000000000021, 53.08, 63.33, 75.63000000000005, 77.68000000000008, 92.03000000000017, 85.88000000000011, 58.880000000000116, 62.88000000000008, 74.88000000000004, 72.83000000000007, 59.22999999999999, 71.53000000000003, 63.33000000000001, 100.23000000000022, 67.43000000000002, 92.03000000000016, 112.53000000000029, 81.78000000000011, 69.48000000000003, 83.83000000000013, 51.02999999999997, 57.17999999999999, 124.83000000000035, 71.53000000000006, 92.03000000000016, 57.18000000000001, 75.63000000000007, 79.73000000000009, 89.98000000000016, 73.58000000000004, 67.43, 124.83000000000035, 77.68000000000008, 73.58000000000006, 79.7300000000001, 73.58000000000003, 89.98000000000015, 106.38000000000025, 81.7800000000001, 75.63000000000005, 112.53000000000029, 61.656999999999975, 120.73000000000033, 73.58000000000004, 73.58000000000006, 100.2300000000002, 120.73000000000033, 71.53000000000004, 118.8799999999998, 118.8799999999998, 112.53000000000029, 83.58000000000007, 81.63000000000007, 58.93000000000001, 73.58000000000006, 122.48000000000027, 87.68000000000008, 89.68000000000009, 71.33, 73.27999999999999, 81.53000000000004, 79.48000000000005, 85.68000000000008, 71.22999999999998, 77.53000000000003, 81.63000000000005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.122012952251481, "mean_inference_ms": 0.8132056269268501, "mean_action_processing_ms": 0.13979374416672946, "mean_env_wait_ms": 1.9464944009196297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002185344696044922, "StateBufferConnector_ms": 0.002164602279663086, "ViewRequirementAgentConnector_ms": 0.05235731601715088}, "num_episodes": 29, "episode_return_max": 240.63999999999882, "episode_return_min": 145.50900000000019, "episode_return_mean": 205.86167000000037, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263529, "num_agent_steps_trained": 263529, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 141.5122103592875, "num_env_steps_trained_throughput_per_sec": 141.5122103592875, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 263529, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 263529, "timers": {"training_iteration_time_ms": 29916.067, "restore_workers_time_ms": 0.005, "training_step_time_ms": 29916.052, "sample_time_ms": 28056.192, "learn_time_ms": 1859.654, "learn_throughput": 2150.938, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 263529, "num_agent_steps_trained": 263529}, "done": false, "training_iteration": 22, "trial_id": "default", "date": "2025-10-13_02-17-35", "timestamp": 1760336255, "time_this_iter_s": 28.266775131225586, "time_total_s": 578.9308214187622, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 578.9308214187622, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 35.620000000000005, "ram_util_percent": 34.5225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 2.941638481427753, "policy_loss": -0.019212266317539153, "vf_loss": 6.146990100164262, "vf_explained_var": -0.004465533154351371, "kl": 0.014378111625803094, "entropy": 11.336321095057896, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.76190476190476, "num_grad_updates_lifetime": 14155.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.351635130867362, "policy_loss": -0.027079094171494945, "vf_loss": 4.979187132418156, "vf_explained_var": 0.08550780192017556, "kl": 0.01449392203601299, "entropy": 11.160406103730201, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 275515, "num_agent_steps_trained": 275515}, "env_runners": {"episode_reward_max": 240.63999999999882, "episode_reward_min": 179.4900000000002, "episode_reward_mean": 204.8046200000003, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 2.880000000000008, "hider_policy": 51.02999999999997}, "policy_reward_max": {"seeker_policy": 71.28, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 46.41900000000003, "hider_policy": 79.19281000000007}, "custom_metrics": {}, "hist_stats": {"episode_reward": [206.59000000000037, 221.29000000000048, 209.19000000000034, 185.29000000000013, 190.3900000000002, 207.64000000000033, 214.94000000000037, 197.99000000000032, 191.19000000000028, 199.24000000000035, 199.19000000000037, 201.14000000000036, 203.44000000000034, 202.89000000000036, 192.2900000000003, 209.54000000000036, 202.39000000000033, 189.09000000000037, 188.91100000000029, 195.6900000000003, 191.19000000000028, 203.19000000000028, 219.59000000000046, 220.1900000000005, 199.2400000000003, 227.64000000000047, 204.84000000000032, 202.5900000000004, 193.99000000000026, 201.64000000000036, 204.84000000000034, 208.94000000000037, 191.6900000000002, 207.94000000000045, 202.34000000000032, 209.04000000000036, 219.5400000000005, 184.4900000000002, 203.6900000000004, 214.99000000000044, 181.839999999999, 197.68999999999895, 188.74000000000035, 208.54000000000042, 205.74000000000038, 224.49000000000046, 203.09000000000037, 179.4900000000002, 224.7400000000005, 200.79000000000042, 203.2400000000003, 208.2400000000004, 222.14000000000053, 201.0400000000003, 203.89000000000038, 224.54000000000048, 205.99000000000046, 199.86700000000036, 223.99000000000055, 213.29000000000048, 220.24000000000052, 240.63999999999882, 224.69000000000048, 195.94000000000014, 224.24000000000046, 215.9400000000003, 197.4900000000002, 206.29000000000022, 204.19000000000025, 206.04000000000028, 219.4900000000004, 202.4900000000002, 215.19000000000023, 196.99000000000018, 222.79000000000028, 197.19000000000014, 201.19000000000017, 193.20400000000024, 207.0900000000004, 201.1400000000003, 186.64000000000019, 197.24000000000026, 210.09000000000037, 200.8400000000002, 210.89000000000019, 210.3900000000002, 201.7900000000004, 200.79000000000042, 203.24000000000032, 206.99000000000024, 193.94000000000025, 200.29000000000033, 198.89000000000033, 205.79000000000036, 197.1400000000003, 208.4400000000003, 205.8900000000004, 198.9900000000003, 197.59000000000032, 210.84000000000037], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [40.980000000000025, 26.979999999999936, 43.579999999999984, 64.78000000000007, 61.68000000000003, 44.08000000000003, 39.079999999999984, 52.880000000000045, 62.480000000000025, 47.98000000000006, 54.08000000000005, 49.88000000000005, 48.080000000000034, 49.58000000000002, 59.48000000000008, 41.879999999999995, 49.08000000000003, 64.48000000000006, 43.280000000000044, 54.68000000000009, 62.48000000000005, 49.88000000000004, 33.47999999999997, 34.08000000000004, 47.98000000000005, 27.17999999999998, 45.38000000000004, 49.2800000000001, 57.080000000000084, 50.38000000000005, 49.48000000000005, 45.380000000000024, 58.88000000000003, 44.38000000000006, 51.08000000000003, 41.38000000000002, 31.37999999999993, 68.08000000000004, 50.38000000000002, 37.079999999999984, 60.08000000000009, 49.980000000000025, 57.98000000000014, 44.98000000000004, 46.28000000000009, 30.179999999999982, 49.78000000000006, 71.28, 28.379999999999967, 51.580000000000034, 47.879999999999995, 44.680000000000035, 29.879999999999942, 49.780000000000044, 50.58000000000004, 28.179999999999982, 48.58000000000004, 25.679999999999943, 29.67999999999995, 39.48000000000002, 27.979999999999936, 2.880000000000008, 28.579999999999963, 55.380000000000045, 28.179999999999954, 38.580000000000005, 52.88000000000007, 45.28000000000002, 47.280000000000065, 46.88000000000004, 33.47999999999998, 49.480000000000004, 31.979999999999954, 54.58000000000006, 31.379999999999956, 54.480000000000075, 52.38000000000003, 46.47999999999997, 45.880000000000045, 50.18000000000007, 64.38000000000007, 56.58000000000006, 42.580000000000005, 51.98000000000003, 41.68000000000001, 43.27999999999997, 48.48000000000007, 51.58000000000005, 47.88000000000001, 45.48000000000001, 59.080000000000055, 46.98000000000002, 53.78000000000006, 48.38000000000001, 49.98000000000011, 44.87999999999999, 48.480000000000054, 53.88000000000001, 56.58000000000002, 43.180000000000014], "policy_hider_policy_reward": [85.88000000000012, 79.73000000000008, 69.48, 124.83000000000035, 83.83000000000011, 81.78000000000011, 51.029999999999994, 69.48000000000003, 67.43, 61.28000000000001, 77.68000000000008, 85.88000000000014, 106.38000000000025, 69.48, 75.63000000000007, 69.48000000000003, 63.33, 65.38000000000001, 73.58000000000006, 77.68000000000008, 71.53000000000004, 73.58000000000006, 79.73000000000008, 71.53000000000004, 79.73000000000008, 75.63000000000007, 75.63000000000007, 77.68000000000008, 65.38000000000001, 67.43000000000002, 59.22999999999999, 108.43000000000026, 71.53000000000004, 81.7800000000001, 63.33000000000001, 61.280000000000015, 69.48000000000005, 76.15100000000007, 67.43, 73.58000000000007, 69.48000000000002, 59.230000000000004, 65.38, 87.93000000000015, 102.28000000000023, 83.8300000000001, 89.98000000000012, 96.13000000000017, 89.98000000000016, 61.27999999999999, 124.83000000000035, 75.63000000000007, 79.7300000000001, 79.7300000000001, 77.68000000000006, 75.63000000000004, 59.230000000000004, 77.68000000000006, 75.63000000000007, 75.63000000000007, 61.27999999999999, 94.08000000000017, 94.08000000000018, 69.48000000000002, 65.38000000000001, 67.43000000000004, 104.33000000000024, 59.23, 73.58000000000006, 77.68000000000008, 83.83000000000011, 83.83000000000011, 85.88000000000012, 102.28000000000021, 53.08, 63.33, 75.63000000000005, 77.68000000000008, 92.03000000000017, 85.88000000000011, 58.880000000000116, 62.88000000000008, 74.88000000000004, 72.83000000000007, 59.22999999999999, 71.53000000000003, 63.33000000000001, 100.23000000000022, 67.43000000000002, 92.03000000000016, 112.53000000000029, 81.78000000000011, 69.48000000000003, 83.83000000000013, 51.02999999999997, 57.17999999999999, 124.83000000000035, 71.53000000000006, 92.03000000000016, 57.18000000000001, 75.63000000000007, 79.73000000000009, 89.98000000000016, 73.58000000000004, 67.43, 124.83000000000035, 77.68000000000008, 73.58000000000006, 79.7300000000001, 73.58000000000003, 89.98000000000015, 106.38000000000025, 81.7800000000001, 75.63000000000005, 112.53000000000029, 61.656999999999975, 120.73000000000033, 73.58000000000004, 73.58000000000006, 100.2300000000002, 120.73000000000033, 71.53000000000004, 118.8799999999998, 118.8799999999998, 112.53000000000029, 83.58000000000007, 81.63000000000007, 58.93000000000001, 73.58000000000006, 122.48000000000027, 87.68000000000008, 89.68000000000009, 71.33, 73.27999999999999, 81.53000000000004, 79.48000000000005, 85.68000000000008, 71.22999999999998, 77.53000000000003, 81.63000000000005, 87.88000000000014, 98.1300000000002, 73.27999999999999, 79.73000000000008, 85.43, 97.78000000000011, 65.03, 77.38, 124.38000000000025, 67.02999999999997, 71.27999999999996, 71.43, 75.32999999999998, 73.48000000000005, 71.19400000000002, 75.53000000000004, 104.03000000000016, 57.180000000000014, 73.32999999999998, 77.63000000000007, 61.03, 61.22999999999998, 69.12999999999997, 71.53000000000003, 85.88000000000012, 81.63000000000007, 67.07999999999998, 81.78000000000011, 75.32999999999998, 93.88000000000014, 79.38, 87.73000000000009, 77.68000000000008, 75.63000000000008, 71.53000000000003, 77.68000000000008, 77.68000000000008, 77.68000000000008, 71.53000000000006, 89.98000000000016, 63.33, 71.53000000000003, 69.48000000000003, 83.8300000000001, 77.68000000000008, 67.43, 67.43000000000002, 89.98000000000015, 77.68000000000008, 69.48, 81.7800000000001, 81.7800000000001, 77.68000000000006, 79.73000000000009, 71.53000000000004, 73.58000000000007, 67.43000000000002, 73.58000000000006, 77.68000000000008, 89.98000000000016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.147771300175707, "mean_inference_ms": 0.8122952329047817, "mean_action_processing_ms": 0.13954746351394187, "mean_env_wait_ms": 1.9553225228113214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021622180938720703, "StateBufferConnector_ms": 0.002117156982421875, "ViewRequirementAgentConnector_ms": 0.051032423973083496}, "num_episodes": 30, "episode_return_max": 240.63999999999882, "episode_return_min": 179.4900000000002, "episode_return_mean": 204.8046200000003, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 275515, "num_agent_steps_trained": 275515, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.0154983542176, "num_env_steps_trained_throughput_per_sec": 153.0154983542176, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 275515, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 275515, "timers": {"training_iteration_time_ms": 30661.518, "restore_workers_time_ms": 0.005, "training_step_time_ms": 30661.503, "sample_time_ms": 28799.823, "learn_time_ms": 1861.472, "learn_throughput": 2148.838, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 275515, "num_agent_steps_trained": 275515}, "done": false, "training_iteration": 23, "trial_id": "default", "date": "2025-10-13_02-18-01", "timestamp": 1760336281, "time_this_iter_s": 26.14174175262451, "time_total_s": 605.0725631713867, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 605.0725631713867, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 40.08648648648649, "ram_util_percent": 34.52432432432431}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 2.9362278953431145, "policy_loss": -0.019301206025014086, "vf_loss": 6.139713269188291, "vf_explained_var": 0.037657457684713694, "kl": 0.016221441534573777, "entropy": 11.513860051594083, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.33333333333333, "num_grad_updates_lifetime": 14785.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.5142181020230057, "policy_loss": -0.027809698149212636, "vf_loss": 5.307294583320617, "vf_explained_var": 0.06340276319533586, "kl": 0.01353963089917451, "entropy": 11.22964875102043, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7520.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 287474, "num_agent_steps_trained": 287474}, "env_runners": {"episode_reward_max": 240.63999999999882, "episode_reward_min": 168.1809999999998, "episode_reward_mean": 204.2783200000002, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 2.880000000000008, "hider_policy": 51.02999999999997}, "policy_reward_max": {"seeker_policy": 71.28, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 46.61400000000003, "hider_policy": 78.83216000000006}, "custom_metrics": {}, "hist_stats": {"episode_reward": [204.84000000000034, 208.94000000000037, 191.6900000000002, 207.94000000000045, 202.34000000000032, 209.04000000000036, 219.5400000000005, 184.4900000000002, 203.6900000000004, 214.99000000000044, 181.839999999999, 197.68999999999895, 188.74000000000035, 208.54000000000042, 205.74000000000038, 224.49000000000046, 203.09000000000037, 179.4900000000002, 224.7400000000005, 200.79000000000042, 203.2400000000003, 208.2400000000004, 222.14000000000053, 201.0400000000003, 203.89000000000038, 224.54000000000048, 205.99000000000046, 199.86700000000036, 223.99000000000055, 213.29000000000048, 220.24000000000052, 240.63999999999882, 224.69000000000048, 195.94000000000014, 224.24000000000046, 215.9400000000003, 197.4900000000002, 206.29000000000022, 204.19000000000025, 206.04000000000028, 219.4900000000004, 202.4900000000002, 215.19000000000023, 196.99000000000018, 222.79000000000028, 197.19000000000014, 201.19000000000017, 193.20400000000024, 207.0900000000004, 201.1400000000003, 186.64000000000019, 197.24000000000026, 210.09000000000037, 200.8400000000002, 210.89000000000019, 210.3900000000002, 201.7900000000004, 200.79000000000042, 203.24000000000032, 206.99000000000024, 193.94000000000025, 200.29000000000033, 198.89000000000033, 205.79000000000036, 197.1400000000003, 208.4400000000003, 205.8900000000004, 198.9900000000003, 197.59000000000032, 210.84000000000037, 219.09000000000046, 208.04000000000033, 180.84000000000006, 211.49000000000044, 198.34000000000032, 217.44000000000042, 193.54000000000028, 203.59000000000037, 206.69000000000037, 188.59000000000032, 201.54000000000022, 189.04000000000028, 204.49000000000035, 197.74000000000032, 205.54000000000036, 210.9900000000004, 190.33999999999898, 183.5899999999991, 214.34000000000023, 194.1399999999999, 230.34, 211.1900000000001, 210.48999999999992, 191.68999999999988, 192.23999999999978, 202.3400000000003, 168.1809999999998, 188.5399999999997, 206.44, 198.9399999999998], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [49.48000000000005, 45.380000000000024, 58.88000000000003, 44.38000000000006, 51.08000000000003, 41.38000000000002, 31.37999999999993, 68.08000000000004, 50.38000000000002, 37.079999999999984, 60.08000000000009, 49.980000000000025, 57.98000000000014, 44.98000000000004, 46.28000000000009, 30.179999999999982, 49.78000000000006, 71.28, 28.379999999999967, 51.580000000000034, 47.879999999999995, 44.680000000000035, 29.879999999999942, 49.780000000000044, 50.58000000000004, 28.179999999999982, 48.58000000000004, 25.679999999999943, 29.67999999999995, 39.48000000000002, 27.979999999999936, 2.880000000000008, 28.579999999999963, 55.380000000000045, 28.179999999999954, 38.580000000000005, 52.88000000000007, 45.28000000000002, 47.280000000000065, 46.88000000000004, 33.47999999999998, 49.480000000000004, 31.979999999999954, 54.58000000000006, 31.379999999999956, 54.480000000000075, 52.38000000000003, 46.47999999999997, 45.880000000000045, 50.18000000000007, 64.38000000000007, 56.58000000000006, 42.580000000000005, 51.98000000000003, 41.68000000000001, 43.27999999999997, 48.48000000000007, 51.58000000000005, 47.88000000000001, 45.48000000000001, 59.080000000000055, 46.98000000000002, 53.78000000000006, 48.38000000000001, 49.98000000000011, 44.87999999999999, 48.480000000000054, 53.88000000000001, 56.58000000000002, 43.180000000000014, 32.979999999999976, 44.48000000000003, 70.58000000000004, 41.779999999999994, 55.28000000000004, 37.47999999999999, 58.68000000000006, 50.28000000000005, 45.18000000000005, 63.98000000000004, 50.28000000000004, 62.38000000000006, 42.98000000000004, 54.68000000000005, 46.08000000000004, 41.28, 55.18000000000006, 57.08000000000011, 39.08, 54.980000000000075, 22.079999999999977, 40.88000000000006, 40.77999999999995, 58.58000000000003, 61.38000000000003, 49.68000000000006, 41.18000000000005, 57.9800000000001, 46.579999999999984, 51.88000000000005], "policy_hider_policy_reward": [61.27999999999999, 94.08000000000017, 94.08000000000018, 69.48000000000002, 65.38000000000001, 67.43000000000004, 104.33000000000024, 59.23, 73.58000000000006, 77.68000000000008, 83.83000000000011, 83.83000000000011, 85.88000000000012, 102.28000000000021, 53.08, 63.33, 75.63000000000005, 77.68000000000008, 92.03000000000017, 85.88000000000011, 58.880000000000116, 62.88000000000008, 74.88000000000004, 72.83000000000007, 59.22999999999999, 71.53000000000003, 63.33000000000001, 100.23000000000022, 67.43000000000002, 92.03000000000016, 112.53000000000029, 81.78000000000011, 69.48000000000003, 83.83000000000013, 51.02999999999997, 57.17999999999999, 124.83000000000035, 71.53000000000006, 92.03000000000016, 57.18000000000001, 75.63000000000007, 79.73000000000009, 89.98000000000016, 73.58000000000004, 67.43, 124.83000000000035, 77.68000000000008, 73.58000000000006, 79.7300000000001, 73.58000000000003, 89.98000000000015, 106.38000000000025, 81.7800000000001, 75.63000000000005, 112.53000000000029, 61.656999999999975, 120.73000000000033, 73.58000000000004, 73.58000000000006, 100.2300000000002, 120.73000000000033, 71.53000000000004, 118.8799999999998, 118.8799999999998, 112.53000000000029, 83.58000000000007, 81.63000000000007, 58.93000000000001, 73.58000000000006, 122.48000000000027, 87.68000000000008, 89.68000000000009, 71.33, 73.27999999999999, 81.53000000000004, 79.48000000000005, 85.68000000000008, 71.22999999999998, 77.53000000000003, 81.63000000000005, 87.88000000000014, 98.1300000000002, 73.27999999999999, 79.73000000000008, 85.43, 97.78000000000011, 65.03, 77.38, 124.38000000000025, 67.02999999999997, 71.27999999999996, 71.43, 75.32999999999998, 73.48000000000005, 71.19400000000002, 75.53000000000004, 104.03000000000016, 57.180000000000014, 73.32999999999998, 77.63000000000007, 61.03, 61.22999999999998, 69.12999999999997, 71.53000000000003, 85.88000000000012, 81.63000000000007, 67.07999999999998, 81.78000000000011, 75.32999999999998, 93.88000000000014, 79.38, 87.73000000000009, 77.68000000000008, 75.63000000000008, 71.53000000000003, 77.68000000000008, 77.68000000000008, 77.68000000000008, 71.53000000000006, 89.98000000000016, 63.33, 71.53000000000003, 69.48000000000003, 83.8300000000001, 77.68000000000008, 67.43, 67.43000000000002, 89.98000000000015, 77.68000000000008, 69.48, 81.7800000000001, 81.7800000000001, 77.68000000000006, 79.73000000000009, 71.53000000000004, 73.58000000000007, 67.43000000000002, 73.58000000000006, 77.68000000000008, 89.98000000000016, 94.08000000000018, 92.03000000000017, 73.58000000000004, 89.98000000000016, 55.13000000000002, 55.130000000000024, 83.83000000000011, 85.88000000000014, 77.68000000000006, 65.38, 104.33000000000023, 75.63000000000005, 63.33, 71.53000000000006, 65.38000000000001, 87.93000000000013, 79.73000000000008, 81.7800000000001, 59.229999999999976, 65.38, 71.53000000000004, 79.7300000000001, 65.38000000000001, 61.28, 75.63000000000007, 85.88000000000012, 75.63000000000005, 67.43000000000002, 83.8300000000001, 75.63000000000008, 89.98000000000016, 79.73000000000008, 63.53000000000009, 71.63000000000005, 61.5300000000001, 64.98000000000009, 87.93000000000013, 87.33, 59.930000000000085, 79.22999999999998, 123.07999999999996, 85.17999999999995, 82.37999999999988, 87.93000000000013, 92.57999999999983, 77.12999999999995, 66.33000000000003, 66.78, 64.08000000000007, 66.78000000000002, 83.8300000000001, 68.83, 69.78000000000003, 57.22099999999998, 65.98000000000008, 64.58000000000003, 78.07999999999994, 81.7800000000001, 76.22999999999989, 70.82999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1524384856234917, "mean_inference_ms": 0.8114052542483842, "mean_action_processing_ms": 0.13928403439436013, "mean_env_wait_ms": 1.9650394728414435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021439790725708008, "StateBufferConnector_ms": 0.0020804405212402344, "ViewRequirementAgentConnector_ms": 0.04954934120178223}, "num_episodes": 30, "episode_return_max": 240.63999999999882, "episode_return_min": 168.1809999999998, "episode_return_mean": 204.2783200000002, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287474, "num_agent_steps_trained": 287474, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.62988078865502, "num_env_steps_trained_throughput_per_sec": 152.62988078865502, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 287474, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 287474, "timers": {"training_iteration_time_ms": 30162.714, "restore_workers_time_ms": 0.005, "training_step_time_ms": 30162.699, "sample_time_ms": 28296.097, "learn_time_ms": 1866.394, "learn_throughput": 2143.17, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 287474, "num_agent_steps_trained": 287474}, "done": false, "training_iteration": 24, "trial_id": "default", "date": "2025-10-13_02-18-27", "timestamp": 1760336307, "time_this_iter_s": 26.20774483680725, "time_total_s": 631.280308008194, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 631.280308008194, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 35.310810810810814, "ram_util_percent": 34.65945945945945}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 2.9570512665642634, "policy_loss": -0.0206227956217758, "vf_loss": 6.1839722550104534, "vf_explained_var": 0.016849023292935084, "kl": 0.015027936366072622, "entropy": 11.50634639073932, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 15415.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.3303733464330434, "policy_loss": -0.0238502275547944, "vf_loss": 4.934491494297982, "vf_explained_var": 0.13493368290364743, "kl": 0.01573527259442934, "entropy": 11.380893418192864, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7840.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 299474, "num_agent_steps_trained": 299474}, "env_runners": {"episode_reward_max": 240.63999999999882, "episode_reward_min": 168.1809999999998, "episode_reward_mean": 204.6296100000002, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 2.880000000000008, "hider_policy": 55.129999999999995}, "policy_reward_max": {"seeker_policy": 70.58000000000004, "hider_policy": 124.38000000000025}, "policy_reward_mean": {"seeker_policy": 46.381020000000035, "hider_policy": 79.12429500000006}, "custom_metrics": {}, "hist_stats": {"episode_reward": [213.29000000000048, 220.24000000000052, 240.63999999999882, 224.69000000000048, 195.94000000000014, 224.24000000000046, 215.9400000000003, 197.4900000000002, 206.29000000000022, 204.19000000000025, 206.04000000000028, 219.4900000000004, 202.4900000000002, 215.19000000000023, 196.99000000000018, 222.79000000000028, 197.19000000000014, 201.19000000000017, 193.20400000000024, 207.0900000000004, 201.1400000000003, 186.64000000000019, 197.24000000000026, 210.09000000000037, 200.8400000000002, 210.89000000000019, 210.3900000000002, 201.7900000000004, 200.79000000000042, 203.24000000000032, 206.99000000000024, 193.94000000000025, 200.29000000000033, 198.89000000000033, 205.79000000000036, 197.1400000000003, 208.4400000000003, 205.8900000000004, 198.9900000000003, 197.59000000000032, 210.84000000000037, 219.09000000000046, 208.04000000000033, 180.84000000000006, 211.49000000000044, 198.34000000000032, 217.44000000000042, 193.54000000000028, 203.59000000000037, 206.69000000000037, 188.59000000000032, 201.54000000000022, 189.04000000000028, 204.49000000000035, 197.74000000000032, 205.54000000000036, 210.9900000000004, 190.33999999999898, 183.5899999999991, 214.34000000000023, 194.1399999999999, 230.34, 211.1900000000001, 210.48999999999992, 191.68999999999988, 192.23999999999978, 202.3400000000003, 168.1809999999998, 188.5399999999997, 206.44, 198.9399999999998, 205.44600000000017, 202.94000000000005, 210.19000000000017, 207.14000000000019, 209.14000000000013, 192.93999999999994, 226.19000000000023, 196.84000000000003, 206.54000000000036, 197.59, 221.99000000000012, 209.74000000000015, 203.94000000000005, 194.93999999999997, 209.04000000000013, 198.34000000000003, 195.99000000000015, 192.74000000000004, 196.2900000000001, 220.6400000000004, 223.99000000000052, 213.34000000000043, 208.99000000000035, 186.54000000000016, 215.69000000000042, 211.04000000000033, 230.34000000000057, 202.79000000000028, 199.3900000000003], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [39.48000000000002, 27.979999999999936, 2.880000000000008, 28.579999999999963, 55.380000000000045, 28.179999999999954, 38.580000000000005, 52.88000000000007, 45.28000000000002, 47.280000000000065, 46.88000000000004, 33.47999999999998, 49.480000000000004, 31.979999999999954, 54.58000000000006, 31.379999999999956, 54.480000000000075, 52.38000000000003, 46.47999999999997, 45.880000000000045, 50.18000000000007, 64.38000000000007, 56.58000000000006, 42.580000000000005, 51.98000000000003, 41.68000000000001, 43.27999999999997, 48.48000000000007, 51.58000000000005, 47.88000000000001, 45.48000000000001, 59.080000000000055, 46.98000000000002, 53.78000000000006, 48.38000000000001, 49.98000000000011, 44.87999999999999, 48.480000000000054, 53.88000000000001, 56.58000000000002, 43.180000000000014, 32.979999999999976, 44.48000000000003, 70.58000000000004, 41.779999999999994, 55.28000000000004, 37.47999999999999, 58.68000000000006, 50.28000000000005, 45.18000000000005, 63.98000000000004, 50.28000000000004, 62.38000000000006, 42.98000000000004, 54.68000000000005, 46.08000000000004, 41.28, 55.18000000000006, 57.08000000000011, 39.08, 54.980000000000075, 22.079999999999977, 40.88000000000006, 40.77999999999995, 58.58000000000003, 61.38000000000003, 49.68000000000006, 41.18000000000005, 57.9800000000001, 46.579999999999984, 51.88000000000005, 40.982000000000035, 50.680000000000014, 39.88000000000003, 45.87999999999999, 40.780000000000044, 59.28000000000003, 22.979999999999976, 52.680000000000035, 43.28000000000005, 53.38000000000004, 29.07999999999996, 41.28000000000003, 47.780000000000044, 57.180000000000035, 42.580000000000034, 50.28000000000008, 55.98000000000006, 59.080000000000084, 54.28000000000008, 31.179999999999918, 29.679999999999957, 37.47999999999996, 43.380000000000024, 63.98000000000007, 37.779999999999994, 43.38000000000002, 21.67999999999999, 49.480000000000025, 54.28000000000003], "policy_hider_policy_reward": [73.58000000000006, 100.2300000000002, 120.73000000000033, 71.53000000000004, 118.8799999999998, 118.8799999999998, 112.53000000000029, 83.58000000000007, 81.63000000000007, 58.93000000000001, 73.58000000000006, 122.48000000000027, 87.68000000000008, 89.68000000000009, 71.33, 73.27999999999999, 81.53000000000004, 79.48000000000005, 85.68000000000008, 71.22999999999998, 77.53000000000003, 81.63000000000005, 87.88000000000014, 98.1300000000002, 73.27999999999999, 79.73000000000008, 85.43, 97.78000000000011, 65.03, 77.38, 124.38000000000025, 67.02999999999997, 71.27999999999996, 71.43, 75.32999999999998, 73.48000000000005, 71.19400000000002, 75.53000000000004, 104.03000000000016, 57.180000000000014, 73.32999999999998, 77.63000000000007, 61.03, 61.22999999999998, 69.12999999999997, 71.53000000000003, 85.88000000000012, 81.63000000000007, 67.07999999999998, 81.78000000000011, 75.32999999999998, 93.88000000000014, 79.38, 87.73000000000009, 77.68000000000008, 75.63000000000008, 71.53000000000003, 77.68000000000008, 77.68000000000008, 77.68000000000008, 71.53000000000006, 89.98000000000016, 63.33, 71.53000000000003, 69.48000000000003, 83.8300000000001, 77.68000000000008, 67.43, 67.43000000000002, 89.98000000000015, 77.68000000000008, 69.48, 81.7800000000001, 81.7800000000001, 77.68000000000006, 79.73000000000009, 71.53000000000004, 73.58000000000007, 67.43000000000002, 73.58000000000006, 77.68000000000008, 89.98000000000016, 94.08000000000018, 92.03000000000017, 73.58000000000004, 89.98000000000016, 55.13000000000002, 55.130000000000024, 83.83000000000011, 85.88000000000014, 77.68000000000006, 65.38, 104.33000000000023, 75.63000000000005, 63.33, 71.53000000000006, 65.38000000000001, 87.93000000000013, 79.73000000000008, 81.7800000000001, 59.229999999999976, 65.38, 71.53000000000004, 79.7300000000001, 65.38000000000001, 61.28, 75.63000000000007, 85.88000000000012, 75.63000000000005, 67.43000000000002, 83.8300000000001, 75.63000000000008, 89.98000000000016, 79.73000000000008, 63.53000000000009, 71.63000000000005, 61.5300000000001, 64.98000000000009, 87.93000000000013, 87.33, 59.930000000000085, 79.22999999999998, 123.07999999999996, 85.17999999999995, 82.37999999999988, 87.93000000000013, 92.57999999999983, 77.12999999999995, 66.33000000000003, 66.78, 64.08000000000007, 66.78000000000002, 83.8300000000001, 68.83, 69.78000000000003, 57.22099999999998, 65.98000000000008, 64.58000000000003, 78.07999999999994, 81.7800000000001, 76.22999999999989, 70.82999999999998, 77.38200000000002, 87.08199999999994, 71.22999999999998, 81.02999999999993, 89.48000000000003, 80.82999999999988, 75.38000000000001, 85.88000000000012, 95.58000000000004, 72.77999999999994, 64.97999999999999, 68.67999999999996, 124.33000000000024, 78.87999999999991, 81.48000000000003, 62.68000000000004, 81.48000000000002, 81.78000000000009, 71.53000000000004, 72.67999999999995, 114.23000000000022, 78.67999999999988, 93.78000000000011, 74.6799999999999, 85.58000000000007, 70.57999999999998, 79.48, 58.28000000000006, 91.88000000000014, 74.57999999999994, 69.38, 78.6799999999999, 81.63000000000004, 58.380000000000045, 65.17999999999998, 68.48, 69.33, 72.67999999999998, 96.13000000000018, 93.33, 98.18000000000019, 96.13000000000018, 67.43000000000002, 108.43000000000026, 73.58000000000006, 92.03000000000017, 55.129999999999995, 67.43000000000002, 114.58000000000028, 63.329999999999984, 94.08000000000017, 73.58000000000004, 85.88000000000014, 122.78000000000034, 77.68000000000008, 75.63000000000008, 67.43, 77.68000000000008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.137284708601743, "mean_inference_ms": 0.8109442293995001, "mean_action_processing_ms": 0.13912052866696237, "mean_env_wait_ms": 1.9766086178018312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002188444137573242, "StateBufferConnector_ms": 0.002093195915222168, "ViewRequirementAgentConnector_ms": 0.05013573169708252}, "num_episodes": 29, "episode_return_max": 240.63999999999882, "episode_return_min": 168.1809999999998, "episode_return_mean": 204.6296100000002, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 299474, "num_agent_steps_trained": 299474, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 166.90779294360502, "num_env_steps_trained_throughput_per_sec": 166.90779294360502, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 299474, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 299474, "timers": {"training_iteration_time_ms": 29369.188, "restore_workers_time_ms": 0.005, "training_step_time_ms": 29369.172, "sample_time_ms": 27490.438, "learn_time_ms": 1878.49, "learn_throughput": 2129.37, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 299474, "num_agent_steps_trained": 299474}, "done": false, "training_iteration": 25, "trial_id": "default", "date": "2025-10-13_02-18-51", "timestamp": 1760336331, "time_this_iter_s": 23.96590518951416, "time_total_s": 655.2462131977081, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 655.2462131977081, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 34.464705882352945, "ram_util_percent": 35.05882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 3.071805978199792, "policy_loss": -0.01620500163463432, "vf_loss": 6.410623959132603, "vf_explained_var": 0.008590586128688994, "kl": 0.013978203086847526, "entropy": 11.799990876515706, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16045.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.3244531583040953, "policy_loss": -0.015196684305556119, "vf_loss": 4.902947912365198, "vf_explained_var": -0.004057790525257588, "kl": 0.014281322301258203, "entropy": 11.253817486763001, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 311474, "num_agent_steps_trained": 311474}, "env_runners": {"episode_reward_max": 230.34000000000057, "episode_reward_min": 168.1809999999998, "episode_reward_mean": 203.00197000000017, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 21.67999999999999, "hider_policy": 51.02999999999999}, "policy_reward_max": {"seeker_policy": 70.58000000000004, "hider_policy": 124.33000000000024}, "policy_reward_mean": {"seeker_policy": 48.20302000000002, "hider_policy": 77.39947500000005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [206.99000000000024, 193.94000000000025, 200.29000000000033, 198.89000000000033, 205.79000000000036, 197.1400000000003, 208.4400000000003, 205.8900000000004, 198.9900000000003, 197.59000000000032, 210.84000000000037, 219.09000000000046, 208.04000000000033, 180.84000000000006, 211.49000000000044, 198.34000000000032, 217.44000000000042, 193.54000000000028, 203.59000000000037, 206.69000000000037, 188.59000000000032, 201.54000000000022, 189.04000000000028, 204.49000000000035, 197.74000000000032, 205.54000000000036, 210.9900000000004, 190.33999999999898, 183.5899999999991, 214.34000000000023, 194.1399999999999, 230.34, 211.1900000000001, 210.48999999999992, 191.68999999999988, 192.23999999999978, 202.3400000000003, 168.1809999999998, 188.5399999999997, 206.44, 198.9399999999998, 205.44600000000017, 202.94000000000005, 210.19000000000017, 207.14000000000019, 209.14000000000013, 192.93999999999994, 226.19000000000023, 196.84000000000003, 206.54000000000036, 197.59, 221.99000000000012, 209.74000000000015, 203.94000000000005, 194.93999999999997, 209.04000000000013, 198.34000000000003, 195.99000000000015, 192.74000000000004, 196.2900000000001, 220.6400000000004, 223.99000000000052, 213.34000000000043, 208.99000000000035, 186.54000000000016, 215.69000000000042, 211.04000000000033, 230.34000000000057, 202.79000000000028, 199.3900000000003, 214.79000000000033, 204.04000000000036, 200.99000000000026, 194.99000000000035, 196.49000000000035, 201.44000000000034, 225.14000000000053, 218.99000000000046, 201.0400000000003, 197.24000000000026, 208.59000000000046, 199.74000000000026, 187.79000000000033, 197.09000000000032, 207.84000000000032, 212.69000000000042, 187.54000000000016, 196.49000000000032, 213.99000000000032, 199.6400000000003, 180.9900000000002, 198.1900000000003, 199.34000000000026, 204.44000000000037, 204.49000000000038, 201.34000000000032, 209.74000000000038, 199.54000000000042, 187.14000000000016, 213.14000000000044], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [45.48000000000001, 59.080000000000055, 46.98000000000002, 53.78000000000006, 48.38000000000001, 49.98000000000011, 44.87999999999999, 48.480000000000054, 53.88000000000001, 56.58000000000002, 43.180000000000014, 32.979999999999976, 44.48000000000003, 70.58000000000004, 41.779999999999994, 55.28000000000004, 37.47999999999999, 58.68000000000006, 50.28000000000005, 45.18000000000005, 63.98000000000004, 50.28000000000004, 62.38000000000006, 42.98000000000004, 54.68000000000005, 46.08000000000004, 41.28, 55.18000000000006, 57.08000000000011, 39.08, 54.980000000000075, 22.079999999999977, 40.88000000000006, 40.77999999999995, 58.58000000000003, 61.38000000000003, 49.68000000000006, 41.18000000000005, 57.9800000000001, 46.579999999999984, 51.88000000000005, 40.982000000000035, 50.680000000000014, 39.88000000000003, 45.87999999999999, 40.780000000000044, 59.28000000000003, 22.979999999999976, 52.680000000000035, 43.28000000000005, 53.38000000000004, 29.07999999999996, 41.28000000000003, 47.780000000000044, 57.180000000000035, 42.580000000000034, 50.28000000000008, 55.98000000000006, 59.080000000000084, 54.28000000000008, 31.179999999999918, 29.679999999999957, 37.47999999999996, 43.380000000000024, 63.98000000000007, 37.779999999999994, 43.38000000000002, 21.67999999999999, 49.480000000000025, 54.28000000000003, 40.97999999999998, 48.68000000000004, 47.68000000000003, 58.080000000000034, 55.48000000000007, 50.18000000000005, 28.779999999999955, 36.97999999999999, 49.779999999999994, 54.18000000000004, 42.979999999999976, 52.58000000000005, 67.27999999999997, 56.08000000000007, 44.28000000000002, 38.88, 64.98000000000009, 55.48000000000008, 40.18, 52.480000000000054, 68.68000000000008, 48.980000000000025, 52.18000000000004, 49.08000000000004, 42.97999999999999, 50.08000000000002, 37.98000000000001, 52.38000000000007, 64.58000000000003, 41.37999999999999], "policy_hider_policy_reward": [71.53000000000006, 89.98000000000016, 63.33, 71.53000000000003, 69.48000000000003, 83.8300000000001, 77.68000000000008, 67.43, 67.43000000000002, 89.98000000000015, 77.68000000000008, 69.48, 81.7800000000001, 81.7800000000001, 77.68000000000006, 79.73000000000009, 71.53000000000004, 73.58000000000007, 67.43000000000002, 73.58000000000006, 77.68000000000008, 89.98000000000016, 94.08000000000018, 92.03000000000017, 73.58000000000004, 89.98000000000016, 55.13000000000002, 55.130000000000024, 83.83000000000011, 85.88000000000014, 77.68000000000006, 65.38, 104.33000000000023, 75.63000000000005, 63.33, 71.53000000000006, 65.38000000000001, 87.93000000000013, 79.73000000000008, 81.7800000000001, 59.229999999999976, 65.38, 71.53000000000004, 79.7300000000001, 65.38000000000001, 61.28, 75.63000000000007, 85.88000000000012, 75.63000000000005, 67.43000000000002, 83.8300000000001, 75.63000000000008, 89.98000000000016, 79.73000000000008, 63.53000000000009, 71.63000000000005, 61.5300000000001, 64.98000000000009, 87.93000000000013, 87.33, 59.930000000000085, 79.22999999999998, 123.07999999999996, 85.17999999999995, 82.37999999999988, 87.93000000000013, 92.57999999999983, 77.12999999999995, 66.33000000000003, 66.78, 64.08000000000007, 66.78000000000002, 83.8300000000001, 68.83, 69.78000000000003, 57.22099999999998, 65.98000000000008, 64.58000000000003, 78.07999999999994, 81.7800000000001, 76.22999999999989, 70.82999999999998, 77.38200000000002, 87.08199999999994, 71.22999999999998, 81.02999999999993, 89.48000000000003, 80.82999999999988, 75.38000000000001, 85.88000000000012, 95.58000000000004, 72.77999999999994, 64.97999999999999, 68.67999999999996, 124.33000000000024, 78.87999999999991, 81.48000000000003, 62.68000000000004, 81.48000000000002, 81.78000000000009, 71.53000000000004, 72.67999999999995, 114.23000000000022, 78.67999999999988, 93.78000000000011, 74.6799999999999, 85.58000000000007, 70.57999999999998, 79.48, 58.28000000000006, 91.88000000000014, 74.57999999999994, 69.38, 78.6799999999999, 81.63000000000004, 58.380000000000045, 65.17999999999998, 68.48, 69.33, 72.67999999999998, 96.13000000000018, 93.33, 98.18000000000019, 96.13000000000018, 67.43000000000002, 108.43000000000026, 73.58000000000006, 92.03000000000017, 55.129999999999995, 67.43000000000002, 114.58000000000028, 63.329999999999984, 94.08000000000017, 73.58000000000004, 85.88000000000014, 122.78000000000034, 77.68000000000008, 75.63000000000008, 67.43, 77.68000000000008, 71.53000000000004, 102.28000000000023, 75.63000000000005, 79.73000000000009, 79.7300000000001, 73.58000000000006, 79.73000000000009, 57.17999999999999, 77.68000000000006, 63.33, 77.68000000000008, 73.58000000000006, 75.63000000000004, 120.73000000000033, 85.88000000000011, 96.1300000000002, 69.48000000000003, 81.7800000000001, 69.48000000000003, 73.58000000000004, 79.73000000000009, 85.88000000000014, 79.7300000000001, 67.42999999999999, 59.23, 61.27999999999999, 65.37999999999998, 75.63000000000007, 71.53000000000004, 92.03000000000017, 87.93000000000013, 85.88000000000014, 51.02999999999999, 71.53000000000004, 69.48000000000003, 71.53000000000004, 83.83000000000013, 89.98000000000016, 75.63000000000007, 71.53000000000004, 57.18, 55.13000000000001, 75.63000000000007, 73.58000000000004, 81.78000000000009, 65.38000000000001, 89.98000000000015, 65.38, 79.73000000000009, 81.7800000000001, 77.68000000000006, 73.58000000000006, 87.93000000000015, 83.83000000000011, 73.58000000000006, 73.58000000000004, 55.13000000000001, 67.43000000000002, 65.38, 106.38000000000025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.135169537659433, "mean_inference_ms": 0.8108131473119227, "mean_action_processing_ms": 0.13900004767551022, "mean_env_wait_ms": 1.9886614291174374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021554231643676758, "StateBufferConnector_ms": 0.0021811723709106445, "ViewRequirementAgentConnector_ms": 0.05070650577545166}, "num_episodes": 30, "episode_return_max": 230.34000000000057, "episode_return_min": 168.1809999999998, "episode_return_mean": 203.00197000000017, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 311474, "num_agent_steps_trained": 311474, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.571976845116, "num_env_steps_trained_throughput_per_sec": 125.571976845116, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 311474, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 311474, "timers": {"training_iteration_time_ms": 29359.754, "restore_workers_time_ms": 0.005, "training_step_time_ms": 29359.738, "sample_time_ms": 27483.596, "learn_time_ms": 1875.891, "learn_throughput": 2132.32, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 311474, "num_agent_steps_trained": 311474}, "done": false, "training_iteration": 26, "trial_id": "default", "date": "2025-10-13_02-19-23", "timestamp": 1760336363, "time_this_iter_s": 31.854809284210205, "time_total_s": 687.1010224819183, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 687.1010224819183, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 29.928260869565225, "ram_util_percent": 34.189130434782605}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 3.078223835475861, "policy_loss": -0.017325685996680506, "vf_loss": 6.426731622786749, "vf_explained_var": -0.0017208124910082136, "kl": 0.016782218082863447, "entropy": 11.865539145091223, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16675.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.481185429543257, "policy_loss": -0.021904218049894553, "vf_loss": 5.233826893568039, "vf_explained_var": 0.025464125908911228, "kl": 0.014958081401300746, "entropy": 11.457170549035073, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8480.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 323474, "num_agent_steps_trained": 323474}, "env_runners": {"episode_reward_max": 230.34000000000057, "episode_reward_min": 168.1809999999998, "episode_reward_mean": 203.78647000000026, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 21.67999999999999, "hider_policy": 46.93000000000001}, "policy_reward_max": {"seeker_policy": 68.68000000000008, "hider_policy": 124.33000000000024}, "policy_reward_mean": {"seeker_policy": 47.466020000000036, "hider_policy": 78.16022500000007}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194.1399999999999, 230.34, 211.1900000000001, 210.48999999999992, 191.68999999999988, 192.23999999999978, 202.3400000000003, 168.1809999999998, 188.5399999999997, 206.44, 198.9399999999998, 205.44600000000017, 202.94000000000005, 210.19000000000017, 207.14000000000019, 209.14000000000013, 192.93999999999994, 226.19000000000023, 196.84000000000003, 206.54000000000036, 197.59, 221.99000000000012, 209.74000000000015, 203.94000000000005, 194.93999999999997, 209.04000000000013, 198.34000000000003, 195.99000000000015, 192.74000000000004, 196.2900000000001, 220.6400000000004, 223.99000000000052, 213.34000000000043, 208.99000000000035, 186.54000000000016, 215.69000000000042, 211.04000000000033, 230.34000000000057, 202.79000000000028, 199.3900000000003, 214.79000000000033, 204.04000000000036, 200.99000000000026, 194.99000000000035, 196.49000000000035, 201.44000000000034, 225.14000000000053, 218.99000000000046, 201.0400000000003, 197.24000000000026, 208.59000000000046, 199.74000000000026, 187.79000000000033, 197.09000000000032, 207.84000000000032, 212.69000000000042, 187.54000000000016, 196.49000000000032, 213.99000000000032, 199.6400000000003, 180.9900000000002, 198.1900000000003, 199.34000000000026, 204.44000000000037, 204.49000000000038, 201.34000000000032, 209.74000000000038, 199.54000000000042, 187.14000000000016, 213.14000000000044, 212.44000000000045, 202.04000000000036, 199.5900000000003, 195.54000000000022, 218.74000000000046, 201.89000000000036, 208.39000000000036, 193.89000000000038, 221.14000000000044, 208.24000000000038, 196.14000000000027, 195.84000000000034, 195.0400000000003, 194.94000000000037, 200.14000000000033, 211.89000000000044, 201.0400000000004, 192.39000000000024, 202.3900000000004, 203.64000000000038, 204.34000000000037, 202.2900000000003, 203.84000000000034, 220.24000000000044, 188.74000000000018, 205.59000000000026, 229.2400000000006, 192.24000000000018, 230.14000000000044, 196.49000000000035], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [54.980000000000075, 22.079999999999977, 40.88000000000006, 40.77999999999995, 58.58000000000003, 61.38000000000003, 49.68000000000006, 41.18000000000005, 57.9800000000001, 46.579999999999984, 51.88000000000005, 40.982000000000035, 50.680000000000014, 39.88000000000003, 45.87999999999999, 40.780000000000044, 59.28000000000003, 22.979999999999976, 52.680000000000035, 43.28000000000005, 53.38000000000004, 29.07999999999996, 41.28000000000003, 47.780000000000044, 57.180000000000035, 42.580000000000034, 50.28000000000008, 55.98000000000006, 59.080000000000084, 54.28000000000008, 31.179999999999918, 29.679999999999957, 37.47999999999996, 43.380000000000024, 63.98000000000007, 37.779999999999994, 43.38000000000002, 21.67999999999999, 49.480000000000025, 54.28000000000003, 40.97999999999998, 48.68000000000004, 47.68000000000003, 58.080000000000034, 55.48000000000007, 50.18000000000005, 28.779999999999955, 36.97999999999999, 49.779999999999994, 54.18000000000004, 42.979999999999976, 52.58000000000005, 67.27999999999997, 56.08000000000007, 44.28000000000002, 38.88, 64.98000000000009, 55.48000000000008, 40.18, 52.480000000000054, 68.68000000000008, 48.980000000000025, 52.18000000000004, 49.08000000000004, 42.97999999999999, 50.08000000000002, 37.98000000000001, 52.38000000000007, 64.58000000000003, 41.37999999999999, 40.68000000000001, 50.78000000000005, 50.38000000000008, 56.580000000000034, 34.679999999999964, 48.58000000000006, 42.780000000000015, 56.98000000000011, 32.979999999999976, 44.68000000000005, 53.080000000000055, 56.880000000000074, 51.98000000000012, 55.980000000000075, 52.980000000000054, 42.18000000000001, 49.78000000000007, 59.58000000000006, 44.980000000000054, 48.28000000000007, 48.980000000000025, 48.98000000000005, 48.48000000000001, 32.07999999999997, 57.98000000000008, 48.18000000000002, 24.67999999999992, 61.48000000000005, 25.580000000000005, 55.48000000000004], "policy_hider_policy_reward": [59.930000000000085, 79.22999999999998, 123.07999999999996, 85.17999999999995, 82.37999999999988, 87.93000000000013, 92.57999999999983, 77.12999999999995, 66.33000000000003, 66.78, 64.08000000000007, 66.78000000000002, 83.8300000000001, 68.83, 69.78000000000003, 57.22099999999998, 65.98000000000008, 64.58000000000003, 78.07999999999994, 81.7800000000001, 76.22999999999989, 70.82999999999998, 77.38200000000002, 87.08199999999994, 71.22999999999998, 81.02999999999993, 89.48000000000003, 80.82999999999988, 75.38000000000001, 85.88000000000012, 95.58000000000004, 72.77999999999994, 64.97999999999999, 68.67999999999996, 124.33000000000024, 78.87999999999991, 81.48000000000003, 62.68000000000004, 81.48000000000002, 81.78000000000009, 71.53000000000004, 72.67999999999995, 114.23000000000022, 78.67999999999988, 93.78000000000011, 74.6799999999999, 85.58000000000007, 70.57999999999998, 79.48, 58.28000000000006, 91.88000000000014, 74.57999999999994, 69.38, 78.6799999999999, 81.63000000000004, 58.380000000000045, 65.17999999999998, 68.48, 69.33, 72.67999999999998, 96.13000000000018, 93.33, 98.18000000000019, 96.13000000000018, 67.43000000000002, 108.43000000000026, 73.58000000000006, 92.03000000000017, 55.129999999999995, 67.43000000000002, 114.58000000000028, 63.329999999999984, 94.08000000000017, 73.58000000000004, 85.88000000000014, 122.78000000000034, 77.68000000000008, 75.63000000000008, 67.43, 77.68000000000008, 71.53000000000004, 102.28000000000023, 75.63000000000005, 79.73000000000009, 79.7300000000001, 73.58000000000006, 79.73000000000009, 57.17999999999999, 77.68000000000006, 63.33, 77.68000000000008, 73.58000000000006, 75.63000000000004, 120.73000000000033, 85.88000000000011, 96.1300000000002, 69.48000000000003, 81.7800000000001, 69.48000000000003, 73.58000000000004, 79.73000000000009, 85.88000000000014, 79.7300000000001, 67.42999999999999, 59.23, 61.27999999999999, 65.37999999999998, 75.63000000000007, 71.53000000000004, 92.03000000000017, 87.93000000000013, 85.88000000000014, 51.02999999999999, 71.53000000000004, 69.48000000000003, 71.53000000000004, 83.83000000000013, 89.98000000000016, 75.63000000000007, 71.53000000000004, 57.18, 55.13000000000001, 75.63000000000007, 73.58000000000004, 81.78000000000009, 65.38000000000001, 89.98000000000015, 65.38, 79.73000000000009, 81.7800000000001, 77.68000000000006, 73.58000000000006, 87.93000000000015, 83.83000000000011, 73.58000000000006, 73.58000000000004, 55.13000000000001, 67.43000000000002, 65.38, 106.38000000000025, 89.98000000000015, 81.7800000000001, 77.68000000000005, 73.58000000000006, 79.73000000000009, 69.48000000000003, 75.63000000000007, 63.33000000000001, 73.58000000000004, 110.48000000000026, 81.7800000000001, 71.53000000000004, 102.28000000000023, 63.33, 69.48000000000003, 67.43000000000002, 71.53000000000004, 116.63000000000031, 81.7800000000001, 81.7800000000001, 71.53000000000004, 71.53000000000004, 69.48000000000002, 69.48000000000002, 73.58000000000004, 69.48, 69.48, 69.48000000000003, 75.63000000000007, 71.53000000000006, 85.88000000000012, 83.83000000000011, 87.93000000000013, 63.330000000000005, 59.229999999999976, 73.58000000000006, 85.88000000000012, 71.53000000000004, 73.58000000000004, 81.7800000000001, 75.63000000000005, 79.73000000000009, 79.7300000000001, 73.58000000000006, 96.1300000000002, 59.230000000000004, 69.48000000000003, 118.68000000000032, 83.83000000000011, 46.93000000000001, 65.38000000000001, 92.03000000000017, 106.38000000000024, 98.18000000000019, 73.58000000000003, 57.180000000000014, 81.7800000000001, 122.78000000000034, 67.43, 73.58000000000006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1494132948474602, "mean_inference_ms": 0.8108973339274931, "mean_action_processing_ms": 0.13891065426499208, "mean_env_wait_ms": 1.9991693910600796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021303892135620117, "StateBufferConnector_ms": 0.0022034645080566406, "ViewRequirementAgentConnector_ms": 0.051462531089782715}, "num_episodes": 30, "episode_return_max": 230.34000000000057, "episode_return_min": 168.1809999999998, "episode_return_mean": 203.78647000000026, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 323474, "num_agent_steps_trained": 323474, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 126.31426466988749, "num_env_steps_trained_throughput_per_sec": 126.31426466988749, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 323474, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 323474, "timers": {"training_iteration_time_ms": 29414.338, "restore_workers_time_ms": 0.005, "training_step_time_ms": 29414.322, "sample_time_ms": 27536.143, "learn_time_ms": 1877.925, "learn_throughput": 2130.01, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 323474, "num_agent_steps_trained": 323474}, "done": false, "training_iteration": 27, "trial_id": "default", "date": "2025-10-13_02-19-55", "timestamp": 1760336395, "time_this_iter_s": 31.667603969573975, "time_total_s": 718.7686264514923, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 718.7686264514923, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 26.282222222222224, "ram_util_percent": 34.128888888888895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.05, "cur_lr": 0.0003, "total_loss": 3.0557563439492257, "policy_loss": -0.02056375382723467, "vf_loss": 6.389817187863011, "vf_explained_var": 0.05096232583445887, "kl": 0.017760599307991027, "entropy": 11.947652481448266, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.11290322580645, "num_grad_updates_lifetime": 17300.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.3860308352857826, "policy_loss": -0.021362140851852018, "vf_loss": 5.043096925318241, "vf_explained_var": 0.12076050508767366, "kl": 0.01674206621778477, "entropy": 11.499258413910866, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8800.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 335355, "num_agent_steps_trained": 335355}, "env_runners": {"episode_reward_max": 230.34000000000057, "episode_reward_min": 137.3630000000001, "episode_reward_mean": 203.17569000000032, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 21.67999999999999, "hider_policy": 21.603}, "policy_reward_max": {"seeker_policy": 68.68000000000008, "hider_policy": 122.78000000000034}, "policy_reward_mean": {"seeker_policy": 47.52400000000003, "hider_policy": 77.82584500000009}, "custom_metrics": {}, "hist_stats": {"episode_reward": [196.2900000000001, 220.6400000000004, 223.99000000000052, 213.34000000000043, 208.99000000000035, 186.54000000000016, 215.69000000000042, 211.04000000000033, 230.34000000000057, 202.79000000000028, 199.3900000000003, 214.79000000000033, 204.04000000000036, 200.99000000000026, 194.99000000000035, 196.49000000000035, 201.44000000000034, 225.14000000000053, 218.99000000000046, 201.0400000000003, 197.24000000000026, 208.59000000000046, 199.74000000000026, 187.79000000000033, 197.09000000000032, 207.84000000000032, 212.69000000000042, 187.54000000000016, 196.49000000000032, 213.99000000000032, 199.6400000000003, 180.9900000000002, 198.1900000000003, 199.34000000000026, 204.44000000000037, 204.49000000000038, 201.34000000000032, 209.74000000000038, 199.54000000000042, 187.14000000000016, 213.14000000000044, 212.44000000000045, 202.04000000000036, 199.5900000000003, 195.54000000000022, 218.74000000000046, 201.89000000000036, 208.39000000000036, 193.89000000000038, 221.14000000000044, 208.24000000000038, 196.14000000000027, 195.84000000000034, 195.0400000000003, 194.94000000000037, 200.14000000000033, 211.89000000000044, 201.0400000000004, 192.39000000000024, 202.3900000000004, 203.64000000000038, 204.34000000000037, 202.2900000000003, 203.84000000000034, 220.24000000000044, 188.74000000000018, 205.59000000000026, 229.2400000000006, 192.24000000000018, 230.14000000000044, 196.49000000000035, 213.39000000000044, 200.34000000000034, 181.69000000000028, 225.49000000000055, 201.0400000000003, 215.2900000000005, 203.5400000000004, 208.04000000000033, 197.49000000000035, 194.49000000000032, 199.44000000000028, 137.3630000000001, 203.3400000000003, 205.69000000000037, 200.84000000000032, 218.14000000000033, 202.54000000000033, 200.54000000000036, 193.5400000000004, 214.4400000000004, 197.09000000000032, 197.29000000000028, 191.04000000000025, 214.7400000000003, 208.4400000000003, 209.4900000000004, 211.0900000000004, 161.1360000000001, 208.14000000000036], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [54.28000000000008, 31.179999999999918, 29.679999999999957, 37.47999999999996, 43.380000000000024, 63.98000000000007, 37.779999999999994, 43.38000000000002, 21.67999999999999, 49.480000000000025, 54.28000000000003, 40.97999999999998, 48.68000000000004, 47.68000000000003, 58.080000000000034, 55.48000000000007, 50.18000000000005, 28.779999999999955, 36.97999999999999, 49.779999999999994, 54.18000000000004, 42.979999999999976, 52.58000000000005, 67.27999999999997, 56.08000000000007, 44.28000000000002, 38.88, 64.98000000000009, 55.48000000000008, 40.18, 52.480000000000054, 68.68000000000008, 48.980000000000025, 52.18000000000004, 49.08000000000004, 42.97999999999999, 50.08000000000002, 37.98000000000001, 52.38000000000007, 64.58000000000003, 41.37999999999999, 40.68000000000001, 50.78000000000005, 50.38000000000008, 56.580000000000034, 34.679999999999964, 48.58000000000006, 42.780000000000015, 56.98000000000011, 32.979999999999976, 44.68000000000005, 53.080000000000055, 56.880000000000074, 51.98000000000012, 55.980000000000075, 52.980000000000054, 42.18000000000001, 49.78000000000007, 59.58000000000006, 44.980000000000054, 48.28000000000007, 48.980000000000025, 48.98000000000005, 48.48000000000001, 32.07999999999997, 57.98000000000008, 48.18000000000002, 24.67999999999992, 61.48000000000005, 25.580000000000005, 55.48000000000004, 39.58000000000001, 53.18000000000007, 65.28000000000006, 22.979999999999947, 49.78000000000002, 37.380000000000024, 44.08000000000005, 44.48000000000002, 52.380000000000074, 57.580000000000055, 52.28000000000006, 38.080000000000005, 47.98000000000004, 44.18000000000002, 49.58000000000004, 34.07999999999996, 51.280000000000065, 53.38000000000002, 58.6800000000001, 38.580000000000034, 56.08000000000007, 56.28000000000007, 60.28000000000007, 38.88, 44.879999999999995, 43.88000000000004, 41.38000000000002, 43.78000000000008, 44.58000000000002], "policy_hider_policy_reward": [69.33, 72.67999999999998, 96.13000000000018, 93.33, 98.18000000000019, 96.13000000000018, 67.43000000000002, 108.43000000000026, 73.58000000000006, 92.03000000000017, 55.129999999999995, 67.43000000000002, 114.58000000000028, 63.329999999999984, 94.08000000000017, 73.58000000000004, 85.88000000000014, 122.78000000000034, 77.68000000000008, 75.63000000000008, 67.43, 77.68000000000008, 71.53000000000004, 102.28000000000023, 75.63000000000005, 79.73000000000009, 79.7300000000001, 73.58000000000006, 79.73000000000009, 57.17999999999999, 77.68000000000006, 63.33, 77.68000000000008, 73.58000000000006, 75.63000000000004, 120.73000000000033, 85.88000000000011, 96.1300000000002, 69.48000000000003, 81.7800000000001, 69.48000000000003, 73.58000000000004, 79.73000000000009, 85.88000000000014, 79.7300000000001, 67.42999999999999, 59.23, 61.27999999999999, 65.37999999999998, 75.63000000000007, 71.53000000000004, 92.03000000000017, 87.93000000000013, 85.88000000000014, 51.02999999999999, 71.53000000000004, 69.48000000000003, 71.53000000000004, 83.83000000000013, 89.98000000000016, 75.63000000000007, 71.53000000000004, 57.18, 55.13000000000001, 75.63000000000007, 73.58000000000004, 81.78000000000009, 65.38000000000001, 89.98000000000015, 65.38, 79.73000000000009, 81.7800000000001, 77.68000000000006, 73.58000000000006, 87.93000000000015, 83.83000000000011, 73.58000000000006, 73.58000000000004, 55.13000000000001, 67.43000000000002, 65.38, 106.38000000000025, 89.98000000000015, 81.7800000000001, 77.68000000000005, 73.58000000000006, 79.73000000000009, 69.48000000000003, 75.63000000000007, 63.33000000000001, 73.58000000000004, 110.48000000000026, 81.7800000000001, 71.53000000000004, 102.28000000000023, 63.33, 69.48000000000003, 67.43000000000002, 71.53000000000004, 116.63000000000031, 81.7800000000001, 81.7800000000001, 71.53000000000004, 71.53000000000004, 69.48000000000002, 69.48000000000002, 73.58000000000004, 69.48, 69.48, 69.48000000000003, 75.63000000000007, 71.53000000000006, 85.88000000000012, 83.83000000000011, 87.93000000000013, 63.330000000000005, 59.229999999999976, 73.58000000000006, 85.88000000000012, 71.53000000000004, 73.58000000000004, 81.7800000000001, 75.63000000000005, 79.73000000000009, 79.7300000000001, 73.58000000000006, 96.1300000000002, 59.230000000000004, 69.48000000000003, 118.68000000000032, 83.83000000000011, 46.93000000000001, 65.38000000000001, 92.03000000000017, 106.38000000000024, 98.18000000000019, 73.58000000000003, 57.180000000000014, 81.7800000000001, 122.78000000000034, 67.43, 73.58000000000006, 65.38, 108.43000000000026, 69.48000000000005, 77.68000000000006, 61.28, 55.129999999999995, 122.78000000000034, 79.73000000000009, 65.38, 85.88000000000012, 92.03000000000017, 85.88000000000012, 85.88000000000011, 73.58000000000004, 69.48000000000002, 94.08000000000018, 75.63000000000007, 69.48000000000002, 79.73000000000009, 57.179999999999986, 55.12999999999999, 92.03000000000016, 21.603, 77.68000000000006, 79.73000000000008, 75.63000000000008, 75.63000000000005, 85.88000000000012, 71.53000000000003, 79.73000000000009, 73.58000000000006, 110.48000000000027, 85.88000000000012, 65.38000000000001, 83.83000000000011, 63.32999999999999, 59.23, 75.63000000000004, 61.28000000000002, 114.5800000000003, 73.58000000000006, 67.43, 73.58000000000004, 67.43, 69.48000000000003, 61.280000000000015, 77.68000000000008, 98.1800000000002, 77.68000000000008, 85.88000000000014, 94.08000000000017, 71.53000000000004, 92.03000000000016, 77.68000000000006, 43.775999999999996, 73.58000000000004, 81.78000000000009, 81.78000000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1817842009213484, "mean_inference_ms": 0.8110537195399417, "mean_action_processing_ms": 0.1388566051212279, "mean_env_wait_ms": 2.007385706345862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0020842552185058594, "StateBufferConnector_ms": 0.0022237300872802734, "ViewRequirementAgentConnector_ms": 0.05221235752105713}, "num_episodes": 29, "episode_return_max": 230.34000000000057, "episode_return_min": 137.3630000000001, "episode_return_mean": 203.17569000000032, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 335355, "num_agent_steps_trained": 335355, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 127.2071969064263, "num_env_steps_trained_throughput_per_sec": 127.2071969064263, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 335355, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 335355, "timers": {"training_iteration_time_ms": 29369.129, "restore_workers_time_ms": 0.005, "training_step_time_ms": 29369.113, "sample_time_ms": 27481.331, "learn_time_ms": 1887.534, "learn_throughput": 2119.167, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 335355, "num_agent_steps_trained": 335355}, "done": false, "training_iteration": 28, "trial_id": "default", "date": "2025-10-13_02-20-26", "timestamp": 1760336426, "time_this_iter_s": 31.445372104644775, "time_total_s": 750.2139985561371, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 750.2139985561371, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 26.515909090909087, "ram_util_percent": 34.24090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 2.98571400982993, "policy_loss": -0.017684262719315787, "vf_loss": 6.242226810303945, "vf_explained_var": 0.026124963779298085, "kl": 0.017131138872724848, "entropy": 11.857168710799444, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.58730158730158, "num_grad_updates_lifetime": 17925.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.4224592465907335, "policy_loss": -0.022680897073587402, "vf_loss": 5.121032842248678, "vf_explained_var": 0.045781221613287924, "kl": 0.015359086425405715, "entropy": 11.614423659443855, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 347330, "num_agent_steps_trained": 347330}, "env_runners": {"episode_reward_max": 234.94000000000057, "episode_reward_min": 137.3630000000001, "episode_reward_mean": 203.54294000000039, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 18.08000000000002, "hider_policy": 21.603}, "policy_reward_max": {"seeker_policy": 68.68000000000008, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 46.63900000000003, "hider_policy": 78.45197000000009}, "custom_metrics": {}, "hist_stats": {"episode_reward": [199.6400000000003, 180.9900000000002, 198.1900000000003, 199.34000000000026, 204.44000000000037, 204.49000000000038, 201.34000000000032, 209.74000000000038, 199.54000000000042, 187.14000000000016, 213.14000000000044, 212.44000000000045, 202.04000000000036, 199.5900000000003, 195.54000000000022, 218.74000000000046, 201.89000000000036, 208.39000000000036, 193.89000000000038, 221.14000000000044, 208.24000000000038, 196.14000000000027, 195.84000000000034, 195.0400000000003, 194.94000000000037, 200.14000000000033, 211.89000000000044, 201.0400000000004, 192.39000000000024, 202.3900000000004, 203.64000000000038, 204.34000000000037, 202.2900000000003, 203.84000000000034, 220.24000000000044, 188.74000000000018, 205.59000000000026, 229.2400000000006, 192.24000000000018, 230.14000000000044, 196.49000000000035, 213.39000000000044, 200.34000000000034, 181.69000000000028, 225.49000000000055, 201.0400000000003, 215.2900000000005, 203.5400000000004, 208.04000000000033, 197.49000000000035, 194.49000000000032, 199.44000000000028, 137.3630000000001, 203.3400000000003, 205.69000000000037, 200.84000000000032, 218.14000000000033, 202.54000000000033, 200.54000000000036, 193.5400000000004, 214.4400000000004, 197.09000000000032, 197.29000000000028, 191.04000000000025, 214.7400000000003, 208.4400000000003, 209.4900000000004, 211.0900000000004, 161.1360000000001, 208.14000000000036, 210.79000000000036, 230.29000000000048, 197.14000000000024, 207.8400000000005, 205.34000000000032, 192.99000000000024, 216.24000000000038, 211.84000000000046, 222.14000000000055, 205.94000000000042, 203.84000000000037, 221.1900000000006, 204.1900000000003, 208.69000000000042, 192.99000000000032, 209.24000000000038, 204.29000000000033, 200.14000000000036, 195.04000000000033, 234.94000000000057, 203.14000000000027, 203.9400000000003, 221.09000000000052, 204.14000000000027, 178.56500000000017, 210.19000000000034, 207.5900000000004, 208.14000000000047, 206.7900000000003, 193.9900000000003], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [52.480000000000054, 68.68000000000008, 48.980000000000025, 52.18000000000004, 49.08000000000004, 42.97999999999999, 50.08000000000002, 37.98000000000001, 52.38000000000007, 64.58000000000003, 41.37999999999999, 40.68000000000001, 50.78000000000005, 50.38000000000008, 56.580000000000034, 34.679999999999964, 48.58000000000006, 42.780000000000015, 56.98000000000011, 32.979999999999976, 44.68000000000005, 53.080000000000055, 56.880000000000074, 51.98000000000012, 55.980000000000075, 52.980000000000054, 42.18000000000001, 49.78000000000007, 59.58000000000006, 44.980000000000054, 48.28000000000007, 48.980000000000025, 48.98000000000005, 48.48000000000001, 32.07999999999997, 57.98000000000008, 48.18000000000002, 24.67999999999992, 61.48000000000005, 25.580000000000005, 55.48000000000004, 39.58000000000001, 53.18000000000007, 65.28000000000006, 22.979999999999947, 49.78000000000002, 37.380000000000024, 44.08000000000005, 44.48000000000002, 52.380000000000074, 57.580000000000055, 52.28000000000006, 38.080000000000005, 47.98000000000004, 44.18000000000002, 49.58000000000004, 34.07999999999996, 51.280000000000065, 53.38000000000002, 58.6800000000001, 38.580000000000034, 56.08000000000007, 56.28000000000007, 60.28000000000007, 38.88, 44.879999999999995, 43.88000000000004, 41.38000000000002, 43.78000000000008, 44.58000000000002, 41.080000000000034, 23.679999999999968, 49.98000000000002, 44.280000000000065, 45.880000000000024, 60.18000000000005, 36.27999999999996, 40.08000000000009, 29.879999999999953, 46.480000000000054, 48.48000000000007, 30.979999999999926, 46.78000000000005, 38.98000000000003, 60.18000000000008, 41.57999999999999, 46.88000000000005, 52.98000000000007, 56.08000000000007, 18.08000000000002, 47.78000000000002, 48.58000000000001, 30.879999999999963, 48.779999999999994, 47.38000000000006, 40.480000000000025, 46.08000000000004, 44.58, 45.27999999999999, 52.980000000000054], "policy_hider_policy_reward": [75.63000000000007, 71.53000000000004, 57.18, 55.13000000000001, 75.63000000000007, 73.58000000000004, 81.78000000000009, 65.38000000000001, 89.98000000000015, 65.38, 79.73000000000009, 81.7800000000001, 77.68000000000006, 73.58000000000006, 87.93000000000015, 83.83000000000011, 73.58000000000006, 73.58000000000004, 55.13000000000001, 67.43000000000002, 65.38, 106.38000000000025, 89.98000000000015, 81.7800000000001, 77.68000000000005, 73.58000000000006, 79.73000000000009, 69.48000000000003, 75.63000000000007, 63.33000000000001, 73.58000000000004, 110.48000000000026, 81.7800000000001, 71.53000000000004, 102.28000000000023, 63.33, 69.48000000000003, 67.43000000000002, 71.53000000000004, 116.63000000000031, 81.7800000000001, 81.7800000000001, 71.53000000000004, 71.53000000000004, 69.48000000000002, 69.48000000000002, 73.58000000000004, 69.48, 69.48, 69.48000000000003, 75.63000000000007, 71.53000000000006, 85.88000000000012, 83.83000000000011, 87.93000000000013, 63.330000000000005, 59.229999999999976, 73.58000000000006, 85.88000000000012, 71.53000000000004, 73.58000000000004, 81.7800000000001, 75.63000000000005, 79.73000000000009, 79.7300000000001, 73.58000000000006, 96.1300000000002, 59.230000000000004, 69.48000000000003, 118.68000000000032, 83.83000000000011, 46.93000000000001, 65.38000000000001, 92.03000000000017, 106.38000000000024, 98.18000000000019, 73.58000000000003, 57.180000000000014, 81.7800000000001, 122.78000000000034, 67.43, 73.58000000000006, 65.38, 108.43000000000026, 69.48000000000005, 77.68000000000006, 61.28, 55.129999999999995, 122.78000000000034, 79.73000000000009, 65.38, 85.88000000000012, 92.03000000000017, 85.88000000000012, 85.88000000000011, 73.58000000000004, 69.48000000000002, 94.08000000000018, 75.63000000000007, 69.48000000000002, 79.73000000000009, 57.179999999999986, 55.12999999999999, 92.03000000000016, 21.603, 77.68000000000006, 79.73000000000008, 75.63000000000008, 75.63000000000005, 85.88000000000012, 71.53000000000003, 79.73000000000009, 73.58000000000006, 110.48000000000027, 85.88000000000012, 65.38000000000001, 83.83000000000011, 63.32999999999999, 59.23, 75.63000000000004, 61.28000000000002, 114.5800000000003, 73.58000000000006, 67.43, 73.58000000000004, 67.43, 69.48000000000003, 61.280000000000015, 77.68000000000008, 98.1800000000002, 77.68000000000008, 85.88000000000014, 94.08000000000017, 71.53000000000004, 92.03000000000016, 77.68000000000006, 43.775999999999996, 73.58000000000004, 81.78000000000009, 81.78000000000009, 71.53000000000004, 98.18000000000019, 100.23000000000022, 106.38000000000024, 67.43000000000002, 79.73000000000009, 83.8300000000001, 79.73000000000008, 77.68000000000006, 81.7800000000001, 57.18000000000001, 75.63000000000007, 92.03000000000016, 87.93000000000015, 69.48000000000003, 102.28000000000023, 75.63000000000005, 116.63000000000031, 67.43, 92.03000000000017, 61.280000000000015, 94.08000000000017, 85.88000000000014, 104.33000000000023, 83.83000000000011, 73.58000000000006, 83.83000000000011, 85.88000000000012, 71.53000000000003, 61.28000000000001, 83.83000000000011, 83.83000000000013, 75.63000000000007, 81.7800000000001, 69.48000000000003, 77.68000000000008, 71.53000000000003, 67.43000000000002, 94.08000000000017, 122.78000000000034, 75.63000000000005, 79.73000000000009, 81.78000000000009, 73.58000000000004, 124.83000000000035, 65.38000000000001, 77.68000000000008, 77.68000000000006, 79.73000000000008, 51.454999999999984, 81.78000000000011, 87.93000000000015, 71.53000000000003, 89.98000000000016, 85.88000000000012, 77.68000000000006, 83.83000000000013, 77.68000000000006, 71.53000000000004, 69.48000000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.22170851134748, "mean_inference_ms": 0.8113340993211715, "mean_action_processing_ms": 0.13878029555135524, "mean_env_wait_ms": 2.0147546610077516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021184682846069336, "StateBufferConnector_ms": 0.0021327733993530273, "ViewRequirementAgentConnector_ms": 0.05294013023376465}, "num_episodes": 30, "episode_return_max": 234.94000000000057, "episode_return_min": 137.3630000000001, "episode_return_mean": 203.54294000000039, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 347330, "num_agent_steps_trained": 347330, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.21000597838923, "num_env_steps_trained_throughput_per_sec": 125.21000597838923, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 347330, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 347330, "timers": {"training_iteration_time_ms": 29446.677, "restore_workers_time_ms": 0.005, "training_step_time_ms": 29446.661, "sample_time_ms": 27536.22, "learn_time_ms": 1910.194, "learn_throughput": 2094.028, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 347330, "num_agent_steps_trained": 347330}, "done": false, "training_iteration": 29, "trial_id": "default", "date": "2025-10-13_02-20-58", "timestamp": 1760336458, "time_this_iter_s": 31.946949005126953, "time_total_s": 782.160947561264, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 782.160947561264, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 36.85, "ram_util_percent": 34.71739130434783}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00030000000000000003, "total_loss": 2.9242917950191196, "policy_loss": -0.017352775466584022, "vf_loss": 6.117575319986495, "vf_explained_var": 0.11883205270010327, "kl": 0.015832395082716666, "entropy": 11.793473139263334, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 18555.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0003, "total_loss": 2.41338089928031, "policy_loss": -0.021935739445325453, "vf_loss": 5.099781166017055, "vf_explained_var": 0.06869048327207565, "kl": 0.015509929252539315, "entropy": 11.534943756461143, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9440.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 359330, "num_agent_steps_trained": 359330}, "env_runners": {"episode_reward_max": 234.94000000000057, "episode_reward_min": 137.3630000000001, "episode_reward_mean": 206.5759400000004, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 18.08000000000002, "hider_policy": 21.603}, "policy_reward_max": {"seeker_policy": 65.28000000000006, "hider_policy": 124.83000000000035}, "policy_reward_mean": {"seeker_policy": 44.014000000000024, "hider_policy": 81.28097000000011}, "custom_metrics": {}, "hist_stats": {"episode_reward": [202.3900000000004, 203.64000000000038, 204.34000000000037, 202.2900000000003, 203.84000000000034, 220.24000000000044, 188.74000000000018, 205.59000000000026, 229.2400000000006, 192.24000000000018, 230.14000000000044, 196.49000000000035, 213.39000000000044, 200.34000000000034, 181.69000000000028, 225.49000000000055, 201.0400000000003, 215.2900000000005, 203.5400000000004, 208.04000000000033, 197.49000000000035, 194.49000000000032, 199.44000000000028, 137.3630000000001, 203.3400000000003, 205.69000000000037, 200.84000000000032, 218.14000000000033, 202.54000000000033, 200.54000000000036, 193.5400000000004, 214.4400000000004, 197.09000000000032, 197.29000000000028, 191.04000000000025, 214.7400000000003, 208.4400000000003, 209.4900000000004, 211.0900000000004, 161.1360000000001, 208.14000000000036, 210.79000000000036, 230.29000000000048, 197.14000000000024, 207.8400000000005, 205.34000000000032, 192.99000000000024, 216.24000000000038, 211.84000000000046, 222.14000000000055, 205.94000000000042, 203.84000000000037, 221.1900000000006, 204.1900000000003, 208.69000000000042, 192.99000000000032, 209.24000000000038, 204.29000000000033, 200.14000000000036, 195.04000000000033, 234.94000000000057, 203.14000000000027, 203.9400000000003, 221.09000000000052, 204.14000000000027, 178.56500000000017, 210.19000000000034, 207.5900000000004, 208.14000000000047, 206.7900000000003, 193.9900000000003, 197.6400000000003, 206.44000000000034, 194.59000000000026, 213.19000000000045, 209.29000000000033, 200.0900000000003, 208.54000000000036, 230.5400000000005, 207.39000000000027, 200.0400000000003, 213.74000000000035, 218.14000000000047, 199.49000000000035, 220.7400000000004, 227.59000000000057, 209.24000000000038, 200.8900000000003, 207.74000000000044, 231.84000000000057, 228.34000000000054, 208.8400000000004, 211.14000000000047, 225.0400000000005, 227.1900000000005, 193.99000000000024, 203.64000000000038, 217.4900000000005, 203.34000000000037, 234.4400000000006], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [44.980000000000054, 48.28000000000007, 48.980000000000025, 48.98000000000005, 48.48000000000001, 32.07999999999997, 57.98000000000008, 48.18000000000002, 24.67999999999992, 61.48000000000005, 25.580000000000005, 55.48000000000004, 39.58000000000001, 53.18000000000007, 65.28000000000006, 22.979999999999947, 49.78000000000002, 37.380000000000024, 44.08000000000005, 44.48000000000002, 52.380000000000074, 57.580000000000055, 52.28000000000006, 38.080000000000005, 47.98000000000004, 44.18000000000002, 49.58000000000004, 34.07999999999996, 51.280000000000065, 53.38000000000002, 58.6800000000001, 38.580000000000034, 56.08000000000007, 56.28000000000007, 60.28000000000007, 38.88, 44.879999999999995, 43.88000000000004, 41.38000000000002, 43.78000000000008, 44.58000000000002, 41.080000000000034, 23.679999999999968, 49.98000000000002, 44.280000000000065, 45.880000000000024, 60.18000000000005, 36.27999999999996, 40.08000000000009, 29.879999999999953, 46.480000000000054, 48.48000000000007, 30.979999999999926, 46.78000000000005, 38.98000000000003, 60.18000000000008, 41.57999999999999, 46.88000000000005, 52.98000000000007, 56.08000000000007, 18.08000000000002, 47.78000000000002, 48.58000000000001, 30.879999999999963, 48.779999999999994, 47.38000000000006, 40.480000000000025, 46.08000000000004, 44.58, 45.27999999999999, 52.980000000000054, 54.58000000000006, 46.98000000000004, 57.680000000000106, 39.37999999999999, 43.680000000000035, 50.88000000000006, 44.98000000000001, 21.879999999999978, 45.88000000000004, 52.880000000000024, 41.97999999999996, 34.07999999999995, 54.38000000000005, 32.579999999999956, 25.079999999999984, 45.679999999999986, 51.68000000000001, 44.18000000000005, 23.179999999999975, 23.77999999999996, 41.18, 43.48000000000001, 28.67999999999996, 24.679999999999964, 52.980000000000054, 48.28000000000005, 35.47999999999996, 47.98000000000004, 21.679999999999975], "policy_hider_policy_reward": [85.88000000000012, 71.53000000000004, 73.58000000000004, 81.7800000000001, 75.63000000000005, 79.73000000000009, 79.7300000000001, 73.58000000000006, 96.1300000000002, 59.230000000000004, 69.48000000000003, 118.68000000000032, 83.83000000000011, 46.93000000000001, 65.38000000000001, 92.03000000000017, 106.38000000000024, 98.18000000000019, 73.58000000000003, 57.180000000000014, 81.7800000000001, 122.78000000000034, 67.43, 73.58000000000006, 65.38, 108.43000000000026, 69.48000000000005, 77.68000000000006, 61.28, 55.129999999999995, 122.78000000000034, 79.73000000000009, 65.38, 85.88000000000012, 92.03000000000017, 85.88000000000012, 85.88000000000011, 73.58000000000004, 69.48000000000002, 94.08000000000018, 75.63000000000007, 69.48000000000002, 79.73000000000009, 57.179999999999986, 55.12999999999999, 92.03000000000016, 21.603, 77.68000000000006, 79.73000000000008, 75.63000000000008, 75.63000000000005, 85.88000000000012, 71.53000000000003, 79.73000000000009, 73.58000000000006, 110.48000000000027, 85.88000000000012, 65.38000000000001, 83.83000000000011, 63.32999999999999, 59.23, 75.63000000000004, 61.28000000000002, 114.5800000000003, 73.58000000000006, 67.43, 73.58000000000004, 67.43, 69.48000000000003, 61.280000000000015, 77.68000000000008, 98.1800000000002, 77.68000000000008, 85.88000000000014, 94.08000000000017, 71.53000000000004, 92.03000000000016, 77.68000000000006, 43.775999999999996, 73.58000000000004, 81.78000000000009, 81.78000000000009, 71.53000000000004, 98.18000000000019, 100.23000000000022, 106.38000000000024, 67.43000000000002, 79.73000000000009, 83.8300000000001, 79.73000000000008, 77.68000000000006, 81.7800000000001, 57.18000000000001, 75.63000000000007, 92.03000000000016, 87.93000000000015, 69.48000000000003, 102.28000000000023, 75.63000000000005, 116.63000000000031, 67.43, 92.03000000000017, 61.280000000000015, 94.08000000000017, 85.88000000000014, 104.33000000000023, 83.83000000000011, 73.58000000000006, 83.83000000000011, 85.88000000000012, 71.53000000000003, 61.28000000000001, 83.83000000000011, 83.83000000000013, 75.63000000000007, 81.7800000000001, 69.48000000000003, 77.68000000000008, 71.53000000000003, 67.43000000000002, 94.08000000000017, 122.78000000000034, 75.63000000000005, 79.73000000000009, 81.78000000000009, 73.58000000000004, 124.83000000000035, 65.38000000000001, 77.68000000000008, 77.68000000000006, 79.73000000000008, 51.454999999999984, 81.78000000000011, 87.93000000000015, 71.53000000000003, 89.98000000000016, 85.88000000000012, 77.68000000000006, 83.83000000000013, 77.68000000000006, 71.53000000000004, 69.48000000000003, 75.63000000000008, 67.43, 83.83000000000013, 75.63000000000008, 71.53000000000003, 65.37999999999997, 69.48000000000002, 104.33000000000023, 67.43000000000002, 98.1800000000002, 75.63000000000007, 73.58000000000006, 87.93000000000013, 75.63000000000007, 124.83000000000035, 83.8300000000001, 75.63000000000005, 85.88000000000014, 63.32999999999999, 83.83000000000011, 87.93000000000015, 83.83000000000011, 94.08000000000017, 89.98000000000013, 71.53000000000003, 73.58000000000006, 100.2300000000002, 87.93000000000015, 124.83000000000035, 77.68000000000006, 92.03000000000016, 71.53000000000003, 73.58000000000007, 75.63000000000007, 65.38000000000001, 98.1800000000002, 83.83000000000011, 124.83000000000035, 96.1300000000002, 108.43000000000026, 87.93000000000012, 79.73000000000009, 67.43, 100.23000000000019, 114.5800000000003, 81.7800000000001, 77.68000000000006, 124.83000000000035, 69.48000000000003, 71.53000000000004, 79.73000000000009, 75.63000000000005, 100.2300000000002, 81.78000000000009, 77.68000000000008, 77.68000000000006, 124.83000000000035, 87.93000000000013]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.253600718211842, "mean_inference_ms": 0.811479164902133, "mean_action_processing_ms": 0.13866901295696746, "mean_env_wait_ms": 2.0239780101362443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002140522003173828, "StateBufferConnector_ms": 0.0021151304244995117, "ViewRequirementAgentConnector_ms": 0.05188703536987305}, "num_episodes": 29, "episode_return_max": 234.94000000000057, "episode_return_min": 137.3630000000001, "episode_return_mean": 206.5759400000004, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 359330, "num_agent_steps_trained": 359330, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 128.4843719272407, "num_env_steps_trained_throughput_per_sec": 128.4843719272407, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 359330, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 359330, "timers": {"training_iteration_time_ms": 29376.254, "restore_workers_time_ms": 0.006, "training_step_time_ms": 29376.238, "sample_time_ms": 27453.324, "learn_time_ms": 1922.671, "learn_throughput": 2080.439, "synch_weights_time_ms": 0.001}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 359330, "num_agent_steps_trained": 359330}, "done": false, "training_iteration": 30, "trial_id": "default", "date": "2025-10-13_02-21-29", "timestamp": 1760336489, "time_this_iter_s": 31.132800102233887, "time_total_s": 813.2937476634979, "pid": 40564, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0003, "lr_hider": 0.0003, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x325790ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x325790c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0003}], "hider_policy": [null, null, null, {"lr": 0.0003}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 813.2937476634979, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 33.46590909090909, "ram_util_percent": 34.98863636363637}}
