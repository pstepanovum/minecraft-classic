{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49989719163803825, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0001, "total_loss": 1.2397566299589853, "policy_loss": -0.003745956458742656, "vf_loss": 2.506231112707229, "vf_explained_var": 0.06746011849433657, "kl": 0.0015912443365409892, "entropy": 9.931216489701043, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49371094787493347, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.00010000000000000002, "total_loss": 4.082750381156802, "policy_loss": -0.005889377335552126, "vf_loss": 8.196249378472567, "vf_explained_var": -0.047660530917346476, "kl": 0.002415496682501939, "entropy": 9.96804806292057, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": 104.94467351994356, "episode_reward_min": 65.79640371220343, "episode_reward_mean": 79.92204549178113, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 3915, "policy_reward_min": {"seeker_policy": 59.7346837098144, "hider_policy": -22.321415108337828}, "policy_reward_max": {"seeker_policy": 99.51055816969536, "hider_policy": 50.76867351994358}, "policy_reward_mean": {"seeker_policy": 83.72525111828463, "hider_policy": -1.901602813251733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.66559151168693, 81.11556021515845, 94.790488092148, 80.29390054539795, 87.92914765131813, 68.92591554992865, 82.23990658695028, 92.78768827577083, 68.11647271188174, 84.61485826824016, 78.64107813671858, 104.94467351994356, 65.79640371220343, 68.0857194298627, 85.60104913715578, 80.49246636015268, 83.68047200138824, 76.44859225556743, 87.10231181676154, 76.05950872176753, 81.46679840710937, 75.0308269721243, 83.44062832451158, 75.52756722158291, 77.54635230875927, 68.82266399509525, 73.88287413842981, 77.57580248770188, 73.11400090633553], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [81.3395193513776, 87.93995290494317, 65.23376617960098, 86.55336771854361, 81.40434513855665, 91.49440095363464, 76.02421176859342, 59.7346837098144, 87.52635741593556, 92.62959732703965, 97.67195642334734, 68.4237433914995, 99.15370743599468, 90.56447153525794, 68.18214662150623, 99.51055816969536, 91.57076794056707, 92.34231742386359, 76.63666543431769, 71.94685883217772, 82.84710633950995, 95.72995470045392, 73.2230806594725, 88.4251806472538, 80.93462084284448, 80.65590966896062, 80.14712483121895, 94.42014142276852, 85.76576764150407], "policy_hider_policy_reward": [4.509591511686899, -2.1835193513775555, 0.6495602151584405, -7.473952904943176, -10.777766179600995, 40.33448809214793, -5.580013510473577, -0.6794536626720777, 18.133147651318154, -11.608345138556652, -8.098813769007759, -14.46967163469816, 1.3959531694111897, 4.819741648945667, -1.2386837098143935, 34.291688275770845, -14.336741016384803, -5.073143687668969, 13.508858268240148, -21.523597327039656, -16.359356979014617, -2.6715213076141464, -14.247743391499476, 50.76867351994358, -14.271353231780484, -19.085950492010713, -16.16437740912057, -6.314374696274633, -4.766146621506195, 22.1850491371558, -10.154558169695303, -8.863533639847295, -18.254767940567028, 10.364472001388236, -6.397407744432577, -9.496317423863594, 24.936311816761542, -14.47066543431771, 8.07079794335998, -3.958148053770141, -7.721106339509957, 6.340798407109327, 1.6222873800082045, -22.321415108337828, 3.132333402356362, 7.085214262682843, -10.04918064725383, -2.848432778416955, -3.8524967519617275, 0.4642282178765315, -2.5442782921095692, -9.288967381755802, -4.141124831218978, -2.123125861570169, -1.4601975122980708, -15.384141422768499, -5.3508907926632245, -7.3008759425053125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0829181022806125, "mean_inference_ms": 0.8313506283005663, "mean_action_processing_ms": 0.13221594370236783, "mean_env_wait_ms": 1.7572930085006524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002338146341258082, "StateBufferConnector_ms": 0.002214415320034685, "ViewRequirementAgentConnector_ms": 0.057647557094179354}, "num_episodes": 29, "episode_return_max": 104.94467351994356, "episode_return_min": 65.79640371220343, "episode_return_mean": 79.92204549178113, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.4183132750647, "num_env_steps_trained_throughput_per_sec": 233.4183132750647, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 17136.627, "restore_workers_time_ms": 0.011, "training_step_time_ms": 17136.591, "sample_time_ms": 15267.112, "learn_time_ms": 1869.152, "learn_throughput": 2140.008, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 1, "trial_id": "default", "date": "2025-10-13_04-39-45", "timestamp": 1760344785, "time_this_iter_s": 17.13696002960205, "time_total_s": 17.13696002960205, "pid": 49179, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x177984c20>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x177984d60>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.13696002960205, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 28.320000000000004, "ram_util_percent": 35.42}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000002, "total_loss": 1.3400176537613715, "policy_loss": -0.00618263786853922, "vf_loss": 2.7115435840622073, "vf_explained_var": 0.17516619486193502, "kl": 0.0031466853595097494, "entropy": 9.886163683860532, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.95161290322581, "num_grad_updates_lifetime": 940.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.197343987971544, "policy_loss": -0.00510981054540025, "vf_loss": 6.424488317966461, "vf_explained_var": 0.012858799286186695, "kl": 0.0019903336035050367, "entropy": 9.989392080903054, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 23871, "num_agent_steps_trained": 23871}, "env_runners": {"episode_reward_max": 104.94467351994356, "episode_reward_min": 55.284844902889944, "episode_reward_mean": 79.2764982060632, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 7965, "policy_reward_min": {"seeker_policy": 52.21470646894309, "hider_policy": -24.15725481499558}, "policy_reward_max": {"seeker_policy": 110.50325481499556, "hider_policy": 50.76867351994358}, "policy_reward_mean": {"seeker_policy": 82.21987933929951, "hider_policy": -1.4716905666181417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.66559151168693, 81.11556021515845, 94.790488092148, 80.29390054539795, 87.92914765131813, 68.92591554992865, 82.23990658695028, 92.78768827577083, 68.11647271188174, 84.61485826824016, 78.64107813671858, 104.94467351994356, 65.79640371220343, 68.0857194298627, 85.60104913715578, 80.49246636015268, 83.68047200138824, 76.44859225556743, 87.10231181676154, 76.05950872176753, 81.46679840710937, 75.0308269721243, 83.44062832451158, 75.52756722158291, 77.54635230875927, 68.82266399509525, 73.88287413842981, 77.57580248770188, 73.11400090633553, 99.2036206605375, 77.14906759433039, 72.2106054381821, 82.30141462955989, 71.94122175635498, 87.90696044162367, 73.1935400430007, 88.51765308227395, 65.3499618478764, 73.39684105678995, 83.73411109296916, 68.45447947292763, 84.39736189071262, 76.55822240879971, 97.07293799453493, 65.41744482696502, 84.9338667904544, 97.18796002346342, 77.30289786335463, 55.284844902889944, 85.96709553984769, 77.64465108342341, 61.88612647252587, 77.69514018956515, 70.85605342929667, 86.23667336485323, 79.3004767159907, 76.48198763766894, 79.7119548987671, 82.27890174653687], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [81.3395193513776, 87.93995290494317, 65.23376617960098, 86.55336771854361, 81.40434513855665, 91.49440095363464, 76.02421176859342, 59.7346837098144, 87.52635741593556, 92.62959732703965, 97.67195642334734, 68.4237433914995, 99.15370743599468, 90.56447153525794, 68.18214662150623, 99.51055816969536, 91.57076794056707, 92.34231742386359, 76.63666543431769, 71.94685883217772, 82.84710633950995, 95.72995470045392, 73.2230806594725, 88.4251806472538, 80.93462084284448, 80.65590966896062, 80.14712483121895, 94.42014142276852, 85.76576764150407, 55.00578875355149, 93.67836576579667, 86.91239726154835, 110.50325481499556, 89.98922156026374, 52.21470646894309, 81.98865863729212, 63.20851360929028, 93.31797061169843, 91.26819398085709, 91.40342139026657, 89.45840920190405, 58.19769475217284, 101.564232710692, 54.76421454962267, 88.04218370042473, 70.4164646841015, 57.89232893535197, 84.98720528795934, 75.1255151203399, 57.37261410665763, 82.64984876894358, 93.92966935579685, 93.02591872748398, 90.82323389380207, 75.3968941264452, 91.59328566952453, 86.99888732650398, 81.13210076799271, 80.07940404819402], "policy_hider_policy_reward": [4.509591511686899, -2.1835193513775555, 0.6495602151584405, -7.473952904943176, -10.777766179600995, 40.33448809214793, -5.580013510473577, -0.6794536626720777, 18.133147651318154, -11.608345138556652, -8.098813769007759, -14.46967163469816, 1.3959531694111897, 4.819741648945667, -1.2386837098143935, 34.291688275770845, -14.336741016384803, -5.073143687668969, 13.508858268240148, -21.523597327039656, -16.359356979014617, -2.6715213076141464, -14.247743391499476, 50.76867351994358, -14.271353231780484, -19.085950492010713, -16.16437740912057, -6.314374696274633, -4.766146621506195, 22.1850491371558, -10.154558169695303, -8.863533639847295, -18.254767940567028, 10.364472001388236, -6.397407744432577, -9.496317423863594, 24.936311816761542, -14.47066543431771, 8.07079794335998, -3.958148053770141, -7.721106339509957, 6.340798407109327, 1.6222873800082045, -22.321415108337828, 3.132333402356362, 7.085214262682843, -10.04918064725383, -2.848432778416955, -3.8524967519617275, 0.4642282178765315, -2.5442782921095692, -9.288967381755802, -4.141124831218978, -2.123125861570169, -1.4601975122980708, -15.384141422768499, -5.3508907926632245, -7.3008759425053125, -0.9397887535514984, 45.13762066053748, -9.227077169126334, -7.302221002339942, -9.889850531808094, -4.811941291558157, -4.044585370440107, -24.15725481499558, -8.33301749376493, -9.714982310143832, 7.931293531056925, 27.760960441623716, 3.0006017784949424, -11.795720372786345, -0.5425136092903017, 25.851653082273987, -16.763174765257958, -11.204833998564093, -8.018546540338587, -9.852806383728561, -9.877421390266568, 2.2081110929691614, -9.843826987607075, -11.160102741369409, 8.546383730070149, 17.65328340846962, -19.998232710691976, -5.007777591200304, -0.2982145496226605, 42.606937994534924, -10.850209950312955, -11.77452892314676, 15.775506311304843, -1.2581042049519493, -3.766328935351965, 43.06196002346343, -5.581205287959379, -2.103102136645323, -3.1259578010789464, -16.714712416370997, 31.375240377119678, -2.7807589439296136, 0.33904103444993106, -5.34423871997008, -12.990573030884358, -19.05296985238657, 1.7691401895651957, -17.099918727483953, -8.499946570703369, -11.467233893802124, 22.100673364853275, -11.260894126445185, 2.2544767159907457, -14.547285669524543, -2.994012362331049, -7.5228873265040015, -9.02610076799271, 7.605954898767075, -4.093404048194048, 6.292901746536892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0898173830048346, "mean_inference_ms": 0.8309766044445133, "mean_action_processing_ms": 0.13226698345536236, "mean_env_wait_ms": 1.7643912862801483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002380346847792803, "StateBufferConnector_ms": 0.002250630976790089, "ViewRequirementAgentConnector_ms": 0.05856004811949649}, "num_episodes": 30, "episode_return_max": 104.94467351994356, "episode_return_min": 55.284844902889944, "episode_return_mean": 79.2764982060632, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23871, "num_agent_steps_trained": 23871, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 228.31732866748376, "num_env_steps_trained_throughput_per_sec": 228.31732866748376, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 23871, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 23871, "timers": {"training_iteration_time_ms": 17328.054, "restore_workers_time_ms": 0.009, "training_step_time_ms": 17328.025, "sample_time_ms": 15373.255, "learn_time_ms": 1954.5, "learn_throughput": 2046.559, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 23871, "num_agent_steps_trained": 23871}, "done": false, "training_iteration": 2, "trial_id": "default", "date": "2025-10-13_04-40-03", "timestamp": 1760344803, "time_this_iter_s": 17.519869804382324, "time_total_s": 34.656829833984375, "pid": 49179, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x177984c20>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x177984d60>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.656829833984375, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 33.227999999999994, "ram_util_percent": 35.559999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 1.5620475424660576, "policy_loss": -0.005837000296672895, "vf_loss": 3.1552879636249846, "vf_explained_var": 0.32285182617959524, "kl": 0.002950108912322839, "entropy": 9.906942208607992, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 1565.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00010000000000000002, "total_loss": 3.1917597062885763, "policy_loss": -0.003464427673316095, "vf_loss": 6.410312254726887, "vf_explained_var": 0.007374952547252178, "kl": 0.0024210171507554066, "entropy": 10.053046029806136, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 800.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 35871, "num_agent_steps_trained": 35871}, "env_runners": {"episode_reward_max": 111.71555837572836, "episode_reward_min": 55.284844902889944, "episode_reward_mean": 80.05428737197417, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 11880, "policy_reward_min": {"seeker_policy": 13.758244545617153, "hider_policy": -24.15725481499558}, "policy_reward_max": {"seeker_policy": 110.50325481499556, "hider_policy": 55.21955837572833}, "policy_reward_mean": {"seeker_policy": 80.79980915083249, "hider_policy": -0.37276088942915453}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.66559151168693, 81.11556021515845, 94.790488092148, 80.29390054539795, 87.92914765131813, 68.92591554992865, 82.23990658695028, 92.78768827577083, 68.11647271188174, 84.61485826824016, 78.64107813671858, 104.94467351994356, 65.79640371220343, 68.0857194298627, 85.60104913715578, 80.49246636015268, 83.68047200138824, 76.44859225556743, 87.10231181676154, 76.05950872176753, 81.46679840710937, 75.0308269721243, 83.44062832451158, 75.52756722158291, 77.54635230875927, 68.82266399509525, 73.88287413842981, 77.57580248770188, 73.11400090633553, 99.2036206605375, 77.14906759433039, 72.2106054381821, 82.30141462955989, 71.94122175635498, 87.90696044162367, 73.1935400430007, 88.51765308227395, 65.3499618478764, 73.39684105678995, 83.73411109296916, 68.45447947292763, 84.39736189071262, 76.55822240879971, 97.07293799453493, 65.41744482696502, 84.9338667904544, 97.18796002346342, 77.30289786335463, 55.284844902889944, 85.96709553984769, 77.64465108342341, 61.88612647252587, 77.69514018956515, 70.85605342929667, 86.23667336485323, 79.3004767159907, 76.48198763766894, 79.7119548987671, 82.27890174653687, 86.44845512554897, 70.7826343013968, 87.85723562148556, 86.8154751430642, 72.48707377571397, 75.95531500776903, 76.10002772924797, 89.04583343219151, 76.50797781887054, 80.94954472712513, 74.0473217496567, 87.54211336396992, 104.85416957771983, 64.65153450597136, 73.14656826522422, 74.66129730450074, 85.72757957284931, 74.2837602595877, 66.70289131636659, 78.96908192764894, 88.19331508951376, 90.21271433317192, 68.66363392010884, 95.57359190682251, 86.27754427582768, 79.4003794129298, 78.90211192607666, 80.98915480990922, 111.71555837572836], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [81.3395193513776, 87.93995290494317, 65.23376617960098, 86.55336771854361, 81.40434513855665, 91.49440095363464, 76.02421176859342, 59.7346837098144, 87.52635741593556, 92.62959732703965, 97.67195642334734, 68.4237433914995, 99.15370743599468, 90.56447153525794, 68.18214662150623, 99.51055816969536, 91.57076794056707, 92.34231742386359, 76.63666543431769, 71.94685883217772, 82.84710633950995, 95.72995470045392, 73.2230806594725, 88.4251806472538, 80.93462084284448, 80.65590966896062, 80.14712483121895, 94.42014142276852, 85.76576764150407, 55.00578875355149, 93.67836576579667, 86.91239726154835, 110.50325481499556, 89.98922156026374, 52.21470646894309, 81.98865863729212, 63.20851360929028, 93.31797061169843, 91.26819398085709, 91.40342139026657, 89.45840920190405, 58.19769475217284, 101.564232710692, 54.76421454962267, 88.04218370042473, 70.4164646841015, 57.89232893535197, 84.98720528795934, 75.1255151203399, 57.37261410665763, 82.64984876894358, 93.92966935579685, 93.02591872748398, 90.82323389380207, 75.3968941264452, 91.59328566952453, 86.99888732650398, 81.13210076799271, 80.07940404819402, 83.7285730800121, 88.98457682575689, 74.40474619108403, 73.25116408374564, 90.94903247940705, 95.03617335251658, 83.05484283076646, 37.84099939228463, 86.97960556753651, 80.48456876394745, 70.70578441312789, 77.31920618146533, 59.61624035615258, 90.9276334142074, 95.60952298022397, 89.50473033388336, 63.42526993544965, 95.05741951598286, 95.38874386006783, 99.18865636020188, 59.92892088903055, 73.78727790830035, 87.7213813493132, 55.67941805789132, 64.82768812977116, 78.66746000154775, 103.91991314281175, 89.66253031248503, 13.758244545617153], "policy_hider_policy_reward": [4.509591511686899, -2.1835193513775555, 0.6495602151584405, -7.473952904943176, -10.777766179600995, 40.33448809214793, -5.580013510473577, -0.6794536626720777, 18.133147651318154, -11.608345138556652, -8.098813769007759, -14.46967163469816, 1.3959531694111897, 4.819741648945667, -1.2386837098143935, 34.291688275770845, -14.336741016384803, -5.073143687668969, 13.508858268240148, -21.523597327039656, -16.359356979014617, -2.6715213076141464, -14.247743391499476, 50.76867351994358, -14.271353231780484, -19.085950492010713, -16.16437740912057, -6.314374696274633, -4.766146621506195, 22.1850491371558, -10.154558169695303, -8.863533639847295, -18.254767940567028, 10.364472001388236, -6.397407744432577, -9.496317423863594, 24.936311816761542, -14.47066543431771, 8.07079794335998, -3.958148053770141, -7.721106339509957, 6.340798407109327, 1.6222873800082045, -22.321415108337828, 3.132333402356362, 7.085214262682843, -10.04918064725383, -2.848432778416955, -3.8524967519617275, 0.4642282178765315, -2.5442782921095692, -9.288967381755802, -4.141124831218978, -2.123125861570169, -1.4601975122980708, -15.384141422768499, -5.3508907926632245, -7.3008759425053125, -0.9397887535514984, 45.13762066053748, -9.227077169126334, -7.302221002339942, -9.889850531808094, -4.811941291558157, -4.044585370440107, -24.15725481499558, -8.33301749376493, -9.714982310143832, 7.931293531056925, 27.760960441623716, 3.0006017784949424, -11.795720372786345, -0.5425136092903017, 25.851653082273987, -16.763174765257958, -11.204833998564093, -8.018546540338587, -9.852806383728561, -9.877421390266568, 2.2081110929691614, -9.843826987607075, -11.160102741369409, 8.546383730070149, 17.65328340846962, -19.998232710691976, -5.007777591200304, -0.2982145496226605, 42.606937994534924, -10.850209950312955, -11.77452892314676, 15.775506311304843, -1.2581042049519493, -3.766328935351965, 43.06196002346343, -5.581205287959379, -2.103102136645323, -3.1259578010789464, -16.714712416370997, 31.375240377119678, -2.7807589439296136, 0.33904103444993106, -5.34423871997008, -12.990573030884358, -19.05296985238657, 1.7691401895651957, -17.099918727483953, -8.499946570703369, -11.467233893802124, 22.100673364853275, -11.260894126445185, 2.2544767159907457, -14.547285669524543, -2.994012362331049, -7.5228873265040015, -9.02610076799271, 7.605954898767075, -4.093404048194048, 6.292901746536892, -16.432573080012123, 19.152455125548972, -9.784736883369119, -8.417205640990987, -19.578746191084072, 33.03123562148552, -7.335164083745624, 20.899475143064247, -4.617590102858126, -13.844368600834963, -11.950173352516645, -7.130684992230912, -0.11104727598098059, -6.843767825537497, 16.24181586136866, 34.963018178538185, -3.8580221811295017, -6.6136055675364505, 8.643544727125073, -8.178568763947426, 8.554696324163864, -5.213158987635041, -8.273206181465314, 18.49611336396996, 50.528169577719936, -5.290240356152589, -13.121679913948268, -13.15441899428774, -6.9843611284296205, -15.478593586570186, -1.3647026954992894, -13.478730333883343, 9.058367662662945, 13.24394197473663, 0.21776025958769119, -20.991419515982845, -8.623108683633335, -20.062743860067858, -22.78265636020188, 2.56308192764897, -3.6829208890305525, 31.94731508951379, 20.386714333172005, -3.9612779083003895, -11.510666597233293, -7.547080831971129, 35.79759190682254, 4.096581942108691, 16.645196511501535, 4.804659634555008, -6.291330864927601, 7.024250276309676, -21.993913142811717, -3.0238880739233487, 1.7831548099093013, -10.456530312485036, 42.73775545438283, 55.21955837572833]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2802216391953918, "mean_inference_ms": 0.825950056026248, "mean_action_processing_ms": 0.13285081273310045, "mean_env_wait_ms": 1.7853994718689172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002310221845453436, "StateBufferConnector_ms": 0.00219074162569913, "ViewRequirementAgentConnector_ms": 0.0559522347016768}, "num_episodes": 29, "episode_return_max": 111.71555837572836, "episode_return_min": 55.284844902889944, "episode_return_mean": 80.05428737197417, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35871, "num_agent_steps_trained": 35871, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.44416676965542, "num_env_steps_trained_throughput_per_sec": 162.44416676965542, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 35871, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 35871, "timers": {"training_iteration_time_ms": 19759.987, "restore_workers_time_ms": 0.009, "training_step_time_ms": 19759.96, "sample_time_ms": 17830.487, "learn_time_ms": 1929.232, "learn_throughput": 2073.364, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 35871, "num_agent_steps_trained": 35871}, "done": false, "training_iteration": 3, "trial_id": "default", "date": "2025-10-13_04-40-27", "timestamp": 1760344827, "time_this_iter_s": 24.624284029006958, "time_total_s": 59.28111386299133, "pid": 49179, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x177984c20>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x177984d60>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 59.28111386299133, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 27.779999999999998, "ram_util_percent": 35.42285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000002, "total_loss": 1.4367974973494007, "policy_loss": -0.00445578440745932, "vf_loss": 2.9021392460792295, "vf_explained_var": 0.3489002405635772, "kl": 0.002984917132002085, "entropy": 9.89095698018228, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.90322580645162, "num_grad_updates_lifetime": 2190.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.00010000000000000002, "total_loss": 3.147048255801201, "policy_loss": -0.005174941547738854, "vf_loss": 6.324522435665131, "vf_explained_var": 0.019808934628963472, "kl": 0.0036865964347004704, "entropy": 10.13017888367176, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1120.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 47801, "num_agent_steps_trained": 47801}, "env_runners": {"episode_reward_max": 111.71555837572836, "episode_reward_min": 55.284844902889944, "episode_reward_mean": 79.34334044097358, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 13.758244545617153, "hider_policy": -24.289911940319456}, "policy_reward_max": {"seeker_policy": 110.50325481499556, "hider_policy": 55.21955837572833}, "policy_reward_mean": {"seeker_policy": 79.79630575779959, "hider_policy": -0.22648265841300513}, "custom_metrics": {}, "hist_stats": {"episode_reward": [87.10231181676154, 76.05950872176753, 81.46679840710937, 75.0308269721243, 83.44062832451158, 75.52756722158291, 77.54635230875927, 68.82266399509525, 73.88287413842981, 77.57580248770188, 73.11400090633553, 99.2036206605375, 77.14906759433039, 72.2106054381821, 82.30141462955989, 71.94122175635498, 87.90696044162367, 73.1935400430007, 88.51765308227395, 65.3499618478764, 73.39684105678995, 83.73411109296916, 68.45447947292763, 84.39736189071262, 76.55822240879971, 97.07293799453493, 65.41744482696502, 84.9338667904544, 97.18796002346342, 77.30289786335463, 55.284844902889944, 85.96709553984769, 77.64465108342341, 61.88612647252587, 77.69514018956515, 70.85605342929667, 86.23667336485323, 79.3004767159907, 76.48198763766894, 79.7119548987671, 82.27890174653687, 86.44845512554897, 70.7826343013968, 87.85723562148556, 86.8154751430642, 72.48707377571397, 75.95531500776903, 76.10002772924797, 89.04583343219151, 76.50797781887054, 80.94954472712513, 74.0473217496567, 87.54211336396992, 104.85416957771983, 64.65153450597136, 73.14656826522422, 74.66129730450074, 85.72757957284931, 74.2837602595877, 66.70289131636659, 78.96908192764894, 88.19331508951376, 90.21271433317192, 68.66363392010884, 95.57359190682251, 86.27754427582768, 79.4003794129298, 78.90211192607666, 80.98915480990922, 111.71555837572836, 96.82787146456486, 70.54878468694908, 76.58191080196177, 69.96684689595567, 82.31429720144904, 86.67908620315039, 82.74864579245633, 71.81800153686936, 87.37226352618102, 78.7927005330844, 88.14285975976097, 63.8246704753413, 74.75925701636602, 70.77988587595006, 93.39478996408702, 84.41602396629024, 82.13154431164432, 85.43369430409737, 87.86458084990488, 69.57628467943414, 75.65372477258413, 80.19657032682606, 68.23065505927678, 74.1854563063836, 99.20822918899121, 74.0770519306569, 69.99845054158254, 72.86253725955692, 67.72501610105711, 71.61504799269018], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [76.63666543431769, 71.94685883217772, 82.84710633950995, 95.72995470045392, 73.2230806594725, 88.4251806472538, 80.93462084284448, 80.65590966896062, 80.14712483121895, 94.42014142276852, 85.76576764150407, 55.00578875355149, 93.67836576579667, 86.91239726154835, 110.50325481499556, 89.98922156026374, 52.21470646894309, 81.98865863729212, 63.20851360929028, 93.31797061169843, 91.26819398085709, 91.40342139026657, 89.45840920190405, 58.19769475217284, 101.564232710692, 54.76421454962267, 88.04218370042473, 70.4164646841015, 57.89232893535197, 84.98720528795934, 75.1255151203399, 57.37261410665763, 82.64984876894358, 93.92966935579685, 93.02591872748398, 90.82323389380207, 75.3968941264452, 91.59328566952453, 86.99888732650398, 81.13210076799271, 80.07940404819402, 83.7285730800121, 88.98457682575689, 74.40474619108403, 73.25116408374564, 90.94903247940705, 95.03617335251658, 83.05484283076646, 37.84099939228463, 86.97960556753651, 80.48456876394745, 70.70578441312789, 77.31920618146533, 59.61624035615258, 90.9276334142074, 95.60952298022397, 89.50473033388336, 63.42526993544965, 95.05741951598286, 95.38874386006783, 99.18865636020188, 59.92892088903055, 73.78727790830035, 87.7213813493132, 55.67941805789132, 64.82768812977116, 78.66746000154775, 103.91991314281175, 89.66253031248503, 13.758244545617153, 62.389587890015015, 92.78174324071841, 43.82440935408735, 94.18513706577882, 79.44726787719766, 53.24152424123921, 84.66530021462746, 87.26923321688238, 72.95469143123016, 98.95607699985584, 57.58693341652323, 75.46556514769381, 87.14731499178146, 91.38788006708012, 72.14223767512989, 72.53340290682041, 90.95283734455738, 92.44485852862383, 70.76096903672988, 89.29535131934499, 75.25814502759702, 72.13708590336574, 92.07658239626662, 91.79977083512883, 14.988650864579277, 106.88591194031942, 94.60454235814652, 81.65366975010537, 90.87087296558963, 96.83968790945514], "policy_hider_policy_reward": [24.936311816761542, -14.47066543431771, 8.07079794335998, -3.958148053770141, -7.721106339509957, 6.340798407109327, 1.6222873800082045, -22.321415108337828, 3.132333402356362, 7.085214262682843, -10.04918064725383, -2.848432778416955, -3.8524967519617275, 0.4642282178765315, -2.5442782921095692, -9.288967381755802, -4.141124831218978, -2.123125861570169, -1.4601975122980708, -15.384141422768499, -5.3508907926632245, -7.3008759425053125, -0.9397887535514984, 45.13762066053748, -9.227077169126334, -7.302221002339942, -9.889850531808094, -4.811941291558157, -4.044585370440107, -24.15725481499558, -8.33301749376493, -9.714982310143832, 7.931293531056925, 27.760960441623716, 3.0006017784949424, -11.795720372786345, -0.5425136092903017, 25.851653082273987, -16.763174765257958, -11.204833998564093, -8.018546540338587, -9.852806383728561, -9.877421390266568, 2.2081110929691614, -9.843826987607075, -11.160102741369409, 8.546383730070149, 17.65328340846962, -19.998232710691976, -5.007777591200304, -0.2982145496226605, 42.606937994534924, -10.850209950312955, -11.77452892314676, 15.775506311304843, -1.2581042049519493, -3.766328935351965, 43.06196002346343, -5.581205287959379, -2.103102136645323, -3.1259578010789464, -16.714712416370997, 31.375240377119678, -2.7807589439296136, 0.33904103444993106, -5.34423871997008, -12.990573030884358, -19.05296985238657, 1.7691401895651957, -17.099918727483953, -8.499946570703369, -11.467233893802124, 22.100673364853275, -11.260894126445185, 2.2544767159907457, -14.547285669524543, -2.994012362331049, -7.5228873265040015, -9.02610076799271, 7.605954898767075, -4.093404048194048, 6.292901746536892, -16.432573080012123, 19.152455125548972, -9.784736883369119, -8.417205640990987, -19.578746191084072, 33.03123562148552, -7.335164083745624, 20.899475143064247, -4.617590102858126, -13.844368600834963, -11.950173352516645, -7.130684992230912, -0.11104727598098059, -6.843767825537497, 16.24181586136866, 34.963018178538185, -3.8580221811295017, -6.6136055675364505, 8.643544727125073, -8.178568763947426, 8.554696324163864, -5.213158987635041, -8.273206181465314, 18.49611336396996, 50.528169577719936, -5.290240356152589, -13.121679913948268, -13.15441899428774, -6.9843611284296205, -15.478593586570186, -1.3647026954992894, -13.478730333883343, 9.058367662662945, 13.24394197473663, 0.21776025958769119, -20.991419515982845, -8.623108683633335, -20.062743860067858, -22.78265636020188, 2.56308192764897, -3.6829208890305525, 31.94731508951379, 20.386714333172005, -3.9612779083003895, -11.510666597233293, -7.547080831971129, 35.79759190682254, 4.096581942108691, 16.645196511501535, 4.804659634555008, -6.291330864927601, 7.024250276309676, -21.993913142811717, -3.0238880739233487, 1.7831548099093013, -10.456530312485036, 42.73775545438283, 55.21955837572833, 41.8018714645648, -7.363587890015031, -7.679143752208386, -14.553814801561016, 23.03591080196189, 9.721590645912626, -13.06389411526905, -11.15439605455409, 6.104651946767244, -3.237622622515896, 20.763086203150333, 12.674475758760783, -16.879300214627463, 14.962645792456334, -6.87323321688236, -8.5779984631307, 17.927484222197073, -3.509912127246219, -11.28560618129892, -8.877770285472486, 17.18578502973879, 13.37014131349897, -4.0521418303170345, -7.588752842035473, -5.561895290517367, -6.82616268489806, -12.74893848263858, -7.859055708491511, -10.396237675129857, 31.64878996408695, 12.031128135963293, -0.14850707649341588, -14.056837344557362, 5.235544311644309, -22.038858528623738, 15.027694304097329, 25.608580849904804, -8.504969036729873, -7.823445939047352, -11.895620700863473, 8.153427252662885, -7.75784750767574, -0.1710859033657955, 8.230570326826046, -17.776851557713837, -6.069075779276018, -13.230960217905395, -4.383354310839853, 43.690705458631356, 40.52887286578048, -8.518948069343027, -24.289911940319456, -17.725060650326373, -6.88103116623766, 3.076537259556957, -11.86766975010536, -15.26092296432848, -7.884933900203995, -6.346366359549028, -18.87827355721592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.432068540279949, "mean_inference_ms": 0.8241041695630033, "mean_action_processing_ms": 0.13383234359858417, "mean_env_wait_ms": 1.8076203437961016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023403167724609375, "StateBufferConnector_ms": 0.0021969079971313477, "ViewRequirementAgentConnector_ms": 0.05599832534790039}, "num_episodes": 30, "episode_return_max": 111.71555837572836, "episode_return_min": 55.284844902889944, "episode_return_mean": 79.34334044097358, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47801, "num_agent_steps_trained": 47801, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 198.7851642275246, "num_env_steps_trained_throughput_per_sec": 198.7851642275246, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 47801, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 47801, "timers": {"training_iteration_time_ms": 19850.548, "restore_workers_time_ms": 0.008, "training_step_time_ms": 19850.522, "sample_time_ms": 17926.957, "learn_time_ms": 1923.323, "learn_throughput": 2079.734, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 47801, "num_agent_steps_trained": 47801}, "done": false, "training_iteration": 4, "trial_id": "default", "date": "2025-10-13_04-40-48", "timestamp": 1760344848, "time_this_iter_s": 20.122747898101807, "time_total_s": 79.40386176109314, "pid": 49179, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x177984c20>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x177984d60>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 79.40386176109314, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 33.84285714285714, "ram_util_percent": 35.55357142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 0.0001, "total_loss": 1.7373094462213061, "policy_loss": -0.009251294689371236, "vf_loss": 3.512816998693678, "vf_explained_var": 0.5587126227598341, "kl": 0.00381049122632841, "entropy": 9.89538839431036, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.15873015873017, "num_grad_updates_lifetime": 2815.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.3464150838553905, "policy_loss": -0.005769521846377757, "vf_loss": 6.7246172115206715, "vf_explained_var": 0.05937655158340931, "kl": 0.004070661454332489, "entropy": 10.174872824549675, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 59749, "num_agent_steps_trained": 59749}, "env_runners": {"episode_reward_max": 111.71555837572836, "episode_reward_min": 55.284844902889944, "episode_reward_mean": 79.99982938437482, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 9.884623598238433, "hider_policy": -24.289911940319456}, "policy_reward_max": {"seeker_policy": 106.88591194031942, "hider_policy": 55.21955837572833}, "policy_reward_mean": {"seeker_policy": 78.55427496757979, "hider_policy": 0.7227772083975177}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.284844902889944, 85.96709553984769, 77.64465108342341, 61.88612647252587, 77.69514018956515, 70.85605342929667, 86.23667336485323, 79.3004767159907, 76.48198763766894, 79.7119548987671, 82.27890174653687, 86.44845512554897, 70.7826343013968, 87.85723562148556, 86.8154751430642, 72.48707377571397, 75.95531500776903, 76.10002772924797, 89.04583343219151, 76.50797781887054, 80.94954472712513, 74.0473217496567, 87.54211336396992, 104.85416957771983, 64.65153450597136, 73.14656826522422, 74.66129730450074, 85.72757957284931, 74.2837602595877, 66.70289131636659, 78.96908192764894, 88.19331508951376, 90.21271433317192, 68.66363392010884, 95.57359190682251, 86.27754427582768, 79.4003794129298, 78.90211192607666, 80.98915480990922, 111.71555837572836, 96.82787146456486, 70.54878468694908, 76.58191080196177, 69.96684689595567, 82.31429720144904, 86.67908620315039, 82.74864579245633, 71.81800153686936, 87.37226352618102, 78.7927005330844, 88.14285975976097, 63.8246704753413, 74.75925701636602, 70.77988587595006, 93.39478996408702, 84.41602396629024, 82.13154431164432, 85.43369430409737, 87.86458084990488, 69.57628467943414, 75.65372477258413, 80.19657032682606, 68.23065505927678, 74.1854563063836, 99.20822918899121, 74.0770519306569, 69.99845054158254, 72.86253725955692, 67.72501610105711, 71.61504799269018, 83.89345388851588, 62.8058415531692, 84.41840202266883, 102.76715993053334, 67.45751993661061, 89.7319414053136, 69.9088561940438, 68.33428536896427, 81.52179278578632, 70.63970187624349, 85.54828351271107, 76.48325133246449, 84.285348884899, 61.3931467100818, 82.1080048006065, 81.01834178333065, 98.94297507286673, 97.1525441569609, 92.5522247417428, 72.29300178184236, 77.90654067197525, 78.07295630899307, 71.08354483234588, 89.5333030011228, 76.03057246406202, 76.60643352536876, 89.27214710375483, 106.77797496365868, 78.79817559904241, 84.11067234533563], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [75.1255151203399, 57.37261410665763, 82.64984876894358, 93.92966935579685, 93.02591872748398, 90.82323389380207, 75.3968941264452, 91.59328566952453, 86.99888732650398, 81.13210076799271, 80.07940404819402, 83.7285730800121, 88.98457682575689, 74.40474619108403, 73.25116408374564, 90.94903247940705, 95.03617335251658, 83.05484283076646, 37.84099939228463, 86.97960556753651, 80.48456876394745, 70.70578441312789, 77.31920618146533, 59.61624035615258, 90.9276334142074, 95.60952298022397, 89.50473033388336, 63.42526993544965, 95.05741951598286, 95.38874386006783, 99.18865636020188, 59.92892088903055, 73.78727790830035, 87.7213813493132, 55.67941805789132, 64.82768812977116, 78.66746000154775, 103.91991314281175, 89.66253031248503, 13.758244545617153, 62.389587890015015, 92.78174324071841, 43.82440935408735, 94.18513706577882, 79.44726787719766, 53.24152424123921, 84.66530021462746, 87.26923321688238, 72.95469143123016, 98.95607699985584, 57.58693341652323, 75.46556514769381, 87.14731499178146, 91.38788006708012, 72.14223767512989, 72.53340290682041, 90.95283734455738, 92.44485852862383, 70.76096903672988, 89.29535131934499, 75.25814502759702, 72.13708590336574, 92.07658239626662, 91.79977083512883, 14.988650864579277, 106.88591194031942, 94.60454235814652, 81.65366975010537, 90.87087296558963, 96.83968790945514, 83.09866230186128, 97.97766177929665, 81.28442254804733, 9.884623598238433, 95.98911052490712, 69.19554743417126, 84.15273346949851, 100.63549262429532, 88.81952257975644, 97.47887545259725, 80.00391108288092, 82.99544842701101, 75.03775837883066, 91.1453230061439, 82.73626064447122, 85.41499220723352, 50.759154588515685, 70.6917373480479, 61.608295884419995, 81.78890153820937, 72.15616010764631, 79.62392648989483, 97.96631812619876, 60.39638671250766, 93.54054167944408, 92.80024789412523, 61.43988429602331, 10.275634833730589, 80.7275592381687, 81.71746387906157], "policy_hider_policy_reward": [-3.1259578010789464, -16.714712416370997, 31.375240377119678, -2.7807589439296136, 0.33904103444993106, -5.34423871997008, -12.990573030884358, -19.05296985238657, 1.7691401895651957, -17.099918727483953, -8.499946570703369, -11.467233893802124, 22.100673364853275, -11.260894126445185, 2.2544767159907457, -14.547285669524543, -2.994012362331049, -7.5228873265040015, -9.02610076799271, 7.605954898767075, -4.093404048194048, 6.292901746536892, -16.432573080012123, 19.152455125548972, -9.784736883369119, -8.417205640990987, -19.578746191084072, 33.03123562148552, -7.335164083745624, 20.899475143064247, -4.617590102858126, -13.844368600834963, -11.950173352516645, -7.130684992230912, -0.11104727598098059, -6.843767825537497, 16.24181586136866, 34.963018178538185, -3.8580221811295017, -6.6136055675364505, 8.643544727125073, -8.178568763947426, 8.554696324163864, -5.213158987635041, -8.273206181465314, 18.49611336396996, 50.528169577719936, -5.290240356152589, -13.121679913948268, -13.15441899428774, -6.9843611284296205, -15.478593586570186, -1.3647026954992894, -13.478730333883343, 9.058367662662945, 13.24394197473663, 0.21776025958769119, -20.991419515982845, -8.623108683633335, -20.062743860067858, -22.78265636020188, 2.56308192764897, -3.6829208890305525, 31.94731508951379, 20.386714333172005, -3.9612779083003895, -11.510666597233293, -7.547080831971129, 35.79759190682254, 4.096581942108691, 16.645196511501535, 4.804659634555008, -6.291330864927601, 7.024250276309676, -21.993913142811717, -3.0238880739233487, 1.7831548099093013, -10.456530312485036, 42.73775545438283, 55.21955837572833, 41.8018714645648, -7.363587890015031, -7.679143752208386, -14.553814801561016, 23.03591080196189, 9.721590645912626, -13.06389411526905, -11.15439605455409, 6.104651946767244, -3.237622622515896, 20.763086203150333, 12.674475758760783, -16.879300214627463, 14.962645792456334, -6.87323321688236, -8.5779984631307, 17.927484222197073, -3.509912127246219, -11.28560618129892, -8.877770285472486, 17.18578502973879, 13.37014131349897, -4.0521418303170345, -7.588752842035473, -5.561895290517367, -6.82616268489806, -12.74893848263858, -7.859055708491511, -10.396237675129857, 31.64878996408695, 12.031128135963293, -0.14850707649341588, -14.056837344557362, 5.235544311644309, -22.038858528623738, 15.027694304097329, 25.608580849904804, -8.504969036729873, -7.823445939047352, -11.895620700863473, 8.153427252662885, -7.75784750767574, -0.1710859033657955, 8.230570326826046, -17.776851557713837, -6.069075779276018, -13.230960217905395, -4.383354310839853, 43.690705458631356, 40.52887286578048, -8.518948069343027, -24.289911940319456, -17.725060650326373, -6.88103116623766, 3.076537259556957, -11.86766975010536, -15.26092296432848, -7.884933900203995, -6.346366359549028, -18.87827355721592, 10.607453888515895, -9.81266230186129, -15.464222061940621, -19.707598164186876, -10.978422548047323, 14.112402022668878, 48.00115993053333, 44.88137640176156, -21.100575557199452, -7.4310150310970755, 9.122313943642093, 11.414080027500265, -8.073956451523367, -6.16992082393138, -16.881714631035713, -15.419492624295291, -13.733522579756462, 6.435792785786331, -18.144142373491366, -8.695031202862353, -10.717911082880915, 16.262283512711136, -1.7278902586588256, -4.784306835887673, 12.17805007245235, -2.930459566383997, -13.724700497106905, -16.027475798955194, 7.032004800606479, -7.660260644471236, -9.728992207233551, 5.332341783330723, 3.306845411484306, 44.876975072866735, -15.42573734804791, 41.88654415696097, -7.662295884420015, 38.60622474174285, -14.24290153820936, 4.747001781842328, 1.3798939214135368, 4.370486642915403, -5.839272964246411, 4.288302783344635, -15.684462369670493, -11.198310924182348, 32.28730300112281, -3.1503867125076734, -15.214541679444084, -2.295427535937965, -1.382523612120702, -14.811290756635831, 35.266147103754776, -7.433884296023306, 50.09197496365864, 46.4103651662694, 4.171532702587236, -6.100916341713559, -6.61146387906153, 9.004672345335551]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.698054309706727, "mean_inference_ms": 0.8208508037581802, "mean_action_processing_ms": 0.13476986850468162, "mean_env_wait_ms": 1.8395766171535193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022014379501342773, "StateBufferConnector_ms": 0.002107381820678711, "ViewRequirementAgentConnector_ms": 0.05269670486450195}, "num_episodes": 30, "episode_return_max": 111.71555837572836, "episode_return_min": 55.284844902889944, "episode_return_mean": 79.99982938437482, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59749, "num_agent_steps_trained": 59749, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.68821453577243, "num_env_steps_trained_throughput_per_sec": 149.68821453577243, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 59749, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 59749, "timers": {"training_iteration_time_ms": 21224.882, "restore_workers_time_ms": 0.008, "training_step_time_ms": 21224.856, "sample_time_ms": 19273.54, "learn_time_ms": 1951.074, "learn_throughput": 2050.153, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 59749, "num_agent_steps_trained": 59749}, "done": false, "training_iteration": 5, "trial_id": "default", "date": "2025-10-13_04-41-14", "timestamp": 1760344874, "time_this_iter_s": 26.72280979156494, "time_total_s": 106.12667155265808, "pid": 49179, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x177984c20>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x177984d60>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 106.12667155265808, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.549999999999997, "ram_util_percent": 35.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 0.0001, "total_loss": 1.3740792592366537, "policy_loss": -0.007846234781327583, "vf_loss": 2.7834647390577527, "vf_explained_var": 0.6947571086505103, "kl": 0.004916173369102113, "entropy": 9.837603505452474, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 3445.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 0.00010000000000000002, "total_loss": 3.270726566761732, "policy_loss": -0.004040765241370536, "vf_loss": 6.570029034465551, "vf_explained_var": -0.013990803807973861, "kl": 0.0033688178655594926, "entropy": 10.268249309062957, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1760.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 71749, "num_agent_steps_trained": 71749}, "env_runners": {"episode_reward_max": 114.90325707686034, "episode_reward_min": 61.3931467100818, "episode_reward_mean": 80.46033414441249, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 9.884623598238433, "hider_policy": -24.289911940319456}, "policy_reward_max": {"seeker_policy": 106.88591194031942, "hider_policy": 56.79725707686028}, "policy_reward_mean": {"seeker_policy": 77.31569118165243, "hider_policy": 1.572321481380037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.70289131636659, 78.96908192764894, 88.19331508951376, 90.21271433317192, 68.66363392010884, 95.57359190682251, 86.27754427582768, 79.4003794129298, 78.90211192607666, 80.98915480990922, 111.71555837572836, 96.82787146456486, 70.54878468694908, 76.58191080196177, 69.96684689595567, 82.31429720144904, 86.67908620315039, 82.74864579245633, 71.81800153686936, 87.37226352618102, 78.7927005330844, 88.14285975976097, 63.8246704753413, 74.75925701636602, 70.77988587595006, 93.39478996408702, 84.41602396629024, 82.13154431164432, 85.43369430409737, 87.86458084990488, 69.57628467943414, 75.65372477258413, 80.19657032682606, 68.23065505927678, 74.1854563063836, 99.20822918899121, 74.0770519306569, 69.99845054158254, 72.86253725955692, 67.72501610105711, 71.61504799269018, 83.89345388851588, 62.8058415531692, 84.41840202266883, 102.76715993053334, 67.45751993661061, 89.7319414053136, 69.9088561940438, 68.33428536896427, 81.52179278578632, 70.63970187624349, 85.54828351271107, 76.48325133246449, 84.285348884899, 61.3931467100818, 82.1080048006065, 81.01834178333065, 98.94297507286673, 97.1525441569609, 92.5522247417428, 72.29300178184236, 77.90654067197525, 78.07295630899307, 71.08354483234588, 89.5333030011228, 76.03057246406202, 76.60643352536876, 89.27214710375483, 106.77797496365868, 78.79817559904241, 84.11067234533563, 107.5978756575834, 77.00002437612409, 79.32368506566483, 74.94729689187164, 94.40671653779312, 95.38967688885013, 74.05288563202447, 87.8465200395466, 80.84868420861173, 77.1386648286249, 73.89473272250933, 80.72503492962905, 71.26855233408952, 67.2795078574845, 84.16738867063727, 84.25038771426532, 74.96707614257777, 62.16894518393452, 86.14548442340153, 73.96065822119104, 80.63707865849337, 70.5952441413175, 71.39647854221764, 114.90325707686034, 92.47640334113713, 68.49428365094133, 75.69891313548185, 70.68631183736257, 68.99053055680037], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [95.38874386006783, 99.18865636020188, 59.92892088903055, 73.78727790830035, 87.7213813493132, 55.67941805789132, 64.82768812977116, 78.66746000154775, 103.91991314281175, 89.66253031248503, 13.758244545617153, 62.389587890015015, 92.78174324071841, 43.82440935408735, 94.18513706577882, 79.44726787719766, 53.24152424123921, 84.66530021462746, 87.26923321688238, 72.95469143123016, 98.95607699985584, 57.58693341652323, 75.46556514769381, 87.14731499178146, 91.38788006708012, 72.14223767512989, 72.53340290682041, 90.95283734455738, 92.44485852862383, 70.76096903672988, 89.29535131934499, 75.25814502759702, 72.13708590336574, 92.07658239626662, 91.79977083512883, 14.988650864579277, 106.88591194031942, 94.60454235814652, 81.65366975010537, 90.87087296558963, 96.83968790945514, 83.09866230186128, 97.97766177929665, 81.28442254804733, 9.884623598238433, 95.98911052490712, 69.19554743417126, 84.15273346949851, 100.63549262429532, 88.81952257975644, 97.47887545259725, 80.00391108288092, 82.99544842701101, 75.03775837883066, 91.1453230061439, 82.73626064447122, 85.41499220723352, 50.759154588515685, 70.6917373480479, 61.608295884419995, 81.78890153820937, 72.15616010764631, 79.62392648989483, 97.96631812619876, 60.39638671250766, 93.54054167944408, 92.80024789412523, 61.43988429602331, 10.275634833730589, 80.7275592381687, 81.71746387906157, 14.3574075138155, 81.59970054301007, 79.82440999495601, 85.02909435009477, 24.32763848689755, 53.60774283446386, 85.90696684722732, 62.19999014438883, 65.49681617222507, 94.77001304859125, 81.3988811719307, 84.59628552460447, 84.42094607090927, 87.44575008973985, 85.12738575499739, 95.73152814483174, 100.13910192641963, 90.79607620796163, 77.86892648449906, 92.2478676082464, 89.29582660744478, 97.72703428850761, 89.3635117515368, 9.88779017974664, 76.48022785179847, 78.56176049159293, 91.39706033286, 73.60953477063859, 87.9338078225625], "policy_hider_policy_reward": [-8.623108683633335, -20.062743860067858, -22.78265636020188, 2.56308192764897, -3.6829208890305525, 31.94731508951379, 20.386714333172005, -3.9612779083003895, -11.510666597233293, -7.547080831971129, 35.79759190682254, 4.096581942108691, 16.645196511501535, 4.804659634555008, -6.291330864927601, 7.024250276309676, -21.993913142811717, -3.0238880739233487, 1.7831548099093013, -10.456530312485036, 42.73775545438283, 55.21955837572833, 41.8018714645648, -7.363587890015031, -7.679143752208386, -14.553814801561016, 23.03591080196189, 9.721590645912626, -13.06389411526905, -11.15439605455409, 6.104651946767244, -3.237622622515896, 20.763086203150333, 12.674475758760783, -16.879300214627463, 14.962645792456334, -6.87323321688236, -8.5779984631307, 17.927484222197073, -3.509912127246219, -11.28560618129892, -8.877770285472486, 17.18578502973879, 13.37014131349897, -4.0521418303170345, -7.588752842035473, -5.561895290517367, -6.82616268489806, -12.74893848263858, -7.859055708491511, -10.396237675129857, 31.64878996408695, 12.031128135963293, -0.14850707649341588, -14.056837344557362, 5.235544311644309, -22.038858528623738, 15.027694304097329, 25.608580849904804, -8.504969036729873, -7.823445939047352, -11.895620700863473, 8.153427252662885, -7.75784750767574, -0.1710859033657955, 8.230570326826046, -17.776851557713837, -6.069075779276018, -13.230960217905395, -4.383354310839853, 43.690705458631356, 40.52887286578048, -8.518948069343027, -24.289911940319456, -17.725060650326373, -6.88103116623766, 3.076537259556957, -11.86766975010536, -15.26092296432848, -7.884933900203995, -6.346366359549028, -18.87827355721592, 10.607453888515895, -9.81266230186129, -15.464222061940621, -19.707598164186876, -10.978422548047323, 14.112402022668878, 48.00115993053333, 44.88137640176156, -21.100575557199452, -7.4310150310970755, 9.122313943642093, 11.414080027500265, -8.073956451523367, -6.16992082393138, -16.881714631035713, -15.419492624295291, -13.733522579756462, 6.435792785786331, -18.144142373491366, -8.695031202862353, -10.717911082880915, 16.262283512711136, -1.7278902586588256, -4.784306835887673, 12.17805007245235, -2.930459566383997, -13.724700497106905, -16.027475798955194, 7.032004800606479, -7.660260644471236, -9.728992207233551, 5.332341783330723, 3.306845411484306, 44.876975072866735, -15.42573734804791, 41.88654415696097, -7.662295884420015, 38.60622474174285, -14.24290153820936, 4.747001781842328, 1.3798939214135368, 4.370486642915403, -5.839272964246411, 4.288302783344635, -15.684462369670493, -11.198310924182348, 32.28730300112281, -3.1503867125076734, -15.214541679444084, -2.295427535937965, -1.382523612120702, -14.811290756635831, 35.266147103754776, -7.433884296023306, 50.09197496365864, 46.4103651662694, 4.171532702587236, -6.100916341713559, -6.61146387906153, 9.004672345335551, 53.031875657583406, 40.20859248618451, -0.35830106760342223, -4.241375099282546, 4.8932729544102, -5.3939978837013625, 0.781296891871728, -10.863094350094805, 40.35728750396029, 29.721790546935242, 0.39825716553613605, 41.383676888850054, -7.326581459750029, -4.527499755452815, 32.30052003954663, -6.653990144388844, 7.064269827909477, 8.287598208477087, 0.15266482862487002, -17.784013048591227, 0.3041708489064481, -7.808319298327789, -12.430285524604502, 8.559034929629126, 1.117478179463167, -14.269871916282865, -10.997983823436147, -9.168258408819163, 12.061388670637347, -13.021385754997436, -21.925528144831745, 10.44438771426531, -2.3430494056984155, -22.828976378143512, -17.88792279089079, -10.73920823313634, -14.642926484499075, 22.919484423401553, -6.229137450228853, -12.05807193682653, -13.34982660744477, 4.691078658493376, -15.37725873020796, -11.754531416982132, -14.65836305050225, -3.308670158816908, 56.79725707686028, 48.21820982025335, -17.044227851798475, 33.0404033411371, -8.237713485620429, -1.8297633550311692, -1.8170868645181526, -13.881060332859951, -14.606833710846589, 11.683610777570594, -12.229512376107127, -6.713764889655005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9334731196004336, "mean_inference_ms": 0.8213260912419418, "mean_action_processing_ms": 0.1355528453127075, "mean_env_wait_ms": 1.8687934247737275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002173304557800293, "StateBufferConnector_ms": 0.002099752426147461, "ViewRequirementAgentConnector_ms": 0.05196666717529297}, "num_episodes": 29, "episode_return_max": 114.90325707686034, "episode_return_min": 61.3931467100818, "episode_return_mean": 80.46033414441249, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71749, "num_agent_steps_trained": 71749, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 137.26747302352928, "num_env_steps_trained_throughput_per_sec": 137.26747302352928, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 71749, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 71749, "timers": {"training_iteration_time_ms": 22544.101, "restore_workers_time_ms": 0.008, "training_step_time_ms": 22544.075, "sample_time_ms": 20564.759, "learn_time_ms": 1979.084, "learn_throughput": 2021.137, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 71749, "num_agent_steps_trained": 71749}, "done": false, "training_iteration": 6, "trial_id": "default", "date": "2025-10-13_04-41-43", "timestamp": 1760344903, "time_this_iter_s": 29.1407470703125, "time_total_s": 135.26741862297058, "pid": 49179, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x177984c20>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x177984d60>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 135.26741862297058, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 28.204761904761902, "ram_util_percent": 35.226190476190474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 0.0001, "total_loss": 1.3890574148723058, "policy_loss": -0.00813718485268986, "vf_loss": 2.813986699921744, "vf_explained_var": 0.6169081407880026, "kl": 0.004718975266450449, "entropy": 9.813493189736018, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.28571428571429, "num_grad_updates_lifetime": 4075.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.2566724069416524, "policy_loss": -0.008405249920906499, "vf_loss": 6.550456203520298, "vf_explained_var": -0.011040462367236614, "kl": 0.0038294560695227783, "entropy": 10.162416365742683, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2080.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 83705, "num_agent_steps_trained": 83705}, "env_runners": {"episode_reward_max": 114.90325707686034, "episode_reward_min": 60.887317388168626, "episode_reward_mean": 79.15070650241063, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 9.884623598238433, "hider_policy": -24.289911940319456}, "policy_reward_max": {"seeker_policy": 106.88591194031942, "hider_policy": 56.79725707686028}, "policy_reward_mean": {"seeker_policy": 78.0976891531372, "hider_policy": 0.5265086746367171}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.57628467943414, 75.65372477258413, 80.19657032682606, 68.23065505927678, 74.1854563063836, 99.20822918899121, 74.0770519306569, 69.99845054158254, 72.86253725955692, 67.72501610105711, 71.61504799269018, 83.89345388851588, 62.8058415531692, 84.41840202266883, 102.76715993053334, 67.45751993661061, 89.7319414053136, 69.9088561940438, 68.33428536896427, 81.52179278578632, 70.63970187624349, 85.54828351271107, 76.48325133246449, 84.285348884899, 61.3931467100818, 82.1080048006065, 81.01834178333065, 98.94297507286673, 97.1525441569609, 92.5522247417428, 72.29300178184236, 77.90654067197525, 78.07295630899307, 71.08354483234588, 89.5333030011228, 76.03057246406202, 76.60643352536876, 89.27214710375483, 106.77797496365868, 78.79817559904241, 84.11067234533563, 107.5978756575834, 77.00002437612409, 79.32368506566483, 74.94729689187164, 94.40671653779312, 95.38967688885013, 74.05288563202447, 87.8465200395466, 80.84868420861173, 77.1386648286249, 73.89473272250933, 80.72503492962905, 71.26855233408952, 67.2795078574845, 84.16738867063727, 84.25038771426532, 74.96707614257777, 62.16894518393452, 86.14548442340153, 73.96065822119104, 80.63707865849337, 70.5952441413175, 71.39647854221764, 114.90325707686034, 92.47640334113713, 68.49428365094133, 75.69891313548185, 70.68631183736257, 68.99053055680037, 85.39128136302932, 73.42846355919687, 73.49461348117913, 66.039236136882, 88.21021638792095, 97.88533880201112, 68.66735867651666, 85.68437176962405, 75.22275490992568, 76.36415057327906, 74.20785004376506, 77.43472129366464, 78.95058808783264, 78.35409018954022, 78.68816557053036, 91.75311612221913, 91.74772697147543, 60.887317388168626, 70.17819426715458, 79.75987568319958, 72.57885417864445, 78.86216478166762, 91.81776371926078, 89.1225918909013, 64.86240616287407, 71.1886317383859, 71.23564654085777, 72.58834380039511, 82.21515834360092, 62.213935826279524], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [89.29535131934499, 75.25814502759702, 72.13708590336574, 92.07658239626662, 91.79977083512883, 14.988650864579277, 106.88591194031942, 94.60454235814652, 81.65366975010537, 90.87087296558963, 96.83968790945514, 83.09866230186128, 97.97766177929665, 81.28442254804733, 9.884623598238433, 95.98911052490712, 69.19554743417126, 84.15273346949851, 100.63549262429532, 88.81952257975644, 97.47887545259725, 80.00391108288092, 82.99544842701101, 75.03775837883066, 91.1453230061439, 82.73626064447122, 85.41499220723352, 50.759154588515685, 70.6917373480479, 61.608295884419995, 81.78890153820937, 72.15616010764631, 79.62392648989483, 97.96631812619876, 60.39638671250766, 93.54054167944408, 92.80024789412523, 61.43988429602331, 10.275634833730589, 80.7275592381687, 81.71746387906157, 14.3574075138155, 81.59970054301007, 79.82440999495601, 85.02909435009477, 24.32763848689755, 53.60774283446386, 85.90696684722732, 62.19999014438883, 65.49681617222507, 94.77001304859125, 81.3988811719307, 84.59628552460447, 84.42094607090927, 87.44575008973985, 85.12738575499739, 95.73152814483174, 100.13910192641963, 90.79607620796163, 77.86892648449906, 92.2478676082464, 89.29582660744478, 97.72703428850761, 89.3635117515368, 9.88779017974664, 76.48022785179847, 78.56176049159293, 91.39706033286, 73.60953477063859, 87.9338078225625, 67.49408572325763, 81.1703810956729, 75.45289422457131, 97.9367291410593, 64.3576017728343, 16.443424150341205, 93.47708265041442, 66.47408060791832, 90.64771977273908, 105.4623525823416, 82.9484904273996, 92.6820828966856, 80.91250990032016, 82.78504163349668, 87.8382631277518, 50.21503310738664, 51.414300267664814, 78.50541909484278, 97.7032953040199, 92.67796544094797, 90.34635789096893, 89.89957352710046, 66.13080943130264, 60.833564971847814, 88.40016264792501, 90.43001412990299, 85.41491089118729, 87.71097030046883, 78.34161059134794, 86.76027504837081], "policy_hider_policy_reward": [-7.823445939047352, -11.895620700863473, 8.153427252662885, -7.75784750767574, -0.1710859033657955, 8.230570326826046, -17.776851557713837, -6.069075779276018, -13.230960217905395, -4.383354310839853, 43.690705458631356, 40.52887286578048, -8.518948069343027, -24.289911940319456, -17.725060650326373, -6.88103116623766, 3.076537259556957, -11.86766975010536, -15.26092296432848, -7.884933900203995, -6.346366359549028, -18.87827355721592, 10.607453888515895, -9.81266230186129, -15.464222061940621, -19.707598164186876, -10.978422548047323, 14.112402022668878, 48.00115993053333, 44.88137640176156, -21.100575557199452, -7.4310150310970755, 9.122313943642093, 11.414080027500265, -8.073956451523367, -6.16992082393138, -16.881714631035713, -15.419492624295291, -13.733522579756462, 6.435792785786331, -18.144142373491366, -8.695031202862353, -10.717911082880915, 16.262283512711136, -1.7278902586588256, -4.784306835887673, 12.17805007245235, -2.930459566383997, -13.724700497106905, -16.027475798955194, 7.032004800606479, -7.660260644471236, -9.728992207233551, 5.332341783330723, 3.306845411484306, 44.876975072866735, -15.42573734804791, 41.88654415696097, -7.662295884420015, 38.60622474174285, -14.24290153820936, 4.747001781842328, 1.3798939214135368, 4.370486642915403, -5.839272964246411, 4.288302783344635, -15.684462369670493, -11.198310924182348, 32.28730300112281, -3.1503867125076734, -15.214541679444084, -2.295427535937965, -1.382523612120702, -14.811290756635831, 35.266147103754776, -7.433884296023306, 50.09197496365864, 46.4103651662694, 4.171532702587236, -6.100916341713559, -6.61146387906153, 9.004672345335551, 53.031875657583406, 40.20859248618451, -0.35830106760342223, -4.241375099282546, 4.8932729544102, -5.3939978837013625, 0.781296891871728, -10.863094350094805, 40.35728750396029, 29.721790546935242, 0.39825716553613605, 41.383676888850054, -7.326581459750029, -4.527499755452815, 32.30052003954663, -6.653990144388844, 7.064269827909477, 8.287598208477087, 0.15266482862487002, -17.784013048591227, 0.3041708489064481, -7.808319298327789, -12.430285524604502, 8.559034929629126, 1.117478179463167, -14.269871916282865, -10.997983823436147, -9.168258408819163, 12.061388670637347, -13.021385754997436, -21.925528144831745, 10.44438771426531, -2.3430494056984155, -22.828976378143512, -17.88792279089079, -10.73920823313634, -14.642926484499075, 22.919484423401553, -6.229137450228853, -12.05807193682653, -13.34982660744477, 4.691078658493376, -15.37725873020796, -11.754531416982132, -14.65836305050225, -3.308670158816908, 56.79725707686028, 48.21820982025335, -17.044227851798475, 33.0404033411371, -8.237713485620429, -1.8297633550311692, -1.8170868645181526, -13.881060332859951, -14.606833710846589, 11.683610777570594, -12.229512376107127, -6.713764889655005, 13.305281363029385, 4.591914276742364, -1.101229230704962, -6.6406883057711426, 5.468613481179112, -7.426894224571276, -14.129068030871059, -17.768424973306296, -1.1116017728342926, 24.964216387920924, 40.915659857816024, 40.526254793854, -8.985211455452164, -15.824512518445653, 17.201986349822736, 2.0083048118830265, -9.350945143964381, -6.074019718849, -8.761849426720891, -20.336352582341608, -2.79287132153843, -5.947769062096101, -19.476082896685558, 4.228721293664674, 6.5445880878327, -8.506509900320193, -0.6919098104597952, -3.7390416334966603, -5.287834429469664, -3.8622631277518042, 6.120966892613342, 35.417116122219134, 24.11236595562341, 16.221060748187217, -5.255060187220792, -12.36304151945332, -10.887805732845377, -16.637295304019894, -10.83196544094795, -2.086124316800423, -4.2799371033344205, -13.487566608990075, -12.494238907769093, 1.4568301623362532, 32.761763719260856, -7.0748094313026675, 33.15659189090123, -4.867564971847832, -12.028397661012834, -11.50935882403811, -9.505330945498992, -9.736051446018038, -12.379038485053192, -1.8002258652763445, -10.811121222490087, -4.311505277583621, 3.2084277427589645, 0.665120009494065, -10.889784563751686, -13.656554658339495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.120559622672124, "mean_inference_ms": 0.8200612891021302, "mean_action_processing_ms": 0.13559965041938493, "mean_env_wait_ms": 1.8964204256224275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002107381820678711, "StateBufferConnector_ms": 0.002080559730529785, "ViewRequirementAgentConnector_ms": 0.05083727836608887}, "num_episodes": 30, "episode_return_max": 114.90325707686034, "episode_return_min": 60.887317388168626, "episode_return_mean": 79.15070650241063, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83705, "num_agent_steps_trained": 83705, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 169.0727708880612, "num_env_steps_trained_throughput_per_sec": 169.0727708880612, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 83705, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 83705, "timers": {"training_iteration_time_ms": 22703.295, "restore_workers_time_ms": 0.008, "training_step_time_ms": 22703.27, "sample_time_ms": 20736.581, "learn_time_ms": 1966.462, "learn_throughput": 2034.11, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 83705, "num_agent_steps_trained": 83705}, "done": false, "training_iteration": 7, "trial_id": "default", "date": "2025-10-13_04-42-07", "timestamp": 1760344927, "time_this_iter_s": 23.659039974212646, "time_total_s": 158.92645859718323, "pid": 49179, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x177984c20>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x177984d60>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 158.92645859718323, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 30.48181818181818, "ram_util_percent": 35.67878787878787}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 0.0001, "total_loss": 1.5935557765620096, "policy_loss": -0.008259087260295119, "vf_loss": 3.2232939371986995, "vf_explained_var": 0.6853983595257713, "kl": 0.004888010936926222, "entropy": 9.839738082885741, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4705.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.427882097661495, "policy_loss": -0.004220487960265018, "vf_loss": 6.8844961181282995, "vf_explained_var": -0.002144026570022106, "kl": 0.0035055170238962484, "entropy": 10.150934877991677, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 95705, "num_agent_steps_trained": 95705}, "env_runners": {"episode_reward_max": 114.90325707686034, "episode_reward_min": 60.887317388168626, "episode_reward_mean": 79.64710952749519, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 9.88779017974664, "hider_policy": -25.54393555588619}, "policy_reward_max": {"seeker_policy": 105.4623525823416, "hider_policy": 56.79725707686028}, "policy_reward_mean": {"seeker_policy": 76.89851715491879, "hider_policy": 1.3742961862881982}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.29300178184236, 77.90654067197525, 78.07295630899307, 71.08354483234588, 89.5333030011228, 76.03057246406202, 76.60643352536876, 89.27214710375483, 106.77797496365868, 78.79817559904241, 84.11067234533563, 107.5978756575834, 77.00002437612409, 79.32368506566483, 74.94729689187164, 94.40671653779312, 95.38967688885013, 74.05288563202447, 87.8465200395466, 80.84868420861173, 77.1386648286249, 73.89473272250933, 80.72503492962905, 71.26855233408952, 67.2795078574845, 84.16738867063727, 84.25038771426532, 74.96707614257777, 62.16894518393452, 86.14548442340153, 73.96065822119104, 80.63707865849337, 70.5952441413175, 71.39647854221764, 114.90325707686034, 92.47640334113713, 68.49428365094133, 75.69891313548185, 70.68631183736257, 68.99053055680037, 85.39128136302932, 73.42846355919687, 73.49461348117913, 66.039236136882, 88.21021638792095, 97.88533880201112, 68.66735867651666, 85.68437176962405, 75.22275490992568, 76.36415057327906, 74.20785004376506, 77.43472129366464, 78.95058808783264, 78.35409018954022, 78.68816557053036, 91.75311612221913, 91.74772697147543, 60.887317388168626, 70.17819426715458, 79.75987568319958, 72.57885417864445, 78.86216478166762, 91.81776371926078, 89.1225918909013, 64.86240616287407, 71.1886317383859, 71.23564654085777, 72.58834380039511, 82.21515834360092, 62.213935826279524, 80.52724297381835, 79.85614936971893, 88.15998986239927, 70.45984621100858, 88.71921409516052, 73.77549424117194, 92.39440568601668, 83.3914534764175, 71.88462522037003, 79.61628547650075, 100.7244987306446, 68.84452168004984, 80.4971762150167, 75.98093366900963, 89.70133972300808, 70.70068523033679, 65.05069012897037, 71.16593348712017, 73.01266272247072, 87.76427385225257, 88.93982675133454, 93.94710256411115, 81.65138075634493, 76.49672490856595, 91.91339697526655, 68.9631099760929, 82.5342530092213, 77.04153453529887, 89.4960371470251, 70.7216139502842], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [81.78890153820937, 72.15616010764631, 79.62392648989483, 97.96631812619876, 60.39638671250766, 93.54054167944408, 92.80024789412523, 61.43988429602331, 10.275634833730589, 80.7275592381687, 81.71746387906157, 14.3574075138155, 81.59970054301007, 79.82440999495601, 85.02909435009477, 24.32763848689755, 53.60774283446386, 85.90696684722732, 62.19999014438883, 65.49681617222507, 94.77001304859125, 81.3988811719307, 84.59628552460447, 84.42094607090927, 87.44575008973985, 85.12738575499739, 95.73152814483174, 100.13910192641963, 90.79607620796163, 77.86892648449906, 92.2478676082464, 89.29582660744478, 97.72703428850761, 89.3635117515368, 9.88779017974664, 76.48022785179847, 78.56176049159293, 91.39706033286, 73.60953477063859, 87.9338078225625, 67.49408572325763, 81.1703810956729, 75.45289422457131, 97.9367291410593, 64.3576017728343, 16.443424150341205, 93.47708265041442, 66.47408060791832, 90.64771977273908, 105.4623525823416, 82.9484904273996, 92.6820828966856, 80.91250990032016, 82.78504163349668, 87.8382631277518, 50.21503310738664, 51.414300267664814, 78.50541909484278, 97.7032953040199, 92.67796544094797, 90.34635789096893, 89.89957352710046, 66.13080943130264, 60.833564971847814, 88.40016264792501, 90.43001412990299, 85.41491089118729, 87.71097030046883, 78.34161059134794, 86.76027504837081, 50.33415090932043, 88.17607095374673, 45.74383092258641, 95.40730653548546, 38.04063728652706, 88.77754438444023, 55.51279842658599, 68.72233080800808, 95.07397278156368, 93.33692338155502, 11.552634870194648, 86.44744654028136, 72.99948442199634, 85.90425852627733, 62.41066280358068, 89.35853948503278, 104.46993555588618, 83.31648708260005, 96.85294006875526, 85.92828810632713, 62.252973399404866, 74.9950251047739, 93.5067250827754, 102.7275191962299, 61.58820643175842, 92.87194261415644, 71.43198886281462, 80.13752718042268, 53.58900974405736, 83.93544386113707], "policy_hider_policy_reward": [-14.24290153820936, 4.747001781842328, 1.3798939214135368, 4.370486642915403, -5.839272964246411, 4.288302783344635, -15.684462369670493, -11.198310924182348, 32.28730300112281, -3.1503867125076734, -15.214541679444084, -2.295427535937965, -1.382523612120702, -14.811290756635831, 35.266147103754776, -7.433884296023306, 50.09197496365864, 46.4103651662694, 4.171532702587236, -6.100916341713559, -6.61146387906153, 9.004672345335551, 53.031875657583406, 40.20859248618451, -0.35830106760342223, -4.241375099282546, 4.8932729544102, -5.3939978837013625, 0.781296891871728, -10.863094350094805, 40.35728750396029, 29.721790546935242, 0.39825716553613605, 41.383676888850054, -7.326581459750029, -4.527499755452815, 32.30052003954663, -6.653990144388844, 7.064269827909477, 8.287598208477087, 0.15266482862487002, -17.784013048591227, 0.3041708489064481, -7.808319298327789, -12.430285524604502, 8.559034929629126, 1.117478179463167, -14.269871916282865, -10.997983823436147, -9.168258408819163, 12.061388670637347, -13.021385754997436, -21.925528144831745, 10.44438771426531, -2.3430494056984155, -22.828976378143512, -17.88792279089079, -10.73920823313634, -14.642926484499075, 22.919484423401553, -6.229137450228853, -12.05807193682653, -13.34982660744477, 4.691078658493376, -15.37725873020796, -11.754531416982132, -14.65836305050225, -3.308670158816908, 56.79725707686028, 48.21820982025335, -17.044227851798475, 33.0404033411371, -8.237713485620429, -1.8297633550311692, -1.8170868645181526, -13.881060332859951, -14.606833710846589, 11.683610777570594, -12.229512376107127, -6.713764889655005, 13.305281363029385, 4.591914276742364, -1.101229230704962, -6.6406883057711426, 5.468613481179112, -7.426894224571276, -14.129068030871059, -17.768424973306296, -1.1116017728342926, 24.964216387920924, 40.915659857816024, 40.526254793854, -8.985211455452164, -15.824512518445653, 17.201986349822736, 2.0083048118830265, -9.350945143964381, -6.074019718849, -8.761849426720891, -20.336352582341608, -2.79287132153843, -5.947769062096101, -19.476082896685558, 4.228721293664674, 6.5445880878327, -8.506509900320193, -0.6919098104597952, -3.7390416334966603, -5.287834429469664, -3.8622631277518042, 6.120966892613342, 35.417116122219134, 24.11236595562341, 16.221060748187217, -5.255060187220792, -12.36304151945332, -10.887805732845377, -16.637295304019894, -10.83196544094795, -2.086124316800423, -4.2799371033344205, -13.487566608990075, -12.494238907769093, 1.4568301623362532, 32.761763719260856, -7.0748094313026675, 33.15659189090123, -4.867564971847832, -12.028397661012834, -11.50935882403811, -9.505330945498992, -9.736051446018038, -12.379038485053192, -1.8002258652763445, -10.811121222490087, -4.311505277583621, 3.2084277427589645, 0.665120009494065, -10.889784563751686, -13.656554658339495, 12.390347245980847, 17.80274481851691, 0.8701493697189572, -9.190070953746732, 13.452386360923777, 28.96377257888907, -7.666153788991394, -17.281306535485488, 26.545208632834587, 24.133368175798932, -1.6487141765971607, -13.353335966671102, 38.00840568601664, -1.1267984265860058, 1.263669191991932, 13.405453476417446, -20.886045631298888, -2.3033019298947526, 3.6702854765009048, -17.39092338155504, 45.54418356152837, 43.62768029892157, -8.164585745294408, -9.438339114937138, 2.8769635406166163, 4.620728252403722, 0.6895052088389138, -10.612830066106602, 35.615339723008056, -8.324662803580692, -8.817633345751126, -9.84022090894487, -25.54393555588619, -13.875309871029652, -9.62233878659529, -2.528214808884533, -15.66694006875531, -8.173337277529315, 26.218273852252636, -24.38228810632713, -3.246973399404866, 29.933826751334525, 25.721102564111213, -6.76902510477394, 2.6453807563450105, -14.500725082775439, -22.781519196229905, -3.449275091434036, 36.62739697526652, -6.302206431758407, -7.820446645310758, -16.088385992752787, 4.79857748498772, 6.303686661418984, -12.957238629930933, 9.861245984807109, 34.23003714702511, 1.6769902559426613, -7.374164312748616, -5.839665598104179]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2975795789777482, "mean_inference_ms": 0.8190836607135102, "mean_action_processing_ms": 0.1356123904797699, "mean_env_wait_ms": 1.92509076631156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021364688873291016, "StateBufferConnector_ms": 0.002103090286254883, "ViewRequirementAgentConnector_ms": 0.05127239227294922}, "num_episodes": 30, "episode_return_max": 114.90325707686034, "episode_return_min": 60.887317388168626, "episode_return_mean": 79.64710952749519, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95705, "num_agent_steps_trained": 95705, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 139.50168348600548, "num_env_steps_trained_throughput_per_sec": 139.50168348600548, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 95705, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 95705, "timers": {"training_iteration_time_ms": 23449.57, "restore_workers_time_ms": 0.008, "training_step_time_ms": 23449.545, "sample_time_ms": 21507.642, "learn_time_ms": 1941.683, "learn_throughput": 2060.068, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 95705, "num_agent_steps_trained": 95705}, "done": false, "training_iteration": 8, "trial_id": "default", "date": "2025-10-13_04-42-36", "timestamp": 1760344956, "time_this_iter_s": 28.67404079437256, "time_total_s": 187.6004993915558, "pid": 49179, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x177984c20>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x177984d60>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 187.6004993915558, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 25.758536585365853, "ram_util_percent": 35.417073170731705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 0.0001, "total_loss": 1.4712706249857705, "policy_loss": -0.007536666978534961, "vf_loss": 2.9773095259590754, "vf_explained_var": 0.7787337665520017, "kl": 0.00501316378466539, "entropy": 9.851387544662233, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 5335.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.25419245287776, "policy_loss": -0.009607593344117048, "vf_loss": 6.5478048622608185, "vf_explained_var": -0.010221230424940586, "kl": 0.004475003714910759, "entropy": 10.105875691771507, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2720.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 107705, "num_agent_steps_trained": 107705}, "env_runners": {"episode_reward_max": 114.90325707686034, "episode_reward_min": 60.887317388168626, "episode_reward_mean": 79.89617000127151, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 9.88779017974664, "hider_policy": -25.54393555588619}, "policy_reward_max": {"seeker_policy": 105.4623525823416, "hider_policy": 56.79725707686028}, "policy_reward_mean": {"seeker_policy": 77.24202308648464, "hider_policy": 1.3270734573934482}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.14548442340153, 73.96065822119104, 80.63707865849337, 70.5952441413175, 71.39647854221764, 114.90325707686034, 92.47640334113713, 68.49428365094133, 75.69891313548185, 70.68631183736257, 68.99053055680037, 85.39128136302932, 73.42846355919687, 73.49461348117913, 66.039236136882, 88.21021638792095, 97.88533880201112, 68.66735867651666, 85.68437176962405, 75.22275490992568, 76.36415057327906, 74.20785004376506, 77.43472129366464, 78.95058808783264, 78.35409018954022, 78.68816557053036, 91.75311612221913, 91.74772697147543, 60.887317388168626, 70.17819426715458, 79.75987568319958, 72.57885417864445, 78.86216478166762, 91.81776371926078, 89.1225918909013, 64.86240616287407, 71.1886317383859, 71.23564654085777, 72.58834380039511, 82.21515834360092, 62.213935826279524, 80.52724297381835, 79.85614936971893, 88.15998986239927, 70.45984621100858, 88.71921409516052, 73.77549424117194, 92.39440568601668, 83.3914534764175, 71.88462522037003, 79.61628547650075, 100.7244987306446, 68.84452168004984, 80.4971762150167, 75.98093366900963, 89.70133972300808, 70.70068523033679, 65.05069012897037, 71.16593348712017, 73.01266272247072, 87.76427385225257, 88.93982675133454, 93.94710256411115, 81.65138075634493, 76.49672490856595, 91.91339697526655, 68.9631099760929, 82.5342530092213, 77.04153453529887, 89.4960371470251, 70.7216139502842, 82.34191086600372, 68.0338406615451, 66.66378635574289, 93.4775414897734, 74.76828208562789, 105.06758907145071, 79.58928671913198, 87.24495294720684, 104.82344238382566, 90.25099069428217, 70.06040169689848, 70.38818265329995, 84.85697926724396, 86.87489333660955, 70.01092621561574, 65.49628683314221, 90.22813396810797, 73.90412096375532, 89.3753421090973, 75.73758017142245, 68.89006081053428, 95.90825524636948, 86.73837265116347, 83.45674523851497, 88.62719881839932, 103.49295532662957, 72.5574771731474, 67.99319490249374, 75.80629499992202], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [77.86892648449906, 92.2478676082464, 89.29582660744478, 97.72703428850761, 89.3635117515368, 9.88779017974664, 76.48022785179847, 78.56176049159293, 91.39706033286, 73.60953477063859, 87.9338078225625, 67.49408572325763, 81.1703810956729, 75.45289422457131, 97.9367291410593, 64.3576017728343, 16.443424150341205, 93.47708265041442, 66.47408060791832, 90.64771977273908, 105.4623525823416, 82.9484904273996, 92.6820828966856, 80.91250990032016, 82.78504163349668, 87.8382631277518, 50.21503310738664, 51.414300267664814, 78.50541909484278, 97.7032953040199, 92.67796544094797, 90.34635789096893, 89.89957352710046, 66.13080943130264, 60.833564971847814, 88.40016264792501, 90.43001412990299, 85.41491089118729, 87.71097030046883, 78.34161059134794, 86.76027504837081, 50.33415090932043, 88.17607095374673, 45.74383092258641, 95.40730653548546, 38.04063728652706, 88.77754438444023, 55.51279842658599, 68.72233080800808, 95.07397278156368, 93.33692338155502, 11.552634870194648, 86.44744654028136, 72.99948442199634, 85.90425852627733, 62.41066280358068, 89.35853948503278, 104.46993555588618, 83.31648708260005, 96.85294006875526, 85.92828810632713, 62.252973399404866, 74.9950251047739, 93.5067250827754, 102.7275191962299, 61.58820643175842, 92.87194261415644, 71.43198886281462, 80.13752718042268, 53.58900974405736, 83.93544386113707, 72.67898213143883, 88.74326742999233, 98.97447080482, 85.68334914740737, 94.04539408963178, 56.14260113853002, 89.33753914258114, 88.85083470261267, 19.266747431121388, 73.03949642020916, 91.14083598897963, 89.65404410370182, 71.2438176967392, 55.22358092512373, 83.99272064348592, 91.43505615439375, 64.17695299659893, 104.14303722012224, 64.2720430146527, 79.72663790959878, 99.22978071443664, 18.787982575500138, 63.1292419863828, 78.21286364977661, 75.17539045810061, 58.192471239273836, 93.51149660650617, 92.08374627210327, 63.46497018483817], "policy_hider_policy_reward": [-14.642926484499075, 22.919484423401553, -6.229137450228853, -12.05807193682653, -13.34982660744477, 4.691078658493376, -15.37725873020796, -11.754531416982132, -14.65836305050225, -3.308670158816908, 56.79725707686028, 48.21820982025335, -17.044227851798475, 33.0404033411371, -8.237713485620429, -1.8297633550311692, -1.8170868645181526, -13.881060332859951, -14.606833710846589, 11.683610777570594, -12.229512376107127, -6.713764889655005, 13.305281363029385, 4.591914276742364, -1.101229230704962, -6.6406883057711426, 5.468613481179112, -7.426894224571276, -14.129068030871059, -17.768424973306296, -1.1116017728342926, 24.964216387920924, 40.915659857816024, 40.526254793854, -8.985211455452164, -15.824512518445653, 17.201986349822736, 2.0083048118830265, -9.350945143964381, -6.074019718849, -8.761849426720891, -20.336352582341608, -2.79287132153843, -5.947769062096101, -19.476082896685558, 4.228721293664674, 6.5445880878327, -8.506509900320193, -0.6919098104597952, -3.7390416334966603, -5.287834429469664, -3.8622631277518042, 6.120966892613342, 35.417116122219134, 24.11236595562341, 16.221060748187217, -5.255060187220792, -12.36304151945332, -10.887805732845377, -16.637295304019894, -10.83196544094795, -2.086124316800423, -4.2799371033344205, -13.487566608990075, -12.494238907769093, 1.4568301623362532, 32.761763719260856, -7.0748094313026675, 33.15659189090123, -4.867564971847832, -12.028397661012834, -11.50935882403811, -9.505330945498992, -9.736051446018038, -12.379038485053192, -1.8002258652763445, -10.811121222490087, -4.311505277583621, 3.2084277427589645, 0.665120009494065, -10.889784563751686, -13.656554658339495, 12.390347245980847, 17.80274481851691, 0.8701493697189572, -9.190070953746732, 13.452386360923777, 28.96377257888907, -7.666153788991394, -17.281306535485488, 26.545208632834587, 24.133368175798932, -1.6487141765971607, -13.353335966671102, 38.00840568601664, -1.1267984265860058, 1.263669191991932, 13.405453476417446, -20.886045631298888, -2.3033019298947526, 3.6702854765009048, -17.39092338155504, 45.54418356152837, 43.62768029892157, -8.164585745294408, -9.438339114937138, 2.8769635406166163, 4.620728252403722, 0.6895052088389138, -10.612830066106602, 35.615339723008056, -8.324662803580692, -8.817633345751126, -9.84022090894487, -25.54393555588619, -13.875309871029652, -9.62233878659529, -2.528214808884533, -15.66694006875531, -8.173337277529315, 26.218273852252636, -24.38228810632713, -3.246973399404866, 29.933826751334525, 25.721102564111213, -6.76902510477394, 2.6453807563450105, -14.500725082775439, -22.781519196229905, -3.449275091434036, 36.62739697526652, -6.302206431758407, -7.820446645310758, -16.088385992752787, 4.79857748498772, 6.303686661418984, -12.957238629930933, 9.861245984807109, 34.23003714702511, 1.6769902559426613, -7.374164312748616, -5.839665598104179, 10.605310866003759, -0.942382131438839, -5.5121593384548575, -15.197267429992309, -19.99402611099955, -12.31665833807752, 28.5815414897735, -20.78734914740739, -18.78939408963177, -0.48771791437213663, -1.9566011385300444, 50.881589071450605, -14.071539142581134, 4.3232867191319775, 16.118952947206918, -17.72483470261265, 46.95744238382566, 38.59925256887861, 35.27499069428219, -18.063496420209177, -4.571506173651717, -16.508928118429413, -11.22919493713864, -8.036666513263198, 1.783577734799623, 11.829583835705153, 6.76241907487627, 24.888893336609552, -10.574387181689447, -3.4074072461807146, -12.817364887502151, -13.121404433749355, 34.24213396810792, -8.190952996598941, -10.466970588930874, -19.771945667436015, 30.169342109097247, -5.066043014652658, -1.762684294656137, -2.2263734435201936, -20.06541787779623, -10.2743020261061, 36.31734116523907, 40.80293150563027, -3.5832419863828, 27.192372651163463, 4.653568692502233, 0.5903128962361293, -10.72939045810066, 24.1811988183993, -3.9464712392738135, 49.24695532662967, -11.99681870029451, -8.957200733064154, -12.537746272103256, -11.552805097506186, -6.918970184838218, 19.26029499992206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.41523776029848, "mean_inference_ms": 0.8189683454731684, "mean_action_processing_ms": 0.1357140901735613, "mean_env_wait_ms": 1.9516164093389463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002077460289001465, "StateBufferConnector_ms": 0.002045273780822754, "ViewRequirementAgentConnector_ms": 0.051177263259887695}, "num_episodes": 29, "episode_return_max": 114.90325707686034, "episode_return_min": 60.887317388168626, "episode_return_mean": 79.89617000127151, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107705, "num_agent_steps_trained": 107705, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 141.03386182200137, "num_env_steps_trained_throughput_per_sec": 141.03386182200137, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 107705, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 107705, "timers": {"training_iteration_time_ms": 23995.394, "restore_workers_time_ms": 0.008, "training_step_time_ms": 23995.37, "sample_time_ms": 22062.312, "learn_time_ms": 1932.841, "learn_throughput": 2069.493, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 107705, "num_agent_steps_trained": 107705}, "done": false, "training_iteration": 9, "trial_id": "default", "date": "2025-10-13_04-43-04", "timestamp": 1760344984, "time_this_iter_s": 28.36255717277527, "time_total_s": 215.96305656433105, "pid": 49179, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x177984c20>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x177984d60>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 215.96305656433105, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 31.146341463414632, "ram_util_percent": 35.36585365853659}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 0.0001, "total_loss": 1.4617199154127212, "policy_loss": -0.005639002630339255, "vf_loss": 2.9544484006034004, "vf_explained_var": 0.7474156672992404, "kl": 0.0036371768890942945, "entropy": 9.868114889235724, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 5965.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.2065156996250153, "policy_loss": -0.005545732710743323, "vf_loss": 6.444317850470543, "vf_explained_var": -0.05991554856300354, "kl": 0.004398091654036328, "entropy": 10.099190509319305, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3040.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 119705, "num_agent_steps_trained": 119705}, "env_runners": {"episode_reward_max": 105.64218214262549, "episode_reward_min": 62.213935826279524, "episode_reward_mean": 79.98093021887061, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 11.552634870194648, "hider_policy": -25.768749946743043}, "policy_reward_max": {"seeker_policy": 104.46993555588618, "hider_policy": 51.55618214262552}, "policy_reward_mean": {"seeker_policy": 78.98586117209528, "hider_policy": 0.49753452338766707}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.75987568319958, 72.57885417864445, 78.86216478166762, 91.81776371926078, 89.1225918909013, 64.86240616287407, 71.1886317383859, 71.23564654085777, 72.58834380039511, 82.21515834360092, 62.213935826279524, 80.52724297381835, 79.85614936971893, 88.15998986239927, 70.45984621100858, 88.71921409516052, 73.77549424117194, 92.39440568601668, 83.3914534764175, 71.88462522037003, 79.61628547650075, 100.7244987306446, 68.84452168004984, 80.4971762150167, 75.98093366900963, 89.70133972300808, 70.70068523033679, 65.05069012897037, 71.16593348712017, 73.01266272247072, 87.76427385225257, 88.93982675133454, 93.94710256411115, 81.65138075634493, 76.49672490856595, 91.91339697526655, 68.9631099760929, 82.5342530092213, 77.04153453529887, 89.4960371470251, 70.7216139502842, 82.34191086600372, 68.0338406615451, 66.66378635574289, 93.4775414897734, 74.76828208562789, 105.06758907145071, 79.58928671913198, 87.24495294720684, 104.82344238382566, 90.25099069428217, 70.06040169689848, 70.38818265329995, 84.85697926724396, 86.87489333660955, 70.01092621561574, 65.49628683314221, 90.22813396810797, 73.90412096375532, 89.3753421090973, 75.73758017142245, 68.89006081053428, 95.90825524636948, 86.73837265116347, 83.45674523851497, 88.62719881839932, 103.49295532662957, 72.5574771731474, 67.99319490249374, 75.80629499992202, 79.71905341778087, 67.68455061180852, 84.19276584807997, 76.86934776847491, 86.97359575288039, 65.5507777047993, 72.68379907550383, 72.22144137055865, 73.51348119934075, 87.96444288715487, 71.32514147209677, 73.11073196770285, 69.76200412613802, 80.04540822768625, 71.30489243877639, 90.08802026081378, 92.06280972823055, 88.06153151136303, 72.42581574658706, 70.45014460259432, 71.9720866767, 76.5835385786442, 82.5616201821655, 79.872052972104, 94.30300177844808, 73.75787371968273, 85.66294204302366, 81.78463530631798, 76.90053182094695, 105.64218214262549], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [92.67796544094797, 90.34635789096893, 89.89957352710046, 66.13080943130264, 60.833564971847814, 88.40016264792501, 90.43001412990299, 85.41491089118729, 87.71097030046883, 78.34161059134794, 86.76027504837081, 50.33415090932043, 88.17607095374673, 45.74383092258641, 95.40730653548546, 38.04063728652706, 88.77754438444023, 55.51279842658599, 68.72233080800808, 95.07397278156368, 93.33692338155502, 11.552634870194648, 86.44744654028136, 72.99948442199634, 85.90425852627733, 62.41066280358068, 89.35853948503278, 104.46993555588618, 83.31648708260005, 96.85294006875526, 85.92828810632713, 62.252973399404866, 74.9950251047739, 93.5067250827754, 102.7275191962299, 61.58820643175842, 92.87194261415644, 71.43198886281462, 80.13752718042268, 53.58900974405736, 83.93544386113707, 72.67898213143883, 88.74326742999233, 98.97447080482, 85.68334914740737, 94.04539408963178, 56.14260113853002, 89.33753914258114, 88.85083470261267, 19.266747431121388, 73.03949642020916, 91.14083598897963, 89.65404410370182, 71.2438176967392, 55.22358092512373, 83.99272064348592, 91.43505615439375, 64.17695299659893, 104.14303722012224, 64.2720430146527, 79.72663790959878, 99.22978071443664, 18.787982575500138, 63.1292419863828, 78.21286364977661, 75.17539045810061, 58.192471239273836, 93.51149660650617, 92.08374627210327, 63.46497018483817, 85.13232431475072, 102.2496557158311, 89.86838999726473, 94.61824443831864, 68.15237020024541, 101.12160888078525, 84.49411334128217, 92.32506959154291, 74.8176270536527, 65.27911116175903, 84.21994911047499, 95.17869418341422, 98.88280480905902, 85.9180592372081, 93.31337579707626, 66.18973606967106, 43.676513624898156, 64.20684354895718, 88.48740551563067, 97.82641478387644, 93.30625389384927, 92.83086554391286, 76.18818689748073, 92.08665948427172, 78.77447855757318, 92.09199653103951, 82.54280142070213, 76.86145263490333, 85.77453636949333, 56.26240152229271], "policy_hider_policy_reward": [-10.83196544094795, -2.086124316800423, -4.2799371033344205, -13.487566608990075, -12.494238907769093, 1.4568301623362532, 32.761763719260856, -7.0748094313026675, 33.15659189090123, -4.867564971847832, -12.028397661012834, -11.50935882403811, -9.505330945498992, -9.736051446018038, -12.379038485053192, -1.8002258652763445, -10.811121222490087, -4.311505277583621, 3.2084277427589645, 0.665120009494065, -10.889784563751686, -13.656554658339495, 12.390347245980847, 17.80274481851691, 0.8701493697189572, -9.190070953746732, 13.452386360923777, 28.96377257888907, -7.666153788991394, -17.281306535485488, 26.545208632834587, 24.133368175798932, -1.6487141765971607, -13.353335966671102, 38.00840568601664, -1.1267984265860058, 1.263669191991932, 13.405453476417446, -20.886045631298888, -2.3033019298947526, 3.6702854765009048, -17.39092338155504, 45.54418356152837, 43.62768029892157, -8.164585745294408, -9.438339114937138, 2.8769635406166163, 4.620728252403722, 0.6895052088389138, -10.612830066106602, 35.615339723008056, -8.324662803580692, -8.817633345751126, -9.84022090894487, -25.54393555588619, -13.875309871029652, -9.62233878659529, -2.528214808884533, -15.66694006875531, -8.173337277529315, 26.218273852252636, -24.38228810632713, -3.246973399404866, 29.933826751334525, 25.721102564111213, -6.76902510477394, 2.6453807563450105, -14.500725082775439, -22.781519196229905, -3.449275091434036, 36.62739697526652, -6.302206431758407, -7.820446645310758, -16.088385992752787, 4.79857748498772, 6.303686661418984, -12.957238629930933, 9.861245984807109, 34.23003714702511, 1.6769902559426613, -7.374164312748616, -5.839665598104179, 10.605310866003759, -0.942382131438839, -5.5121593384548575, -15.197267429992309, -19.99402611099955, -12.31665833807752, 28.5815414897735, -20.78734914740739, -18.78939408963177, -0.48771791437213663, -1.9566011385300444, 50.881589071450605, -14.071539142581134, 4.3232867191319775, 16.118952947206918, -17.72483470261265, 46.95744238382566, 38.59925256887861, 35.27499069428219, -18.063496420209177, -4.571506173651717, -16.508928118429413, -11.22919493713864, -8.036666513263198, 1.783577734799623, 11.829583835705153, 6.76241907487627, 24.888893336609552, -10.574387181689447, -3.4074072461807146, -12.817364887502151, -13.121404433749355, 34.24213396810792, -8.190952996598941, -10.466970588930874, -19.771945667436015, 30.169342109097247, -5.066043014652658, -1.762684294656137, -2.2263734435201936, -20.06541787779623, -10.2743020261061, 36.31734116523907, 40.80293150563027, -3.5832419863828, 27.192372651163463, 4.653568692502233, 0.5903128962361293, -10.72939045810066, 24.1811988183993, -3.9464712392738135, 49.24695532662967, -11.99681870029451, -8.957200733064154, -12.537746272103256, -11.552805097506186, -6.918970184838218, 19.26029499992206, -0.029612785336774094, -5.3836581116331175, -16.555209762813487, -18.009895341209074, -16.682389997264718, 11.006765848079981, -6.652244438318623, -11.096652231525109, -10.286370200245416, 29.107595752880332, -25.768749946743043, -9.802081229242807, -12.268113341282193, 0.45779907550384946, -9.53909502754822, -10.564533193436056, -5.725635668016465, 4.421489813704537, -7.093111161759057, 29.77844288715488, -2.836846716923428, -10.05796092145479, -4.9152680322971465, -17.152694183414223, -22.472245042896787, -6.648555640024197, 4.179408227686239, -10.052059237208052, -4.841107561223648, -17.167375797076257, -9.963736069671052, 33.862020260813786, 36.696809728230555, 11.68948637510183, 29.855531511363104, -6.000843548957173, -6.528043910487897, -9.533545858555684, -12.075615419436666, -15.300654761845465, -5.133913323299966, -16.20025389384923, -2.5824614213558346, -13.664865543912846, -5.14218689748073, 11.515620182165469, -14.920659484271752, 2.7060529721040685, 40.23700177844813, -24.708478557573198, -15.925996531039505, -2.4081262803172234, -18.336801420702106, 21.456942043023687, 6.4146089051283965, -1.4914262337137265, -12.568536369493374, 3.6945318209469735, -2.1764015222927324, 51.55618214262552]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.548943492052918, "mean_inference_ms": 0.8211659961192206, "mean_action_processing_ms": 0.1360356697762043, "mean_env_wait_ms": 1.9792681174857896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021349191665649414, "StateBufferConnector_ms": 0.002099156379699707, "ViewRequirementAgentConnector_ms": 0.05289018154144287}, "num_episodes": 30, "episode_return_max": 105.64218214262549, "episode_return_min": 62.213935826279524, "episode_return_mean": 79.98093021887061, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 119705, "num_agent_steps_trained": 119705, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.91096653513166, "num_env_steps_trained_throughput_per_sec": 125.91096653513166, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 119705, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 119705, "timers": {"training_iteration_time_ms": 24772.703, "restore_workers_time_ms": 0.009, "training_step_time_ms": 24772.679, "sample_time_ms": 22858.24, "learn_time_ms": 1914.198, "learn_throughput": 2089.648, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 119705, "num_agent_steps_trained": 119705}, "done": false, "training_iteration": 10, "trial_id": "default", "date": "2025-10-13_04-43-36", "timestamp": 1760345016, "time_this_iter_s": 31.7694251537323, "time_total_s": 247.73248171806335, "pid": 49179, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x177984c20>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x177984d60>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 247.73248171806335, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.417777777777772, "ram_util_percent": 35.11555555555554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.0001, "total_loss": 1.4439612465245384, "policy_loss": -0.00700462324884794, "vf_loss": 2.9216121272435265, "vf_explained_var": 0.6803365951492673, "kl": 0.003607546955727823, "entropy": 9.841601000891792, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6595.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 0.00010000000000000002, "total_loss": 3.1177179865539073, "policy_loss": -0.0038509719728608617, "vf_loss": 6.263318859040737, "vf_explained_var": -0.03866552077233791, "kl": 0.0032021459555636733, "entropy": 10.091104555130006, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 131705, "num_agent_steps_trained": 131705}, "env_runners": {"episode_reward_max": 105.64218214262549, "episode_reward_min": 65.49628683314221, "episode_reward_mean": 80.65603725155187, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 18.787982575500138, "hider_policy": -25.768749946743043}, "policy_reward_max": {"seeker_policy": 104.14303722012224, "hider_policy": 51.55618214262552}, "policy_reward_mean": {"seeker_policy": 79.03072923333447, "hider_policy": 0.8126540091087046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.01266272247072, 87.76427385225257, 88.93982675133454, 93.94710256411115, 81.65138075634493, 76.49672490856595, 91.91339697526655, 68.9631099760929, 82.5342530092213, 77.04153453529887, 89.4960371470251, 70.7216139502842, 82.34191086600372, 68.0338406615451, 66.66378635574289, 93.4775414897734, 74.76828208562789, 105.06758907145071, 79.58928671913198, 87.24495294720684, 104.82344238382566, 90.25099069428217, 70.06040169689848, 70.38818265329995, 84.85697926724396, 86.87489333660955, 70.01092621561574, 65.49628683314221, 90.22813396810797, 73.90412096375532, 89.3753421090973, 75.73758017142245, 68.89006081053428, 95.90825524636948, 86.73837265116347, 83.45674523851497, 88.62719881839932, 103.49295532662957, 72.5574771731474, 67.99319490249374, 75.80629499992202, 79.71905341778087, 67.68455061180852, 84.19276584807997, 76.86934776847491, 86.97359575288039, 65.5507777047993, 72.68379907550383, 72.22144137055865, 73.51348119934075, 87.96444288715487, 71.32514147209677, 73.11073196770285, 69.76200412613802, 80.04540822768625, 71.30489243877639, 90.08802026081378, 92.06280972823055, 88.06153151136303, 72.42581574658706, 70.45014460259432, 71.9720866767, 76.5835385786442, 82.5616201821655, 79.872052972104, 94.30300177844808, 73.75787371968273, 85.66294204302366, 81.78463530631798, 76.90053182094695, 105.64218214262549, 75.59937763949833, 83.95876043123049, 83.95945283328244, 68.49719374027532, 67.39218515449322, 74.18094522341178, 82.82587167756745, 86.05126804561966, 85.10453768614985, 78.88624034382566, 76.3743403839911, 84.57452336516039, 96.42730689731184, 71.97332911959585, 71.62012528864857, 79.64649934233789, 87.73017886220354, 66.30129704569727, 79.09971630629285, 70.83335387929795, 98.90183816365548, 98.06757809050511, 70.04845811721552, 75.46028965223312, 87.74324868189663, 79.70986140725051, 82.33380688490455, 82.2445651609784, 89.8604119864003], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [96.85294006875526, 85.92828810632713, 62.252973399404866, 74.9950251047739, 93.5067250827754, 102.7275191962299, 61.58820643175842, 92.87194261415644, 71.43198886281462, 80.13752718042268, 53.58900974405736, 83.93544386113707, 72.67898213143883, 88.74326742999233, 98.97447080482, 85.68334914740737, 94.04539408963178, 56.14260113853002, 89.33753914258114, 88.85083470261267, 19.266747431121388, 73.03949642020916, 91.14083598897963, 89.65404410370182, 71.2438176967392, 55.22358092512373, 83.99272064348592, 91.43505615439375, 64.17695299659893, 104.14303722012224, 64.2720430146527, 79.72663790959878, 99.22978071443664, 18.787982575500138, 63.1292419863828, 78.21286364977661, 75.17539045810061, 58.192471239273836, 93.51149660650617, 92.08374627210327, 63.46497018483817, 85.13232431475072, 102.2496557158311, 89.86838999726473, 94.61824443831864, 68.15237020024541, 101.12160888078525, 84.49411334128217, 92.32506959154291, 74.8176270536527, 65.27911116175903, 84.21994911047499, 95.17869418341422, 98.88280480905902, 85.9180592372081, 93.31337579707626, 66.18973606967106, 43.676513624898156, 64.20684354895718, 88.48740551563067, 97.82641478387644, 93.30625389384927, 92.83086554391286, 76.18818689748073, 92.08665948427172, 78.77447855757318, 92.09199653103951, 82.54280142070213, 76.86145263490333, 85.77453636949333, 56.26240152229271, 80.27377816120548, 78.53130918823595, 86.95110074034544, 93.23908250109815, 85.7353075794878, 89.51343621602521, 88.51699881441098, 79.16607710825103, 72.79370164574628, 89.0972021564528, 97.486303567949, 74.41496648314057, 23.994291738306146, 84.43743042669593, 87.08721308442587, 71.38980856950857, 64.90732144892814, 85.33817817559944, 85.95854346902044, 94.47166568895875, 48.779746445076846, 60.814516365918436, 86.67515145285194, 79.50576959437134, 64.74154163932157, 79.31824483778675, 79.49997065363652, 81.11289633814248, 43.26648258005944], "policy_hider_policy_reward": [-15.66694006875531, -8.173337277529315, 26.218273852252636, -24.38228810632713, -3.246973399404866, 29.933826751334525, 25.721102564111213, -6.76902510477394, 2.6453807563450105, -14.500725082775439, -22.781519196229905, -3.449275091434036, 36.62739697526652, -6.302206431758407, -7.820446645310758, -16.088385992752787, 4.79857748498772, 6.303686661418984, -12.957238629930933, 9.861245984807109, 34.23003714702511, 1.6769902559426613, -7.374164312748616, -5.839665598104179, 10.605310866003759, -0.942382131438839, -5.5121593384548575, -15.197267429992309, -19.99402611099955, -12.31665833807752, 28.5815414897735, -20.78734914740739, -18.78939408963177, -0.48771791437213663, -1.9566011385300444, 50.881589071450605, -14.071539142581134, 4.3232867191319775, 16.118952947206918, -17.72483470261265, 46.95744238382566, 38.59925256887861, 35.27499069428219, -18.063496420209177, -4.571506173651717, -16.508928118429413, -11.22919493713864, -8.036666513263198, 1.783577734799623, 11.829583835705153, 6.76241907487627, 24.888893336609552, -10.574387181689447, -3.4074072461807146, -12.817364887502151, -13.121404433749355, 34.24213396810792, -8.190952996598941, -10.466970588930874, -19.771945667436015, 30.169342109097247, -5.066043014652658, -1.762684294656137, -2.2263734435201936, -20.06541787779623, -10.2743020261061, 36.31734116523907, 40.80293150563027, -3.5832419863828, 27.192372651163463, 4.653568692502233, 0.5903128962361293, -10.72939045810066, 24.1811988183993, -3.9464712392738135, 49.24695532662967, -11.99681870029451, -8.957200733064154, -12.537746272103256, -11.552805097506186, -6.918970184838218, 19.26029499992206, -0.029612785336774094, -5.3836581116331175, -16.555209762813487, -18.009895341209074, -16.682389997264718, 11.006765848079981, -6.652244438318623, -11.096652231525109, -10.286370200245416, 29.107595752880332, -25.768749946743043, -9.802081229242807, -12.268113341282193, 0.45779907550384946, -9.53909502754822, -10.564533193436056, -5.725635668016465, 4.421489813704537, -7.093111161759057, 29.77844288715488, -2.836846716923428, -10.05796092145479, -4.9152680322971465, -17.152694183414223, -22.472245042896787, -6.648555640024197, 4.179408227686239, -10.052059237208052, -4.841107561223648, -17.167375797076257, -9.963736069671052, 33.862020260813786, 36.696809728230555, 11.68948637510183, 29.855531511363104, -6.000843548957173, -6.528043910487897, -9.533545858555684, -12.075615419436666, -15.300654761845465, -5.133913323299966, -16.20025389384923, -2.5824614213558346, -13.664865543912846, -5.14218689748073, 11.515620182165469, -14.920659484271752, 2.7060529721040685, 40.23700177844813, -24.708478557573198, -15.925996531039505, -2.4081262803172234, -18.336801420702106, 21.456942043023687, 6.4146089051283965, -1.4914262337137265, -12.568536369493374, 3.6945318209469735, -2.1764015222927324, 51.55618214262552, -0.3600654506491373, -4.314335071057964, -4.345309188235948, 9.772760431230532, -16.785100740345438, 13.793452833282398, -5.608688001775573, -19.13320075904727, -9.89594362953429, -8.44717879546029, -10.087436216025187, -5.245054776588194, 6.95987167756755, -12.650998814411066, -14.920077108251022, 21.805268045619663, 1.2322983542536785, 11.078537686149962, -13.464886461982108, 3.2539246493549547, 2.1584886718552507, -23.270451855813093, 19.22852336516043, -9.068966483140576, 30.431708261693863, 42.0013068973119, -6.9604832372636345, -5.503618069836499, -5.5143135931686995, -9.952774202608579, 5.868411916596016, 2.3882788562333257, -0.5013214489281725, 23.324178862203524, -12.435612368797443, -6.601268761104712, -2.3705211371892188, -4.488306025538346, -8.593202437308307, -15.045109372352522, 5.62625355492316, 44.495838163655584, -5.668516365918471, 42.92157809050513, -8.982643553153801, -7.6440497824825435, -4.079646598171847, 0.03416665603364226, 0.5044583606784799, 22.49724868189658, 7.603861407250538, -7.212244837786782, -6.22397065363645, 9.057806884904348, -4.046896338142491, 5.178565160978444, 27.072436786965998, 19.52149261937489]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.668719752528968, "mean_inference_ms": 0.8254225971655685, "mean_action_processing_ms": 0.136720957943698, "mean_env_wait_ms": 2.0050450391192878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002234339714050293, "StateBufferConnector_ms": 0.00218963623046875, "ViewRequirementAgentConnector_ms": 0.05543076992034912}, "num_episodes": 29, "episode_return_max": 105.64218214262549, "episode_return_min": 65.49628683314221, "episode_return_mean": 80.65603725155187, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131705, "num_agent_steps_trained": 131705, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 135.59697486777142, "num_env_steps_trained_throughput_per_sec": 135.59697486777142, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 131705, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 131705, "timers": {"training_iteration_time_ms": 26008.96, "restore_workers_time_ms": 0.008, "training_step_time_ms": 26008.937, "sample_time_ms": 24093.436, "learn_time_ms": 1915.259, "learn_throughput": 2088.49, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 131705, "num_agent_steps_trained": 131705}, "done": false, "training_iteration": 11, "trial_id": "default", "date": "2025-10-13_04-44-06", "timestamp": 1760345046, "time_this_iter_s": 29.49981713294983, "time_total_s": 277.2322988510132, "pid": 49179, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x177984c20>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x177984d60>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 277.2322988510132, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.214285714285715, "ram_util_percent": 35.28809523809524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 0.0001, "total_loss": 1.632890055860792, "policy_loss": -0.008423922620418052, "vf_loss": 3.302182699006701, "vf_explained_var": 0.6806872488960387, "kl": 0.004385915425275523, "entropy": 9.778222040146117, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.52380952380952, "num_grad_updates_lifetime": 7225.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 9.765624999999999e-05, "cur_lr": 0.00010000000000000002, "total_loss": 3.312098654359579, "policy_loss": -0.004164290224434808, "vf_loss": 6.652847276628018, "vf_explained_var": 0.01600862219929695, "kl": 0.0037054144656482046, "entropy": 10.161053705215455, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3680.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 143676, "num_agent_steps_trained": 143676}, "env_runners": {"episode_reward_max": 105.64218214262549, "episode_reward_min": 65.5507777047993, "episode_reward_mean": 80.35493978083986, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 18.787982575500138, "hider_policy": -29.980722557886892}, "policy_reward_max": {"seeker_policy": 111.26672255788688, "hider_policy": 51.55618214262552}, "policy_reward_mean": {"seeker_policy": 79.0289102335943, "hider_policy": 0.6630147736227784}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.3753421090973, 75.73758017142245, 68.89006081053428, 95.90825524636948, 86.73837265116347, 83.45674523851497, 88.62719881839932, 103.49295532662957, 72.5574771731474, 67.99319490249374, 75.80629499992202, 79.71905341778087, 67.68455061180852, 84.19276584807997, 76.86934776847491, 86.97359575288039, 65.5507777047993, 72.68379907550383, 72.22144137055865, 73.51348119934075, 87.96444288715487, 71.32514147209677, 73.11073196770285, 69.76200412613802, 80.04540822768625, 71.30489243877639, 90.08802026081378, 92.06280972823055, 88.06153151136303, 72.42581574658706, 70.45014460259432, 71.9720866767, 76.5835385786442, 82.5616201821655, 79.872052972104, 94.30300177844808, 73.75787371968273, 85.66294204302366, 81.78463530631798, 76.90053182094695, 105.64218214262549, 75.59937763949833, 83.95876043123049, 83.95945283328244, 68.49719374027532, 67.39218515449322, 74.18094522341178, 82.82587167756745, 86.05126804561966, 85.10453768614985, 78.88624034382566, 76.3743403839911, 84.57452336516039, 96.42730689731184, 71.97332911959585, 71.62012528864857, 79.64649934233789, 87.73017886220354, 66.30129704569727, 79.09971630629285, 70.83335387929795, 98.90183816365548, 98.06757809050511, 70.04845811721552, 75.46028965223312, 87.74324868189663, 79.70986140725051, 82.33380688490455, 82.2445651609784, 89.8604119864003, 75.42759897377336, 94.31002919901502, 66.6117964116556, 86.98023004520088, 91.5226703153291, 80.16347932822482, 91.69126078654507, 73.43593993900227, 74.59985703285926, 87.06147864748723, 79.72663075584309, 74.47426783100667, 82.95781496073496, 72.74604446171983, 67.00511956047518, 82.92907202249668, 75.32822521187975, 87.20839072160213, 86.09782260125209, 77.55291175203381, 82.50557665046188, 83.11700479129591, 79.29754522064461, 67.58451579925928, 77.89722560052067, 76.36754832724522, 83.35225143440394, 84.58893392559257, 90.6527400897166, 83.25973588905262], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [64.2720430146527, 79.72663790959878, 99.22978071443664, 18.787982575500138, 63.1292419863828, 78.21286364977661, 75.17539045810061, 58.192471239273836, 93.51149660650617, 92.08374627210327, 63.46497018483817, 85.13232431475072, 102.2496557158311, 89.86838999726473, 94.61824443831864, 68.15237020024541, 101.12160888078525, 84.49411334128217, 92.32506959154291, 74.8176270536527, 65.27911116175903, 84.21994911047499, 95.17869418341422, 98.88280480905902, 85.9180592372081, 93.31337579707626, 66.18973606967106, 43.676513624898156, 64.20684354895718, 88.48740551563067, 97.82641478387644, 93.30625389384927, 92.83086554391286, 76.18818689748073, 92.08665948427172, 78.77447855757318, 92.09199653103951, 82.54280142070213, 76.86145263490333, 85.77453636949333, 56.26240152229271, 80.27377816120548, 78.53130918823595, 86.95110074034544, 93.23908250109815, 85.7353075794878, 89.51343621602521, 88.51699881441098, 79.16607710825103, 72.79370164574628, 89.0972021564528, 97.486303567949, 74.41496648314057, 23.994291738306146, 84.43743042669593, 87.08721308442587, 71.38980856950857, 64.90732144892814, 85.33817817559944, 85.95854346902044, 94.47166568895875, 48.779746445076846, 60.814516365918436, 86.67515145285194, 79.50576959437134, 64.74154163932157, 79.31824483778675, 79.49997065363652, 81.11289633814248, 43.26648258005944, 93.78352143404726, 60.432808814014095, 84.12617489583546, 59.06538195128585, 39.814637739104015, 111.26672255788688, 74.55529401595942, 92.28845937741255, 92.3234898259869, 42.92281888916345, 85.80916972168409, 105.48120430464945, 79.36068062850201, 86.51374074342876, 83.04718630223786, 96.99824136221282, 85.67713748250503, 66.60623143135587, 82.39432271307071, 87.79645965487862, 75.88278938830278, 82.8878328604206, 85.62945244047933, 89.62323213486972, 77.38760032484103, 94.69026939688216, 95.99451723012015, 57.74264735270209, 41.906234557496525, 65.40015831474982], "policy_hider_policy_reward": [30.169342109097247, -5.066043014652658, -1.762684294656137, -2.2263734435201936, -20.06541787779623, -10.2743020261061, 36.31734116523907, 40.80293150563027, -3.5832419863828, 27.192372651163463, 4.653568692502233, 0.5903128962361293, -10.72939045810066, 24.1811988183993, -3.9464712392738135, 49.24695532662967, -11.99681870029451, -8.957200733064154, -12.537746272103256, -11.552805097506186, -6.918970184838218, 19.26029499992206, -0.029612785336774094, -5.3836581116331175, -16.555209762813487, -18.009895341209074, -16.682389997264718, 11.006765848079981, -6.652244438318623, -11.096652231525109, -10.286370200245416, 29.107595752880332, -25.768749946743043, -9.802081229242807, -12.268113341282193, 0.45779907550384946, -9.53909502754822, -10.564533193436056, -5.725635668016465, 4.421489813704537, -7.093111161759057, 29.77844288715488, -2.836846716923428, -10.05796092145479, -4.9152680322971465, -17.152694183414223, -22.472245042896787, -6.648555640024197, 4.179408227686239, -10.052059237208052, -4.841107561223648, -17.167375797076257, -9.963736069671052, 33.862020260813786, 36.696809728230555, 11.68948637510183, 29.855531511363104, -6.000843548957173, -6.528043910487897, -9.533545858555684, -12.075615419436666, -15.300654761845465, -5.133913323299966, -16.20025389384923, -2.5824614213558346, -13.664865543912846, -5.14218689748073, 11.515620182165469, -14.920659484271752, 2.7060529721040685, 40.23700177844813, -24.708478557573198, -15.925996531039505, -2.4081262803172234, -18.336801420702106, 21.456942043023687, 6.4146089051283965, -1.4914262337137265, -12.568536369493374, 3.6945318209469735, -2.1764015222927324, 51.55618214262552, -0.3600654506491373, -4.314335071057964, -4.345309188235948, 9.772760431230532, -16.785100740345438, 13.793452833282398, -5.608688001775573, -19.13320075904727, -9.89594362953429, -8.44717879546029, -10.087436216025187, -5.245054776588194, 6.95987167756755, -12.650998814411066, -14.920077108251022, 21.805268045619663, 1.2322983542536785, 11.078537686149962, -13.464886461982108, 3.2539246493549547, 2.1584886718552507, -23.270451855813093, 19.22852336516043, -9.068966483140576, 30.431708261693863, 42.0013068973119, -6.9604832372636345, -5.503618069836499, -5.5143135931686995, -9.952774202608579, 5.868411916596016, 2.3882788562333257, -0.5013214489281725, 23.324178862203524, -12.435612368797443, -6.601268761104712, -2.3705211371892188, -4.488306025538346, -8.593202437308307, -15.045109372352522, 5.62625355492316, 44.495838163655584, -5.668516365918471, 42.92157809050513, -8.982643553153801, -7.6440497824825435, -4.079646598171847, 0.03416665603364226, 0.5044583606784799, 22.49724868189658, 7.603861407250538, -7.212244837786782, -6.22397065363645, 9.057806884904348, -4.046896338142491, 5.178565160978444, 27.072436786965998, 19.52149261937489, -18.095687662106084, -0.26023479816778455, -5.096808814014125, 38.974029199015, -12.443110545411253, -5.071267938768621, 6.4642744219386, 21.450573671976386, 34.016670315328845, 17.691362260895975, -29.980722557886892, -1.1225206717751164, -16.279294015959444, 33.41526078654505, -5.980060060997754, -12.872459377412566, -2.7261429671406803, -14.997489825986884, 18.69481133239039, 25.443848425933368, 3.690630755843047, -9.773169721684031, -13.701530871216857, -17.305405602425935, 7.483209273004769, -3.886074940771844, -15.241892581584313, 1.4741962998753917, -6.766334459677281, -9.275732282085443, -20.83224136221286, 6.763072022496747, -5.841675323040149, -4.507236947585166, 22.06239072160224, -1.4602314313559053, 15.381822601252068, -11.678322713070681, -10.491506006334333, 0.24795810348955954, -6.656789388302811, 13.279576650461888, 5.2710047912959626, -5.041832860420642, 2.1315452206446572, -8.463452440479328, -13.423370556384683, -8.615345779225734, -3.5575217414467963, 4.0671470171264685, 3.889887322587838, -22.21260839222476, -18.788517230120156, 6.146251434403919, 16.775347589904193, 10.070938982986231, 32.56674008971654, 16.179765442503452, 5.779602472809664, 12.079975101493147]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7567646980144502, "mean_inference_ms": 0.8279295985510433, "mean_action_processing_ms": 0.13723739067431034, "mean_env_wait_ms": 2.028502268757287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022104978561401367, "StateBufferConnector_ms": 0.0021753311157226562, "ViewRequirementAgentConnector_ms": 0.0553661584854126}, "num_episodes": 30, "episode_return_max": 105.64218214262549, "episode_return_min": 65.5507777047993, "episode_return_mean": 80.35493978083986, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143676, "num_agent_steps_trained": 143676, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.47489182821442, "num_env_steps_trained_throughput_per_sec": 153.47489182821442, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 143676, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 143676, "timers": {"training_iteration_time_ms": 26863.302, "restore_workers_time_ms": 0.009, "training_step_time_ms": 26863.279, "sample_time_ms": 24966.795, "learn_time_ms": 1896.243, "learn_throughput": 2109.435, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 143676, "num_agent_steps_trained": 143676}, "done": false, "training_iteration": 12, "trial_id": "default", "date": "2025-10-13_04-44-32", "timestamp": 1760345072, "time_this_iter_s": 26.063508987426758, "time_total_s": 303.29580783843994, "pid": 49179, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x177984c20>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x177984d60>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 303.29580783843994, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 32.381578947368425, "ram_util_percent": 35.747368421052634}}
