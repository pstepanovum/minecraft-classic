{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48923526583239435, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.00010000000000000002, "total_loss": 4.711670638620854, "policy_loss": -0.0041162436449667435, "vf_loss": 9.450572009384633, "vf_explained_var": -0.0013723501935601235, "kl": 0.0025472043654701793, "entropy": 10.008598509430886, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49724167817168763, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0001, "total_loss": 2.731207377191574, "policy_loss": -0.004398844686765519, "vf_loss": 5.490173645625039, "vf_explained_var": 0.01137616823589991, "kl": 0.002216335169688526, "entropy": 9.92385967194088, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": 183.2801176216643, "episode_reward_min": 143.21170495803835, "episode_reward_mean": 162.29763321507812, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 3915, "policy_reward_min": {"seeker_policy": 25.140295029854226, "hider_policy": 29.95763950935248}, "policy_reward_max": {"seeker_policy": 79.57821976689583, "hider_policy": 93.24411762166434}, "policy_reward_mean": {"seeker_policy": 61.89777484456628, "hider_policy": 50.19992918525591}, "custom_metrics": {}, "hist_stats": {"episode_reward": [183.2801176216643, 175.59374363294688, 162.90215241869487, 177.07616291394652, 153.36523502702596, 156.33226192700238, 169.9706152795462, 163.61809155141336, 174.34894374696995, 167.19619164743295, 162.2061956750685, 154.88672207263875, 162.92491106508106, 157.7471051457663, 156.15585125958097, 156.67804104341016, 145.17493620302295, 160.81935176704928, 157.47640526754896, 152.6428339848722, 155.57120115938056, 151.83453421283997, 167.5807919369546, 157.5901870435243, 163.75959110326357, 143.21170495803835, 173.2111679257277, 167.96818436377515, 175.50813128307783], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [25.140295029854226, 67.30330277337929, 70.43806917561422, 54.429364002176996, 65.01013755882818, 79.57821976689583, 61.07241229433828, 65.01329864952865, 37.17995071574198, 67.71595329149882, 75.26836049064747, 71.8798332747647, 63.82614297267139, 59.55828794472556, 66.6625230417232, 76.07156913474341, 78.87236757992157, 65.69772530688769, 51.3128618758865, 71.9385963057707, 70.3969658939411, 69.59935934179643, 46.611514585972714, 52.130669954653726, 73.42568838434924, 76.07855512314698, 41.52299408661942, 50.15133537329501, 41.149116563048366], "policy_hider_policy_reward": [64.89570497014579, 93.24411762166434, 40.8726972266207, 67.41774363294692, 38.77793082438579, 53.686152418694896, 76.86016291394652, 45.786635997823, 41.08952629488877, 47.26557117330903, 45.65441020562464, 31.099631954481893, 64.89461527954619, 44.003587705661715, 54.546754043917545, 44.05803885796716, 89.16294374696994, 48.00604928425802, 61.44019164743301, 38.04004670850118, 29.95763950935248, 56.98019567506855, 41.68334441306398, 41.32354438481008, 43.299857027328585, 55.79891106508107, 48.425612301316306, 49.763204899724435, 39.753476958276764, 49.73985125958092, 38.687668926925724, 41.91880298174105, 32.3209589528344, 33.981609670267005, 60.373351767049336, 34.74827469311229, 57.94040526754897, 48.223138124113504, 34.127403694229294, 46.57683398487221, 45.51520115938056, 39.65903410605894, 34.39664065820357, 47.83853421283997, 49.18448541402727, 71.78479193695455, 54.79360776369874, 50.665909325171896, 58.69359110326356, 31.640311615650724, 34.07570495803836, 33.057444876853, 44.12300591338058, 87.56516792572766, 78.86218436377519, 38.95466462670499, 91.24213128307775, 43.11688343695161]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0980280957440085, "mean_inference_ms": 0.8496141707828655, "mean_action_processing_ms": 0.14453010540013309, "mean_env_wait_ms": 1.8032476086224416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023212926141146957, "StateBufferConnector_ms": 0.002304027820455617, "ViewRequirementAgentConnector_ms": 0.05594204212057179}, "num_episodes": 29, "episode_return_max": 183.2801176216643, "episode_return_min": 143.21170495803835, "episode_return_mean": 162.29763321507812, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 229.48633093218152, "num_env_steps_trained_throughput_per_sec": 229.48633093218152, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 17430.239, "restore_workers_time_ms": 0.01, "training_step_time_ms": 17430.208, "sample_time_ms": 15632.213, "learn_time_ms": 1797.771, "learn_throughput": 2224.978, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 1, "trial_id": "default", "date": "2025-10-13_18-22-41", "timestamp": 1760394161, "time_this_iter_s": 17.43062400817871, "time_total_s": 17.43062400817871, "pid": 12406, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x318074f40>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x318075080>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.43062400817871, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.116, "ram_util_percent": 31.24}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.228384242206812, "policy_loss": -0.0037568351370282473, "vf_loss": 6.483926644921302, "vf_explained_var": 0.016593562625348567, "kl": 0.0020067322607674343, "entropy": 10.022924268245697, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000002, "total_loss": 2.6774852256621084, "policy_loss": -0.005876024352056124, "vf_loss": 5.385745173884977, "vf_explained_var": 0.032967764427584985, "kl": 0.0035324705920259268, "entropy": 9.864568056598786, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.87096774193549, "num_grad_updates_lifetime": 940.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 23928, "num_agent_steps_trained": 23928}, "env_runners": {"episode_reward_max": 183.2801176216643, "episode_reward_min": 124.62121969131283, "episode_reward_mean": 160.2522989266436, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 7965, "policy_reward_min": {"seeker_policy": 22.526699388644285, "hider_policy": -4.249031088172467}, "policy_reward_max": {"seeker_policy": 82.8116501692502, "hider_policy": 93.24411762166434}, "policy_reward_mean": {"seeker_policy": 62.00140589442191, "hider_policy": 49.12544651611085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [183.2801176216643, 175.59374363294688, 162.90215241869487, 177.07616291394652, 153.36523502702596, 156.33226192700238, 169.9706152795462, 163.61809155141336, 174.34894374696995, 167.19619164743295, 162.2061956750685, 154.88672207263875, 162.92491106508106, 157.7471051457663, 156.15585125958097, 156.67804104341016, 145.17493620302295, 160.81935176704928, 157.47640526754896, 152.6428339848722, 155.57120115938056, 151.83453421283997, 167.5807919369546, 157.5901870435243, 163.75959110326357, 143.21170495803835, 173.2111679257277, 167.96818436377515, 175.50813128307783, 158.65640047599135, 161.40748569802153, 151.62712525153827, 152.3782024440389, 149.52031706705856, 148.09254034308395, 172.01874181630606, 149.921238921052, 153.41699171031058, 169.73379633611864, 160.81897520902916, 162.67907497601232, 164.897522610965, 168.1011772001205, 148.28816601678813, 124.62121969131283, 161.56896070350535, 159.4148400546396, 177.7305208693494, 150.05282383301898, 164.55835186351428, 150.4427875674058, 160.28217615732592, 160.6970883888461, 154.55697620976332, 167.1414296131087, 169.59734803895017, 156.65387374259086, 167.2351007058059, 152.14301991913618], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [25.140295029854226, 67.30330277337929, 70.43806917561422, 54.429364002176996, 65.01013755882818, 79.57821976689583, 61.07241229433828, 65.01329864952865, 37.17995071574198, 67.71595329149882, 75.26836049064747, 71.8798332747647, 63.82614297267139, 59.55828794472556, 66.6625230417232, 76.07156913474341, 78.87236757992157, 65.69772530688769, 51.3128618758865, 71.9385963057707, 70.3969658939411, 69.59935934179643, 46.611514585972714, 52.130669954653726, 73.42568838434924, 76.07855512314698, 41.52299408661942, 50.15133537329501, 41.149116563048366, 64.99528503650096, 82.8116501692502, 66.45771259745504, 68.20773084107365, 67.27157411196634, 74.98184937887301, 52.38615046420517, 70.17374206174023, 68.80916709498759, 47.70609389191655, 55.00789671461655, 56.12287943543974, 59.128178722307126, 55.47445293107849, 73.94644005530714, 76.37497364836186, 55.6379029484269, 55.10431690559167, 22.526699388644285, 58.95266726322677, 44.546161008066235, 77.80211054412888, 80.14159957880955, 66.47122000113393, 79.03562743902214, 52.117358746226785, 47.2116150868808, 77.22928750479208, 35.65506370127399, 70.76007000716739], "policy_hider_policy_reward": [64.89570497014579, 93.24411762166434, 40.8726972266207, 67.41774363294692, 38.77793082438579, 53.686152418694896, 76.86016291394652, 45.786635997823, 41.08952629488877, 47.26557117330903, 45.65441020562464, 31.099631954481893, 64.89461527954619, 44.003587705661715, 54.546754043917545, 44.05803885796716, 89.16294374696994, 48.00604928425802, 61.44019164743301, 38.04004670850118, 29.95763950935248, 56.98019567506855, 41.68334441306398, 41.32354438481008, 43.299857027328585, 55.79891106508107, 48.425612301316306, 49.763204899724435, 39.753476958276764, 49.73985125958092, 38.687668926925724, 41.91880298174105, 32.3209589528344, 33.981609670267005, 60.373351767049336, 34.74827469311229, 57.94040526754897, 48.223138124113504, 34.127403694229294, 46.57683398487221, 45.51520115938056, 39.65903410605894, 34.39664065820357, 47.83853421283997, 49.18448541402727, 71.78479193695455, 54.79360776369874, 50.665909325171896, 58.69359110326356, 31.640311615650724, 34.07570495803836, 33.057444876853, 44.12300591338058, 87.56516792572766, 78.86218436377519, 38.95466462670499, 91.24213128307775, 43.11688343695161, 55.12040047599136, 38.54071496349905, 22.46434983074976, 56.131485698021585, 41.11860761143285, 44.05080504265038, 50.24566704245478, 33.92480456051045, 35.04442588803364, 47.20431706705856, 31.620113955655672, 41.49057700855525, 36.0198495357948, 83.61274181630603, 37.9671576761547, 41.7803391831571, 38.541306824415116, 46.06651779090791, 38.83990610808345, 83.18779633611874, 39.40810328538346, 66.40297520902912, 40.10312056456023, 66.45307497601243, 40.71782127769288, 65.05152261096508, 70.97517720012053, 41.6515470689215, 42.91216601678812, 31.42955994469291, 52.49527713112343, -4.249031088172467, 48.618097051573116, 57.312960703505325, 52.78445948595377, 51.52606366309415, 93.23452086934927, 61.969300611355735, 48.99631455898654, 42.1038420108057, 73.92235186351428, 46.08983899193379, 29.326380190526322, 43.31429683275055, 31.504400421190454, 48.63617615732597, 52.50108838884602, 41.72477999886608, 30.190372560977828, 45.33097620976338, 39.428641253773236, 75.59542961310864, 78.10134803895012, 44.28438491311918, 43.387873742590855, 36.03671249520795, 64.38793607746464, 67.19210092706734, 39.955929992832644, 41.42701991913614]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1066810245798668, "mean_inference_ms": 0.8470465045231284, "mean_action_processing_ms": 0.14488823711558244, "mean_env_wait_ms": 1.8032490081765753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024534888186697234, "StateBufferConnector_ms": 0.0023399369191315213, "ViewRequirementAgentConnector_ms": 0.057471808740648174}, "num_episodes": 30, "episode_return_max": 183.2801176216643, "episode_return_min": 124.62121969131283, "episode_return_mean": 160.2522989266436, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23928, "num_agent_steps_trained": 23928, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 228.38053874380287, "num_env_steps_trained_throughput_per_sec": 228.38053874380287, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 23928, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 23928, "timers": {"training_iteration_time_ms": 17472.435, "restore_workers_time_ms": 0.008, "training_step_time_ms": 17472.41, "sample_time_ms": 15680.141, "learn_time_ms": 1792.052, "learn_throughput": 2232.078, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 23928, "num_agent_steps_trained": 23928}, "done": false, "training_iteration": 2, "trial_id": "default", "date": "2025-10-13_18-22-59", "timestamp": 1760394179, "time_this_iter_s": 17.514997720718384, "time_total_s": 34.945621728897095, "pid": 12406, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x318074f40>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x318075080>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.945621728897095, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.292, "ram_util_percent": 31.316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00010000000000000002, "total_loss": 3.290465082973242, "policy_loss": -0.0025268960554967633, "vf_loss": 6.605895480513572, "vf_explained_var": 0.010473746992647647, "kl": 0.002227597392719989, "entropy": 10.067142495512963, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 800.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 2.618812527732244, "policy_loss": -0.006310574942460609, "vf_loss": 5.269679458936055, "vf_explained_var": 0.04538818285578773, "kl": 0.003051589447017659, "entropy": 9.869209786066934, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.96825396825396, "num_grad_updates_lifetime": 1565.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 35927, "num_agent_steps_trained": 35927}, "env_runners": {"episode_reward_max": 183.2801176216643, "episode_reward_min": 124.62121969131283, "episode_reward_mean": 160.39420452446706, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 11880, "policy_reward_min": {"seeker_policy": 22.526699388644285, "hider_policy": -15.065458606039543}, "policy_reward_max": {"seeker_policy": 98.03190479310662, "hider_policy": 93.24411762166434}, "policy_reward_mean": {"seeker_policy": 61.97623341899066, "hider_policy": 49.2089855527382}, "custom_metrics": {}, "hist_stats": {"episode_reward": [183.2801176216643, 175.59374363294688, 162.90215241869487, 177.07616291394652, 153.36523502702596, 156.33226192700238, 169.9706152795462, 163.61809155141336, 174.34894374696995, 167.19619164743295, 162.2061956750685, 154.88672207263875, 162.92491106508106, 157.7471051457663, 156.15585125958097, 156.67804104341016, 145.17493620302295, 160.81935176704928, 157.47640526754896, 152.6428339848722, 155.57120115938056, 151.83453421283997, 167.5807919369546, 157.5901870435243, 163.75959110326357, 143.21170495803835, 173.2111679257277, 167.96818436377515, 175.50813128307783, 158.65640047599135, 161.40748569802153, 151.62712525153827, 152.3782024440389, 149.52031706705856, 148.09254034308395, 172.01874181630606, 149.921238921052, 153.41699171031058, 169.73379633611864, 160.81897520902916, 162.67907497601232, 164.897522610965, 168.1011772001205, 148.28816601678813, 124.62121969131283, 161.56896070350535, 159.4148400546396, 177.7305208693494, 150.05282383301898, 164.55835186351428, 150.4427875674058, 160.28217615732592, 160.6970883888461, 154.55697620976332, 167.1414296131087, 169.59734803895017, 156.65387374259086, 167.2351007058059, 152.14301991913618, 160.43946007364775, 162.6279782825481, 160.4114437898868, 168.71711417695468, 160.84543705043018, 157.1340283452942, 142.99433017814493, 155.15896554667964, 166.17275361778655, 164.64342387213637, 148.53218186418, 156.64251808549324, 165.37005243179732, 175.33307776012526, 160.90458503978329, 171.38622153704426, 158.17213115191336, 158.6276047189503, 151.99022478870535, 150.50885809188617, 167.49050862438648, 169.11273475164452, 169.73412514035147, 169.96669240704483, 161.70586227365033, 146.10922015473545, 160.08385364205003, 151.41209084606805, 167.5768832378085], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [25.140295029854226, 67.30330277337929, 70.43806917561422, 54.429364002176996, 65.01013755882818, 79.57821976689583, 61.07241229433828, 65.01329864952865, 37.17995071574198, 67.71595329149882, 75.26836049064747, 71.8798332747647, 63.82614297267139, 59.55828794472556, 66.6625230417232, 76.07156913474341, 78.87236757992157, 65.69772530688769, 51.3128618758865, 71.9385963057707, 70.3969658939411, 69.59935934179643, 46.611514585972714, 52.130669954653726, 73.42568838434924, 76.07855512314698, 41.52299408661942, 50.15133537329501, 41.149116563048366, 64.99528503650096, 82.8116501692502, 66.45771259745504, 68.20773084107365, 67.27157411196634, 74.98184937887301, 52.38615046420517, 70.17374206174023, 68.80916709498759, 47.70609389191655, 55.00789671461655, 56.12287943543974, 59.128178722307126, 55.47445293107849, 73.94644005530714, 76.37497364836186, 55.6379029484269, 55.10431690559167, 22.526699388644285, 58.95266726322677, 44.546161008066235, 77.80211054412888, 80.14159957880955, 66.47122000113393, 79.03562743902214, 52.117358746226785, 47.2116150868808, 77.22928750479208, 35.65506370127399, 70.76007000716739, 74.07537433009894, 53.796528317739515, 48.53518574548346, 35.024500244042045, 57.675118100513146, 68.11591805638255, 98.03190479310662, 72.42647441151318, 52.44840837311983, 74.31158638288181, 83.2074733431958, 76.98882416022515, 45.31275684938298, 36.795937128581684, 76.86890103504774, 40.53125299038888, 65.9093763823524, 72.23356608740649, 74.55311884219714, 74.36353980357093, 49.05956692562759, 42.526983917455794, 51.648447921306186, 43.831395512757865, 68.85429597546805, 63.29188381610852, 71.05308615860518, 74.22431313622192, 50.12987435950397], "policy_hider_policy_reward": [64.89570497014579, 93.24411762166434, 40.8726972266207, 67.41774363294692, 38.77793082438579, 53.686152418694896, 76.86016291394652, 45.786635997823, 41.08952629488877, 47.26557117330903, 45.65441020562464, 31.099631954481893, 64.89461527954619, 44.003587705661715, 54.546754043917545, 44.05803885796716, 89.16294374696994, 48.00604928425802, 61.44019164743301, 38.04004670850118, 29.95763950935248, 56.98019567506855, 41.68334441306398, 41.32354438481008, 43.299857027328585, 55.79891106508107, 48.425612301316306, 49.763204899724435, 39.753476958276764, 49.73985125958092, 38.687668926925724, 41.91880298174105, 32.3209589528344, 33.981609670267005, 60.373351767049336, 34.74827469311229, 57.94040526754897, 48.223138124113504, 34.127403694229294, 46.57683398487221, 45.51520115938056, 39.65903410605894, 34.39664065820357, 47.83853421283997, 49.18448541402727, 71.78479193695455, 54.79360776369874, 50.665909325171896, 58.69359110326356, 31.640311615650724, 34.07570495803836, 33.057444876853, 44.12300591338058, 87.56516792572766, 78.86218436377519, 38.95466462670499, 91.24213128307775, 43.11688343695161, 55.12040047599136, 38.54071496349905, 22.46434983074976, 56.131485698021585, 41.11860761143285, 44.05080504265038, 50.24566704245478, 33.92480456051045, 35.04442588803364, 47.20431706705856, 31.620113955655672, 41.49057700855525, 36.0198495357948, 83.61274181630603, 37.9671576761547, 41.7803391831571, 38.541306824415116, 46.06651779090791, 38.83990610808345, 83.18779633611874, 39.40810328538346, 66.40297520902912, 40.10312056456023, 66.45307497601243, 40.71782127769288, 65.05152261096508, 70.97517720012053, 41.6515470689215, 42.91216601678812, 31.42955994469291, 52.49527713112343, -4.249031088172467, 48.618097051573116, 57.312960703505325, 52.78445948595377, 51.52606366309415, 93.23452086934927, 61.969300611355735, 48.99631455898654, 42.1038420108057, 73.92235186351428, 46.08983899193379, 29.326380190526322, 43.31429683275055, 31.504400421190454, 48.63617615732597, 52.50108838884602, 41.72477999886608, 30.190372560977828, 45.33097620976338, 39.428641253773236, 75.59542961310864, 78.10134803895012, 44.28438491311918, 43.387873742590855, 36.03671249520795, 64.38793607746464, 67.19210092706734, 39.955929992832644, 41.42701991913614, 34.24062566990105, 52.12346007364772, 56.656992090523715, 52.17445787428481, 63.06544378988684, 48.81081425451651, 57.071499755957966, 76.6211141769547, 52.75375605016257, 50.41656289975441, 42.843916982962575, 46.17419330594913, -15.065458606039543, 60.027883991077836, 42.99296554667967, 39.739525588486806, 64.90675361778653, 48.81759162688016, 52.76742387213628, 37.56441361711823, 35.87190776690409, 29.452800754080084, 49.27651808549317, 30.377175839774807, 66.00197829341275, 54.055317289001614, 91.18707776012519, 47.350062871418324, 50.71858503978335, 33.31709896495225, 87.84022153704424, 43.01474700961111, 40.94662361764761, 51.3161311519133, 49.50160471895035, 36.89243391259349, 40.82679595834785, 36.610309988160395, 33.592235561572274, 42.55308272674305, 75.34450862438648, 43.086433074372444, 77.69673475164453, 48.8890160825442, 40.06755207869381, 78.0181251403514, 76.7606924070449, 49.37460448724215, 49.69986227365029, 43.151704024531966, 42.340314902659976, 40.47702143596703, 48.137853642050096, 40.89291384139476, 34.51446328607392, 42.67331442377215, 72.0308832378085, 45.416125640496034]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1071692783525282, "mean_inference_ms": 0.8438494840992555, "mean_action_processing_ms": 0.144641755151659, "mean_env_wait_ms": 1.8005931741408716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024599107829007235, "StateBufferConnector_ms": 0.0023463910276239567, "ViewRequirementAgentConnector_ms": 0.05719756538217718}, "num_episodes": 29, "episode_return_max": 183.2801176216643, "episode_return_min": 124.62121969131283, "episode_return_mean": 160.39420452446706, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35927, "num_agent_steps_trained": 35927, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.24070602249722, "num_env_steps_trained_throughput_per_sec": 233.24070602249722, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 35927, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 35927, "timers": {"training_iteration_time_ms": 17364.846, "restore_workers_time_ms": 0.008, "training_step_time_ms": 17364.823, "sample_time_ms": 15585.959, "learn_time_ms": 1778.652, "learn_throughput": 2248.894, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 35927, "num_agent_steps_trained": 35927}, "done": false, "training_iteration": 3, "trial_id": "default", "date": "2025-10-13_18-23-16", "timestamp": 1760394196, "time_this_iter_s": 17.15011715888977, "time_total_s": 52.095738887786865, "pid": 12406, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x318074f40>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x318075080>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 52.095738887786865, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 28.46, "ram_util_percent": 31.391999999999992}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.00010000000000000002, "total_loss": 3.0483527407050133, "policy_loss": -0.005506449744279962, "vf_loss": 6.12782798409462, "vf_explained_var": -0.02867539320141077, "kl": 0.002446141346189997, "entropy": 10.115963524580001, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1120.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.0001, "total_loss": 2.2878716769672574, "policy_loss": -0.005437832001951479, "vf_loss": 4.606011347922068, "vf_explained_var": 0.022389320248649234, "kl": 0.0037345672039016775, "entropy": 9.789522140745133, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.87301587301587, "num_grad_updates_lifetime": 2195.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 47920, "num_agent_steps_trained": 47920}, "env_runners": {"episode_reward_max": 177.7305208693494, "episode_reward_min": 124.62121969131283, "episode_reward_mean": 158.70679152991653, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 22.526699388644285, "hider_policy": -15.065458606039543}, "policy_reward_max": {"seeker_policy": 98.75097839903664, "hider_policy": 93.23452086934927}, "policy_reward_mean": {"seeker_policy": 62.39645847000439, "hider_policy": 48.15516652995606}, "custom_metrics": {}, "hist_stats": {"episode_reward": [157.47640526754896, 152.6428339848722, 155.57120115938056, 151.83453421283997, 167.5807919369546, 157.5901870435243, 163.75959110326357, 143.21170495803835, 173.2111679257277, 167.96818436377515, 175.50813128307783, 158.65640047599135, 161.40748569802153, 151.62712525153827, 152.3782024440389, 149.52031706705856, 148.09254034308395, 172.01874181630606, 149.921238921052, 153.41699171031058, 169.73379633611864, 160.81897520902916, 162.67907497601232, 164.897522610965, 168.1011772001205, 148.28816601678813, 124.62121969131283, 161.56896070350535, 159.4148400546396, 177.7305208693494, 150.05282383301898, 164.55835186351428, 150.4427875674058, 160.28217615732592, 160.6970883888461, 154.55697620976332, 167.1414296131087, 169.59734803895017, 156.65387374259086, 167.2351007058059, 152.14301991913618, 160.43946007364775, 162.6279782825481, 160.4114437898868, 168.71711417695468, 160.84543705043018, 157.1340283452942, 142.99433017814493, 155.15896554667964, 166.17275361778655, 164.64342387213637, 148.53218186418, 156.64251808549324, 165.37005243179732, 175.33307776012526, 160.90458503978329, 171.38622153704426, 158.17213115191336, 158.6276047189503, 151.99022478870535, 150.50885809188617, 167.49050862438648, 169.11273475164452, 169.73412514035147, 169.96669240704483, 161.70586227365033, 146.10922015473545, 160.08385364205003, 151.41209084606805, 167.5768832378085, 154.22956065832534, 146.65238203429823, 125.76052255018203, 149.75804176013943, 157.72327941547357, 163.65091685908925, 155.29521994555242, 150.78383410668857, 162.08263572919986, 162.62552660735574, 155.00121335487978, 160.80018226724616, 167.48891920779423, 162.66700068093996, 166.1200406407512, 152.80807939306754, 162.7414384807139, 159.459711235408, 155.72568513414882, 165.60030459225607, 167.90780768518653, 146.980666605027, 154.9930017839721, 149.22366413566021, 151.55009396660444, 159.91774703561043, 158.6621236210242, 153.7653085244091, 154.99966591353262, 161.29121091227665], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [51.3128618758865, 71.9385963057707, 70.3969658939411, 69.59935934179643, 46.611514585972714, 52.130669954653726, 73.42568838434924, 76.07855512314698, 41.52299408661942, 50.15133537329501, 41.149116563048366, 64.99528503650096, 82.8116501692502, 66.45771259745504, 68.20773084107365, 67.27157411196634, 74.98184937887301, 52.38615046420517, 70.17374206174023, 68.80916709498759, 47.70609389191655, 55.00789671461655, 56.12287943543974, 59.128178722307126, 55.47445293107849, 73.94644005530714, 76.37497364836186, 55.6379029484269, 55.10431690559167, 22.526699388644285, 58.95266726322677, 44.546161008066235, 77.80211054412888, 80.14159957880955, 66.47122000113393, 79.03562743902214, 52.117358746226785, 47.2116150868808, 77.22928750479208, 35.65506370127399, 70.76007000716739, 74.07537433009894, 53.796528317739515, 48.53518574548346, 35.024500244042045, 57.675118100513146, 68.11591805638255, 98.03190479310662, 72.42647441151318, 52.44840837311983, 74.31158638288181, 83.2074733431958, 76.98882416022515, 45.31275684938298, 36.795937128581684, 76.86890103504774, 40.53125299038888, 65.9093763823524, 72.23356608740649, 74.55311884219714, 74.36353980357093, 49.05956692562759, 42.526983917455794, 51.648447921306186, 43.831395512757865, 68.85429597546805, 63.29188381610852, 71.05308615860518, 74.22431313622192, 50.12987435950397, 63.21626316112817, 68.44172409307478, 98.75097839903664, 62.888646307452206, 61.3711038131018, 54.19636157536662, 80.40298358001756, 67.99544167490856, 54.36950609478602, 56.27787919686784, 76.24343682566611, 62.13007304342486, 51.261173583134166, 61.983468646710875, 50.52919086664623, 78.4512767208493, 68.78060375587631, 64.84909660056526, 56.421321883359184, 55.58811406274029, 37.18332494035866, 66.40919994851953, 58.529538550144025, 68.01169162700057, 65.18652791015201, 78.15566893498008, 64.25098987602125, 62.939726265538795, 70.47999607918905, 71.15981111658685], "policy_hider_policy_reward": [57.94040526754897, 48.223138124113504, 34.127403694229294, 46.57683398487221, 45.51520115938056, 39.65903410605894, 34.39664065820357, 47.83853421283997, 49.18448541402727, 71.78479193695455, 54.79360776369874, 50.665909325171896, 58.69359110326356, 31.640311615650724, 34.07570495803836, 33.057444876853, 44.12300591338058, 87.56516792572766, 78.86218436377519, 38.95466462670499, 91.24213128307775, 43.11688343695161, 55.12040047599136, 38.54071496349905, 22.46434983074976, 56.131485698021585, 41.11860761143285, 44.05080504265038, 50.24566704245478, 33.92480456051045, 35.04442588803364, 47.20431706705856, 31.620113955655672, 41.49057700855525, 36.0198495357948, 83.61274181630603, 37.9671576761547, 41.7803391831571, 38.541306824415116, 46.06651779090791, 38.83990610808345, 83.18779633611874, 39.40810328538346, 66.40297520902912, 40.10312056456023, 66.45307497601243, 40.71782127769288, 65.05152261096508, 70.97517720012053, 41.6515470689215, 42.91216601678812, 31.42955994469291, 52.49527713112343, -4.249031088172467, 48.618097051573116, 57.312960703505325, 52.78445948595377, 51.52606366309415, 93.23452086934927, 61.969300611355735, 48.99631455898654, 42.1038420108057, 73.92235186351428, 46.08983899193379, 29.326380190526322, 43.31429683275055, 31.504400421190454, 48.63617615732597, 52.50108838884602, 41.72477999886608, 30.190372560977828, 45.33097620976338, 39.428641253773236, 75.59542961310864, 78.10134803895012, 44.28438491311918, 43.387873742590855, 36.03671249520795, 64.38793607746464, 67.19210092706734, 39.955929992832644, 41.42701991913614, 34.24062566990105, 52.12346007364772, 56.656992090523715, 52.17445787428481, 63.06544378988684, 48.81081425451651, 57.071499755957966, 76.6211141769547, 52.75375605016257, 50.41656289975441, 42.843916982962575, 46.17419330594913, -15.065458606039543, 60.027883991077836, 42.99296554667967, 39.739525588486806, 64.90675361778653, 48.81759162688016, 52.76742387213628, 37.56441361711823, 35.87190776690409, 29.452800754080084, 49.27651808549317, 30.377175839774807, 66.00197829341275, 54.055317289001614, 91.18707776012519, 47.350062871418324, 50.71858503978335, 33.31709896495225, 87.84022153704424, 43.01474700961111, 40.94662361764761, 51.3161311519133, 49.50160471895035, 36.89243391259349, 40.82679595834785, 36.610309988160395, 33.592235561572274, 42.55308272674305, 75.34450862438648, 43.086433074372444, 77.69673475164453, 48.8890160825442, 40.06755207869381, 78.0181251403514, 76.7606924070449, 49.37460448724215, 49.69986227365029, 43.151704024531966, 42.340314902659976, 40.47702143596703, 48.137853642050096, 40.89291384139476, 34.51446328607392, 42.67331442377215, 72.0308832378085, 45.416125640496034, 49.56356065832533, 41.44973683887182, 39.88096361499755, 38.32969432622585, -11.027082503479003, 38.03662665462441, 42.50153808802003, 44.3678573646672, 47.82887833155923, 48.5232972708125, 53.60118016213384, 55.853375121588776, 29.913016419982423, 44.97921994555247, 44.162601744547885, 38.62579068723211, 51.6646409828806, 56.04848865153332, 49.088120803132156, 57.25952660735565, 44.49185690445516, 34.26591962475844, 53.58306765021182, 45.08704157360944, 76.34291920779425, 39.88482641686579, 63.431000680939974, 37.252531353289086, 65.8340406407512, 49.75680913335378, 37.02120789356861, 37.33559477864965, 54.03543848071385, 39.9253962441237, 46.23690339943468, 48.373711235408095, 54.4164618803706, 44.88790137041896, 71.43430459225598, 38.577885937259694, 59.494695827270284, 71.2297869175576, 39.20410037129268, 41.36736628521481, 47.003006535146326, 49.46045669868171, 40.66537217028583, 40.5466003383738, 40.05905089589496, 46.304515160557465, 30.930331065019917, 50.83174703561046, 50.116123621024194, 44.29501012397875, 41.206273734461234, 49.619308524409114, 39.95705773656008, 44.56261209778355, 35.966188883413146, 54.16521091227664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2117519880081178, "mean_inference_ms": 0.8412904184298235, "mean_action_processing_ms": 0.1446890276826001, "mean_env_wait_ms": 1.8215261495294102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024455785751342773, "StateBufferConnector_ms": 0.0023096799850463867, "ViewRequirementAgentConnector_ms": 0.05756223201751709}, "num_episodes": 30, "episode_return_max": 177.7305208693494, "episode_return_min": 124.62121969131283, "episode_return_mean": 158.70679152991653, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47920, "num_agent_steps_trained": 47920, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 165.9315263793856, "num_env_steps_trained_throughput_per_sec": 165.9315263793856, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 47920, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 47920, "timers": {"training_iteration_time_ms": 19050.218, "restore_workers_time_ms": 0.007, "training_step_time_ms": 19050.195, "sample_time_ms": 17268.817, "learn_time_ms": 1781.125, "learn_throughput": 2245.771, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 47920, "num_agent_steps_trained": 47920}, "done": false, "training_iteration": 4, "trial_id": "default", "date": "2025-10-13_18-23-40", "timestamp": 1760394220, "time_this_iter_s": 24.106916666030884, "time_total_s": 76.20265555381775, "pid": 12406, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x318074f40>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x318075080>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 76.20265555381775, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 26.070588235294114, "ram_util_percent": 31.226470588235287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.3214655838906766, "policy_loss": -0.004979136172914877, "vf_loss": 6.673206974565983, "vf_explained_var": -0.03692039102315903, "kl": 0.0027988420697854124, "entropy": 10.193751859664918, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000002, "total_loss": 2.579164626905995, "policy_loss": -0.007616274912969299, "vf_loss": 5.192992559556038, "vf_explained_var": 0.027079001742024576, "kl": 0.004181813054777298, "entropy": 9.767657346110191, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.40322580645162, "num_grad_updates_lifetime": 2820.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 59819, "num_agent_steps_trained": 59819}, "env_runners": {"episode_reward_max": 181.8339609194465, "episode_reward_min": 118.26112575169475, "episode_reward_mean": 158.1363465415476, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": -2.4927726908599936, "hider_policy": -15.065458606039543}, "policy_reward_max": {"seeker_policy": 98.75097839903664, "hider_policy": 97.50796091944645}, "policy_reward_mean": {"seeker_policy": 62.98460754299022, "hider_policy": 47.57586949927868}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.05282383301898, 164.55835186351428, 150.4427875674058, 160.28217615732592, 160.6970883888461, 154.55697620976332, 167.1414296131087, 169.59734803895017, 156.65387374259086, 167.2351007058059, 152.14301991913618, 160.43946007364775, 162.6279782825481, 160.4114437898868, 168.71711417695468, 160.84543705043018, 157.1340283452942, 142.99433017814493, 155.15896554667964, 166.17275361778655, 164.64342387213637, 148.53218186418, 156.64251808549324, 165.37005243179732, 175.33307776012526, 160.90458503978329, 171.38622153704426, 158.17213115191336, 158.6276047189503, 151.99022478870535, 150.50885809188617, 167.49050862438648, 169.11273475164452, 169.73412514035147, 169.96669240704483, 161.70586227365033, 146.10922015473545, 160.08385364205003, 151.41209084606805, 167.5768832378085, 154.22956065832534, 146.65238203429823, 125.76052255018203, 149.75804176013943, 157.72327941547357, 163.65091685908925, 155.29521994555242, 150.78383410668857, 162.08263572919986, 162.62552660735574, 155.00121335487978, 160.80018226724616, 167.48891920779423, 162.66700068093996, 166.1200406407512, 152.80807939306754, 162.7414384807139, 159.459711235408, 155.72568513414882, 165.60030459225607, 167.90780768518653, 146.980666605027, 154.9930017839721, 149.22366413566021, 151.55009396660444, 159.91774703561043, 158.6621236210242, 153.7653085244091, 154.99966591353262, 161.29121091227665, 167.84920033660507, 159.26488050197713, 158.93283326626843, 157.11804067700305, 161.04270839736563, 172.11229745484425, 148.06335275516113, 149.28608550866267, 158.18811798379872, 177.51346713139014, 149.723065878073, 160.9825835763652, 150.4635867302103, 161.53718722763887, 146.22174477387694, 149.44468534209108, 157.29168149324715, 167.7992245370587, 158.3209412236433, 156.28206478655807, 153.01896831327267, 161.11285869942782, 153.70980169572712, 181.8339609194465, 166.1188229224469, 162.92428995481424, 118.26112575169475, 122.16191493179068, 164.05189089222046, 153.57214813467158], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [58.95266726322677, 44.546161008066235, 77.80211054412888, 80.14159957880955, 66.47122000113393, 79.03562743902214, 52.117358746226785, 47.2116150868808, 77.22928750479208, 35.65506370127399, 70.76007000716739, 74.07537433009894, 53.796528317739515, 48.53518574548346, 35.024500244042045, 57.675118100513146, 68.11591805638255, 98.03190479310662, 72.42647441151318, 52.44840837311983, 74.31158638288181, 83.2074733431958, 76.98882416022515, 45.31275684938298, 36.795937128581684, 76.86890103504774, 40.53125299038888, 65.9093763823524, 72.23356608740649, 74.55311884219714, 74.36353980357093, 49.05956692562759, 42.526983917455794, 51.648447921306186, 43.831395512757865, 68.85429597546805, 63.29188381610852, 71.05308615860518, 74.22431313622192, 50.12987435950397, 63.21626316112817, 68.44172409307478, 98.75097839903664, 62.888646307452206, 61.3711038131018, 54.19636157536662, 80.40298358001756, 67.99544167490856, 54.36950609478602, 56.27787919686784, 76.24343682566611, 62.13007304342486, 51.261173583134166, 61.983468646710875, 50.52919086664623, 78.4512767208493, 68.78060375587631, 64.84909660056526, 56.421321883359184, 55.58811406274029, 37.18332494035866, 66.40919994851953, 58.529538550144025, 68.01169162700057, 65.18652791015201, 78.15566893498008, 64.25098987602125, 62.939726265538795, 70.47999607918905, 71.15981111658685, 29.747426834437913, 58.601999938694235, 73.30322695352103, 63.05329039537858, 60.697055212113966, 36.1219866554938, 67.68434797040659, 82.77002817839194, 75.09449944909984, -2.4927726908599936, 68.93236469275837, 63.45600649785567, 73.09383212406638, 57.00289172630673, 70.6609432507129, 71.60383799363406, 68.18419839521019, 49.6477048923238, 77.85987517379415, 81.63441947421138, 81.42330139538218, 61.53293012398146, 70.95414385064777, 29.2124874862722, 39.48361616149877, 54.059811687610875, 98.44553154649417, 98.20681562853045, 38.58949633611863, 77.69196385071663], "policy_hider_policy_reward": [48.99631455898654, 42.1038420108057, 73.92235186351428, 46.08983899193379, 29.326380190526322, 43.31429683275055, 31.504400421190454, 48.63617615732597, 52.50108838884602, 41.72477999886608, 30.190372560977828, 45.33097620976338, 39.428641253773236, 75.59542961310864, 78.10134803895012, 44.28438491311918, 43.387873742590855, 36.03671249520795, 64.38793607746464, 67.19210092706734, 39.955929992832644, 41.42701991913614, 34.24062566990105, 52.12346007364772, 56.656992090523715, 52.17445787428481, 63.06544378988684, 48.81081425451651, 57.071499755957966, 76.6211141769547, 52.75375605016257, 50.41656289975441, 42.843916982962575, 46.17419330594913, -15.065458606039543, 60.027883991077836, 42.99296554667967, 39.739525588486806, 64.90675361778653, 48.81759162688016, 52.76742387213628, 37.56441361711823, 35.87190776690409, 29.452800754080084, 49.27651808549317, 30.377175839774807, 66.00197829341275, 54.055317289001614, 91.18707776012519, 47.350062871418324, 50.71858503978335, 33.31709896495225, 87.84022153704424, 43.01474700961111, 40.94662361764761, 51.3161311519133, 49.50160471895035, 36.89243391259349, 40.82679595834785, 36.610309988160395, 33.592235561572274, 42.55308272674305, 75.34450862438648, 43.086433074372444, 77.69673475164453, 48.8890160825442, 40.06755207869381, 78.0181251403514, 76.7606924070449, 49.37460448724215, 49.69986227365029, 43.151704024531966, 42.340314902659976, 40.47702143596703, 48.137853642050096, 40.89291384139476, 34.51446328607392, 42.67331442377215, 72.0308832378085, 45.416125640496034, 49.56356065832533, 41.44973683887182, 39.88096361499755, 38.32969432622585, -11.027082503479003, 38.03662665462441, 42.50153808802003, 44.3678573646672, 47.82887833155923, 48.5232972708125, 53.60118016213384, 55.853375121588776, 29.913016419982423, 44.97921994555247, 44.162601744547885, 38.62579068723211, 51.6646409828806, 56.04848865153332, 49.088120803132156, 57.25952660735565, 44.49185690445516, 34.26591962475844, 53.58306765021182, 45.08704157360944, 76.34291920779425, 39.88482641686579, 63.431000680939974, 37.252531353289086, 65.8340406407512, 49.75680913335378, 37.02120789356861, 37.33559477864965, 54.03543848071385, 39.9253962441237, 46.23690339943468, 48.373711235408095, 54.4164618803706, 44.88790137041896, 71.43430459225598, 38.577885937259694, 59.494695827270284, 71.2297869175576, 39.20410037129268, 41.36736628521481, 47.003006535146326, 49.46045669868171, 40.66537217028583, 40.5466003383738, 40.05905089589496, 46.304515160557465, 30.930331065019917, 50.83174703561046, 50.116123621024194, 44.29501012397875, 41.206273734461234, 49.619308524409114, 39.95705773656008, 44.56261209778355, 35.966188883413146, 54.16521091227664, 67.99494463028756, 70.10682887187961, 53.56272030603283, 47.100160257250124, 44.49683326626844, 41.132773046478974, 47.722040677003065, 46.34270960462139, 55.61670839736563, 44.72894478788606, 48.56401334450624, 87.42629745484427, 41.71575384300716, 38.66325094174744, 37.14065920494481, 29.375398125325933, 50.97211798379872, 32.12150055090014, 87.18877269085999, 92.81746713139016, 46.55252188716625, 34.23817929814828, 49.56295684699904, 47.96362023151052, 25.645473995277843, 51.72428061086607, 51.539176366957875, 52.99511913437422, 38.0586572957576, 37.50214422740642, 39.25536634281907, 38.58548100563799, 49.66580180386639, 39.44168129417059, 47.20829510767616, 70.94322453705877, 33.536124826205835, 46.92494122364331, 29.18158052578859, 45.46606478655818, 29.943927554709635, 41.65173936318083, 46.51306987601851, 53.06685869942787, 40.253176414332685, 42.50248143074668, 55.11351251372782, 97.50796091944645, 52.68238383850126, 73.95282292244691, 54.38055041054895, 54.4839278566544, 34.09407320670512, -14.278479001504557, 34.237817519558945, -10.28271821629874, 71.91741198390295, 53.54498257219892, 46.28614813467162, 29.594036149283422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3104077698854988, "mean_inference_ms": 0.8385511924388642, "mean_action_processing_ms": 0.1445985152744684, "mean_env_wait_ms": 1.8437656830873326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002524256706237793, "StateBufferConnector_ms": 0.0023450851440429688, "ViewRequirementAgentConnector_ms": 0.0579988956451416}, "num_episodes": 30, "episode_return_max": 181.8339609194465, "episode_return_min": 118.26112575169475, "episode_return_mean": 158.1363465415476, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59819, "num_agent_steps_trained": 59819, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.2918564814101, "num_env_steps_trained_throughput_per_sec": 213.2918564814101, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 59819, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 59819, "timers": {"training_iteration_time_ms": 18990.905, "restore_workers_time_ms": 0.007, "training_step_time_ms": 18990.88, "sample_time_ms": 17233.201, "learn_time_ms": 1757.44, "learn_throughput": 2276.038, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 59819, "num_agent_steps_trained": 59819}, "done": false, "training_iteration": 5, "trial_id": "default", "date": "2025-10-13_18-23-59", "timestamp": 1760394239, "time_this_iter_s": 18.754178047180176, "time_total_s": 94.95683360099792, "pid": 12406, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x318074f40>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x318075080>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 94.95683360099792, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.72307692307692, "ram_util_percent": 31.307692307692314}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 0.00010000000000000002, "total_loss": 3.256261672079563, "policy_loss": -0.006032790374592878, "vf_loss": 6.544973629713058, "vf_explained_var": -0.053279098495841025, "kl": 0.0030130035489033848, "entropy": 10.211177960038185, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1760.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.00625, "cur_lr": 0.00010000000000000002, "total_loss": 2.5598632258753624, "policy_loss": -0.006802309502757365, "vf_loss": 5.152813321544278, "vf_explained_var": 0.03632317867971236, "kl": 0.0033487909743364105, "entropy": 9.762053895765735, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.19354838709677, "num_grad_updates_lifetime": 3440.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 71705, "num_agent_steps_trained": 71705}, "env_runners": {"episode_reward_max": 186.9664701689031, "episode_reward_min": 114.8077336105482, "episode_reward_mean": 157.23177086909297, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": -3.231471316835595, "hider_policy": -14.278479001504557}, "policy_reward_max": {"seeker_policy": 98.75097839903664, "hider_policy": 99.6804701689031}, "policy_reward_mean": {"seeker_policy": 63.47781776142562, "hider_policy": 46.876976553833686}, "custom_metrics": {}, "hist_stats": {"episode_reward": [151.99022478870535, 150.50885809188617, 167.49050862438648, 169.11273475164452, 169.73412514035147, 169.96669240704483, 161.70586227365033, 146.10922015473545, 160.08385364205003, 151.41209084606805, 167.5768832378085, 154.22956065832534, 146.65238203429823, 125.76052255018203, 149.75804176013943, 157.72327941547357, 163.65091685908925, 155.29521994555242, 150.78383410668857, 162.08263572919986, 162.62552660735574, 155.00121335487978, 160.80018226724616, 167.48891920779423, 162.66700068093996, 166.1200406407512, 152.80807939306754, 162.7414384807139, 159.459711235408, 155.72568513414882, 165.60030459225607, 167.90780768518653, 146.980666605027, 154.9930017839721, 149.22366413566021, 151.55009396660444, 159.91774703561043, 158.6621236210242, 153.7653085244091, 154.99966591353262, 161.29121091227665, 167.84920033660507, 159.26488050197713, 158.93283326626843, 157.11804067700305, 161.04270839736563, 172.11229745484425, 148.06335275516113, 149.28608550866267, 158.18811798379872, 177.51346713139014, 149.723065878073, 160.9825835763652, 150.4635867302103, 161.53718722763887, 146.22174477387694, 149.44468534209108, 157.29168149324715, 167.7992245370587, 158.3209412236433, 156.28206478655807, 153.01896831327267, 161.11285869942782, 153.70980169572712, 181.8339609194465, 166.1188229224469, 162.92428995481424, 118.26112575169475, 122.16191493179068, 164.05189089222046, 153.57214813467158, 162.99910773670416, 160.28980266815512, 186.9664701689031, 158.259283558125, 161.5651295158873, 166.32904593008902, 155.945244981902, 166.88622275653478, 142.46755362539676, 158.26761074257863, 146.2638796733906, 156.68401603877436, 151.14689560144757, 163.63136166581165, 164.54501425215298, 185.91932953120872, 158.2859755696707, 157.20741401107375, 147.71381340430773, 158.23772029933878, 145.0084598801684, 152.07308660915638, 159.05900253225423, 157.7915804924097, 166.13438797159222, 141.4457675795123, 114.8077336105482, 160.48247685050427, 150.60332905920356], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [74.55311884219714, 74.36353980357093, 49.05956692562759, 42.526983917455794, 51.648447921306186, 43.831395512757865, 68.85429597546805, 63.29188381610852, 71.05308615860518, 74.22431313622192, 50.12987435950397, 63.21626316112817, 68.44172409307478, 98.75097839903664, 62.888646307452206, 61.3711038131018, 54.19636157536662, 80.40298358001756, 67.99544167490856, 54.36950609478602, 56.27787919686784, 76.24343682566611, 62.13007304342486, 51.261173583134166, 61.983468646710875, 50.52919086664623, 78.4512767208493, 68.78060375587631, 64.84909660056526, 56.421321883359184, 55.58811406274029, 37.18332494035866, 66.40919994851953, 58.529538550144025, 68.01169162700057, 65.18652791015201, 78.15566893498008, 64.25098987602125, 62.939726265538795, 70.47999607918905, 71.15981111658685, 29.747426834437913, 58.601999938694235, 73.30322695352103, 63.05329039537858, 60.697055212113966, 36.1219866554938, 67.68434797040659, 82.77002817839194, 75.09449944909984, -2.4927726908599936, 68.93236469275837, 63.45600649785567, 73.09383212406638, 57.00289172630673, 70.6609432507129, 71.60383799363406, 68.18419839521019, 49.6477048923238, 77.85987517379415, 81.63441947421138, 81.42330139538218, 61.53293012398146, 70.95414385064777, 29.2124874862722, 39.48361616149877, 54.059811687610875, 98.44553154649417, 98.20681562853045, 38.58949633611863, 77.69196385071663, 79.93286390828575, 84.98681042466177, -3.231471316835595, 85.6857199039614, 68.26602498458047, 49.99765311151819, 67.64545650394354, 61.23708869171023, 74.4210283531231, 68.41968581203906, 86.05781320526957, 64.46110357068926, 80.62633671594217, 75.59826685384138, 40.149428792651065, -3.1511305720747878, 56.137953339870634, 69.20230054028545, 73.8825450744676, 64.54390900708523, 75.99591166631677, 69.24758849514247, 65.8540453731523, 63.79352722494991, 56.8353253701044, 79.75080122809658, 64.01234613979793, 74.7519303935029, 76.42202665965083], "policy_hider_policy_reward": [40.82679595834785, 36.610309988160395, 33.592235561572274, 42.55308272674305, 75.34450862438648, 43.086433074372444, 77.69673475164453, 48.8890160825442, 40.06755207869381, 78.0181251403514, 76.7606924070449, 49.37460448724215, 49.69986227365029, 43.151704024531966, 42.340314902659976, 40.47702143596703, 48.137853642050096, 40.89291384139476, 34.51446328607392, 42.67331442377215, 72.0308832378085, 45.416125640496034, 49.56356065832533, 41.44973683887182, 39.88096361499755, 38.32969432622585, -11.027082503479003, 38.03662665462441, 42.50153808802003, 44.3678573646672, 47.82887833155923, 48.5232972708125, 53.60118016213384, 55.853375121588776, 29.913016419982423, 44.97921994555247, 44.162601744547885, 38.62579068723211, 51.6646409828806, 56.04848865153332, 49.088120803132156, 57.25952660735565, 44.49185690445516, 34.26591962475844, 53.58306765021182, 45.08704157360944, 76.34291920779425, 39.88482641686579, 63.431000680939974, 37.252531353289086, 65.8340406407512, 49.75680913335378, 37.02120789356861, 37.33559477864965, 54.03543848071385, 39.9253962441237, 46.23690339943468, 48.373711235408095, 54.4164618803706, 44.88790137041896, 71.43430459225598, 38.577885937259694, 59.494695827270284, 71.2297869175576, 39.20410037129268, 41.36736628521481, 47.003006535146326, 49.46045669868171, 40.66537217028583, 40.5466003383738, 40.05905089589496, 46.304515160557465, 30.930331065019917, 50.83174703561046, 50.116123621024194, 44.29501012397875, 41.206273734461234, 49.619308524409114, 39.95705773656008, 44.56261209778355, 35.966188883413146, 54.16521091227664, 67.99494463028756, 70.10682887187961, 53.56272030603283, 47.100160257250124, 44.49683326626844, 41.132773046478974, 47.722040677003065, 46.34270960462139, 55.61670839736563, 44.72894478788606, 48.56401334450624, 87.42629745484427, 41.71575384300716, 38.66325094174744, 37.14065920494481, 29.375398125325933, 50.97211798379872, 32.12150055090014, 87.18877269085999, 92.81746713139016, 46.55252188716625, 34.23817929814828, 49.56295684699904, 47.96362023151052, 25.645473995277843, 51.72428061086607, 51.539176366957875, 52.99511913437422, 38.0586572957576, 37.50214422740642, 39.25536634281907, 38.58548100563799, 49.66580180386639, 39.44168129417059, 47.20829510767616, 70.94322453705877, 33.536124826205835, 46.92494122364331, 29.18158052578859, 45.46606478655818, 29.943927554709635, 41.65173936318083, 46.51306987601851, 53.06685869942787, 40.253176414332685, 42.50248143074668, 55.11351251372782, 97.50796091944645, 52.68238383850126, 73.95282292244691, 54.38055041054895, 54.4839278566544, 34.09407320670512, -14.278479001504557, 34.237817519558945, -10.28271821629874, 71.91741198390295, 53.54498257219892, 46.28614813467162, 29.594036149283422, 52.033107736704125, 31.033136091714237, 28.759189575338286, 46.543802668155124, 99.6804701689031, 90.51747131683558, 45.41328355812493, 27.16028009603864, 40.18997501541952, 53.1091295158873, 71.87304593008898, 44.458346888481834, 47.594671247512345, 40.70511723044616, 69.74022275653473, 35.90891130828979, 36.18155362539671, 31.86497164687693, 51.22161074257856, 38.6263141879609, 33.19787967339062, 27.008186794730406, 48.941843400677755, 43.28106906740734, 38.14089560144764, 32.3796632840578, 54.56536166581165, 33.46773314615861, 52.947796268138596, 71.4477891913634, 95.34539320039951, 93.72506690288412, 56.555046223769146, 45.59297600603096, 48.961414011073764, 39.043699459714524, 35.44387767679232, 38.38739065304782, 50.11172029933877, 43.582090992914786, 36.768445875163884, 32.24410233868777, 41.201786209928116, 41.623711904085766, 34.061954626847665, 59.14300253225427, 48.60136804719371, 45.39668522026605, 38.64067462989561, 70.65838797159223, 31.396762821669338, 30.29820352974631, -0.16220885815293684, 50.9575963289032, 53.136476850504295, 32.59406960649705, 44.45732905920359, 29.723973340349165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4431366229560654, "mean_inference_ms": 0.8384132973119549, "mean_action_processing_ms": 0.14455396908491097, "mean_env_wait_ms": 1.8752989874050405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023790597915649414, "StateBufferConnector_ms": 0.0022524595260620117, "ViewRequirementAgentConnector_ms": 0.056371331214904785}, "num_episodes": 29, "episode_return_max": 186.9664701689031, "episode_return_min": 114.8077336105482, "episode_return_mean": 157.23177086909297, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71705, "num_agent_steps_trained": 71705, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 174.98049186104527, "num_env_steps_trained_throughput_per_sec": 174.98049186104527, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 71705, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 71705, "timers": {"training_iteration_time_ms": 19635.703, "restore_workers_time_ms": 0.007, "training_step_time_ms": 19635.68, "sample_time_ms": 17882.57, "learn_time_ms": 1752.874, "learn_throughput": 2281.967, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 71705, "num_agent_steps_trained": 71705}, "done": false, "training_iteration": 6, "trial_id": "default", "date": "2025-10-13_18-24-22", "timestamp": 1760394262, "time_this_iter_s": 22.860241889953613, "time_total_s": 117.81707549095154, "pid": 12406, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x318074f40>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x318075080>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 117.81707549095154, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 26.812121212121212, "ram_util_percent": 31.263636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.20171679854393, "policy_loss": -0.008042505696357694, "vf_loss": 6.439815336465836, "vf_explained_var": -0.022693396545946598, "kl": 0.003742309251595799, "entropy": 10.16008556187153, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2080.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 0.0001, "total_loss": 2.4953540347871326, "policy_loss": -0.007873571144106488, "vf_loss": 5.0259391076981075, "vf_explained_var": 0.07406827485750592, "kl": 0.003962531744498079, "entropy": 9.754323421962678, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4065.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 83705, "num_agent_steps_trained": 83705}, "env_runners": {"episode_reward_max": 186.9664701689031, "episode_reward_min": 114.8077336105482, "episode_reward_mean": 157.45100483132418, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": -3.231471316835595, "hider_policy": -14.278479001504557}, "policy_reward_max": {"seeker_policy": 98.44553154649417, "hider_policy": 99.6804701689031}, "policy_reward_mean": {"seeker_policy": 64.61118365188383, "hider_policy": 46.41991058972018}, "custom_metrics": {}, "hist_stats": {"episode_reward": [165.60030459225607, 167.90780768518653, 146.980666605027, 154.9930017839721, 149.22366413566021, 151.55009396660444, 159.91774703561043, 158.6621236210242, 153.7653085244091, 154.99966591353262, 161.29121091227665, 167.84920033660507, 159.26488050197713, 158.93283326626843, 157.11804067700305, 161.04270839736563, 172.11229745484425, 148.06335275516113, 149.28608550866267, 158.18811798379872, 177.51346713139014, 149.723065878073, 160.9825835763652, 150.4635867302103, 161.53718722763887, 146.22174477387694, 149.44468534209108, 157.29168149324715, 167.7992245370587, 158.3209412236433, 156.28206478655807, 153.01896831327267, 161.11285869942782, 153.70980169572712, 181.8339609194465, 166.1188229224469, 162.92428995481424, 118.26112575169475, 122.16191493179068, 164.05189089222046, 153.57214813467158, 162.99910773670416, 160.28980266815512, 186.9664701689031, 158.259283558125, 161.5651295158873, 166.32904593008902, 155.945244981902, 166.88622275653478, 142.46755362539676, 158.26761074257863, 146.2638796733906, 156.68401603877436, 151.14689560144757, 163.63136166581165, 164.54501425215298, 185.91932953120872, 158.2859755696707, 157.20741401107375, 147.71381340430773, 158.23772029933878, 145.0084598801684, 152.07308660915638, 159.05900253225423, 157.7915804924097, 166.13438797159222, 141.4457675795123, 114.8077336105482, 160.48247685050427, 150.60332905920356, 155.74391549100994, 164.18375134817393, 164.4978537032942, 158.2842875452676, 156.72554208102002, 156.06923944754544, 158.37531654227104, 154.93119833900246, 168.6554586206861, 158.48115079090735, 161.13152541072486, 156.82916596874867, 163.5807902066578, 157.5793040921031, 147.89305660627994, 163.73283808211465, 154.83029470006574, 153.5697822674316, 163.51644847428344, 166.8944046334608, 148.10136476145505, 157.26871228739546, 158.98354799260525, 159.6342553461805, 161.5526007815529, 155.09744185102187, 156.73508826750253, 152.34588700118718, 152.16132855630883, 171.60308904644788], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [55.58811406274029, 37.18332494035866, 66.40919994851953, 58.529538550144025, 68.01169162700057, 65.18652791015201, 78.15566893498008, 64.25098987602125, 62.939726265538795, 70.47999607918905, 71.15981111658685, 29.747426834437913, 58.601999938694235, 73.30322695352103, 63.05329039537858, 60.697055212113966, 36.1219866554938, 67.68434797040659, 82.77002817839194, 75.09449944909984, -2.4927726908599936, 68.93236469275837, 63.45600649785567, 73.09383212406638, 57.00289172630673, 70.6609432507129, 71.60383799363406, 68.18419839521019, 49.6477048923238, 77.85987517379415, 81.63441947421138, 81.42330139538218, 61.53293012398146, 70.95414385064777, 29.2124874862722, 39.48361616149877, 54.059811687610875, 98.44553154649417, 98.20681562853045, 38.58949633611863, 77.69196385071663, 79.93286390828575, 84.98681042466177, -3.231471316835595, 85.6857199039614, 68.26602498458047, 49.99765311151819, 67.64545650394354, 61.23708869171023, 74.4210283531231, 68.41968581203906, 86.05781320526957, 64.46110357068926, 80.62633671594217, 75.59826685384138, 40.149428792651065, -3.1511305720747878, 56.137953339870634, 69.20230054028545, 73.8825450744676, 64.54390900708523, 75.99591166631677, 69.24758849514247, 65.8540453731523, 63.79352722494991, 56.8353253701044, 79.75080122809658, 64.01234613979793, 74.7519303935029, 76.42202665965083, 60.67617975853861, 68.68695852530388, 47.7095748518059, 55.30615325335363, 62.26854960838902, 78.83944836463266, 74.29941677852275, 78.99363208228537, 58.14655699029008, 81.17042095015917, 57.61209002819078, 73.16144749540926, 62.03619935676474, 69.10872082469831, 86.18558814111736, 71.86729700860013, 76.54194747220828, 76.80134422509492, 63.252350732357, 50.69651815735763, 68.64739088499097, 81.02457347653628, 72.22184333646493, 60.82622434250993, 65.09445032846895, 88.53201491227618, 61.32691030567558, 58.57852364418051, 61.45419611409025, 44.36710328634524], "policy_hider_policy_reward": [71.43430459225598, 38.577885937259694, 59.494695827270284, 71.2297869175576, 39.20410037129268, 41.36736628521481, 47.003006535146326, 49.46045669868171, 40.66537217028583, 40.5466003383738, 40.05905089589496, 46.304515160557465, 30.930331065019917, 50.83174703561046, 50.116123621024194, 44.29501012397875, 41.206273734461234, 49.619308524409114, 39.95705773656008, 44.56261209778355, 35.966188883413146, 54.16521091227664, 67.99494463028756, 70.10682887187961, 53.56272030603283, 47.100160257250124, 44.49683326626844, 41.132773046478974, 47.722040677003065, 46.34270960462139, 55.61670839736563, 44.72894478788606, 48.56401334450624, 87.42629745484427, 41.71575384300716, 38.66325094174744, 37.14065920494481, 29.375398125325933, 50.97211798379872, 32.12150055090014, 87.18877269085999, 92.81746713139016, 46.55252188716625, 34.23817929814828, 49.56295684699904, 47.96362023151052, 25.645473995277843, 51.72428061086607, 51.539176366957875, 52.99511913437422, 38.0586572957576, 37.50214422740642, 39.25536634281907, 38.58548100563799, 49.66580180386639, 39.44168129417059, 47.20829510767616, 70.94322453705877, 33.536124826205835, 46.92494122364331, 29.18158052578859, 45.46606478655818, 29.943927554709635, 41.65173936318083, 46.51306987601851, 53.06685869942787, 40.253176414332685, 42.50248143074668, 55.11351251372782, 97.50796091944645, 52.68238383850126, 73.95282292244691, 54.38055041054895, 54.4839278566544, 34.09407320670512, -14.278479001504557, 34.237817519558945, -10.28271821629874, 71.91741198390295, 53.54498257219892, 46.28614813467162, 29.594036149283422, 52.033107736704125, 31.033136091714237, 28.759189575338286, 46.543802668155124, 99.6804701689031, 90.51747131683558, 45.41328355812493, 27.16028009603864, 40.18997501541952, 53.1091295158873, 71.87304593008898, 44.458346888481834, 47.594671247512345, 40.70511723044616, 69.74022275653473, 35.90891130828979, 36.18155362539671, 31.86497164687693, 51.22161074257856, 38.6263141879609, 33.19787967339062, 27.008186794730406, 48.941843400677755, 43.28106906740734, 38.14089560144764, 32.3796632840578, 54.56536166581165, 33.46773314615861, 52.947796268138596, 71.4477891913634, 95.34539320039951, 93.72506690288412, 56.555046223769146, 45.59297600603096, 48.961414011073764, 39.043699459714524, 35.44387767679232, 38.38739065304782, 50.11172029933877, 43.582090992914786, 36.768445875163884, 32.24410233868777, 41.201786209928116, 41.623711904085766, 34.061954626847665, 59.14300253225427, 48.60136804719371, 45.39668522026605, 38.64067462989561, 70.65838797159223, 31.396762821669338, 30.29820352974631, -0.16220885815293684, 50.9575963289032, 53.136476850504295, 32.59406960649705, 44.45732905920359, 29.723973340349165, 39.69666591685006, 55.37106981562131, 56.15775134817395, 39.339041474696145, 71.81595147295533, 44.972327378533, 59.84828754526757, 43.129846746646365, 42.02745039161097, 52.429542081020024, 48.443239447545494, 28.78655163536733, 39.17327402964931, 44.902625734098926, 41.9945683645184, 33.94299789219867, 34.69944300970987, 75.8094586206862, 49.415150790907354, 27.89557904984084, 56.535525410724844, 46.983909971809204, 45.16316596874873, 38.504552504590734, 64.09479020665782, 37.449800643235285, 44.85727917530167, 43.613304092103085, 29.20135376103595, 32.50611470412662, 56.05683808211471, 35.80870299139982, 43.92910296605231, 34.35924426180523, 41.343782267431614, 35.42465577490508, 65.18044847428348, 35.083649267643, 78.04840463346079, 38.14948184264239, 39.96533071226665, 39.488643164197455, 26.281426523463793, 49.96271228739547, 35.47557985367524, 51.28612480246504, 57.338255346180574, 41.46977565749003, 38.17154967153109, 58.28660078155292, 36.071441851021895, 30.49398508772381, 51.585775267314204, 43.82240269451277, 41.717476355819514, 52.049887001187145, 44.11203232574124, 46.59510011647744, 43.68889671365473, 83.5470890464479]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4977004883708247, "mean_inference_ms": 0.83952040747525, "mean_action_processing_ms": 0.14463413160106053, "mean_env_wait_ms": 1.894230844189517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024465322494506836, "StateBufferConnector_ms": 0.00228726863861084, "ViewRequirementAgentConnector_ms": 0.057193756103515625}, "num_episodes": 30, "episode_return_max": 186.9664701689031, "episode_return_min": 114.8077336105482, "episode_return_mean": 157.45100483132418, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83705, "num_agent_steps_trained": 83705, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.12138453496922, "num_env_steps_trained_throughput_per_sec": 221.12138453496922, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 83705, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 83705, "timers": {"training_iteration_time_ms": 19414.834, "restore_workers_time_ms": 0.007, "training_step_time_ms": 19414.811, "sample_time_ms": 17646.428, "learn_time_ms": 1768.147, "learn_throughput": 2262.256, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 83705, "num_agent_steps_trained": 83705}, "done": false, "training_iteration": 7, "trial_id": "default", "date": "2025-10-13_18-24-40", "timestamp": 1760394280, "time_this_iter_s": 18.090189933776855, "time_total_s": 135.9072654247284, "pid": 12406, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x318074f40>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x318075080>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 135.9072654247284, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 28.200000000000003, "ram_util_percent": 31.253846153846155}}
