{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4954456786625087, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.00010000000000000002, "total_loss": 3.991996741294861, "policy_loss": -0.003932177694514394, "vf_loss": 8.010899913311004, "vf_explained_var": 0.03113080430775881, "kl": 0.002007748549008426, "entropy": 9.922567689418793, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49973661833339267, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0001, "total_loss": 1.8327494821851216, "policy_loss": -0.005458045022798673, "vf_loss": 3.695165101308671, "vf_explained_var": 0.12051538276293922, "kl": 0.002628880238214535, "entropy": 9.90080463015844, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.68253968253968, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 11981, "num_agent_steps_trained": 11981}, "env_runners": {"episode_reward_max": 110.43663474366946, "episode_reward_min": 63.77817106969847, "episode_reward_mean": 82.28459835789803, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 3915, "policy_reward_min": {"seeker_policy": 8.817568440838986, "hider_policy": -29.261044293043454}, "policy_reward_max": {"seeker_policy": 107.50248015478002, "hider_policy": 50.818431559161006}, "policy_reward_mean": {"seeker_policy": 77.97684982278462, "hider_policy": 2.153874267556716}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.82346484809315, 94.09710704922108, 87.50973010232984, 73.05972810506539, 85.73271195524231, 93.13695497707646, 76.1814149296025, 89.84890499741387, 73.33499623179421, 82.89867379468937, 88.77930401221259, 63.77817106969847, 94.14505896153022, 110.43663474366946, 88.94413233634711, 70.29586958387722, 81.5029325810284, 66.97637957656812, 81.67340365051162, 94.0277312372039, 75.16643612594457, 86.92039404507845, 70.95796816994509, 90.97424926943943, 84.0753302800311, 84.582309581291, 64.94640321955849, 65.5895204067707, 65.85743653780882], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [66.41925616928876, 69.53274806639578, 84.94981252131107, 87.91575253194362, 70.21675914023173, 73.64375000974464, 88.58043115689179, 73.33872034179106, 96.72338678146605, 82.7529957586371, 71.73845783226068, 97.51033424153873, 52.03228291850745, 8.817568440838986, 106.52287608263218, 93.92211574624525, 98.05353592413817, 94.08664338400384, 74.5847442158697, 40.00415696906913, 80.28430666028424, 62.38085220407608, 86.70614868538749, 59.06645046293914, 90.20276999733055, 54.89117747563095, 97.90725736543943, 107.50248015478002, 91.04087362207962], "policy_hider_policy_reward": [32.74746484809313, 1.656743830711245, -6.186748066395809, 30.751107049221062, -7.663812521311066, 10.223730102329789, -10.014497627455974, -4.841526799422271, 13.446711955242243, 2.0692408597682874, 38.95095497707647, -19.45775000974464, 0.7411759118074429, -13.140192139096825, -17.01272034179103, 33.52290499741384, -7.031833504489122, -16.35655704518265, -7.886995758637081, 8.032673794689424, 25.39330401221268, -8.352457832260727, -15.427828930301466, -18.304334241538726, 2.1337170814925766, 39.9790589615302, 50.80063474366949, 50.818431559161006, -11.782528740198387, -5.796215006086648, -8.170130416122774, -15.456115746245219, -21.67753592413818, 5.126932581028461, -12.279436882474261, -14.830826924961448, -1.1420258729126658, 8.230685307554598, 14.161843030930845, 39.86173123720378, -2.8034835632846584, -2.3143869710549874, 5.174944557321038, 19.36459728368125, -8.146061170979493, -7.6021193444629445, 36.868249269439424, -4.960450462939138, -17.656769997330485, 11.529330280030948, 15.200239481008367, 14.490892624651663, -19.31275771793006, -13.648096427950911, -12.651915454965827, -29.261044293043454, -25.860608858055564, 0.67717177378477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1779030688075363, "mean_inference_ms": 0.8065018228398834, "mean_action_processing_ms": 0.12984772796363897, "mean_env_wait_ms": 1.9097720286572646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023101938181910022, "StateBufferConnector_ms": 0.002270320366168844, "ViewRequirementAgentConnector_ms": 0.05469486631196121}, "num_episodes": 29, "episode_return_max": 110.43663474366946, "episode_return_min": 63.77817106969847, "episode_return_mean": 82.28459835789803, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11981, "num_agent_steps_trained": 11981, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.91893146281538, "num_env_steps_trained_throughput_per_sec": 179.91893146281538, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 11981, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 11981, "timers": {"training_iteration_time_ms": 22232.244, "restore_workers_time_ms": 0.01, "training_step_time_ms": 22232.21, "sample_time_ms": 20144.907, "learn_time_ms": 2087.046, "learn_throughput": 1916.584, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 11981, "num_agent_steps_trained": 11981}, "done": false, "training_iteration": 1, "trial_id": "default", "date": "2025-10-13_04-35-29", "timestamp": 1760344529, "time_this_iter_s": 22.2325701713562, "time_total_s": 22.2325701713562, "pid": 48825, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16da94ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16da94c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.2325701713562, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 37.675000000000004, "ram_util_percent": 35.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.0695160888135433, "policy_loss": -0.003608843377878657, "vf_loss": 6.165438070893288, "vf_explained_var": 0.04177126083523035, "kl": 0.003088069718326249, "entropy": 9.902904018759727, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49994243142150696, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.0001, "total_loss": 1.2465826869010925, "policy_loss": -0.003974660475634866, "vf_loss": 2.5203944563865663, "vf_explained_var": 0.12164510251983764, "kl": 0.0025290992853062113, "entropy": 9.892792948465498, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.85714285714286, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 23973, "num_agent_steps_trained": 23973}, "env_runners": {"episode_reward_max": 110.43663474366946, "episode_reward_min": 60.999524101820036, "episode_reward_mean": 79.82664218908795, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 7965, "policy_reward_min": {"seeker_policy": 8.817568440838986, "hider_policy": -29.261044293043454}, "policy_reward_max": {"seeker_policy": 120.97946753282491, "hider_policy": 50.818431559161006}, "policy_reward_mean": {"seeker_policy": 81.03173450538488, "hider_policy": -0.6025461581484571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.82346484809315, 94.09710704922108, 87.50973010232984, 73.05972810506539, 85.73271195524231, 93.13695497707646, 76.1814149296025, 89.84890499741387, 73.33499623179421, 82.89867379468937, 88.77930401221259, 63.77817106969847, 94.14505896153022, 110.43663474366946, 88.94413233634711, 70.29586958387722, 81.5029325810284, 66.97637957656812, 81.67340365051162, 94.0277312372039, 75.16643612594457, 86.92039404507845, 70.95796816994509, 90.97424926943943, 84.0753302800311, 84.582309581291, 64.94640321955849, 65.5895204067707, 65.85743653780882, 73.79970955291124, 95.17506016582377, 78.5450332766269, 65.55774108141276, 89.64553756520013, 89.04485486470422, 72.4431657966732, 75.27403296321945, 69.06697204570682, 77.33663560278193, 83.52042288203951, 77.49074233700213, 78.42114084647169, 77.11940730705152, 77.68922255228905, 67.22499292993768, 86.54318157372754, 81.17614495263996, 75.63126206202249, 75.85700627500552, 84.13733209145293, 81.24207729311006, 69.72148490164507, 79.13874542536962, 68.488072713338, 73.94031318800064, 88.29347373954725, 74.52572344940174, 76.46952324021386, 60.999524101820036], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [66.41925616928876, 69.53274806639578, 84.94981252131107, 87.91575253194362, 70.21675914023173, 73.64375000974464, 88.58043115689179, 73.33872034179106, 96.72338678146605, 82.7529957586371, 71.73845783226068, 97.51033424153873, 52.03228291850745, 8.817568440838986, 106.52287608263218, 93.92211574624525, 98.05353592413817, 94.08664338400384, 74.5847442158697, 40.00415696906913, 80.28430666028424, 62.38085220407608, 86.70614868538749, 59.06645046293914, 90.20276999733055, 54.89117747563095, 97.90725736543943, 107.50248015478002, 91.04087362207962, 103.82067992033656, 42.715155425609375, 85.20823124767118, 87.42221731760309, 60.49784662273412, 120.97946753282491, 96.45855780381275, 87.95782129584885, 93.4155567735198, 79.91033481527751, 85.19193075063706, 79.19018920288349, 79.08670527768801, 80.83759393984612, 80.87090489986721, 90.49181201167177, 90.2897851744134, 89.05979510942761, 88.43620447362314, 90.97254628675616, 72.4773398623826, 65.96633206616909, 89.42433807944845, 71.79354640577144, 92.86445763520194, 85.39580518570874, 50.577747548658095, 97.32478145247595, 88.6424453356183, 92.26356150346763], "policy_hider_policy_reward": [32.74746484809313, 1.656743830711245, -6.186748066395809, 30.751107049221062, -7.663812521311066, 10.223730102329789, -10.014497627455974, -4.841526799422271, 13.446711955242243, 2.0692408597682874, 38.95095497707647, -19.45775000974464, 0.7411759118074429, -13.140192139096825, -17.01272034179103, 33.52290499741384, -7.031833504489122, -16.35655704518265, -7.886995758637081, 8.032673794689424, 25.39330401221268, -8.352457832260727, -15.427828930301466, -18.304334241538726, 2.1337170814925766, 39.9790589615302, 50.80063474366949, 50.818431559161006, -11.782528740198387, -5.796215006086648, -8.170130416122774, -15.456115746245219, -21.67753592413818, 5.126932581028461, -12.279436882474261, -14.830826924961448, -1.1420258729126658, 8.230685307554598, 14.161843030930845, 39.86173123720378, -2.8034835632846584, -2.3143869710549874, 5.174944557321038, 19.36459728368125, -8.146061170979493, -7.6021193444629445, 36.868249269439424, -4.960450462939138, -17.656769997330485, 11.529330280030948, 15.200239481008367, 14.490892624651663, -19.31275771793006, -13.648096427950911, -12.651915454965827, -29.261044293043454, -25.860608858055564, 0.67717177378477, -20.024679920336585, -9.996290447088693, 40.78906016582381, 11.670844574390648, -8.782231247671195, 2.1190332766269573, -11.112930900621881, -10.75154533556847, 20.772014336016003, 8.375676606449975, -12.964116812258734, -18.970495855861966, -14.900528911087774, -9.11486309605178, -11.811821295848846, -0.8719670367806358, -14.278924028322932, -10.069660699490054, -1.764334815277525, -0.8093643972180224, 10.934050592757583, -12.605558461355049, -6.46418920288344, 4.764742337002039, 3.8751408464717003, -4.540705277688099, -8.266725806976785, 4.54853917418211, 0.7032225522891067, -3.8849048998672395, -7.169151567489851, -16.097667514244225, -22.053785174413466, 18.307181573727636, -15.253795109427669, 7.37014495263991, -13.705842683095673, 0.9009002714951124, 1.4610062750055501, -16.576546286756166, -1.1313398623826456, 12.791332091452968, 16.906077293110037, -1.6303320661691039, -6.534629439911425, -13.168223737891946, -1.6675464057714133, 9.012745425369628, -13.296293834046146, -11.080091087817776, -6.239805185708752, -5.215686811999406, 8.520775484341126, 29.19495070654808, -13.95878145247596, -8.84027655059825, 0.9235232402139264, -13.096445335618268, -15.119585945266923, -16.144451456380647]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9067423834567405, "mean_inference_ms": 0.8062009637817846, "mean_action_processing_ms": 0.13014066768583704, "mean_env_wait_ms": 1.8966335769531026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022627539553884734, "StateBufferConnector_ms": 0.002250226877503476, "ViewRequirementAgentConnector_ms": 0.054176177008677336}, "num_episodes": 30, "episode_return_max": 110.43663474366946, "episode_return_min": 60.999524101820036, "episode_return_mean": 79.82664218908795, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23973, "num_agent_steps_trained": 23973, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.5337356401139, "num_env_steps_trained_throughput_per_sec": 226.5337356401139, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 23973, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 23973, "timers": {"training_iteration_time_ms": 19944.831, "restore_workers_time_ms": 0.009, "training_step_time_ms": 19944.804, "sample_time_ms": 17907.78, "learn_time_ms": 2036.783, "learn_throughput": 1963.881, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 23973, "num_agent_steps_trained": 23973}, "done": false, "training_iteration": 2, "trial_id": "default", "date": "2025-10-13_04-35-46", "timestamp": 1760344546, "time_this_iter_s": 17.657787084579468, "time_total_s": 39.89035725593567, "pid": 48825, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16da94ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16da94c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.89035725593567, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.952, "ram_util_percent": 35.856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.00010000000000000002, "total_loss": 3.1276485823094844, "policy_loss": -0.006225413577340078, "vf_loss": 6.287401241064072, "vf_explained_var": 0.026611420325934887, "kl": 0.0029661661040876245, "entropy": 9.974933817982674, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 800.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 1.2973188143873973, "policy_loss": -0.007228545880033856, "vf_loss": 2.6283984233462623, "vf_explained_var": 0.11672343167047652, "kl": 0.003919751966912788, "entropy": 9.847837604038299, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 35973, "num_agent_steps_trained": 35973}, "env_runners": {"episode_reward_max": 110.43663474366946, "episode_reward_min": 60.999524101820036, "episode_reward_mean": 80.06954979926235, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 11880, "policy_reward_min": {"seeker_policy": 8.817568440838986, "hider_policy": -29.261044293043454}, "policy_reward_max": {"seeker_policy": 120.97946753282491, "hider_policy": 50.818431559161006}, "policy_reward_mean": {"seeker_policy": 80.47439100670763, "hider_policy": -0.2024206037226447}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.82346484809315, 94.09710704922108, 87.50973010232984, 73.05972810506539, 85.73271195524231, 93.13695497707646, 76.1814149296025, 89.84890499741387, 73.33499623179421, 82.89867379468937, 88.77930401221259, 63.77817106969847, 94.14505896153022, 110.43663474366946, 88.94413233634711, 70.29586958387722, 81.5029325810284, 66.97637957656812, 81.67340365051162, 94.0277312372039, 75.16643612594457, 86.92039404507845, 70.95796816994509, 90.97424926943943, 84.0753302800311, 84.582309581291, 64.94640321955849, 65.5895204067707, 65.85743653780882, 73.79970955291124, 95.17506016582377, 78.5450332766269, 65.55774108141276, 89.64553756520013, 89.04485486470422, 72.4431657966732, 75.27403296321945, 69.06697204570682, 77.33663560278193, 83.52042288203951, 77.49074233700213, 78.42114084647169, 77.11940730705152, 77.68922255228905, 67.22499292993768, 86.54318157372754, 81.17614495263996, 75.63126206202249, 75.85700627500552, 84.13733209145293, 81.24207729311006, 69.72148490164507, 79.13874542536962, 68.488072713338, 73.94031318800064, 88.29347373954725, 74.52572344940174, 76.46952324021386, 60.999524101820036, 79.25848449133129, 83.692355128625, 81.7724434661719, 73.83393154100384, 82.34432243817211, 73.25000977977844, 93.09331062228561, 86.33485138696608, 67.2429066953206, 98.23484828539151, 80.99652826768495, 82.11143177022262, 72.87232795445776, 82.31822646273778, 83.38172954719461, 80.60602926488755, 80.73149372679644, 70.29402828991839, 73.47062035412367, 73.22624733937559, 80.18911729029544, 102.91763521743793, 78.90606996954617, 102.63912505004036, 70.35914442150494, 76.55702343334778, 70.8726033678049, 70.36279296118089, 84.47885465529279], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [66.41925616928876, 69.53274806639578, 84.94981252131107, 87.91575253194362, 70.21675914023173, 73.64375000974464, 88.58043115689179, 73.33872034179106, 96.72338678146605, 82.7529957586371, 71.73845783226068, 97.51033424153873, 52.03228291850745, 8.817568440838986, 106.52287608263218, 93.92211574624525, 98.05353592413817, 94.08664338400384, 74.5847442158697, 40.00415696906913, 80.28430666028424, 62.38085220407608, 86.70614868538749, 59.06645046293914, 90.20276999733055, 54.89117747563095, 97.90725736543943, 107.50248015478002, 91.04087362207962, 103.82067992033656, 42.715155425609375, 85.20823124767118, 87.42221731760309, 60.49784662273412, 120.97946753282491, 96.45855780381275, 87.95782129584885, 93.4155567735198, 79.91033481527751, 85.19193075063706, 79.19018920288349, 79.08670527768801, 80.83759393984612, 80.87090489986721, 90.49181201167177, 90.2897851744134, 89.05979510942761, 88.43620447362314, 90.97254628675616, 72.4773398623826, 65.96633206616909, 89.42433807944845, 71.79354640577144, 92.86445763520194, 85.39580518570874, 50.577747548658095, 97.32478145247595, 88.6424453356183, 92.26356150346763, 91.62125347762964, 70.01951507339977, 83.30208485652963, 103.44162116934221, 87.71412250530982, 83.22768724610675, 23.826766235405046, 73.85440117538876, 89.54055380217937, 61.70619424304868, 82.14734958133165, 90.4597424110821, 83.57508702159542, 87.15190578126435, 84.23168703990295, 79.5450521442092, 97.91940848462704, 92.02879603505683, 77.95600796415758, 77.27854963545444, 85.97658265749064, 12.771152742877176, 90.79544335705596, 55.074725115921396, 89.73867767531885, 77.7472881281464, 84.81534971774651, 98.74280481404027, 84.66426268094641], "policy_hider_policy_reward": [32.74746484809313, 1.656743830711245, -6.186748066395809, 30.751107049221062, -7.663812521311066, 10.223730102329789, -10.014497627455974, -4.841526799422271, 13.446711955242243, 2.0692408597682874, 38.95095497707647, -19.45775000974464, 0.7411759118074429, -13.140192139096825, -17.01272034179103, 33.52290499741384, -7.031833504489122, -16.35655704518265, -7.886995758637081, 8.032673794689424, 25.39330401221268, -8.352457832260727, -15.427828930301466, -18.304334241538726, 2.1337170814925766, 39.9790589615302, 50.80063474366949, 50.818431559161006, -11.782528740198387, -5.796215006086648, -8.170130416122774, -15.456115746245219, -21.67753592413818, 5.126932581028461, -12.279436882474261, -14.830826924961448, -1.1420258729126658, 8.230685307554598, 14.161843030930845, 39.86173123720378, -2.8034835632846584, -2.3143869710549874, 5.174944557321038, 19.36459728368125, -8.146061170979493, -7.6021193444629445, 36.868249269439424, -4.960450462939138, -17.656769997330485, 11.529330280030948, 15.200239481008367, 14.490892624651663, -19.31275771793006, -13.648096427950911, -12.651915454965827, -29.261044293043454, -25.860608858055564, 0.67717177378477, -20.024679920336585, -9.996290447088693, 40.78906016582381, 11.670844574390648, -8.782231247671195, 2.1190332766269573, -11.112930900621881, -10.75154533556847, 20.772014336016003, 8.375676606449975, -12.964116812258734, -18.970495855861966, -14.900528911087774, -9.11486309605178, -11.811821295848846, -0.8719670367806358, -14.278924028322932, -10.069660699490054, -1.764334815277525, -0.8093643972180224, 10.934050592757583, -12.605558461355049, -6.46418920288344, 4.764742337002039, 3.8751408464717003, -4.540705277688099, -8.266725806976785, 4.54853917418211, 0.7032225522891067, -3.8849048998672395, -7.169151567489851, -16.097667514244225, -22.053785174413466, 18.307181573727636, -15.253795109427669, 7.37014495263991, -13.705842683095673, 0.9009002714951124, 1.4610062750055501, -16.576546286756166, -1.1313398623826456, 12.791332091452968, 16.906077293110037, -1.6303320661691039, -6.534629439911425, -13.168223737891946, -1.6675464057714133, 9.012745425369628, -13.296293834046146, -11.080091087817776, -6.239805185708752, -5.215686811999406, 8.520775484341126, 29.19495070654808, -13.95878145247596, -8.84027655059825, 0.9235232402139264, -13.096445335618268, -15.119585945266923, -16.144451456380647, -15.030522045676559, 2.667753059378245, 14.606355128625053, -0.9335150733997625, -0.008415748335875838, -1.521225642021823, -21.09562116934224, -8.512068458996069, -16.45812250530985, 11.088322438172254, -2.1559902202215446, -7.821687246106709, 38.48642826979179, 30.780116117088795, 14.848851386966066, -2.368401175388748, -14.684645313142468, -7.613001793716329, -7.260194243048673, 43.788848285391474, -4.5013495813316835, 3.350528267684956, -10.553742411082066, 2.2054317702226305, 0.11495635951906312, -10.817715426656683, -4.685905781264377, -0.14777353726217013, -10.56568703990297, 9.715729547194606, 2.0410775137044253, -0.980100393025978, -12.732307605363909, -4.45560715246672, -11.62213906427193, -10.11262868086642, -3.385135422699836, -1.1002521873340256, 1.900467911019408, -5.952770207098182, -12.130582657490645, 6.34311729029545, 48.42163521743782, 41.724847257122825, 2.9000699695460987, -14.78944335705598, 48.73312505004027, -1.168725115921404, -4.7868555784949685, -14.592677675318946, -2.978976566652174, 1.7887118718536181, -7.078755225463846, -6.863991124477769, -14.24943828972884, -14.130573563130534, -9.598262680946382, 9.412854655292726]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7815702237883442, "mean_inference_ms": 0.8046134200754758, "mean_action_processing_ms": 0.13025451804929333, "mean_env_wait_ms": 1.8929294482650194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002263892780650746, "StateBufferConnector_ms": 0.0022825869646939364, "ViewRequirementAgentConnector_ms": 0.05495006387883967}, "num_episodes": 29, "episode_return_max": 110.43663474366946, "episode_return_min": 60.999524101820036, "episode_return_mean": 80.06954979926235, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35973, "num_agent_steps_trained": 35973, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.09565645674428, "num_env_steps_trained_throughput_per_sec": 218.09565645674428, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 35973, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 35973, "timers": {"training_iteration_time_ms": 19410.081, "restore_workers_time_ms": 0.008, "training_step_time_ms": 19410.056, "sample_time_ms": 17424.371, "learn_time_ms": 1985.436, "learn_throughput": 2014.67, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 35973, "num_agent_steps_trained": 35973}, "done": false, "training_iteration": 3, "trial_id": "default", "date": "2025-10-13_04-36-05", "timestamp": 1760344565, "time_this_iter_s": 18.341042041778564, "time_total_s": 58.23139929771423, "pid": 48825, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16da94ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16da94c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 58.23139929771423, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 42.603846153846156, "ram_util_percent": 35.98076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.00010000000000000002, "total_loss": 3.2118720047175886, "policy_loss": -0.003054553212132305, "vf_loss": 6.44966037273407, "vf_explained_var": 0.012842265889048576, "kl": 0.0022689579066844964, "entropy": 9.960352075099944, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1120.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.0001, "total_loss": 1.2511645565903375, "policy_loss": -0.006903963065188792, "vf_loss": 2.5356983165892344, "vf_explained_var": 0.17882888695550345, "kl": 0.003335551884161506, "entropy": 9.86401961038983, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2205.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 47973, "num_agent_steps_trained": 47973}, "env_runners": {"episode_reward_max": 102.91763521743793, "episode_reward_min": 60.999524101820036, "episode_reward_mean": 79.30388517672513, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 12.771152742877176, "hider_policy": -29.261044293043454}, "policy_reward_max": {"seeker_policy": 120.97946753282491, "hider_policy": 48.73312505004027}, "policy_reward_mean": {"seeker_policy": 80.22576484792259, "hider_policy": -0.4609398355987302}, "custom_metrics": {}, "hist_stats": {"episode_reward": [81.67340365051162, 94.0277312372039, 75.16643612594457, 86.92039404507845, 70.95796816994509, 90.97424926943943, 84.0753302800311, 84.582309581291, 64.94640321955849, 65.5895204067707, 65.85743653780882, 73.79970955291124, 95.17506016582377, 78.5450332766269, 65.55774108141276, 89.64553756520013, 89.04485486470422, 72.4431657966732, 75.27403296321945, 69.06697204570682, 77.33663560278193, 83.52042288203951, 77.49074233700213, 78.42114084647169, 77.11940730705152, 77.68922255228905, 67.22499292993768, 86.54318157372754, 81.17614495263996, 75.63126206202249, 75.85700627500552, 84.13733209145293, 81.24207729311006, 69.72148490164507, 79.13874542536962, 68.488072713338, 73.94031318800064, 88.29347373954725, 74.52572344940174, 76.46952324021386, 60.999524101820036, 79.25848449133129, 83.692355128625, 81.7724434661719, 73.83393154100384, 82.34432243817211, 73.25000977977844, 93.09331062228561, 86.33485138696608, 67.2429066953206, 98.23484828539151, 80.99652826768495, 82.11143177022262, 72.87232795445776, 82.31822646273778, 83.38172954719461, 80.60602926488755, 80.73149372679644, 70.29402828991839, 73.47062035412367, 73.22624733937559, 80.18911729029544, 102.91763521743793, 78.90606996954617, 102.63912505004036, 70.35914442150494, 76.55702343334778, 70.8726033678049, 70.36279296118089, 84.47885465529279, 85.75796445081141, 87.77999758286974, 78.27463552471401, 80.29889928900964, 66.26967555239106, 71.85612524977833, 102.39282095030198, 72.54676405266828, 90.64930084018704, 95.3798894236822, 81.33263206975322, 68.79394420520396, 82.49465321221095, 83.81030486621943, 97.17126237100666, 76.03354066883662, 69.73641366123036, 67.39557729958955, 80.60518551545921, 86.97792935811783, 75.36007113495168, 100.35054534054237, 74.66715410397111, 84.27365135315777, 70.91004152327449, 74.53698483432292, 83.16236905603832, 69.67886913242762, 66.75910149712558, 80.49400107303217], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [74.5847442158697, 40.00415696906913, 80.28430666028424, 62.38085220407608, 86.70614868538749, 59.06645046293914, 90.20276999733055, 54.89117747563095, 97.90725736543943, 107.50248015478002, 91.04087362207962, 103.82067992033656, 42.715155425609375, 85.20823124767118, 87.42221731760309, 60.49784662273412, 120.97946753282491, 96.45855780381275, 87.95782129584885, 93.4155567735198, 79.91033481527751, 85.19193075063706, 79.19018920288349, 79.08670527768801, 80.83759393984612, 80.87090489986721, 90.49181201167177, 90.2897851744134, 89.05979510942761, 88.43620447362314, 90.97254628675616, 72.4773398623826, 65.96633206616909, 89.42433807944845, 71.79354640577144, 92.86445763520194, 85.39580518570874, 50.577747548658095, 97.32478145247595, 88.6424453356183, 92.26356150346763, 91.62125347762964, 70.01951507339977, 83.30208485652963, 103.44162116934221, 87.71412250530982, 83.22768724610675, 23.826766235405046, 73.85440117538876, 89.54055380217937, 61.70619424304868, 82.14734958133165, 90.4597424110821, 83.57508702159542, 87.15190578126435, 84.23168703990295, 79.5450521442092, 97.91940848462704, 92.02879603505683, 77.95600796415758, 77.27854963545444, 85.97658265749064, 12.771152742877176, 90.79544335705596, 55.074725115921396, 89.73867767531885, 77.7472881281464, 84.81534971774651, 98.74280481404027, 84.66426268094641, 87.78142575740202, 67.81099417617433, 86.49271568542231, 86.75240047902484, 98.10270567281748, 84.50685222850723, 45.08106521689119, 101.61911577674857, 47.26626100506756, 55.495416641775336, 69.63655605295588, 84.76294598221449, 71.49698199895583, 91.91455647353322, 58.21438980508158, 76.79411886291619, 100.58206976029474, 62.41409317184318, 72.61953134346508, 69.12933790010031, 94.67288052193085, 64.71997232392104, 77.73236375536386, 85.57838432942229, 83.60363619716541, 85.07523649610017, 78.2625417504581, 83.60816479022259, 91.94309583658688, 93.91769325749078], "policy_hider_policy_reward": [-1.1420258729126658, 8.230685307554598, 14.161843030930845, 39.86173123720378, -2.8034835632846584, -2.3143869710549874, 5.174944557321038, 19.36459728368125, -8.146061170979493, -7.6021193444629445, 36.868249269439424, -4.960450462939138, -17.656769997330485, 11.529330280030948, 15.200239481008367, 14.490892624651663, -19.31275771793006, -13.648096427950911, -12.651915454965827, -29.261044293043454, -25.860608858055564, 0.67717177378477, -20.024679920336585, -9.996290447088693, 40.78906016582381, 11.670844574390648, -8.782231247671195, 2.1190332766269573, -11.112930900621881, -10.75154533556847, 20.772014336016003, 8.375676606449975, -12.964116812258734, -18.970495855861966, -14.900528911087774, -9.11486309605178, -11.811821295848846, -0.8719670367806358, -14.278924028322932, -10.069660699490054, -1.764334815277525, -0.8093643972180224, 10.934050592757583, -12.605558461355049, -6.46418920288344, 4.764742337002039, 3.8751408464717003, -4.540705277688099, -8.266725806976785, 4.54853917418211, 0.7032225522891067, -3.8849048998672395, -7.169151567489851, -16.097667514244225, -22.053785174413466, 18.307181573727636, -15.253795109427669, 7.37014495263991, -13.705842683095673, 0.9009002714951124, 1.4610062750055501, -16.576546286756166, -1.1313398623826456, 12.791332091452968, 16.906077293110037, -1.6303320661691039, -6.534629439911425, -13.168223737891946, -1.6675464057714133, 9.012745425369628, -13.296293834046146, -11.080091087817776, -6.239805185708752, -5.215686811999406, 8.520775484341126, 29.19495070654808, -13.95878145247596, -8.84027655059825, 0.9235232402139264, -13.096445335618268, -15.119585945266923, -16.144451456380647, -15.030522045676559, 2.667753059378245, 14.606355128625053, -0.9335150733997625, -0.008415748335875838, -1.521225642021823, -21.09562116934224, -8.512068458996069, -16.45812250530985, 11.088322438172254, -2.1559902202215446, -7.821687246106709, 38.48642826979179, 30.780116117088795, 14.848851386966066, -2.368401175388748, -14.684645313142468, -7.613001793716329, -7.260194243048673, 43.788848285391474, -4.5013495813316835, 3.350528267684956, -10.553742411082066, 2.2054317702226305, 0.11495635951906312, -10.817715426656683, -4.685905781264377, -0.14777353726217013, -10.56568703990297, 9.715729547194606, 2.0410775137044253, -0.980100393025978, -12.732307605363909, -4.45560715246672, -11.62213906427193, -10.11262868086642, -3.385135422699836, -1.1002521873340256, 1.900467911019408, -5.952770207098182, -12.130582657490645, 6.34311729029545, 48.42163521743782, 41.724847257122825, 2.9000699695460987, -14.78944335705598, 48.73312505004027, -1.168725115921404, -4.7868555784949685, -14.592677675318946, -2.978976566652174, 1.7887118718536181, -7.078755225463846, -6.863991124477769, -14.24943828972884, -14.130573563130534, -9.598262680946382, 9.412854655292726, 14.381964450811498, -16.405425757402032, -0.41499417617433954, 20.383997582869693, -11.26671568542231, 3.0486355247139887, 6.012899289009671, -12.46640047902487, -12.246055945874472, -19.586974174551873, -10.060852228507247, -2.589874750221609, 47.61682095030201, 9.694934783108804, -22.77311577674857, -6.2992359473316455, 20.479231383590925, 22.903808451528562, -1.3094166417753048, 41.19388942368213, 4.704620284763985, 6.991455732033397, -5.2937956272080315, -10.675206149802388, 0.696731967089627, 10.300939246165463, -12.818556473533192, 4.714304866219331, 43.34526237100676, -4.388389805081559, -1.0617320723079435, 0.3011538782283666, -17.036069760294737, -13.809586338769611, 3.5835106559269643, 1.3979734718192312, -1.588438627200242, 9.574092799194402, 21.831929358117815, -3.9833379001002984, -7.325928865048243, -11.98688052193089, 46.5545453405424, -10.923972323921022, -3.839686814508447, 0.7744771631156505, 7.427651353157821, -8.732384329422313, -0.5858602026674851, -12.107734471223411, -2.0090151656770945, -8.52923649610018, 11.616369056038323, -6.716541750458073, -9.011761168635845, -4.917534489159184, -15.075175467757838, -10.108818871703445, -15.371693257490803, 1.9480010730322566]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.668593830482144, "mean_inference_ms": 0.8020731725634505, "mean_action_processing_ms": 0.13056978974286074, "mean_env_wait_ms": 1.898184199076674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022298097610473633, "StateBufferConnector_ms": 0.002237081527709961, "ViewRequirementAgentConnector_ms": 0.053905487060546875}, "num_episodes": 30, "episode_return_max": 102.91763521743793, "episode_return_min": 60.999524101820036, "episode_return_mean": 79.30388517672513, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47973, "num_agent_steps_trained": 47973, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 185.68021044533967, "num_env_steps_trained_throughput_per_sec": 185.68021044533967, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 47973, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 47973, "timers": {"training_iteration_time_ms": 19943.166, "restore_workers_time_ms": 0.008, "training_step_time_ms": 19943.14, "sample_time_ms": 18013.751, "learn_time_ms": 1929.15, "learn_throughput": 2073.452, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 47973, "num_agent_steps_trained": 47973}, "done": false, "training_iteration": 4, "trial_id": "default", "date": "2025-10-13_04-36-26", "timestamp": 1760344586, "time_this_iter_s": 21.54298210144043, "time_total_s": 79.77438139915466, "pid": 48825, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16da94ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16da94c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 79.77438139915466, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 32.26129032258064, "ram_util_percent": 35.806451612903224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.342797484993935, "policy_loss": -0.0037263296282617374, "vf_loss": 6.712729461491108, "vf_explained_var": -0.0325512895360589, "kl": 0.0029808449794913815, "entropy": 9.878159022331237, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 0.0001, "total_loss": 1.422037498913114, "policy_loss": -0.008030604648714265, "vf_loss": 2.8797229350559297, "vf_explained_var": 0.2944076967617822, "kl": 0.004621517797074876, "entropy": 9.851135355328756, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 59973, "num_agent_steps_trained": 59973}, "env_runners": {"episode_reward_max": 109.6824156436579, "episode_reward_min": 60.999524101820036, "episode_reward_mean": 79.48744175377864, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 6.008669973021033, "hider_policy": -25.89381817863851}, "policy_reward_max": {"seeker_policy": 103.44162116934221, "hider_policy": 53.49641564365795}, "policy_reward_mean": {"seeker_policy": 80.59594517067725, "hider_policy": -0.5542517084493013}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.85700627500552, 84.13733209145293, 81.24207729311006, 69.72148490164507, 79.13874542536962, 68.488072713338, 73.94031318800064, 88.29347373954725, 74.52572344940174, 76.46952324021386, 60.999524101820036, 79.25848449133129, 83.692355128625, 81.7724434661719, 73.83393154100384, 82.34432243817211, 73.25000977977844, 93.09331062228561, 86.33485138696608, 67.2429066953206, 98.23484828539151, 80.99652826768495, 82.11143177022262, 72.87232795445776, 82.31822646273778, 83.38172954719461, 80.60602926488755, 80.73149372679644, 70.29402828991839, 73.47062035412367, 73.22624733937559, 80.18911729029544, 102.91763521743793, 78.90606996954617, 102.63912505004036, 70.35914442150494, 76.55702343334778, 70.8726033678049, 70.36279296118089, 84.47885465529279, 85.75796445081141, 87.77999758286974, 78.27463552471401, 80.29889928900964, 66.26967555239106, 71.85612524977833, 102.39282095030198, 72.54676405266828, 90.64930084018704, 95.3798894236822, 81.33263206975322, 68.79394420520396, 82.49465321221095, 83.81030486621943, 97.17126237100666, 76.03354066883662, 69.73641366123036, 67.39557729958955, 80.60518551545921, 86.97792935811783, 75.36007113495168, 100.35054534054237, 74.66715410397111, 84.27365135315777, 70.91004152327449, 74.53698483432292, 83.16236905603832, 69.67886913242762, 66.75910149712558, 80.49400107303217, 75.78167287033932, 82.19025769998206, 71.56863884188625, 74.11121216411007, 69.34424511887816, 84.00578090379202, 73.14244066069935, 77.16403485200577, 109.6824156436579, 85.14497372069668, 71.8007514930081, 71.24244425183787, 86.65459863500719, 90.29433125791556, 71.14642124725727, 84.8906656387158, 74.36069169094522, 67.05469482732909, 72.58891040981707, 87.61003927194264, 82.10402644698516, 75.61059487482052, 79.56562235235627, 71.91629036020238, 100.60062138865631, 80.1345668890646, 80.56083770759003, 75.75488317300118, 77.65768828179513, 70.14774791288231], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [90.97254628675616, 72.4773398623826, 65.96633206616909, 89.42433807944845, 71.79354640577144, 92.86445763520194, 85.39580518570874, 50.577747548658095, 97.32478145247595, 88.6424453356183, 92.26356150346763, 91.62125347762964, 70.01951507339977, 83.30208485652963, 103.44162116934221, 87.71412250530982, 83.22768724610675, 23.826766235405046, 73.85440117538876, 89.54055380217937, 61.70619424304868, 82.14734958133165, 90.4597424110821, 83.57508702159542, 87.15190578126435, 84.23168703990295, 79.5450521442092, 97.91940848462704, 92.02879603505683, 77.95600796415758, 77.27854963545444, 85.97658265749064, 12.771152742877176, 90.79544335705596, 55.074725115921396, 89.73867767531885, 77.7472881281464, 84.81534971774651, 98.74280481404027, 84.66426268094641, 87.78142575740202, 67.81099417617433, 86.49271568542231, 86.75240047902484, 98.10270567281748, 84.50685222850723, 45.08106521689119, 101.61911577674857, 47.26626100506756, 55.495416641775336, 69.63655605295588, 84.76294598221449, 71.49698199895583, 91.91455647353322, 58.21438980508158, 76.79411886291619, 100.58206976029474, 62.41409317184318, 72.61953134346508, 69.12933790010031, 94.67288052193085, 64.71997232392104, 77.73236375536386, 85.57838432942229, 83.60363619716541, 85.07523649610017, 78.2625417504581, 83.60816479022259, 91.94309583658688, 93.91769325749078, 87.50988384923043, 73.56685368711514, 99.33104208598492, 79.45524565416636, 88.09365688939734, 67.10843571947476, 97.62780373065918, 88.25500429357851, 6.008669973021033, 80.7219152398784, 87.60938906621485, 95.39780659580492, 69.46130111557862, 62.429412856900164, 95.85131338556297, 83.58820527845906, 89.18213574993418, 92.83294656919574, 95.71359900481217, 69.9453388440815, 88.12261048966079, 102.06233173878233, 93.01724685537103, 94.02755161756497, 53.765939413908235, 91.39204536287143, 99.78598919776726, 91.53793414825478, 87.75245926191063, 92.27597200850788], "policy_hider_policy_reward": [1.4610062750055501, -16.576546286756166, -1.1313398623826456, 12.791332091452968, 16.906077293110037, -1.6303320661691039, -6.534629439911425, -13.168223737891946, -1.6675464057714133, 9.012745425369628, -13.296293834046146, -11.080091087817776, -6.239805185708752, -5.215686811999406, 8.520775484341126, 29.19495070654808, -13.95878145247596, -8.84027655059825, 0.9235232402139264, -13.096445335618268, -15.119585945266923, -16.144451456380647, -15.030522045676559, 2.667753059378245, 14.606355128625053, -0.9335150733997625, -0.008415748335875838, -1.521225642021823, -21.09562116934224, -8.512068458996069, -16.45812250530985, 11.088322438172254, -2.1559902202215446, -7.821687246106709, 38.48642826979179, 30.780116117088795, 14.848851386966066, -2.368401175388748, -14.684645313142468, -7.613001793716329, -7.260194243048673, 43.788848285391474, -4.5013495813316835, 3.350528267684956, -10.553742411082066, 2.2054317702226305, 0.11495635951906312, -10.817715426656683, -4.685905781264377, -0.14777353726217013, -10.56568703990297, 9.715729547194606, 2.0410775137044253, -0.980100393025978, -12.732307605363909, -4.45560715246672, -11.62213906427193, -10.11262868086642, -3.385135422699836, -1.1002521873340256, 1.900467911019408, -5.952770207098182, -12.130582657490645, 6.34311729029545, 48.42163521743782, 41.724847257122825, 2.9000699695460987, -14.78944335705598, 48.73312505004027, -1.168725115921404, -4.7868555784949685, -14.592677675318946, -2.978976566652174, 1.7887118718536181, -7.078755225463846, -6.863991124477769, -14.24943828972884, -14.130573563130534, -9.598262680946382, 9.412854655292726, 14.381964450811498, -16.405425757402032, -0.41499417617433954, 20.383997582869693, -11.26671568542231, 3.0486355247139887, 6.012899289009671, -12.46640047902487, -12.246055945874472, -19.586974174551873, -10.060852228507247, -2.589874750221609, 47.61682095030201, 9.694934783108804, -22.77311577674857, -6.2992359473316455, 20.479231383590925, 22.903808451528562, -1.3094166417753048, 41.19388942368213, 4.704620284763985, 6.991455732033397, -5.2937956272080315, -10.675206149802388, 0.696731967089627, 10.300939246165463, -12.818556473533192, 4.714304866219331, 43.34526237100676, -4.388389805081559, -1.0617320723079435, 0.3011538782283666, -17.036069760294737, -13.809586338769611, 3.5835106559269643, 1.3979734718192312, -1.588438627200242, 9.574092799194402, 21.831929358117815, -3.9833379001002984, -7.325928865048243, -11.98688052193089, 46.5545453405424, -10.923972323921022, -3.839686814508447, 0.7744771631156505, 7.427651353157821, -8.732384329422313, -0.5858602026674851, -12.107734471223411, -2.0090151656770945, -8.52923649610018, 11.616369056038323, -6.716541750458073, -9.011761168635845, -4.917534489159184, -15.075175467757838, -10.108818871703445, -15.371693257490803, 1.9480010730322566, 0.6556728703393508, -12.38388384923042, 4.436425480992708, 4.186978531874296, -3.5173611581137854, -24.245042085984903, -6.096087190733749, 0.7520537006775305, -11.256877604922769, -7.492534165596449, 4.326958399331042, 12.57038678498624, -10.885542076048303, -13.599820993911543, -2.8679078872853676, -8.223061554287428, 53.49641564365795, 50.177330026978986, -14.715915239878456, 19.138973720696765, -8.205658955406909, -7.602978617799759, -17.24568641289543, -6.90967593107168, 16.30859863500717, 0.88469888442141, 32.9583312579156, -5.093412856900172, -25.89381817863851, 1.1889260403327875, -6.482205278459106, 7.784665638715902, -4.540052204061975, -10.28139185492698, -12.831008983361855, -12.947242758504796, -17.50634313182928, -5.618345463165782, 24.54403927194274, -6.879338844081536, 10.058026446985245, -16.076610489660787, -21.896331738782347, -4.555405125179474, -13.791246855371073, 0.3396223523563186, -6.647476838139154, -15.463784419223375, 0.3600605860917985, 46.474621388656324, 4.928566889064646, -16.186045362871457, -7.345162292409913, -11.879989197767255, -10.136479381795866, -5.646571593457738, 1.3516882817951743, -11.446459261910654, -6.980304809292454, -15.147919286333206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7013840000833105, "mean_inference_ms": 0.8014071225924055, "mean_action_processing_ms": 0.13131513912102633, "mean_env_wait_ms": 1.9331564191139805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021822452545166016, "StateBufferConnector_ms": 0.0022096633911132812, "ViewRequirementAgentConnector_ms": 0.05273163318634033}, "num_episodes": 30, "episode_return_max": 109.6824156436579, "episode_return_min": 60.999524101820036, "episode_return_mean": 79.48744175377864, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59973, "num_agent_steps_trained": 59973, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 142.83244769189713, "num_env_steps_trained_throughput_per_sec": 142.83244769189713, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 59973, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 59973, "timers": {"training_iteration_time_ms": 21555.502, "restore_workers_time_ms": 0.008, "training_step_time_ms": 21555.477, "sample_time_ms": 19630.748, "learn_time_ms": 1924.441, "learn_throughput": 2078.526, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 59973, "num_agent_steps_trained": 59973}, "done": false, "training_iteration": 5, "trial_id": "default", "date": "2025-10-13_04-36-54", "timestamp": 1760344614, "time_this_iter_s": 28.005434274673462, "time_total_s": 107.77981567382812, "pid": 48825, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16da94ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16da94c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 107.77981567382812, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 30.195000000000004, "ram_util_percent": 35.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 0.00010000000000000002, "total_loss": 3.293372527509928, "policy_loss": -0.003876749859773554, "vf_loss": 6.614248496294022, "vf_explained_var": -0.033213737048208715, "kl": 0.0019334004170986035, "entropy": 9.887041422724725, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1760.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 0.0001, "total_loss": 1.5269866939574952, "policy_loss": -0.00706794355582032, "vf_loss": 3.087768170568678, "vf_explained_var": 0.4443679478433397, "kl": 0.003934366006334024, "entropy": 9.85404331419203, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.68253968253968, "num_grad_updates_lifetime": 3465.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 71954, "num_agent_steps_trained": 71954}, "env_runners": {"episode_reward_max": 109.6824156436579, "episode_reward_min": 65.59289460779648, "episode_reward_mean": 79.85186605625799, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 6.008669973021033, "hider_policy": -25.89381817863851}, "policy_reward_max": {"seeker_policy": 117.89038269563093, "hider_policy": 53.49641564365795}, "policy_reward_mean": {"seeker_policy": 79.74014693813432, "hider_policy": 0.05585955906184818}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.47062035412367, 73.22624733937559, 80.18911729029544, 102.91763521743793, 78.90606996954617, 102.63912505004036, 70.35914442150494, 76.55702343334778, 70.8726033678049, 70.36279296118089, 84.47885465529279, 85.75796445081141, 87.77999758286974, 78.27463552471401, 80.29889928900964, 66.26967555239106, 71.85612524977833, 102.39282095030198, 72.54676405266828, 90.64930084018704, 95.3798894236822, 81.33263206975322, 68.79394420520396, 82.49465321221095, 83.81030486621943, 97.17126237100666, 76.03354066883662, 69.73641366123036, 67.39557729958955, 80.60518551545921, 86.97792935811783, 75.36007113495168, 100.35054534054237, 74.66715410397111, 84.27365135315777, 70.91004152327449, 74.53698483432292, 83.16236905603832, 69.67886913242762, 66.75910149712558, 80.49400107303217, 75.78167287033932, 82.19025769998206, 71.56863884188625, 74.11121216411007, 69.34424511887816, 84.00578090379202, 73.14244066069935, 77.16403485200577, 109.6824156436579, 85.14497372069668, 71.8007514930081, 71.24244425183787, 86.65459863500719, 90.29433125791556, 71.14642124725727, 84.8906656387158, 74.36069169094522, 67.05469482732909, 72.58891040981707, 87.61003927194264, 82.10402644698516, 75.61059487482052, 79.56562235235627, 71.91629036020238, 100.60062138865631, 80.1345668890646, 80.56083770759003, 75.75488317300118, 77.65768828179513, 70.14774791288231, 105.02692456289809, 86.1087744580506, 77.46626793948077, 77.19031140886867, 65.59289460779648, 72.99033386554767, 67.16164215672995, 80.59007979541106, 66.2879822089484, 104.8847212311062, 72.5981752142447, 75.62638092213389, 76.61243596331036, 71.14957802120709, 70.21378109269426, 91.56286750920061, 87.3015694745099, 82.63095281754619, 73.81626014850768, 88.98098408519263, 75.58690316680567, 92.53421248469361, 72.8810978525688, 82.31615737545359, 73.35301805868193, 75.86168038502717, 88.39515443968995, 89.73581180085779, 77.16801273862352], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [77.95600796415758, 77.27854963545444, 85.97658265749064, 12.771152742877176, 90.79544335705596, 55.074725115921396, 89.73867767531885, 77.7472881281464, 84.81534971774651, 98.74280481404027, 84.66426268094641, 87.78142575740202, 67.81099417617433, 86.49271568542231, 86.75240047902484, 98.10270567281748, 84.50685222850723, 45.08106521689119, 101.61911577674857, 47.26626100506756, 55.495416641775336, 69.63655605295588, 84.76294598221449, 71.49698199895583, 91.91455647353322, 58.21438980508158, 76.79411886291619, 100.58206976029474, 62.41409317184318, 72.61953134346508, 69.12933790010031, 94.67288052193085, 64.71997232392104, 77.73236375536386, 85.57838432942229, 83.60363619716541, 85.07523649610017, 78.2625417504581, 83.60816479022259, 91.94309583658688, 93.91769325749078, 87.50988384923043, 73.56685368711514, 99.33104208598492, 79.45524565416636, 88.09365688939734, 67.10843571947476, 97.62780373065918, 88.25500429357851, 6.008669973021033, 80.7219152398784, 87.60938906621485, 95.39780659580492, 69.46130111557862, 62.429412856900164, 95.85131338556297, 83.58820527845906, 89.18213574993418, 92.83294656919574, 95.71359900481217, 69.9453388440815, 88.12261048966079, 102.06233173878233, 93.01724685537103, 94.02755161756497, 53.765939413908235, 91.39204536287143, 99.78598919776726, 91.53793414825478, 87.75245926191063, 92.27597200850788, 10.027183799548405, 75.48848250161821, 94.62626389134117, 75.78385840014872, 97.44385726315029, 83.07410981041765, 93.16885897651451, 87.97304770186278, 93.44187741648354, 12.610266760978915, 99.37931563833074, 91.04711053917633, 84.77725809928381, 106.81361595484563, 98.59745044371563, 71.39148827004841, 63.11515951001206, 92.9048087643308, 89.87080292347571, 39.495117530599686, 87.47720269221219, 54.166587721930576, 86.15200367111083, 117.89038269563093, 77.10919073614164, 73.07813198867728, 72.9310398936158, 68.19064156636456, 79.41119122920614], "policy_hider_policy_reward": [-3.385135422699836, -1.1002521873340256, 1.900467911019408, -5.952770207098182, -12.130582657490645, 6.34311729029545, 48.42163521743782, 41.724847257122825, 2.9000699695460987, -14.78944335705598, 48.73312505004027, -1.168725115921404, -4.7868555784949685, -14.592677675318946, -2.978976566652174, 1.7887118718536181, -7.078755225463846, -6.863991124477769, -14.24943828972884, -14.130573563130534, -9.598262680946382, 9.412854655292726, 14.381964450811498, -16.405425757402032, -0.41499417617433954, 20.383997582869693, -11.26671568542231, 3.0486355247139887, 6.012899289009671, -12.46640047902487, -12.246055945874472, -19.586974174551873, -10.060852228507247, -2.589874750221609, 47.61682095030201, 9.694934783108804, -22.77311577674857, -6.2992359473316455, 20.479231383590925, 22.903808451528562, -1.3094166417753048, 41.19388942368213, 4.704620284763985, 6.991455732033397, -5.2937956272080315, -10.675206149802388, 0.696731967089627, 10.300939246165463, -12.818556473533192, 4.714304866219331, 43.34526237100676, -4.388389805081559, -1.0617320723079435, 0.3011538782283666, -17.036069760294737, -13.809586338769611, 3.5835106559269643, 1.3979734718192312, -1.588438627200242, 9.574092799194402, 21.831929358117815, -3.9833379001002984, -7.325928865048243, -11.98688052193089, 46.5545453405424, -10.923972323921022, -3.839686814508447, 0.7744771631156505, 7.427651353157821, -8.732384329422313, -0.5858602026674851, -12.107734471223411, -2.0090151656770945, -8.52923649610018, 11.616369056038323, -6.716541750458073, -9.011761168635845, -4.917534489159184, -15.075175467757838, -10.108818871703445, -15.371693257490803, 1.9480010730322566, 0.6556728703393508, -12.38388384923042, 4.436425480992708, 4.186978531874296, -3.5173611581137854, -24.245042085984903, -6.096087190733749, 0.7520537006775305, -11.256877604922769, -7.492534165596449, 4.326958399331042, 12.57038678498624, -10.885542076048303, -13.599820993911543, -2.8679078872853676, -8.223061554287428, 53.49641564365795, 50.177330026978986, -14.715915239878456, 19.138973720696765, -8.205658955406909, -7.602978617799759, -17.24568641289543, -6.90967593107168, 16.30859863500717, 0.88469888442141, 32.9583312579156, -5.093412856900172, -25.89381817863851, 1.1889260403327875, -6.482205278459106, 7.784665638715902, -4.540052204061975, -10.28139185492698, -12.831008983361855, -12.947242758504796, -17.50634313182928, -5.618345463165782, 24.54403927194274, -6.879338844081536, 10.058026446985245, -16.076610489660787, -21.896331738782347, -4.555405125179474, -13.791246855371073, 0.3396223523563186, -6.647476838139154, -15.463784419223375, 0.3600605860917985, 46.474621388656324, 4.928566889064646, -16.186045362871457, -7.345162292409913, -11.879989197767255, -10.136479381795866, -5.646571593457738, 1.3516882817951743, -11.446459261910654, -6.980304809292454, -15.147919286333206, 47.49612959543686, 47.5036111679128, 17.752774458050617, -7.132482501618212, -10.637831827656493, -6.522164124203875, 1.888684080359219, -0.48223107163931117, -16.868411696690043, -14.982550958663818, -7.463044071307824, -2.620731873562123, -8.984357843270091, -17.022858976514545, -17.377047701862782, 9.994079795411109, -17.478471799559095, -9.675423407976089, 42.27573323902107, 49.99872123110619, -11.355936551471117, -15.425203872614937, -2.8635592324024155, -12.557170384639988, -7.9460407403065245, -0.2187813956669183, -10.936421978792875, -24.727615954845646, -12.443497981365386, -15.94017136965596, -17.845488270048413, 38.01686750920057, -0.5534066428114972, 24.73981660730942, -1.6950471824537952, -8.578808764330775, -9.397015784073517, -6.657526990894591, 19.113494981350915, 30.372371573241992, -3.7285114018626184, -8.161788123543905, 35.20635712183229, 3.161267640930722, -9.958243464180544, -3.312662354361465, -16.183004019252046, -19.39122130092535, -3.9852788828162082, 0.22910620535656673, -3.8921319886772956, 6.675680385027195, 23.429154439689974, -7.965039893615795, -6.144641566364588, 27.689811800857772, -0.5677691038081444, -1.6754093867745372]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8552953872621045, "mean_inference_ms": 0.8046199536109967, "mean_action_processing_ms": 0.13217458045281308, "mean_env_wait_ms": 1.990659914336579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002146124839782715, "StateBufferConnector_ms": 0.0022066831588745117, "ViewRequirementAgentConnector_ms": 0.05119156837463379}, "num_episodes": 29, "episode_return_max": 109.6824156436579, "episode_return_min": 65.59289460779648, "episode_return_mean": 79.85186605625799, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71954, "num_agent_steps_trained": 71954, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.9215643444896, "num_env_steps_trained_throughput_per_sec": 146.9215643444896, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 71954, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 71954, "timers": {"training_iteration_time_ms": 22500.488, "restore_workers_time_ms": 0.008, "training_step_time_ms": 22500.464, "sample_time_ms": 20578.884, "learn_time_ms": 1921.301, "learn_throughput": 2081.923, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 71954, "num_agent_steps_trained": 71954}, "done": false, "training_iteration": 6, "trial_id": "default", "date": "2025-10-13_04-37-21", "timestamp": 1760344641, "time_this_iter_s": 27.226011991500854, "time_total_s": 135.00582766532898, "pid": 48825, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16da94ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16da94c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 135.00582766532898, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 33.22105263157894, "ram_util_percent": 35.50000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 0.00010000000000000002, "total_loss": 3.292361646145582, "policy_loss": -0.007206275628414005, "vf_loss": 6.618805408477783, "vf_explained_var": -0.06849333588033915, "kl": 0.004018553149121838, "entropy": 9.847340127825737, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2080.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 0.0001, "total_loss": 1.4153415615596467, "policy_loss": -0.007544038877896373, "vf_loss": 2.8653634211373706, "vf_explained_var": 0.5301741868730575, "kl": 0.004484829579072298, "entropy": 9.81011945785038, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.76190476190476, "num_grad_updates_lifetime": 4095.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 83940, "num_agent_steps_trained": 83940}, "env_runners": {"episode_reward_max": 109.6824156436579, "episode_reward_min": 63.72770198137215, "episode_reward_mean": 79.86541988527988, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 6.008669973021033, "hider_policy": -25.89381817863851}, "policy_reward_max": {"seeker_policy": 117.89038269563093, "hider_policy": 53.49641564365795}, "policy_reward_mean": {"seeker_policy": 80.90356314871626, "hider_policy": -0.5190716317181766}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.97792935811783, 75.36007113495168, 100.35054534054237, 74.66715410397111, 84.27365135315777, 70.91004152327449, 74.53698483432292, 83.16236905603832, 69.67886913242762, 66.75910149712558, 80.49400107303217, 75.78167287033932, 82.19025769998206, 71.56863884188625, 74.11121216411007, 69.34424511887816, 84.00578090379202, 73.14244066069935, 77.16403485200577, 109.6824156436579, 85.14497372069668, 71.8007514930081, 71.24244425183787, 86.65459863500719, 90.29433125791556, 71.14642124725727, 84.8906656387158, 74.36069169094522, 67.05469482732909, 72.58891040981707, 87.61003927194264, 82.10402644698516, 75.61059487482052, 79.56562235235627, 71.91629036020238, 100.60062138865631, 80.1345668890646, 80.56083770759003, 75.75488317300118, 77.65768828179513, 70.14774791288231, 105.02692456289809, 86.1087744580506, 77.46626793948077, 77.19031140886867, 65.59289460779648, 72.99033386554767, 67.16164215672995, 80.59007979541106, 66.2879822089484, 104.8847212311062, 72.5981752142447, 75.62638092213389, 76.61243596331036, 71.14957802120709, 70.21378109269426, 91.56286750920061, 87.3015694745099, 82.63095281754619, 73.81626014850768, 88.98098408519263, 75.58690316680567, 92.53421248469361, 72.8810978525688, 82.31615737545359, 73.35301805868193, 75.86168038502717, 88.39515443968995, 89.73581180085779, 77.16801273862352, 70.47257216246946, 92.28027350184996, 93.2115314364804, 75.40568689454253, 74.9525879759468, 86.95552658968704, 90.06166904967232, 83.58883305145883, 76.18595127526713, 74.22445700981505, 93.00787708591908, 79.61899824308219, 72.89426475088784, 76.42559356789216, 88.56427267821296, 78.8733609047012, 77.48002681940463, 81.26369240676499, 95.45359177342613, 81.48002410971732, 75.39668570940103, 66.7120116626724, 63.72770198137215, 86.94029653448959, 71.55185220864028, 82.1743085763436, 75.88142749643553, 80.33977408487814, 108.49689337270364, 70.29246083392802], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [69.12933790010031, 94.67288052193085, 64.71997232392104, 77.73236375536386, 85.57838432942229, 83.60363619716541, 85.07523649610017, 78.2625417504581, 83.60816479022259, 91.94309583658688, 93.91769325749078, 87.50988384923043, 73.56685368711514, 99.33104208598492, 79.45524565416636, 88.09365688939734, 67.10843571947476, 97.62780373065918, 88.25500429357851, 6.008669973021033, 80.7219152398784, 87.60938906621485, 95.39780659580492, 69.46130111557862, 62.429412856900164, 95.85131338556297, 83.58820527845906, 89.18213574993418, 92.83294656919574, 95.71359900481217, 69.9453388440815, 88.12261048966079, 102.06233173878233, 93.01724685537103, 94.02755161756497, 53.765939413908235, 91.39204536287143, 99.78598919776726, 91.53793414825478, 87.75245926191063, 92.27597200850788, 10.027183799548405, 75.48848250161821, 94.62626389134117, 75.78385840014872, 97.44385726315029, 83.07410981041765, 93.16885897651451, 87.97304770186278, 93.44187741648354, 12.610266760978915, 99.37931563833074, 91.04711053917633, 84.77725809928381, 106.81361595484563, 98.59745044371563, 71.39148827004841, 63.11515951001206, 92.9048087643308, 89.87080292347571, 39.495117530599686, 87.47720269221219, 54.166587721930576, 86.15200367111083, 117.89038269563093, 77.10919073614164, 73.07813198867728, 72.9310398936158, 68.19064156636456, 79.41119122920614, 90.58255693586894, 68.83362416478366, 81.79318413473061, 87.34754217614878, 95.99144069126615, 68.00557755543852, 65.88746394578003, 79.80438204483626, 88.13966742111334, 78.58627993628575, 58.964025292398475, 85.06997383111275, 90.91064510843947, 86.89265809363911, 57.83856138748715, 73.80078091125814, 79.75019819410159, 85.9232491527679, 59.48627586705903, 81.67408041846089, 91.32646990555371, 96.95676058485004, 92.20431734720077, 52.56892931983367, 95.5079196102924, 117.4900185049792, 88.7159982952905, 95.34921868642589, 8.74973709005024, 97.0951250309869], "policy_hider_policy_reward": [21.831929358117815, -3.9833379001002984, -7.325928865048243, -11.98688052193089, 46.5545453405424, -10.923972323921022, -3.839686814508447, 0.7744771631156505, 7.427651353157821, -8.732384329422313, -0.5858602026674851, -12.107734471223411, -2.0090151656770945, -8.52923649610018, 11.616369056038323, -6.716541750458073, -9.011761168635845, -4.917534489159184, -15.075175467757838, -10.108818871703445, -15.371693257490803, 1.9480010730322566, 0.6556728703393508, -12.38388384923042, 4.436425480992708, 4.186978531874296, -3.5173611581137854, -24.245042085984903, -6.096087190733749, 0.7520537006775305, -11.256877604922769, -7.492534165596449, 4.326958399331042, 12.57038678498624, -10.885542076048303, -13.599820993911543, -2.8679078872853676, -8.223061554287428, 53.49641564365795, 50.177330026978986, -14.715915239878456, 19.138973720696765, -8.205658955406909, -7.602978617799759, -17.24568641289543, -6.90967593107168, 16.30859863500717, 0.88469888442141, 32.9583312579156, -5.093412856900172, -25.89381817863851, 1.1889260403327875, -6.482205278459106, 7.784665638715902, -4.540052204061975, -10.28139185492698, -12.831008983361855, -12.947242758504796, -17.50634313182928, -5.618345463165782, 24.54403927194274, -6.879338844081536, 10.058026446985245, -16.076610489660787, -21.896331738782347, -4.555405125179474, -13.791246855371073, 0.3396223523563186, -6.647476838139154, -15.463784419223375, 0.3600605860917985, 46.474621388656324, 4.928566889064646, -16.186045362871457, -7.345162292409913, -11.879989197767255, -10.136479381795866, -5.646571593457738, 1.3516882817951743, -11.446459261910654, -6.980304809292454, -15.147919286333206, 47.49612959543686, 47.5036111679128, 17.752774458050617, -7.132482501618212, -10.637831827656493, -6.522164124203875, 1.888684080359219, -0.48223107163931117, -16.868411696690043, -14.982550958663818, -7.463044071307824, -2.620731873562123, -8.984357843270091, -17.022858976514545, -17.377047701862782, 9.994079795411109, -17.478471799559095, -9.675423407976089, 42.27573323902107, 49.99872123110619, -11.355936551471117, -15.425203872614937, -2.8635592324024155, -12.557170384639988, -7.9460407403065245, -0.2187813956669183, -10.936421978792875, -24.727615954845646, -12.443497981365386, -15.94017136965596, -17.845488270048413, 38.01686750920057, -0.5534066428114972, 24.73981660730942, -1.6950471824537952, -8.578808764330775, -9.397015784073517, -6.657526990894591, 19.113494981350915, 30.372371573241992, -3.7285114018626184, -8.161788123543905, 35.20635712183229, 3.161267640930722, -9.958243464180544, -3.312662354361465, -16.183004019252046, -19.39122130092535, -3.9852788828162082, 0.22910620535656673, -3.8921319886772956, 6.675680385027195, 23.429154439689974, -7.965039893615795, -6.144641566364588, 27.689811800857772, -0.5677691038081444, -1.6754093867745372, -5.693427837530574, -14.416556935868915, 23.044273501849975, 0.40237583521637266, -18.517184134730613, 29.935531436480364, -2.2869646397507117, -9.654890641855557, -6.44612575767114, -14.59272695764816, 17.74952658968706, 1.2004224445614977, -5.471463945780035, 29.64566904967221, -4.048382044836251, 7.8328330514588025, 5.639951275267109, -17.593667421113327, -3.135021350858854, -1.2268015756118247, 38.80187708591905, -4.758025292398459, 3.452998243082153, -8.903973831112703, -4.659512845970036, -13.356867511581589, -7.679856450670202, -2.787208075076754, 2.3674386125128724, 28.35827267821302, -2.593531074767876, 7.666111068210929, 0.4740268194045955, -2.74419819410158, -7.789526105834858, 3.1299693598319047, 41.38759177342615, -5.420275867059029, 6.2740241097173675, -6.468080418460886, -5.113576124413982, -10.816208071738771, -14.660738326765285, -15.584010595412371, -17.82653752847742, -10.650077837351185, 6.80273342267782, 27.56863379197811, -12.572969986488008, -11.38309741516411, -14.122351994337315, -21.193357934298266, -11.917660523341437, -0.9169102755135137, -14.383218686425899, -0.6262259151218024, 50.82291350605808, 48.924242776595314, -13.029125030986867, -13.773539166072036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0394304017187745, "mean_inference_ms": 0.8110873486604325, "mean_action_processing_ms": 0.13324578676699247, "mean_env_wait_ms": 2.064282068995834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002187371253967285, "StateBufferConnector_ms": 0.0022039413452148438, "ViewRequirementAgentConnector_ms": 0.051833391189575195}, "num_episodes": 30, "episode_return_max": 109.6824156436579, "episode_return_min": 63.72770198137215, "episode_return_mean": 79.86541988527988, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83940, "num_agent_steps_trained": 83940, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.82431686458537, "num_env_steps_trained_throughput_per_sec": 144.82431686458537, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 83940, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 83940, "timers": {"training_iteration_time_ms": 23231.801, "restore_workers_time_ms": 0.008, "training_step_time_ms": 23231.777, "sample_time_ms": 21334.814, "learn_time_ms": 1896.698, "learn_throughput": 2108.928, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 83940, "num_agent_steps_trained": 83940}, "done": false, "training_iteration": 7, "trial_id": "default", "date": "2025-10-13_04-37-49", "timestamp": 1760344669, "time_this_iter_s": 27.620208978652954, "time_total_s": 162.62603664398193, "pid": 48825, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16da94ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16da94c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 162.62603664398193, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 36.8, "ram_util_percent": 35.5275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.2432658918201924, "policy_loss": -0.003759729095327202, "vf_loss": 6.513790591061115, "vf_explained_var": -0.04763275068253279, "kl": 0.0047780057155181535, "entropy": 9.877135199308395, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 0.0001, "total_loss": 1.1969144370347735, "policy_loss": -0.005935029858087618, "vf_loss": 2.4252442372223686, "vf_explained_var": 0.37971779070203265, "kl": 0.0044277049268711954, "entropy": 9.779572467198447, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.15873015873017, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 95888, "num_agent_steps_trained": 95888}, "env_runners": {"episode_reward_max": 108.49689337270364, "episode_reward_min": 63.72770198137215, "episode_reward_mean": 79.69674668424449, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 8.74973709005024, "hider_policy": -25.082671110170594}, "policy_reward_max": {"seeker_policy": 117.89038269563093, "hider_policy": 50.82291350605808}, "policy_reward_mean": {"seeker_policy": 82.32712092259364, "hider_policy": -1.3151871191745876}, "custom_metrics": {}, "hist_stats": {"episode_reward": [87.61003927194264, 82.10402644698516, 75.61059487482052, 79.56562235235627, 71.91629036020238, 100.60062138865631, 80.1345668890646, 80.56083770759003, 75.75488317300118, 77.65768828179513, 70.14774791288231, 105.02692456289809, 86.1087744580506, 77.46626793948077, 77.19031140886867, 65.59289460779648, 72.99033386554767, 67.16164215672995, 80.59007979541106, 66.2879822089484, 104.8847212311062, 72.5981752142447, 75.62638092213389, 76.61243596331036, 71.14957802120709, 70.21378109269426, 91.56286750920061, 87.3015694745099, 82.63095281754619, 73.81626014850768, 88.98098408519263, 75.58690316680567, 92.53421248469361, 72.8810978525688, 82.31615737545359, 73.35301805868193, 75.86168038502717, 88.39515443968995, 89.73581180085779, 77.16801273862352, 70.47257216246946, 92.28027350184996, 93.2115314364804, 75.40568689454253, 74.9525879759468, 86.95552658968704, 90.06166904967232, 83.58883305145883, 76.18595127526713, 74.22445700981505, 93.00787708591908, 79.61899824308219, 72.89426475088784, 76.42559356789216, 88.56427267821296, 78.8733609047012, 77.48002681940463, 81.26369240676499, 95.45359177342613, 81.48002410971732, 75.39668570940103, 66.7120116626724, 63.72770198137215, 86.94029653448959, 71.55185220864028, 82.1743085763436, 75.88142749643553, 80.33977408487814, 108.49689337270364, 70.29246083392802, 80.91105681470845, 91.70738102875758, 73.4293432433466, 86.60883638345439, 69.73261394852648, 77.85366376977414, 76.95984739796457, 72.01564971995036, 83.4288994714395, 82.88141241997265, 88.78885845391287, 77.83057469737179, 87.34753010932397, 74.17985276873837, 66.80275161642662, 74.6501340861705, 68.49369344590697, 70.76811911707541, 77.25605750375765, 79.64250356549542, 74.61872887546502, 80.37084833381539, 79.62892844651363, 81.69802118887101, 75.48645817004027, 80.60885044503762, 73.25347877789866, 77.47208953157921, 78.59848126139052, 79.44791563861541], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [69.9453388440815, 88.12261048966079, 102.06233173878233, 93.01724685537103, 94.02755161756497, 53.765939413908235, 91.39204536287143, 99.78598919776726, 91.53793414825478, 87.75245926191063, 92.27597200850788, 10.027183799548405, 75.48848250161821, 94.62626389134117, 75.78385840014872, 97.44385726315029, 83.07410981041765, 93.16885897651451, 87.97304770186278, 93.44187741648354, 12.610266760978915, 99.37931563833074, 91.04711053917633, 84.77725809928381, 106.81361595484563, 98.59745044371563, 71.39148827004841, 63.11515951001206, 92.9048087643308, 89.87080292347571, 39.495117530599686, 87.47720269221219, 54.166587721930576, 86.15200367111083, 117.89038269563093, 77.10919073614164, 73.07813198867728, 72.9310398936158, 68.19064156636456, 79.41119122920614, 90.58255693586894, 68.83362416478366, 81.79318413473061, 87.34754217614878, 95.99144069126615, 68.00557755543852, 65.88746394578003, 79.80438204483626, 88.13966742111334, 78.58627993628575, 58.964025292398475, 85.06997383111275, 90.91064510843947, 86.89265809363911, 57.83856138748715, 73.80078091125814, 79.75019819410159, 85.9232491527679, 59.48627586705903, 81.67408041846089, 91.32646990555371, 96.95676058485004, 92.20431734720077, 52.56892931983367, 95.5079196102924, 117.4900185049792, 88.7159982952905, 95.34921868642589, 8.74973709005024, 97.0951250309869, 72.4454800436272, 68.8408298452354, 94.27904525131547, 68.4296058544825, 94.6621520098622, 80.47474553414257, 89.93853874728623, 108.28060135889744, 84.32927905885501, 72.00286474999668, 89.9219980282095, 83.35110205339726, 56.406715532638856, 91.762773715802, 93.67895536977737, 88.05452732859717, 87.85106741358818, 97.2852182467014, 79.32174052592438, 73.49495739636747, 84.3891105641134, 81.78656188470805, 104.1629085593145, 100.94669996921216, 94.76823523985009, 98.10867111017063, 91.54763638698333, 84.16826859827547, 88.30407953868759, 87.34933537545221], "policy_hider_policy_reward": [24.54403927194274, -6.879338844081536, 10.058026446985245, -16.076610489660787, -21.896331738782347, -4.555405125179474, -13.791246855371073, 0.3396223523563186, -6.647476838139154, -15.463784419223375, 0.3600605860917985, 46.474621388656324, 4.928566889064646, -16.186045362871457, -7.345162292409913, -11.879989197767255, -10.136479381795866, -5.646571593457738, 1.3516882817951743, -11.446459261910654, -6.980304809292454, -15.147919286333206, 47.49612959543686, 47.5036111679128, 17.752774458050617, -7.132482501618212, -10.637831827656493, -6.522164124203875, 1.888684080359219, -0.48223107163931117, -16.868411696690043, -14.982550958663818, -7.463044071307824, -2.620731873562123, -8.984357843270091, -17.022858976514545, -17.377047701862782, 9.994079795411109, -17.478471799559095, -9.675423407976089, 42.27573323902107, 49.99872123110619, -11.355936551471117, -15.425203872614937, -2.8635592324024155, -12.557170384639988, -7.9460407403065245, -0.2187813956669183, -10.936421978792875, -24.727615954845646, -12.443497981365386, -15.94017136965596, -17.845488270048413, 38.01686750920057, -0.5534066428114972, 24.73981660730942, -1.6950471824537952, -8.578808764330775, -9.397015784073517, -6.657526990894591, 19.113494981350915, 30.372371573241992, -3.7285114018626184, -8.161788123543905, 35.20635712183229, 3.161267640930722, -9.958243464180544, -3.312662354361465, -16.183004019252046, -19.39122130092535, -3.9852788828162082, 0.22910620535656673, -3.8921319886772956, 6.675680385027195, 23.429154439689974, -7.965039893615795, -6.144641566364588, 27.689811800857772, -0.5677691038081444, -1.6754093867745372, -5.693427837530574, -14.416556935868915, 23.044273501849975, 0.40237583521637266, -18.517184134730613, 29.935531436480364, -2.2869646397507117, -9.654890641855557, -6.44612575767114, -14.59272695764816, 17.74952658968706, 1.2004224445614977, -5.471463945780035, 29.64566904967221, -4.048382044836251, 7.8328330514588025, 5.639951275267109, -17.593667421113327, -3.135021350858854, -1.2268015756118247, 38.80187708591905, -4.758025292398459, 3.452998243082153, -8.903973831112703, -4.659512845970036, -13.356867511581589, -7.679856450670202, -2.787208075076754, 2.3674386125128724, 28.35827267821302, -2.593531074767876, 7.666111068210929, 0.4740268194045955, -2.74419819410158, -7.789526105834858, 3.1299693598319047, 41.38759177342615, -5.420275867059029, 6.2740241097173675, -6.468080418460886, -5.113576124413982, -10.816208071738771, -14.660738326765285, -15.584010595412371, -17.82653752847742, -10.650077837351185, 6.80273342267782, 27.56863379197811, -12.572969986488008, -11.38309741516411, -14.122351994337315, -21.193357934298266, -11.917660523341437, -0.9169102755135137, -14.383218686425899, -0.6262259151218024, 50.82291350605808, 48.924242776595314, -13.029125030986867, -13.773539166072036, 3.9175049223742575, 4.548071848706996, 35.32138102875768, -12.454829845235434, -9.556656756653299, -11.293045251315517, 27.942836383454328, -9.763605854482515, -14.763551478383956, -10.165986582951733, -10.248745534142563, 7.627663769774219, -4.414862962727213, -8.563828386594409, -20.289348366465774, -15.9756032724813, 6.382899471439597, -7.283279058855014, -1.8916938750806382, 12.770241545056649, -23.655998028209538, 22.522858453912843, -6.145102053397238, 0.6245746973718032, 6.768715012444091, 24.172099564241034, -9.709817270924317, -7.873103676139308, -13.812055225306754, -13.064148528044072, -0.9761023710536065, -12.428290871373154, -9.57136581975191, -9.786008147929325, -9.99788088292454, -16.519218246701428, 0.949911150216401, -3.015594172383157, 5.1568699713725055, 0.9906761977554841, -9.843110564113413, 0.07272887546503724, -2.658424121149006, 1.2427105702563919, -9.479663320627566, -15.054316792173358, -12.17977775231291, -7.06890102802822, -14.862235239850087, -4.419541829959669, 7.582850445037633, -25.082671110170594, -10.214365332709942, -8.07979227637473, -7.783060246943341, 1.0868811802471858, -6.6436186922949565, -3.0619795850021125, -6.143335375452248, -1.758084361384505]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.189486286486501, "mean_inference_ms": 0.8177058043397519, "mean_action_processing_ms": 0.13409841479873288, "mean_env_wait_ms": 2.133416598838611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021904706954956055, "StateBufferConnector_ms": 0.0022068023681640625, "ViewRequirementAgentConnector_ms": 0.05256021022796631}, "num_episodes": 30, "episode_return_max": 108.49689337270364, "episode_return_min": 63.72770198137215, "episode_return_mean": 79.69674668424449, "episodes_this_iter": 30}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95888, "num_agent_steps_trained": 95888, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 138.1676196982966, "num_env_steps_trained_throughput_per_sec": 138.1676196982966, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 95888, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 95888, "timers": {"training_iteration_time_ms": 23946.619, "restore_workers_time_ms": 0.008, "training_step_time_ms": 23946.595, "sample_time_ms": 22060.458, "learn_time_ms": 1885.88, "learn_throughput": 2121.026, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 95888, "num_agent_steps_trained": 95888}, "done": false, "training_iteration": 8, "trial_id": "default", "date": "2025-10-13_04-38-18", "timestamp": 1760344698, "time_this_iter_s": 28.950894832611084, "time_total_s": 191.57693147659302, "pid": 48825, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16da94ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16da94c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 191.57693147659302, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.985365853658532, "ram_util_percent": 35.44146341463414}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"seeker_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 0.00010000000000000002, "total_loss": 3.1189520291984083, "policy_loss": -0.007556800090242177, "vf_loss": 6.272796107828617, "vf_explained_var": -0.05400922652333975, "kl": 0.0042181970654013605, "entropy": 9.892514091730117, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2720.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}, "hider_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 0.0001, "total_loss": 1.3176859906741551, "policy_loss": -0.007077637100813999, "vf_loss": 2.669109719140189, "vf_explained_var": 0.4805011894967821, "kl": 0.003598722244341563, "entropy": 9.794045458899603, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 5355.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 107888, "num_agent_steps_trained": 107888}, "env_runners": {"episode_reward_max": 108.49689337270364, "episode_reward_min": 63.72770198137215, "episode_reward_mean": 79.15119196714949, "episode_len_mean": 135.0, "episode_media": {}, "episodes_timesteps_total": 13500, "policy_reward_min": {"seeker_policy": 8.74973709005024, "hider_policy": -27.970138130928227}, "policy_reward_max": {"seeker_policy": 117.89038269563093, "hider_policy": 50.82291350605808}, "policy_reward_mean": {"seeker_policy": 82.52162288397656, "hider_policy": -1.6852154584135395}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.81626014850768, 88.98098408519263, 75.58690316680567, 92.53421248469361, 72.8810978525688, 82.31615737545359, 73.35301805868193, 75.86168038502717, 88.39515443968995, 89.73581180085779, 77.16801273862352, 70.47257216246946, 92.28027350184996, 93.2115314364804, 75.40568689454253, 74.9525879759468, 86.95552658968704, 90.06166904967232, 83.58883305145883, 76.18595127526713, 74.22445700981505, 93.00787708591908, 79.61899824308219, 72.89426475088784, 76.42559356789216, 88.56427267821296, 78.8733609047012, 77.48002681940463, 81.26369240676499, 95.45359177342613, 81.48002410971732, 75.39668570940103, 66.7120116626724, 63.72770198137215, 86.94029653448959, 71.55185220864028, 82.1743085763436, 75.88142749643553, 80.33977408487814, 108.49689337270364, 70.29246083392802, 80.91105681470845, 91.70738102875758, 73.4293432433466, 86.60883638345439, 69.73261394852648, 77.85366376977414, 76.95984739796457, 72.01564971995036, 83.4288994714395, 82.88141241997265, 88.78885845391287, 77.83057469737179, 87.34753010932397, 74.17985276873837, 66.80275161642662, 74.6501340861705, 68.49369344590697, 70.76811911707541, 77.25605750375765, 79.64250356549542, 74.61872887546502, 80.37084833381539, 79.62892844651363, 81.69802118887101, 75.48645817004027, 80.60885044503762, 73.25347877789866, 77.47208953157921, 78.59848126139052, 79.44791563861541, 68.78101807191261, 87.07116498152259, 81.53593325144826, 70.470028433924, 75.25646288292516, 65.05397463733337, 80.31431348108985, 73.35475212703523, 86.2065512461547, 86.314794359591, 84.52753433427024, 68.1885289736417, 74.03851250724064, 74.65548322683803, 67.79739142131923, 92.02240057063122, 83.86032904841431, 87.62047224104683, 77.77057526432141, 84.74280154174686, 70.49729871182048, 82.28999926289106, 67.27910396470868, 73.84052579063936, 91.49877005579437, 82.36034042749844, 75.44324242833552, 69.07526253606771, 76.23555441931907], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_seeker_policy_reward": [89.87080292347571, 39.495117530599686, 87.47720269221219, 54.166587721930576, 86.15200367111083, 117.89038269563093, 77.10919073614164, 73.07813198867728, 72.9310398936158, 68.19064156636456, 79.41119122920614, 90.58255693586894, 68.83362416478366, 81.79318413473061, 87.34754217614878, 95.99144069126615, 68.00557755543852, 65.88746394578003, 79.80438204483626, 88.13966742111334, 78.58627993628575, 58.964025292398475, 85.06997383111275, 90.91064510843947, 86.89265809363911, 57.83856138748715, 73.80078091125814, 79.75019819410159, 85.9232491527679, 59.48627586705903, 81.67408041846089, 91.32646990555371, 96.95676058485004, 92.20431734720077, 52.56892931983367, 95.5079196102924, 117.4900185049792, 88.7159982952905, 95.34921868642589, 8.74973709005024, 97.0951250309869, 72.4454800436272, 68.8408298452354, 94.27904525131547, 68.4296058544825, 94.6621520098622, 80.47474553414257, 89.93853874728623, 108.28060135889744, 84.32927905885501, 72.00286474999668, 89.9219980282095, 83.35110205339726, 56.406715532638856, 91.762773715802, 93.67895536977737, 88.05452732859717, 87.85106741358818, 97.2852182467014, 79.32174052592438, 73.49495739636747, 84.3891105641134, 81.78656188470805, 104.1629085593145, 100.94669996921216, 94.76823523985009, 98.10867111017063, 91.54763638698333, 84.16826859827547, 88.30407953868759, 87.34933537545221, 86.7944793793151, 69.99633987482866, 89.00496392212824, 92.4585572485114, 95.26381148220348, 107.32759331391674, 87.17331187086003, 81.82366432968783, 63.37021943923607, 81.03746447566779, 50.148262940031195, 100.68372835329257, 78.02893275079059, 104.3887780109005, 97.61384141636013, 70.3574251551036, 66.08973514064812, 69.59997261950917, 76.0671352941376, 73.44885376470565, 89.81409037568618, 76.59319086467895, 94.50403699828867, 89.83114814740618, 71.16065863206124, 86.35243780383043, 97.97256028190085, 79.15048874025376, 88.74394619283824], "policy_hider_policy_reward": [-9.397015784073517, -6.657526990894591, 19.113494981350915, 30.372371573241992, -3.7285114018626184, -8.161788123543905, 35.20635712183229, 3.161267640930722, -9.958243464180544, -3.312662354361465, -16.183004019252046, -19.39122130092535, -3.9852788828162082, 0.22910620535656673, -3.8921319886772956, 6.675680385027195, 23.429154439689974, -7.965039893615795, -6.144641566364588, 27.689811800857772, -0.5677691038081444, -1.6754093867745372, -5.693427837530574, -14.416556935868915, 23.044273501849975, 0.40237583521637266, -18.517184134730613, 29.935531436480364, -2.2869646397507117, -9.654890641855557, -6.44612575767114, -14.59272695764816, 17.74952658968706, 1.2004224445614977, -5.471463945780035, 29.64566904967221, -4.048382044836251, 7.8328330514588025, 5.639951275267109, -17.593667421113327, -3.135021350858854, -1.2268015756118247, 38.80187708591905, -4.758025292398459, 3.452998243082153, -8.903973831112703, -4.659512845970036, -13.356867511581589, -7.679856450670202, -2.787208075076754, 2.3674386125128724, 28.35827267821302, -2.593531074767876, 7.666111068210929, 0.4740268194045955, -2.74419819410158, -7.789526105834858, 3.1299693598319047, 41.38759177342615, -5.420275867059029, 6.2740241097173675, -6.468080418460886, -5.113576124413982, -10.816208071738771, -14.660738326765285, -15.584010595412371, -17.82653752847742, -10.650077837351185, 6.80273342267782, 27.56863379197811, -12.572969986488008, -11.38309741516411, -14.122351994337315, -21.193357934298266, -11.917660523341437, -0.9169102755135137, -14.383218686425899, -0.6262259151218024, 50.82291350605808, 48.924242776595314, -13.029125030986867, -13.773539166072036, 3.9175049223742575, 4.548071848706996, 35.32138102875768, -12.454829845235434, -9.556656756653299, -11.293045251315517, 27.942836383454328, -9.763605854482515, -14.763551478383956, -10.165986582951733, -10.248745534142563, 7.627663769774219, -4.414862962727213, -8.563828386594409, -20.289348366465774, -15.9756032724813, 6.382899471439597, -7.283279058855014, -1.8916938750806382, 12.770241545056649, -23.655998028209538, 22.522858453912843, -6.145102053397238, 0.6245746973718032, 6.768715012444091, 24.172099564241034, -9.709817270924317, -7.873103676139308, -13.812055225306754, -13.064148528044072, -0.9761023710536065, -12.428290871373154, -9.57136581975191, -9.786008147929325, -9.99788088292454, -16.519218246701428, 0.949911150216401, -3.015594172383157, 5.1568699713725055, 0.9906761977554841, -9.843110564113413, 0.07272887546503724, -2.658424121149006, 1.2427105702563919, -9.479663320627566, -15.054316792173358, -12.17977775231291, -7.06890102802822, -14.862235239850087, -4.419541829959669, 7.582850445037633, -25.082671110170594, -10.214365332709942, -8.07979227637473, -7.783060246943341, 1.0868811802471858, -6.6436186922949565, -3.0619795850021125, -6.143335375452248, -1.758084361384505, -12.367279379315143, -5.646181928087424, 25.14516498152265, -8.07033987482868, 3.329933251448371, -10.798963922128298, -10.372557248511391, -11.615971566075945, -6.238407128982185, -13.768941470296115, -27.970138130928227, -14.303480545655084, 5.1083134810897715, -11.967311870859993, -5.912217359727496, -2.556694842925158, 8.17958137537053, 14.656750431548152, -9.851464475667807, 15.128794359591021, 17.50787252487001, 16.871398869369024, -17.566670565791338, -14.928528813859545, 5.841616319960657, -9.832036563510632, -11.757139737800145, -17.976155046262377, -13.594625267896987, -16.22182472714396, -6.071425155103622, 27.736400570631304, 7.262978428919223, 10.507615478846938, -9.47397261950919, 27.494472241046793, -4.617020404392504, 6.320460374576299, 12.656801541746823, -1.3628537647056473, -11.938278981710901, -7.378512682154856, -4.327190864678951, 10.023999262891104, -13.606936721662887, -13.617996311917082, -3.34602142109541, -12.64460093567139, 34.59277005579437, -14.254658632061217, 10.414340427498486, -14.406437803830448, -4.9404065524533065, -17.588911301112056, -4.3856990946108905, -5.68952710957513, -9.386751686236, -3.1216400872831023]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.303912036497386, "mean_inference_ms": 0.8207829850617575, "mean_action_processing_ms": 0.1345977082903907, "mean_env_wait_ms": 2.19259732518104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002124786376953125, "StateBufferConnector_ms": 0.0021505355834960938, "ViewRequirementAgentConnector_ms": 0.05113112926483154}, "num_episodes": 29, "episode_return_max": 108.49689337270364, "episode_return_min": 63.72770198137215, "episode_return_mean": 79.15119196714949, "episodes_this_iter": 29}, "num_healthy_workers": 0, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107888, "num_agent_steps_trained": 107888, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 136.73410145661956, "num_env_steps_trained_throughput_per_sec": 136.73410145661956, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 107888, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 107888, "timers": {"training_iteration_time_ms": 24536.313, "restore_workers_time_ms": 0.008, "training_step_time_ms": 24536.29, "sample_time_ms": 22663.179, "learn_time_ms": 1872.864, "learn_throughput": 2135.766, "synch_weights_time_ms": 0.002}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 107888, "num_agent_steps_trained": 107888}, "done": false, "training_iteration": 9, "trial_id": "default", "date": "2025-10-13_04-38-47", "timestamp": 1760344727, "time_this_iter_s": 29.25438904762268, "time_total_s": 220.8313205242157, "pid": 48825, "hostname": "Mac.attlocal.net", "node_ip": "127.0.0.1", "config": {"exploration_config": {"type": "StochasticSampling"}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "<class 'ppo_trainer.RLlibMinecraftEnv'>", "env_config": {"environment": {"observation_size": 94, "action_space_type": "continuous", "continuous_actions": {"movement_forward": [-1.0, 1.0], "movement_strafe": [-1.0, 1.0], "rotation": [-1.0, 1.0], "look": [-1.0, 1.0], "jump": [0.0, 1.0], "place_block": [0.0, 1.0], "remove_block": [0.0, 1.0]}, "max_steps": 150, "rewards": {"seeker_visibility": 1.0, "hider_hidden": 1.0, "hider_seen": -1.0, "exploration": 0.1, "stationary": 0.05, "time_penalty": -0.001, "seeker_success": 10.0, "seeker_failure": -5.0, "hider_survival": 10.0, "hider_caught": -5.0}}, "ppo": {"lr_seeker": 0.0001, "lr_hider": 0.0001, "gamma": 0.99, "lambda": 0.95, "clip_param": 0.2, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "train_batch_size": 4000, "minibatch_size": 128, "num_epochs": 10, "grad_clip": 0.5, "kl_coeff": 0.2, "kl_target": 0.01, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu"}, "num_workers": 0, "num_envs_per_worker": 1, "checkpoint_freq": 10, "checkpoint_dir": "./checkpoints"}, "websocket": {"host": "localhost", "port": 8765}, "training": {"total_episodes": 5000, "eval_frequency": 10, "log_frequency": 1}}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4000, "num_epochs": 10, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [128, 128, 64], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "_prior_exploration_config": null, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function create_ppo_trainer.<locals>.policy_mapping_fn at 0x16da94ae0>", "policies_to_train": ["seeker_policy", "hider_policy"], "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function create_ppo_trainer.<locals>.<lambda> at 0x16da94c20>", "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.001, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "class": "<class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>", "lambda": 0.95, "input": "sampler", "policies": {"seeker_policy": [null, null, null, {"lr": 0.0001}], "hider_policy": [null, null, null, {"lr": 0.0001}]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 220.8313205242157, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 30.99512195121951, "ram_util_percent": 35.517073170731706}}
